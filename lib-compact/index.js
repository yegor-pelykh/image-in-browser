(()=>{var ws=Object.create;var Vn=Object.defineProperty,Is=Object.defineProperties,As=Object.getOwnPropertyDescriptor,vs=Object.getOwnPropertyDescriptors,Ps=Object.getOwnPropertyNames,hs=Object.getOwnPropertySymbols,Ss=Object.getPrototypeOf,cs=Object.prototype.hasOwnProperty,Cs=Object.prototype.propertyIsEnumerable;var fs=(m,e,t)=>e in m?Vn(m,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):m[e]=t,ds=(m,e)=>{for(var t in e||={})cs.call(e,t)&&fs(m,t,e[t]);if(hs)for(var t of hs(e))Cs.call(e,t)&&fs(m,t,e[t]);return m},ms=(m,e)=>Is(m,vs(e));var C=(m,e)=>()=>(m&&(e=m(m=0)),e);var Ms=(m,e)=>()=>(e||m((e={exports:{}}).exports,e),e.exports);var Bs=(m,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of Ps(e))!cs.call(m,r)&&r!==t&&Vn(m,r,{get:()=>e[r],enumerable:!(i=As(e,r))||i.enumerable});return m};var An=(m,e,t)=>(t=m!=null?ws(Ss(m)):{},Bs(e||!m||!m.__esModule?Vn(t,"default",{value:m,enumerable:!0}):t,m));var T,ue=C(()=>{"use strict";T=class extends Error{toString(){return`ImageError: ${this.message}`}}});var te,ut=C(()=>{"use strict";ue();te=class{static copyInt8(e,t,i){return Int8Array.from(e.subarray(t,i))}static copyUint8(e,t,i){return Uint8Array.from(e.subarray(t,i))}static copyInt16(e,t,i){return Int16Array.from(e.subarray(t,i))}static copyUint16(e,t,i){return Uint16Array.from(e.subarray(t,i))}static copyInt32(e,t,i){return Int32Array.from(e.subarray(t,i))}static copyUint32(e,t,i){return Uint32Array.from(e.subarray(t,i))}static copyFloat32(e,t,i){return Float32Array.from(e.subarray(t,i))}static copyFloat64(e,t,i){return Float64Array.from(e.subarray(t,i))}static copy(e,t,i){if(e instanceof Int8Array)return te.copyInt8(e,t,i);if(e instanceof Uint8Array)return te.copyUint8(e,t,i);if(e instanceof Int16Array)return te.copyInt16(e,t,i);if(e instanceof Uint16Array)return te.copyUint16(e,t,i);if(e instanceof Int32Array)return te.copyInt32(e,t,i);if(e instanceof Uint32Array)return te.copyUint32(e,t,i);if(e instanceof Float32Array)return te.copyFloat32(e,t,i);if(e instanceof Float64Array)return te.copyFloat64(e,t,i);throw new T("Unknown array type")}static setRange(e,t,i,r,n=0){let s=r.subarray(n,i-t);e.set(s,t)}}});var ae,E,je=C(()=>{"use strict";ae=class{static signed(e,t){return t&1<<e-1?t-(1<<e):t}static shiftR(e,t){return ae.signed(32,e>>t)}static shiftL(e,t){return ae.signed(32,e<<t)}static toInt8(e){return ae.uint8arr[0]=e,ae.uint8ToInt8arr[0]}static toUint8(e){return ae.int8arr[0]=e,ae.int8ToUint8arr[0]}static toInt16(e){return ae.uint16arr[0]=e,ae.uint16ToInt16arr[0]}static toUint16(e){return ae.int16arr[0]=e,ae.int16ToUint16arr[0]}static toInt32(e){return ae.uint32arr[0]=e,ae.uint32ToInt32arr[0]}static toUint32(e){return ae.int32arr[0]=e,ae.int32ToUint32arr[0]}static toFloat32(e){return ae.uint32arr[0]=e,ae.uint32ToFloat32arr[0]}static toFloat64(e){return ae.uint64arr[0]=e,ae.uint64ToFloat64arr[0]}static debugBits32(e){if(e===void 0)return"undefined";let t=32,i="";for(let r=t;r>-1;r--)i+=(e&1<<r)===0?"0":"1";return i}},E=ae;E.uint8arr=new Uint8Array(1),E.uint8ToInt8arr=new Int8Array(ae.uint8arr.buffer),E.int8arr=new Int8Array(1),E.int8ToUint8arr=new Uint8Array(ae.int8arr.buffer),E.uint16arr=new Uint16Array(1),E.uint16ToInt16arr=new Int16Array(ae.uint16arr.buffer),E.int16arr=new Int16Array(1),E.int16ToUint16arr=new Uint16Array(ae.int16arr.buffer),E.uint32arr=new Uint32Array(1),E.uint32ToInt32arr=new Int32Array(ae.uint32arr.buffer),E.int32arr=new Int32Array(1),E.int32ToUint32arr=new Uint32Array(ae.int32arr.buffer),E.uint32ToFloat32arr=new Float32Array(ae.uint32arr.buffer),E.uint64arr=new BigUint64Array(1),E.uint64ToFloat64arr=new Float64Array(ae.uint64arr.buffer)});var Ht=C(()=>{"use strict"});var Vt=C(()=>{"use strict"});var Ci=C(()=>{"use strict"});var F,Qe=C(()=>{"use strict";F=class{static gcd(e,t){let i=Math.abs(e),r=Math.abs(t);for(;r;){let n=r;r=i%r,i=n}return i}static clamp(e,t,i){return Math.max(t,Math.min(e,i))}static clampInt(e,t,i){return Math.trunc(F.clamp(e,t,i))}static clampInt255(e){return Math.trunc(F.clamp(e,0,255))}}});var d,ge=C(()=>{"use strict";ue();je();Vt();Qe();d=class{static fromRgb(e,t,i){return d.getColor(e,t,i)}static fromRgba(e,t,i,r){return d.getColor(e,t,i,r)}static fromHsl(e,t,i){let r=d.hslToRgb(e,t,i);return d.getColor(r[0],r[1],r[2])}static fromHsv(e,t,i){let r=d.hsvToRgb(e,t,i);return d.getColor(r[0],r[1],r[2])}static fromXyz(e,t,i){let r=d.xyzToRgb(e,t,i);return d.getColor(r[0],r[1],r[2])}static fromLab(e,t,i){let r=d.labToRgb(e,t,i);return d.getColor(r[0],r[1],r[2])}static distance(e,t,i){let r=e[0]-t[0],n=e[1]-t[1],s=e[2]-t[2];if(i){let a=e[3]-t[3];return Math.sqrt(Math.max(r*r,(r-a)*(r-a))+Math.max(n*n,(n-a)*(n-a))+Math.max(s*s,(s-a)*(s-a)))}else return Math.sqrt(r*r+n*n+s*s)}static alphaBlendColors(e,t,i=255){let r=d.getAlpha(t);if(r===255&&i===255)return t;if(r===0&&i===255)return e;let n=r/255;i!==255&&(n*=i/255);let s=Math.round(d.getRed(t)*n),a=Math.round(d.getGreen(t)*n),o=Math.round(d.getBlue(t)*n),u=Math.round(r*n),l=Math.round(d.getRed(e)*(1-n)),h=Math.round(d.getGreen(e)*(1-n)),f=Math.round(d.getBlue(e)*(1-n)),c=Math.round(d.getAlpha(e)*(1-n));return d.getColor(s+l,a+h,o+f,u+c)}static getChannel(e,t){return t===0?d.getRed(e):t===1?d.getGreen(e):t===2?d.getBlue(e):t===3?d.getAlpha(e):d.getLuminance(e)}static getAlpha(e){return e>>24&255}static getBlue(e){return e>>16&255}static getColor(e,t,i,r=255){let n=F.clampInt255(r)<<24|F.clampInt255(i)<<16|F.clampInt255(t)<<8|F.clampInt255(e);return E.toUint32(n)}static getGreen(e){return e>>8&255}static getLuminance(e){let t=d.getRed(e),i=d.getGreen(e),r=d.getBlue(e);return d.getLuminanceRgb(t,i,r)}static getLuminanceRgb(e,t,i){return Math.round(.299*e+.587*t+.114*i)}static getRed(e){return e&255}static isBlack(e){return(e&16777215)===0}static isWhite(e){return(e&16777215)===16777215}static setAlpha(e,t){return e&16777215|F.clampInt255(t)<<24}static setBlue(e,t){return e&4278255615|F.clampInt255(t)<<16}static setChannel(e,t,i){return t===0?d.setRed(e,i):t===1?d.setGreen(e,i):t===2?d.setBlue(e,i):t===3?d.setAlpha(e,i):e}static setGreen(e,t){return e&4294902015|F.clampInt255(t)<<8}static setRed(e,t){return e&4294967040|F.clampInt255(t)}static hslToRgb(e,t,i){if(t===0){let l=Math.trunc(i*255);return[l,l,l]}let r=(l,h,f)=>{let c=f;return c<0&&(c+=1),c>1&&(c-=1),c<1/6?l+(h-l)*6*c:c<1/2?h:c<2/3?l+(h-l)*(2/3-c)*6:l},n=i<.5?i*(1+t):i+t-i*t,s=2*i-n,a=r(s,n,e+1/3),o=r(s,n,e),u=r(s,n,e-1/3);return[Math.round(a*255),Math.round(o*255),Math.round(u*255)]}static hsvToRgb(e,t,i){if(t===0){let u=Math.round(i*255);return[u,u,u]}let r=(e-Math.floor(e))*6,n=r-Math.floor(r),s=i*(1-t),a=i*(1-t*n),o=i*(1-t*(1-n));switch(Math.trunc(r)){case 0:return[Math.round(i*255),Math.round(o*255),Math.round(s*255)];case 1:return[Math.round(a*255),Math.round(i*255),Math.round(s*255)];case 2:return[Math.round(s*255),Math.round(i*255),Math.round(o*255)];case 3:return[Math.round(s*255),Math.round(a*255),Math.round(i*255)];case 4:return[Math.round(o*255),Math.round(s*255),Math.round(i*255)];case 5:return[Math.round(i*255),Math.round(s*255),Math.round(a*255)];default:throw new T("Invalid hue")}}static rgbToHsl(e,t,i){let r=e/255,n=t/255,s=i/255,a=Math.max(r,Math.max(n,s)),o=Math.min(r,Math.min(n,s)),u=(a+o)/2;if(a===o)return[0,0,u];let l=a-o,h=u>.5?l/(2-a-o):l/(a+o),f=0;return a===r?f=(n-s)/l+(n<s?6:0):a===n?f=(s-r)/l+2:f=(r-n)/l+4,f/=6,[f,h,u]}static labToXyz(e,t,i){let r=(e+16)/116,n=r+t/500,s=r-i/200;return Math.pow(n,3)>.008856?n=Math.pow(n,3):n=(n-16/116)/7.787,Math.pow(r,3)>.008856?r=Math.pow(r,3):r=(r-16/116)/7.787,Math.pow(s,3)>.008856?s=Math.pow(s,3):s=(s-16/116)/7.787,[Math.trunc(n*95.047),Math.trunc(r*100),Math.trunc(s*108.883)]}static xyzToRgb(e,t,i){let r=e/100,n=t/100,s=i/100,a=3.2406*r+-1.5372*n+-.4986*s,o=-.9689*r+1.8758*n+.0415*s,u=.0557*r+-.204*n+1.057*s;return a>.0031308?a=1.055*Math.pow(a,.4166666667)-.055:a*=12.92,o>.0031308?o=1.055*Math.pow(o,.4166666667)-.055:o*=12.92,u>.0031308?u=1.055*Math.pow(u,.4166666667)-.055:u*=12.92,[Math.trunc(F.clamp(a*255,0,255)),Math.trunc(F.clamp(o*255,0,255)),Math.trunc(F.clamp(u*255,0,255))]}static cmykToRgb(e,t,i,r){let n=e/255,s=t/255,a=i/255,o=r/255;return[Math.round(255*(1-n)*(1-o)),Math.round(255*(1-s)*(1-o)),Math.round(255*(1-a)*(1-o))]}static labToRgb(e,t,i){let a=(e+16)/116,o=t/500+a,u=a-i/200,l=Math.pow(a,3);l>.008856?a=l:a=(a-16/116)/7.787;let h=Math.pow(o,3);h>.008856?o=h:o=(o-16/116)/7.787;let f=Math.pow(u,3);f>.008856?u=f:u=(u-16/116)/7.787,o*=95.047,a*=100,u*=108.883,o/=100,a/=100,u/=100;let c=o*3.2406+a*-1.5372+u*-.4986,p=o*-.9689+a*1.8758+u*.0415,g=o*.0557+a*-.204+u*1.057;return c>.0031308?c=1.055*Math.pow(c,1/2.4)-.055:c*=12.92,p>.0031308?p=1.055*Math.pow(p,1/2.4)-.055:p*=12.92,g>.0031308?g=1.055*Math.pow(g,1/2.4)-.055:g*=12.92,[Math.trunc(F.clamp(c*255,0,255)),Math.trunc(F.clamp(p*255,0,255)),Math.trunc(F.clamp(g*255,0,255))]}static rgbToXyz(e,t,i){let r=e/255,n=t/255,s=i/255;return r>.04045?r=Math.pow((r+.055)/1.055,2.4):r/=12.92,n>.04045?n=Math.pow((n+.055)/1.055,2.4):n/=12.92,s>.04045?s=Math.pow((s+.055)/1.055,2.4):s/=12.92,r*=100,n*=100,s*=100,[r*.4124+n*.3576+s*.1805,r*.2126+n*.7152+s*.0722,r*.0193+n*.1192+s*.9505]}static xyzToLab(e,t,i){let r=e/95.047,n=t/100,s=i/108.883;return r>.008856?r=Math.pow(r,1/3):r=7.787*r+16/116,n>.008856?n=Math.pow(n,1/3):n=7.787*n+16/116,s>.008856?s=Math.pow(s,1/3):s=7.787*s+16/116,[116*n-16,500*(r-n),200*(n-s)]}static rgbToLab(e,t,i){let r=e/255,n=t/255,s=i/255;r>.04045?r=Math.pow((r+.055)/1.055,2.4):r/=12.92,n>.04045?n=Math.pow((n+.055)/1.055,2.4):n/=12.92,s>.04045?s=Math.pow((s+.055)/1.055,2.4):s/=12.92,r*=100,n*=100,s*=100;let a=r*.4124+n*.3576+s*.1805,o=r*.2126+n*.7152+s*.0722,u=r*.0193+n*.1192+s*.9505;return a/=95.047,o/=100,u/=108.883,a>.008856?a=Math.pow(a,1/3):a=7.787*a+16/116,o>.008856?o=Math.pow(o,1/3):o=7.787*o+16/116,u>.008856?u=Math.pow(u,1/3):u=7.787*u+16/116,[116*o-16,500*(a-o),200*(o-u)]}}});var Pn,pt,Yt=C(()=>{"use strict";Pn=class{static makeTable(){let e=[],t=0;for(let i=0;i<256;i++){t=i;for(let r=0;r<8;r++)t=t&1?3988292384^t>>>1:t>>>1;e[i]=t}return e}static getChecksum(e){var a,o,u;let t=Pn.crcTable,i=(a=e.length)!=null?a:e.buffer.length,r=(o=e.position)!=null?o:0,n=r+i,s=((u=e.baseCrc)!=null?u:0)^-1;for(let l=r;l<n;l++)s=s>>>8^t[(s^e.buffer[l])&255];return(s^-1)>>>0}},pt=Pn;pt.crcTable=new Uint32Array(Pn.makeTable())});var zt=C(()=>{"use strict"});var Wt=C(()=>{"use strict"});var Yn,Tt,Mi=C(()=>{"use strict";Wt();Yn=class{static getDitherPixels(e,t,i,r){if(i===0)return t.getIndexMap(e);let n=Yn.ditherKernels[i],s=e.height,a=e.width,o=new Uint8Array(e.getBytes()),u=new Uint8Array(a*s),l=t.colorMap8,h=r?-1:1,f=0;for(let c=0;c<s;c++){r&&(h*=-1);let p=h===1?0:a-1,g=h===1?a:0;for(let b=p;b!==g;b+=h,++f){let x=f*4,y=o[x],P=o[x+1],w=o[x+2];x=t.lookupRGB(y,P,w),u[f]=x,x*=3;let M=l[x],B=l[x+1],O=l[x+2],R=y-M,N=P-B,L=w-O;if(R!==0||N!==0||L!==0){let D=h===1?0:n.length-1,k=h===1?n.length:0;for(let Y=D;Y!==k;Y+=h){let Z=Math.trunc(n[Y][1]),j=Math.trunc(n[Y][2]);if(Z+b>=0&&Z+b<a&&j+c>=0&&j+c<s){let X=n[Y][0];x=f+Z+j*a,x*=4,o[x]=Math.max(0,Math.min(255,Math.trunc(o[x]+R*X))),o[x+1]=Math.max(0,Math.min(255,Math.trunc(o[x+1]+N*X))),o[x+2]=Math.max(0,Math.min(255,Math.trunc(o[x+2]+L*X)))}}}}}return u}},Tt=Yn;Tt.ditherKernels=[[[0,0,0],[0,0,0],[0,0,0]],[[3/8,1,0],[3/8,0,1],[2/8,1,1]],[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]],[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]],[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]]]});var Xt=C(()=>{"use strict"});var Xe,bt=C(()=>{"use strict";Xt();Xe=class{constructor(e){this._width=0;this._height=0;this._backgroundColor=4294967295;this._loopCount=0;this._frameType=0;this._frames=[];var t,i,r,n;this._width=(t=e==null?void 0:e.width)!=null?t:0,this._height=(i=e==null?void 0:e.height)!=null?i:0,this._loopCount=(r=e==null?void 0:e.loopCount)!=null?r:0,this._frameType=(n=e==null?void 0:e.frameType)!=null?n:0}get width(){return this._width}get height(){return this._height}get backgroundColor(){return this._backgroundColor}get loopCount(){return this._loopCount}get frameType(){return this._frameType}get frames(){return this._frames}get numFrames(){return this.frames.length}get first(){return this.frames[0]}get last(){return this.frames[this.frames.length-1]}get isEmpty(){return this.frames.length===0}get isNotEmpty(){return this.frames.length>0}getFrame(e){return this.frames[e]}addFrame(e){this._width<e.width&&(this._width=e.width),this._height<e.height&&(this._height=e.height),this.frames.push(e)}[Symbol.iterator](){let e=-1;return{next:()=>({value:this._frames[++e],done:!(e in this._frames)})}}}});var Bi,Ti=C(()=>{"use strict";Bi=class{constructor(){this._buf=[void 0]}get buf(){return this._buf}get n(){return this._buf.length}}});var qt=C(()=>{"use strict"});var ce,xt=C(()=>{"use strict";ue();ce=class{static getCodePoints(e){let t=new Uint8Array(e.length);for(let i=0;i<e.length;i++){let r=e.codePointAt(i);if(r!==void 0)if(0<=r&&r<256)t[i]=r;else throw new T(`Error encoding text "${e}": unknown character code point ${r}`);else throw new T(`Error encoding text "${e}"`)}return t}};ce.utf8Decoder=new TextDecoder("utf8"),ce.latin1Decoder=new TextDecoder("latin1")});var G,He=C(()=>{"use strict";ue();je();xt();G=class{get buffer(){return this._buffer}set bigEndian(e){this._bigEndian=e}get bigEndian(){return this._bigEndian}set offset(e){this._offset=e}get offset(){return this._offset}get start(){return this._start}get end(){return this._end}get position(){return this._offset-this._start}get length(){return this._end-this._offset}get isEOS(){return this._offset>=this._end}constructor(e){var t,i;this._buffer=e.buffer,this._bigEndian=(t=e.bigEndian)!=null?t:!1,this._offset=(i=e.offset)!=null?i:0,this._start=this._offset,this._end=e.length!==void 0?this._start+e.length:this._buffer.length}static from(e,t,i){let r=t!=null?t:0,n=new G({buffer:e._buffer,bigEndian:e._bigEndian,offset:e._offset+r,length:i});return n._start=e._start,n._end=i!==void 0?e.offset+r+i:e._end,n}rewind(){this._offset=this._start}getByte(e){return this._buffer[this._offset+e]}setByte(e,t){return this._buffer[this._offset+e]=t}memset(e,t,i){this._buffer.fill(this._offset+e,this._offset+e+t,i)}subarray(e,t,i=0){let r=t!==void 0?this._start+t:this._offset;return r+=i,new G({buffer:this._buffer,bigEndian:this._bigEndian,offset:r,length:e})}indexOf(e,t=0){for(let i=this._offset+t,r=this._offset+this.length;i<r;++i)if(this._buffer[i]===e)return i-this._start;return-1}peekBytes(e,t=0){return this.subarray(e,void 0,t)}skip(e){this._offset+=e}readByte(){return this._buffer[this._offset++]}readInt8(){return E.toInt8(this.readByte())}readBytes(e){let t=this.subarray(e);return this._offset+=t.length,t}readString(e){if(e===void 0){let n=[];for(;!this.isEOS;){let s=this.readByte();if(s===0)return String.fromCharCode(...n);n.push(s)}throw new T("EOF reached without finding string terminator")}let i=this.readBytes(e).toUint8Array();return String.fromCharCode(...i)}readStringUtf8(){let e=[];for(;!this.isEOS;){let t=this.readByte();if(t===0){let i=new Uint8Array(e);return ce.utf8Decoder.decode(i)}e.push(t)}throw new T("EOF reached without finding string terminator")}readUint16(){let e=this._buffer[this._offset++]&255,t=this._buffer[this._offset++]&255;return this._bigEndian?e<<8|t:t<<8|e}readInt16(){return E.toInt16(this.readUint16())}readUint24(){let e=this._buffer[this._offset++]&255,t=this._buffer[this._offset++]&255,i=this._buffer[this._offset++]&255;return this._bigEndian?i|t<<8|e<<16:e|t<<8|i<<16}readUint32(){let e=this._buffer[this._offset++]&255,t=this._buffer[this._offset++]&255,i=this._buffer[this._offset++]&255,r=this._buffer[this._offset++]&255,n=this._bigEndian?e<<24|t<<16|i<<8|r:r<<24|i<<16|t<<8|e;return E.toUint32(n)}readInt32(){return E.toInt32(this.readUint32())}readFloat32(){return E.toFloat32(this.readUint32())}readFloat64(){return E.toFloat64(this.readUint64())}readUint64(){let e=this._buffer[this._offset++]&255,t=this._buffer[this._offset++]&255,i=this._buffer[this._offset++]&255,r=this._buffer[this._offset++]&255,n=this._buffer[this._offset++]&255,s=this._buffer[this._offset++]&255,a=this._buffer[this._offset++]&255,o=this._buffer[this._offset++]&255;return this._bigEndian?BigInt(e<<56)|BigInt(t<<48)|BigInt(i<<40)|BigInt(r<<32)|BigInt(n<<24)|BigInt(s<<16)|BigInt(a<<8)|BigInt(o):BigInt(o<<56)|BigInt(a<<48)|BigInt(s<<40)|BigInt(n<<32)|BigInt(r<<24)|BigInt(i<<16)|BigInt(t<<8)|BigInt(e)}toUint8Array(e,t){let i=e!=null?e:0,r=t!=null?t:this.length-i;return new Uint8Array(this._buffer.buffer,this._buffer.byteOffset+this._offset+i,r)}toUint32Array(e){let t=e!=null?e:0;return new Uint32Array(this._buffer.buffer,this._buffer.byteOffset+this._offset+t)}}});var Zt=C(()=>{"use strict"});var qe,Ei=C(()=>{"use strict";qe=class{constructor(e,t,i,r){this._startX=0;this._startY=0;this._endX=0;this._endY=0;this._dx=0;this._dy=0;this.initialize(e,t,i,r)}get startX(){return this._startX}get startY(){return this._startY}get endX(){return this._endX}get endY(){return this._endY}get dx(){return this._dx}get dy(){return this._dy}static from(e){return new qe(e.startX,e.startY,e.endX,e.endY)}initialize(e,t,i,r){this._startX=Math.min(e,i),this._startY=Math.min(t,r),this._endX=Math.max(e,i),this._endY=Math.max(t,r),this._dx=this._endX-this._startX,this._dy=this._endY-this._startY}moveStart(e,t){this.initialize(e,t,this._endX,this._endY)}moveEnd(e,t){this.initialize(this._startX,this._startY,e,t)}}});var Ve=C(()=>{"use strict"});var Oi,Ui=C(()=>{"use strict";Oi=class{get tag(){return this._tag}get value(){return this._value}set value(e){this._value=e}constructor(e,t){this._tag=e,this._value=t}}});var se,vt=C(()=>{"use strict";Qe();se=class{get numerator(){return this._numerator}get denominator(){return this._denominator}get asInt(){return this.denominator!==0?Math.trunc(this.numerator/this.denominator):0}get asDouble(){return this.denominator!==0?this.numerator/this.denominator:0}constructor(e,t){this._numerator=e,this._denominator=t}simplify(){let e=F.gcd(this.numerator,this.denominator);e!==0&&(this._numerator=Math.trunc(this.numerator/e),this._denominator=Math.trunc(this.denominator/e))}equalsTo(e){return e instanceof se&&this._numerator===e._numerator&&this._denominator===e._denominator}toString(){return`${this._numerator}/${this._denominator}`}}});var yt,$t=C(()=>{"use strict";Kt();yt=class{get keys(){return this.directories.keys()}get values(){return this.directories.values()}get size(){return this.directories.size}get isEmpty(){if(this.directories.size===0)return!0;for(let e of this.directories.values())if(!e.isEmpty)return!1;return!0}constructor(e){this.directories=e!=null?e:new Map}static from(e){return new yt(e.directories)}has(e){return this.directories.has(e)}get(e){let t=this.directories.get(e);return t===void 0&&(t=new _t,this.directories.set(e,t)),t}set(e,t){this.directories.set(e,t)}clear(){this.directories.clear()}}});function $r(m){return Mn[m]}function Kr(m,e=1){return Lr[m]*e}var ve,Mn,Lr,Ie=C(()=>{"use strict";ve=(c=>(c[c.none=0]="none",c[c.byte=1]="byte",c[c.ascii=2]="ascii",c[c.short=3]="short",c[c.long=4]="long",c[c.rational=5]="rational",c[c.sbyte=6]="sbyte",c[c.undefined=7]="undefined",c[c.sshort=8]="sshort",c[c.slong=9]="slong",c[c.srational=10]="srational",c[c.single=11]="single",c[c.double=12]="double",c))(ve||{}),Mn=["None","Byte","Ascii","Short","Long","Rational","SByte","Undefined","SShort","SLong","SRational","Single","Double"],Lr=[0,1,1,2,4,8,1,1,2,4,8,4,8]});var _,Nr,Fi,zn,Wn,jt=C(()=>{"use strict";Ie();_=class{get name(){return this._name}get type(){return this._type}get count(){return this._count}constructor(e){var t,i;this._name=e.name,this._type=(t=e.type)!=null?t:0,this._count=(i=e.count)!=null?i:1}},Nr=new Map([["ProcessingSoftware",11],["SubfileType",254],["OldSubfileType",255],["ImageWidth",256],["ImageLength",257],["ImageHeight",257],["BitsPerSample",258],["Compression",259],["PhotometricInterpretation",262],["Thresholding",263],["CellWidth",264],["CellLength",265],["FillOrder",266],["DocumentName",269],["ImageDescription",270],["Make",271],["Model",272],["StripOffsets",273],["Orientation",274],["SamplesPerPixel",277],["RowsPerStrip",278],["StripByteCounts",279],["MinSampleValue",280],["MaxSampleValue",281],["XResolution",282],["YResolution",283],["PlanarConfiguration",284],["PageName",285],["XPosition",286],["YPosition",287],["GrayResponseUnit",290],["GrayResponseCurve",291],["T4Options",292],["T6Options",293],["ResolutionUnit",296],["PageNumber",297],["ColorResponseUnit",300],["TransferFunction",301],["Software",305],["DateTime",306],["Artist",315],["HostComputer",316],["Predictor",317],["WhitePoint",318],["PrimaryChromaticities",319],["ColorMap",320],["HalftoneHints",321],["TileWidth",322],["TileLength",323],["TileOffsets",324],["TileByteCounts",325],["BadFaxLines",326],["CleanFaxData",327],["ConsecutiveBadFaxLines",328],["InkSet",332],["InkNames",333],["NumberofInks",334],["DotRange",336],["TargetPrinter",337],["ExtraSamples",338],["SampleFormat",339],["SMinSampleValue",340],["SMaxSampleValue",341],["TransferRange",342],["ClipPath",343],["JPEGProc",512],["JPEGInterchangeFormat",513],["JPEGInterchangeFormatLength",514],["YCbCrCoefficients",529],["YCbCrSubSampling",530],["YCbCrPositioning",531],["ReferenceBlackWhite",532],["ApplicationNotes",700],["Rating",18246],["CFARepeatPatternDim",33421],["CFAPattern",33422],["BatteryLevel",33423],["Copyright",33432],["ExposureTime",33434],["FNumber",33437],["IPTC-NAA",33723],["ExifOffset",34665],["InterColorProfile",34675],["ExposureProgram",34850],["SpectralSensitivity",34852],["GPSOffset",34853],["ISOSpeed",34855],["OECF",34856],["SensitivityType",34864],["RecommendedExposureIndex",34866],["ExifVersion",36864],["DateTimeOriginal",36867],["DateTimeDigitized",36868],["OffsetTime",36880],["OffsetTimeOriginal",36881],["OffsetTimeDigitized",36882],["ComponentsConfiguration",37121],["CompressedBitsPerPixel",37122],["ShutterSpeedValue",37377],["ApertureValue",37378],["BrightnessValue",37379],["ExposureBiasValue",37380],["MaxApertureValue",37381],["SubjectDistance",37382],["MeteringMode",37383],["LightSource",37384],["Flash",37385],["FocalLength",37386],["SubjectArea",37396],["MakerNote",37500],["UserComment",37510],["SubSecTime",37520],["SubSecTimeOriginal",37521],["SubSecTimeDigitized",37522],["XPTitle",40091],["XPComment",40092],["XPAuthor",40093],["XPKeywords",40094],["XPSubject",40095],["FlashPixVersion",40960],["ColorSpace",40961],["ExifImageWidth",40962],["ExifImageLength",40963],["RelatedSoundFile",40964],["InteroperabilityOffset",40965],["FlashEnergy",41483],["SpatialFrequencyResponse",41484],["FocalPlaneXResolution",41486],["FocalPlaneYResolution",41487],["FocalPlaneResolutionUnit",41488],["SubjectLocation",41492],["ExposureIndex",41493],["SensingMethod",41495],["FileSource",41728],["SceneType",41729],["CVAPattern",41730],["CustomRendered",41985],["ExposureMode",41986],["WhiteBalance",41987],["DigitalZoomRatio",41988],["FocalLengthIn35mmFilm",41989],["SceneCaptureType",41990],["GainControl",41991],["Contrast",41992],["Saturation",41993],["Sharpness",41994],["DeviceSettingDescription",41995],["SubjectDistanceRange",41996],["ImageUniqueID",42016],["CameraOwnerName",42032],["BodySerialNumber",42033],["LensSpecification",42034],["LensMake",42035],["LensModel",42036],["LensSerialNumber",42037],["Gamma",42240],["PrintIM",50341],["Padding",59932],["OffsetSchema",59933],["OwnerName",65e3],["SerialNumber",65001],["InteropIndex",1],["InteropVersion",2],["RelatedImageFileFormat",4096],["RelatedImageWidth",4097],["RelatedImageLength",4098],["GPSVersionID",0],["GPSLatitudeRef",1],["GPSLatitude",2],["GPSLongitudeRef",3],["GPSLongitude",4],["GPSAltitudeRef",5],["GPSAltitude",6],["GPSTimeStamp",7],["GPSSatellites",8],["GPSStatus",9],["GPSMeasureMode",10],["GPSDOP",11],["GPSSpeedRef",12],["GPSSpeed",13],["GPSTrackRef",14],["GPSTrack",15],["GPSImgDirectionRef",16],["GPSImgDirection",17],["GPSMapDatum",18],["GPSDestLatitudeRef",19],["GPSDestLatitude",20],["GPSDestLongitudeRef",21],["GPSDestLongitude",22],["GPSDestBearingRef",23],["GPSDestBearing",24],["GPSDestDistanceRef",25],["GPSDestDistance",26],["GPSProcessingMethod",27],["GPSAreaInformation",28],["GPSDate",29],["GPSDifferential",30]]),Fi=new Map([[11,new _({name:"ProcessingSoftware",type:2})],[254,new _({name:"SubfileType",type:4})],[255,new _({name:"OldSubfileType",type:4})],[256,new _({name:"ImageWidth",type:4})],[257,new _({name:"ImageLength",type:4})],[258,new _({name:"BitsPerSample",type:3})],[259,new _({name:"Compression",type:3})],[262,new _({name:"PhotometricInterpretation",type:3})],[263,new _({name:"Thresholding",type:3})],[264,new _({name:"CellWidth",type:3})],[265,new _({name:"CellLength",type:3})],[266,new _({name:"FillOrder",type:3})],[269,new _({name:"DocumentName",type:2})],[270,new _({name:"ImageDescription",type:2})],[271,new _({name:"Make",type:2})],[272,new _({name:"Model",type:2})],[273,new _({name:"StripOffsets",type:4})],[274,new _({name:"Orientation",type:3})],[277,new _({name:"SamplesPerPixel",type:3})],[278,new _({name:"RowsPerStrip",type:4})],[279,new _({name:"StripByteCounts",type:4})],[280,new _({name:"MinSampleValue",type:3})],[281,new _({name:"MaxSampleValue",type:3})],[282,new _({name:"XResolution",type:5})],[283,new _({name:"YResolution",type:5})],[284,new _({name:"PlanarConfiguration",type:3})],[285,new _({name:"PageName",type:2})],[286,new _({name:"XPosition",type:5})],[287,new _({name:"YPosition",type:5})],[290,new _({name:"GrayResponseUnit",type:3})],[291,new _({name:"GrayResponseCurve"})],[292,new _({name:"T4Options"})],[293,new _({name:"T6Options"})],[296,new _({name:"ResolutionUnit",type:3})],[297,new _({name:"PageNumber",type:3,count:2})],[300,new _({name:"ColorResponseUnit"})],[301,new _({name:"TransferFunction",type:3,count:768})],[305,new _({name:"Software",type:2})],[306,new _({name:"DateTime",type:2})],[315,new _({name:"Artist",type:2})],[316,new _({name:"HostComputer",type:2})],[317,new _({name:"Predictor",type:3})],[318,new _({name:"WhitePoint",type:5,count:2})],[319,new _({name:"PrimaryChromaticities",type:5,count:6})],[320,new _({name:"ColorMap"})],[321,new _({name:"HalftoneHints",type:3,count:2})],[322,new _({name:"TileWidth",type:4})],[323,new _({name:"TileLength",type:4})],[324,new _({name:"TileOffsets"})],[325,new _({name:"TileByteCounts"})],[326,new _({name:"BadFaxLines"})],[327,new _({name:"CleanFaxData"})],[328,new _({name:"ConsecutiveBadFaxLines"})],[332,new _({name:"InkSet"})],[333,new _({name:"InkNames"})],[334,new _({name:"NumberofInks"})],[336,new _({name:"DotRange"})],[337,new _({name:"TargetPrinter",type:2})],[338,new _({name:"ExtraSamples"})],[339,new _({name:"SampleFormat"})],[340,new _({name:"SMinSampleValue"})],[341,new _({name:"SMaxSampleValue"})],[342,new _({name:"TransferRange"})],[343,new _({name:"ClipPath"})],[512,new _({name:"JPEGProc"})],[513,new _({name:"JPEGInterchangeFormat"})],[514,new _({name:"JPEGInterchangeFormatLength"})],[529,new _({name:"YCbCrCoefficients",type:5,count:3})],[530,new _({name:"YCbCrSubSampling",type:3})],[531,new _({name:"YCbCrPositioning",type:3})],[532,new _({name:"ReferenceBlackWhite",type:5,count:6})],[700,new _({name:"ApplicationNotes",type:3})],[18246,new _({name:"Rating",type:3})],[33421,new _({name:"CFARepeatPatternDim"})],[33422,new _({name:"CFAPattern"})],[33423,new _({name:"BatteryLevel"})],[33432,new _({name:"Copyright",type:2})],[33434,new _({name:"ExposureTime",type:5})],[33437,new _({name:"FNumber",type:5})],[33723,new _({name:"IPTC-NAA",type:4})],[34665,new _({name:"ExifOffset"})],[34675,new _({name:"InterColorProfile"})],[34850,new _({name:"ExposureProgram",type:3})],[34852,new _({name:"SpectralSensitivity",type:2})],[34853,new _({name:"GPSOffset"})],[34855,new _({name:"ISOSpeed",type:4})],[34856,new _({name:"OECF"})],[34864,new _({name:"SensitivityType",type:3})],[34866,new _({name:"RecommendedExposureIndex",type:4})],[34867,new _({name:"ISOSpeed",type:4})],[36864,new _({name:"ExifVersion",type:7})],[36867,new _({name:"DateTimeOriginal",type:2})],[36868,new _({name:"DateTimeDigitized",type:2})],[36880,new _({name:"OffsetTime",type:2})],[36881,new _({name:"OffsetTimeOriginal",type:2})],[36882,new _({name:"OffsetTimeDigitized",type:2})],[37121,new _({name:"ComponentsConfiguration"})],[37122,new _({name:"CompressedBitsPerPixel"})],[37377,new _({name:"ShutterSpeedValue"})],[37378,new _({name:"ApertureValue"})],[37379,new _({name:"BrightnessValue"})],[37380,new _({name:"ExposureBiasValue"})],[37381,new _({name:"MaxApertureValue"})],[37382,new _({name:"SubjectDistance"})],[37383,new _({name:"MeteringMode"})],[37384,new _({name:"LightSource"})],[37385,new _({name:"Flash"})],[37386,new _({name:"FocalLength"})],[37396,new _({name:"SubjectArea"})],[37500,new _({name:"MakerNote"})],[37510,new _({name:"UserComment"})],[37520,new _({name:"SubSecTime"})],[37521,new _({name:"SubSecTimeOriginal"})],[37522,new _({name:"SubSecTimeDigitized"})],[40091,new _({name:"XPTitle"})],[40092,new _({name:"XPComment"})],[40093,new _({name:"XPAuthor"})],[40094,new _({name:"XPKeywords"})],[40095,new _({name:"XPSubject"})],[40960,new _({name:"FlashPixVersion"})],[40961,new _({name:"ColorSpace",type:3})],[40962,new _({name:"ExifImageWidth",type:3})],[40963,new _({name:"ExifImageLength",type:3})],[40964,new _({name:"RelatedSoundFile"})],[40965,new _({name:"InteroperabilityOffset"})],[41483,new _({name:"FlashEnergy"})],[41484,new _({name:"SpatialFrequencyResponse"})],[41486,new _({name:"FocalPlaneXResolution"})],[41487,new _({name:"FocalPlaneYResolution"})],[41488,new _({name:"FocalPlaneResolutionUnit"})],[41492,new _({name:"SubjectLocation"})],[41493,new _({name:"ExposureIndex"})],[41495,new _({name:"SensingMethod"})],[41728,new _({name:"FileSource"})],[41729,new _({name:"SceneType"})],[41730,new _({name:"CVAPattern"})],[41985,new _({name:"CustomRendered"})],[41986,new _({name:"ExposureMode"})],[41987,new _({name:"WhiteBalance"})],[41988,new _({name:"DigitalZoomRatio"})],[41989,new _({name:"FocalLengthIn35mmFilm"})],[41990,new _({name:"SceneCaptureType"})],[41991,new _({name:"GainControl"})],[41992,new _({name:"Contrast"})],[41993,new _({name:"Saturation"})],[41994,new _({name:"Sharpness"})],[41995,new _({name:"DeviceSettingDescription"})],[41996,new _({name:"SubjectDistanceRange"})],[42016,new _({name:"ImageUniqueID"})],[42032,new _({name:"CameraOwnerName",type:2})],[42033,new _({name:"BodySerialNumber",type:2})],[42034,new _({name:"LensSpecification"})],[42035,new _({name:"LensMake",type:2})],[42036,new _({name:"LensModel",type:2})],[42037,new _({name:"LensSerialNumber",type:2})],[42240,new _({name:"Gamma",type:5})],[50341,new _({name:"PrintIM"})],[59932,new _({name:"Padding"})],[59933,new _({name:"OffsetSchema"})],[65e3,new _({name:"OwnerName",type:2})],[65001,new _({name:"SerialNumber",type:2})]]),zn=new Map([[1,new _({name:"InteropIndex",type:2})],[2,new _({name:"InteropVersion",type:7})],[4096,new _({name:"RelatedImageFileFormat",type:2})],[4097,new _({name:"RelatedImageWidth",type:3})],[4098,new _({name:"RelatedImageLength",type:3})]]),Wn=new Map([[0,new _({name:"GPSVersionID"})],[1,new _({name:"GPSLatitudeRef"})],[2,new _({name:"GPSLatitude"})],[3,new _({name:"GPSLongitudeRef"})],[4,new _({name:"GPSLongitude"})],[5,new _({name:"GPSAltitudeRef"})],[6,new _({name:"GPSAltitude"})],[7,new _({name:"GPSTimeStamp"})],[8,new _({name:"GPSSatellites"})],[9,new _({name:"GPSStatus"})],[10,new _({name:"GPSMeasureMode"})],[11,new _({name:"GPSDOP"})],[12,new _({name:"GPSSpeedRef"})],[13,new _({name:"GPSSpeed"})],[14,new _({name:"GPSTrackRef"})],[15,new _({name:"GPSTrack"})],[16,new _({name:"GPSImgDirectionRef"})],[17,new _({name:"GPSImgDirection"})],[18,new _({name:"GPSMapDatum"})],[19,new _({name:"GPSDestLatitudeRef"})],[20,new _({name:"GPSDestLatitude"})],[21,new _({name:"GPSDestLongitudeRef"})],[22,new _({name:"GPSDestLongitude"})],[23,new _({name:"GPSDestBearingRef"})],[24,new _({name:"GPSDestBearing"})],[25,new _({name:"GPSDestDistanceRef"})],[26,new _({name:"GPSDestDistance"})],[27,new _({name:"GPSProcessingMethod"})],[28,new _({name:"GPSAreaInformation"})],[29,new _({name:"GPSDate"})],[30,new _({name:"GPSDifferential"})]])});var ne,Ce=C(()=>{"use strict";vt();ue();Ie();ne=class{get type(){return 0}get length(){return 0}get dataSize(){return Kr(this.type,this.length)}get typeString(){return $r(this.type)}toBool(e){return!1}toInt(e){return 0}toDouble(e){return 0}toRational(e){return new se(0,1)}toString(){return""}write(e){}setBool(e,t){}setInt(e,t){}setDouble(e,t){}setRational(e,t,i){}setString(e){}equalsTo(e){return!1}clone(){throw new T("Cannot be copied.")}}});var Ee,Qt=C(()=>{"use strict";xt();Ce();Ie();Ee=class extends ne{constructor(t){super();typeof t=="string"?this.value=t:this.value=String.fromCharCode(...t)}get type(){return 2}get length(){return this.value.length}static fromData(t,i){let r=i>0?t.readString(i-1):t.readString();return new Ee(r)}toData(){return ce.getCodePoints(this.value)}toString(){return this.value}write(t){let i=ce.getCodePoints(this.value);t.writeBytes(i)}setString(t){this.value=t}equalsTo(t){return t instanceof Ee&&this.length===t.length}clone(){return new Ee(this.value)}}});var Je,Jt=C(()=>{"use strict";Ce();Ie();Je=class extends ne{constructor(t){super();typeof t=="number"?(this.value=new Uint8Array(1),this.value[0]=t):this.value=t}get type(){return 1}get length(){return this.value.length}static fromData(t,i,r){let n=t.toUint8Array(i,r);return new Je(n)}toInt(t=0){return this.value[t]}toData(){return this.value}toString(){return this.value.length===1?`${this.value[0]}`:`${this.value}`}write(t){t.writeBytes(this.value)}setInt(t,i=0){this.value[i]=t}equalsTo(t){return t instanceof Je&&this.length===t.length}clone(){return new Je(this.value)}}});var et,ei=C(()=>{"use strict";Ce();Ie();et=class extends ne{constructor(t){super();typeof t=="number"?(this.value=new Float64Array(1),this.value[0]=t):this.value=t}get type(){return 12}get length(){return this.value.length}static fromData(t,i){let r=new Float64Array(i);for(let n=0;n<i;++n)r[n]=t.readFloat64();return new et(r)}toDouble(t=0){return this.value[t]}toData(){return new Uint8Array(this.value.buffer)}toString(){return this.value.length===1?`${this.value[0]}`:`${this.value}`}write(t){for(let i=0,r=this.value.length;i<r;++i)t.writeFloat64(this.value[i])}setDouble(t,i=0){this.value[i]=t}equalsTo(t){return t instanceof et&&this.length===t.length}clone(){return new et(this.value)}}});var De,ti=C(()=>{"use strict";Ce();Ie();De=class extends ne{constructor(t){super();typeof t=="number"?(this.value=new Uint32Array(1),this.value[0]=t):this.value=t}get type(){return 4}get length(){return this.value.length}static fromData(t,i){let r=new Uint32Array(i);for(let n=0;n<i;++n)r[n]=t.readUint32();return new De(r)}toInt(t=0){return this.value[t]}toData(){return new Uint8Array(this.value.buffer)}toString(){return this.value.length===1?`${this.value[0]}`:`${this.value}`}write(t){for(let i=0,r=this.value.length;i<r;++i)t.writeUint32(this.value[i])}setInt(t,i=0){this.value[i]=t}equalsTo(t){return t instanceof De&&this.length===t.length}clone(){return new De(this.value)}}});var Me,ii=C(()=>{"use strict";Ce();Ie();vt();Me=class extends ne{constructor(t){super();t instanceof se?this.value=[t]:this.value=t}get type(){return 5}get length(){return this.value.length}static fromData(t,i){let r=new Array;for(let n=0;n<i;n++){let s=new se(t.readUint32(),t.readUint32());r.push(s)}return new Me(r)}static from(t){let i=new se(t.numerator,t.denominator);return new Me(i)}toInt(t=0){return this.value[t].asInt}toDouble(t=0){return this.value[t].asDouble}toRational(t=0){return this.value[t]}toString(){return this.value.length===1?`${this.value[0]}`:`${this.value}`}write(t){for(let i of this.value)t.writeUint32(i.numerator),t.writeUint32(i.denominator)}setRational(t,i,r=0){this.value[r]=new se(t,i)}equalsTo(t){return t instanceof Me&&this.length===t.length}clone(){return new Me(this.value)}}});var tt,ri=C(()=>{"use strict";Ce();Ie();tt=class extends ne{constructor(t){super();typeof t=="number"?(this.value=new Int8Array(1),this.value[0]=t):this.value=t}get type(){return 6}get length(){return this.value.length}static fromData(t,i,r){let n=new Int8Array(new Int8Array(t.toUint8Array(i,r).buffer));return new tt(n)}toInt(t=0){return this.value[t]}toData(){return new Uint8Array(this.value.buffer)}toString(){return this.value.length===1?`${this.value[0]}`:`${this.value}`}write(t){t.writeBytes(new Uint8Array(this.value.buffer))}setInt(t,i=0){this.value[i]=t}equalsTo(t){return t instanceof tt&&this.length===t.length}clone(){return new tt(this.value)}}});var Oe,ni=C(()=>{"use strict";Ce();Ie();Oe=class extends ne{constructor(t){super();typeof t=="number"?(this.value=new Uint16Array(1),this.value[0]=t):this.value=t}get type(){return 3}get length(){return this.value.length}static fromData(t,i){let r=new Uint16Array(i);for(let n=0;n<i;++n)r[n]=t.readUint16();return new Oe(r)}toInt(t=0){return this.value[t]}toString(){return this.value.length===1?`${this.value[0]}`:`${this.value}`}write(t){for(let i=0,r=this.value.length;i<r;++i)t.writeUint16(this.value[i])}setInt(t,i=0){this.value[i]=t}equalsTo(t){return t instanceof Oe&&this.length===t.length}clone(){return new Oe(this.value)}}});var it,si=C(()=>{"use strict";Ce();Ie();it=class extends ne{constructor(t){super();typeof t=="number"?(this.value=new Float32Array(1),this.value[0]=t):this.value=t}get type(){return 11}get length(){return this.value.length}static fromData(t,i){let r=new Float32Array(i);for(let n=0;n<i;++n)r[n]=t.readFloat32();return new it(r)}toDouble(t=0){return this.value[t]}toData(){return new Uint8Array(this.value.buffer)}toString(){return this.value.length===1?`${this.value[0]}`:`${this.value}`}write(t){for(let i=0,r=this.value.length;i<r;++i)t.writeFloat32(this.value[i])}setDouble(t,i=0){this.value[i]=t}equalsTo(t){return t instanceof it&&this.length===t.length}clone(){return new it(this.value)}}});var rt,ai=C(()=>{"use strict";Ce();Ie();je();rt=class extends ne{constructor(t){super();typeof t=="number"?(this.value=new Int32Array(1),this.value[0]=t):this.value=t}get type(){return 9}get length(){return this.value.length}static fromData(t,i){let r=new Int32Array(i);for(let n=0;n<i;++n)r[n]=t.readInt32();return new rt(r)}toInt(t=0){return this.value[t]}toData(){return new Uint8Array(this.value.buffer)}toString(){return this.value.length===1?`${this.value[0]}`:`${this.value}`}write(t){for(let i=0,r=this.value.length;i<r;++i)t.writeUint32(E.toUint32(this.value[i]))}setInt(t,i=0){this.value[i]=t}equalsTo(t){return t instanceof rt&&this.length===t.length}clone(){return new rt(this.value)}}});var Le,oi=C(()=>{"use strict";Ce();Ie();je();vt();Le=class extends ne{constructor(t){super();t instanceof se?this.value=[t]:this.value=t}get type(){return 10}get length(){return this.value.length}static fromData(t,i){let r=new Array;for(let n=0;n<i;n++){let s=new se(t.readInt32(),t.readInt32());r.push(s)}return new Le(r)}static from(t){let i=new se(t.numerator,t.denominator);return new Le(i)}toInt(t=0){return this.value[t].asInt}toDouble(t=0){return this.value[t].asDouble}toRational(t=0){return this.value[t]}toString(){return this.value.length===1?`${this.value[0]}`:`${this.value}`}write(t){for(let i of this.value)t.writeUint32(E.toUint32(i.numerator)),t.writeUint32(E.toUint32(i.denominator))}setRational(t,i,r=0){this.value[r]=new se(t,i)}equalsTo(t){return t instanceof Le&&this.length===t.length}clone(){return new Le(this.value)}}});var nt,ui=C(()=>{"use strict";Ce();Ie();nt=class extends ne{constructor(t){super();typeof t=="number"?(this.value=new Int16Array(1),this.value[0]=t):this.value=t}get type(){return 8}get length(){return this.value.length}static fromData(t,i){let r=new Int16Array(i);for(let n=0;n<i;++n)r[n]=t.readInt16();return new nt(r)}toInt(t=0){return this.value[t]}toData(){return new Uint8Array(this.value.buffer)}toString(){return this.value.length===1?`${this.value[0]}`:`${this.value}`}write(t){let i=new Int16Array(1),r=new Uint16Array(i.buffer);for(let n=0,s=this.value.length;n<s;++n)i[0]=this.value[n],t.writeUint16(r[0])}setInt(t,i=0){this.value[i]=t}equalsTo(t){return t instanceof nt&&this.length===t.length}clone(){return new nt(this.value)}}});var lt,li=C(()=>{"use strict";Ce();Ie();lt=class extends ne{constructor(t){super();typeof t=="number"?(this.value=new Uint8Array(1),this.value[0]=t):this.value=t}get type(){return 7}get length(){return this.value.length}static fromData(t,i,r){let n=new Uint8Array(t.toUint8Array(i,r));return new lt(n)}toData(){return this.value}toString(){return"<data>"}write(t){t.writeBytes(this.value)}equalsTo(t){return t instanceof lt&&this.length===t.length}clone(){return new lt(this.value)}}});var _t,Kt=C(()=>{"use strict";vt();$t();jt();Ie();Qt();Jt();ei();ti();ii();ri();ni();si();ai();oi();ui();li();Ce();_t=class{constructor(){this.data=new Map;this._sub=new yt}get sub(){return this._sub}get keys(){return this.data.keys()}get values(){return this.data.values()}get size(){return this.data.size}get isEmpty(){return this.data.size===0&&this._sub.isEmpty}get hasImageDescription(){return this.data.has(270)}get imageDescription(){var e;return(e=this.data.get(270))==null?void 0:e.toString()}set imageDescription(e){e===void 0?this.data.delete(270):this.data.set(270,new Ee(e))}get hasMake(){return this.data.has(271)}get make(){var e;return(e=this.data.get(271))==null?void 0:e.toString()}set make(e){e===void 0?this.data.delete(271):this.data.set(271,new Ee(e))}get hasModel(){return this.data.has(272)}get model(){var e;return(e=this.data.get(272))==null?void 0:e.toString()}set model(e){e===void 0?this.data.delete(272):this.data.set(272,new Ee(e))}get hasOrientation(){return this.data.has(274)}get orientation(){var e;return(e=this.data.get(274))==null?void 0:e.toInt()}set orientation(e){e===void 0?this.data.delete(274):this.data.set(274,new Oe(e))}get hasResolutionX(){return this.data.has(282)}get resolutionX(){var e;return(e=this.data.get(282))==null?void 0:e.toRational()}set resolutionX(e){this.setRational(282,e)||this.data.delete(282)}get hasResolutionY(){return this.data.has(283)}get resolutionY(){var e;return(e=this.data.get(283))==null?void 0:e.toRational()}set resolutionY(e){this.setRational(283,e)||this.data.delete(283)}get hasResolutionUnit(){return this.data.has(296)}get resolutionUnit(){var e;return(e=this.data.get(296))==null?void 0:e.toInt()}set resolutionUnit(e){e===void 0?this.data.delete(296):this.data.set(296,new Oe(Math.trunc(e)))}get hasImageWidth(){return this.data.has(256)}get imageWidth(){var e;return(e=this.data.get(256))==null?void 0:e.toInt()}set imageWidth(e){e===void 0?this.data.delete(256):this.data.set(256,new Oe(Math.trunc(e)))}get hasImageHeight(){return this.data.has(257)}get imageHeight(){var e;return(e=this.data.get(257))==null?void 0:e.toInt()}set imageHeight(e){e===void 0?this.data.delete(257):this.data.set(257,new Oe(Math.trunc(e)))}get hasSoftware(){return this.data.has(305)}get software(){var e;return(e=this.data.get(305))==null?void 0:e.toString()}set software(e){e===void 0?this.data.delete(305):this.data.set(305,new Ee(e))}get hasCopyright(){return this.data.has(33432)}get copyright(){var e;return(e=this.data.get(33432))==null?void 0:e.toString()}set copyright(e){e===void 0?this.data.delete(33432):this.data.set(33432,new Ee(e))}setRational(e,t){if(t instanceof se)return this.data.set(e,Me.from(t)),!0;if(Array.isArray(t)&&t.every(i=>typeof i=="number")&&t.length===2){let i=new se(t[0],t[1]);return this.data.set(e,Me.from(i)),!0}return!1}static isArrayOfRationalNumbers(e){return Array.isArray(e)&&e.every(t=>Array.isArray(t)&&t.length>=2&&t.every(i=>typeof i=="number"))}has(e){return this.data.has(e)}getValue(e){let t=e;if(typeof t=="string"&&(t=Nr.get(t)),typeof t=="number")return this.data.get(t)}setValue(e,t){let i=e;if(typeof i=="string"&&(i=Nr.get(i)),typeof i=="number")if(t===void 0)this.data.delete(i);else if(t instanceof ne)this.data.set(i,t);else{let r=Fi.get(i);if(r!==void 0){let n=r.type,s=r.count;switch(n){case 1:Array.isArray(t)&&t.length===s&&t.every(a=>typeof a=="number")?this.data.set(i,new Je(new Uint8Array(t))):typeof t=="number"&&s===1&&this.data.set(i,new Je(t));break;case 2:typeof t=="string"&&this.data.set(i,new Ee(t));break;case 3:Array.isArray(t)&&t.length===s&&t.every(a=>typeof a=="number")?this.data.set(i,new Oe(new Uint16Array(t))):typeof t=="number"&&s===1&&this.data.set(i,new Oe(t));break;case 4:Array.isArray(t)&&t.length===s&&t.every(a=>typeof a=="number")?this.data.set(i,new De(new Uint32Array(t))):typeof t=="number"&&s===1&&this.data.set(i,new De(t));break;case 5:if(Array.isArray(t)&&t.length===s&&t.every(a=>a instanceof se))this.data.set(i,new Me(t));else if(s===1&&Array.isArray(t)&&t.length===2&&t.every(a=>typeof a=="number")){let a=new se(t[0],t[1]);this.data.set(i,new Me(a))}else if(s===1&&t instanceof se)this.data.set(i,new Me(t));else if(Array.isArray(t)&&t.length===s&&t.every(a=>Array.isArray(a)&&a.length>=2&&a.every(o=>typeof o=="number"))){let a=new Array;for(let o=0;o<t.length;o++){let u=t[o];Array.isArray(u)&&u.length>=2&&u.every(l=>typeof l=="number")&&a.push(new se(u[0],u[1]))}this.data.set(i,new Me(a))}break;case 6:Array.isArray(t)&&t.length===s&&t.every(a=>typeof a=="number")?this.data.set(i,new tt(new Int8Array(t))):typeof t=="number"&&s===1&&this.data.set(i,new tt(t));break;case 7:Array.isArray(t)&&t.every(a=>typeof a=="number")&&this.data.set(i,new lt(new Uint8Array(t)));break;case 8:Array.isArray(t)&&t.length===s&&t.every(a=>typeof a=="number")?this.data.set(i,new nt(new Int16Array(t))):typeof t=="number"&&s===1&&this.data.set(i,new nt(t));break;case 9:Array.isArray(t)&&t.length===s&&t.every(a=>typeof a=="number")?this.data.set(i,new rt(new Int32Array(t))):typeof t=="number"&&s===1&&this.data.set(i,new rt(t));break;case 10:if(Array.isArray(t)&&t.length===s&&t.every(a=>a instanceof se))this.data.set(i,new Le(t));else if(s===1&&Array.isArray(t)&&t.length===2&&t.every(a=>typeof a=="number")){let a=new se(t[0],t[1]);this.data.set(i,new Le(a))}else if(s===1&&t instanceof se)this.data.set(i,new Le(t));else if(Array.isArray(t)&&t.length===s&&t.every(a=>Array.isArray(a)&&a.length>=2&&a.every(o=>typeof o=="number"))){let a=new Array;for(let o=0;o<t.length;o++){let u=t[o];Array.isArray(u)&&u.length>=2&&u.every(l=>typeof l=="number")&&a.push(new se(u[0],u[1]))}this.data.set(i,new Le(a))}break;case 11:Array.isArray(t)&&t.length===s&&t.every(a=>typeof a=="number")?this.data.set(i,new it(new Float32Array(t))):typeof t=="number"&&s===1&&this.data.set(i,new it(t));break;case 12:Array.isArray(t)&&t.length===s&&t.every(a=>typeof a=="number")?this.data.set(i,new et(new Float64Array(t))):typeof t=="number"&&s===1&&this.data.set(i,new et(t));break;case 0:break}}}}}});var Ae,wt=C(()=>{"use strict";Ui();Kt();$t();jt();Ie();Qt();Jt();ei();ti();ii();ri();ni();si();ai();oi();ui();li();Ae=class extends yt{get imageIfd(){return this.get("ifd0")}get thumbnailIfd(){return this.get("ifd1")}get exifIfd(){return this.get("ifd0").sub.get("exif")}get gpsIfd(){return this.get("ifd0").sub.get("gps")}get interopIfd(){return this.get("ifd0").sub.get("interop")}writeDirectory(e,t,i){let r=i;e.writeUint16(t.size);for(let n of t.keys){let s=t.getValue(n);e.writeUint16(n),e.writeUint16(s.type),e.writeUint32(s.length);let a=s.dataSize;if(a<=4)for(s.write(e);a<4;)e.writeByte(0),a++;else e.writeUint32(r),r+=a}return r}writeDirectoryLargeValues(e,t){for(let i of t.values)i.dataSize>4&&i.write(e)}readEntry(e,t){let i=e.readUint16(),r=e.readUint16(),n=e.readUint32(),s=new Oi(i,void 0);if(r>Object.keys(ve).length)return s;let a=r,o=Lr[r],u=n*o,l=e.offset+4;if(u>4){let f=e.readUint32();e.offset=f+t}if(e.offset+u>e.end)return s;let h=e.readBytes(u);switch(a){case 0:break;case 6:s.value=tt.fromData(h,n);break;case 1:s.value=Je.fromData(h,n);break;case 7:s.value=lt.fromData(h,n);break;case 2:s.value=Ee.fromData(h,n);break;case 3:s.value=Oe.fromData(h,n);break;case 4:s.value=De.fromData(h,n);break;case 5:s.value=Me.fromData(h,n);break;case 10:s.value=Le.fromData(h,n);break;case 8:s.value=nt.fromData(h,n);break;case 9:s.value=rt.fromData(h,n);break;case 11:s.value=it.fromData(h,n);break;case 12:s.value=et.fromData(h,n);break}return e.offset=l,s}static from(e){return new Ae(e.directories)}static fromInputBuffer(e){let t=new Ae;return t.read(e),t}hasTag(e){for(let t of this.directories.values())if(t.has(e))return!0;return!1}getTag(e){for(let t of this.directories.values())if(t.has(e))return t.getValue(e)}getTagName(e){var t,i;return(i=(t=Fi.get(e))==null?void 0:t.name)!=null?i:"<unknown>"}write(e){let t=e.bigEndian;e.bigEndian=!0,e.writeUint16(19789),e.writeUint16(42),e.writeUint32(8),this.directories.get("ifd0")===void 0&&this.directories.set("ifd0",new _t);let i=8,r=new Map;for(let[s,a]of this.directories){r.set(s,i),a.sub.has("exif")?a.setValue(34665,new De(0)):a.setValue(34665,void 0),a.sub.has("interop")?a.setValue(40965,new De(0)):a.setValue(40965,void 0),a.sub.has("gps")?a.setValue(34853,new De(0)):a.setValue(34853,void 0),i+=2+12*a.size+4;for(let o of a.values){let u=o.dataSize;u>4&&(i+=u)}for(let o of a.sub.keys){let u=a.sub.get(o);r.set(o,i);let l=2+12*u.size;for(let h of u.values){let f=h.dataSize;f>4&&(l+=f)}i+=l}}let n=Array.from(this.directories);for(let s=0;s<n.length;s++){let[a,o]=n[s];o.sub.has("exif")&&o.getValue(34665).setInt(r.get("exif")),o.sub.has("interop")&&o.getValue(40965).setInt(r.get("interop")),o.sub.has("gps")&&o.getValue(34853).setInt(r.get("gps"));let l=r.get(a)+2+12*o.size+4;if(this.writeDirectory(e,o,l),s===n.length-1)e.writeUint32(0);else{let h=n[s+1][0];e.writeUint32(r.get(h))}this.writeDirectoryLargeValues(e,o);for(let h of o.sub.keys){let f=o.sub.get(h),p=r.get(h)+2+12*f.size;this.writeDirectory(e,f,p),this.writeDirectoryLargeValues(e,f)}}e.bigEndian=t}read(e){let t=e.bigEndian;e.bigEndian=!0;let i=e.offset,r=e.readUint16();if(r===18761){if(e.bigEndian=!1,e.readUint16()!==10752)return e.bigEndian=t,!1}else if(r===19789){if(e.bigEndian=!0,e.readUint16()!==42)return e.bigEndian=t,!1}else return!1;let n=e.readUint32(),s=0;for(;n>0;){e.offset=i+n;let o=new _t,u=e.readUint16(),l=new Array;for(let h=0;h<u;h++){let f=this.readEntry(e,i);l.push(f)}for(let h of l)h.value!==void 0&&o.setValue(h.tag,h.value);this.directories.set(`ifd${s}`,o),s++,n=e.readUint32()}let a=new Map([[34665,"exif"],[40965,"interop"],[34853,"gps"]]);for(let o of this.directories.values())for(let u of a.keys())if(o.has(u)){let l=o.getValue(u).toInt();e.offset=i+l;let h=new _t,f=e.readUint16(),c=new Array;for(let p=0;p<f;p++){let g=this.readEntry(e,i);c.push(g)}for(let p of c)p.value!==void 0&&h.setValue(p.tag,p.value);o.sub.set(a.get(u),h)}return e.bigEndian=t,!1}toString(){let e="";for(let[t,i]of this.directories){e+=`${t}
`;for(let r of i.keys){let n=i.getValue(r);n===void 0?e+=`	${this.getTagName(r)}
`:e+=`	${this.getTagName(r)}: ${n.toString()}
`}for(let r of i.sub.keys){e+=`${r}
`;let n=i.sub.get(r);for(let s of n.keys){let a=n.getValue(s);a===void 0?e+=`	${this.getTagName(s)}
`:e+=`	${this.getTagName(s)}: ${a}
`}}}return e.toString()}}});var W,Ye=C(()=>{"use strict";ut();Ve();zt();Ht();Ci();ue();Zt();ge();wt();W=class{constructor(e){this._xOffset=0;this._yOffset=0;this._duration=0;this._disposeMethod=1;this._blendMethod=1;var t,i;this._width=e.width,this._height=e.height,this._rgbChannelSet=(t=e.rgbChannelSet)!=null?t:1,this._exifData=e.exifData!==void 0?Ae.from(e.exifData):new Ae,this._iccProfile=e.iccProfile,this._textData=e.textData,this._data=(i=e.data)!=null?i:new Uint32Array(e.width*e.height)}get data(){return this._data}get xOffset(){return this._xOffset}get yOffset(){return this._yOffset}set duration(e){this._duration=e}get duration(){return this._duration}get disposeMethod(){return this._disposeMethod}get blendMethod(){return this._blendMethod}get rgbChannelSet(){return this._rgbChannelSet}get exifData(){return this._exifData}set exifData(e){this._exifData=e}set iccProfile(e){this._iccProfile=e}get iccProfile(){return this._iccProfile}get textData(){return this._textData}get width(){return this._width}get height(){return this._height}get numberOfChannels(){return this.rgbChannelSet===1?4:3}get length(){return this.data.length}static convertData(e,t,i,r){if(r===2)return i instanceof Uint32Array?te.copyUint32(i):te.copyUint32(new Uint32Array(i.buffer));let n=i instanceof Uint32Array?new Uint8Array(i.buffer):i,s=new Uint32Array(e*t),a=new Uint8Array(s.buffer);switch(r){case 3:for(let o=0,u=n.length;o<u;o+=4)a[o+0]=n[o+2],a[o+1]=n[o+1],a[o+2]=n[o+0],a[o+3]=n[o+3];break;case 1:for(let o=0,u=n.length;o<u;o+=4)a[o+0]=n[o+3],a[o+1]=n[o+2],a[o+2]=n[o+1],a[o+3]=n[o+0];break;case 0:for(let o=0,u=n.length;o<u;o+=4)a[o+0]=n[o+1],a[o+1]=n[o+2],a[o+2]=n[o+3],a[o+3]=n[o+0];break;case 5:for(let o=0,u=0,l=n.length;u<l;o+=4,u+=3)a[o+0]=n[u+2],a[o+1]=n[u+1],a[o+2]=n[u+0],a[o+3]=255;break;case 4:for(let o=0,u=0,l=n.length;u<l;o+=4,u+=3)a[o+0]=n[u+0],a[o+1]=n[u+1],a[o+2]=n[u+2],a[o+3]=255;break;case 6:for(let o=0,u=0,l=n.length;u<l;o+=4,++u)a[o+0]=n[u],a[o+1]=n[u],a[o+2]=n[u],a[o+3]=255;break}return s}static rgb(e){let t=ms(ds({},e),{rgbChannelSet:0});return new W(t)}static from(e){let t=new W({width:e._width,height:e._height,rgbChannelSet:e._rgbChannelSet,exifData:Ae.from(e._exifData),iccProfile:e._iccProfile,textData:e._textData!==void 0?new Map(e._textData):void 0,data:te.copyUint32(e._data)});return t._xOffset=e._xOffset,t._yOffset=e._yOffset,t._duration=e._duration,t._disposeMethod=e._disposeMethod,t._blendMethod=e._blendMethod,t}static fromBytes(e){var r,n;(r=e.rgbChannelSet)!=null||(e.rgbChannelSet=1),(n=e.colorModel)!=null||(e.colorModel=2);let t=this.convertData(e.width,e.height,e.data,e.colorModel);return new W({width:e.width,height:e.height,rgbChannelSet:e.rgbChannelSet,exifData:e.exifData,iccProfile:e.iccProfile,textData:e.textData,data:t})}clone(){return W.from(this)}getBytes(e=2){let t=new Uint8Array(this._data.buffer);switch(e){case 2:return t;case 3:{let i=new Uint8Array(this._width*this._height*4);for(let r=0,n=i.length;r<n;r+=4)i[r+0]=t[r+2],i[r+1]=t[r+1],i[r+2]=t[r+0],i[r+3]=t[r+3];return i}case 1:{let i=new Uint8Array(this._width*this._height*4);for(let r=0,n=i.length;r<n;r+=4)i[r+0]=t[r+3],i[r+1]=t[r+2],i[r+2]=t[r+1],i[r+3]=t[r+0];return i}case 0:{let i=new Uint8Array(this._width*this._height*4);for(let r=0,n=i.length;r<n;r+=4)i[r+0]=t[r+3],i[r+1]=t[r+0],i[r+2]=t[r+1],i[r+3]=t[r+2];return i}case 4:{let i=new Uint8Array(this._width*this._height*3);for(let r=0,n=0,s=i.length;n<s;r+=4,n+=3)i[n+0]=t[r+0],i[n+1]=t[r+1],i[n+2]=t[r+2];return i}case 5:{let i=new Uint8Array(this._width*this._height*3);for(let r=0,n=0,s=i.length;n<s;r+=4,n+=3)i[n+0]=t[r+2],i[n+1]=t[r+1],i[n+2]=t[r+0];return i}case 6:{let i=new Uint8Array(this._width*this._height);for(let r=0,n=this.length;r<n;++r)i[r]=d.getLuminance(this._data[r]);return i}}throw new T("Unknown color model")}fill(e){return this._data.fill(e),this}fillBackground(e){for(let t=0;t<this.length;t++)this._data[t]===0&&(this._data[t]=e)}addImage(e){let t=Math.min(this._height,e._height),i=Math.min(this._width,e._width);for(let r=0;r<t;++r)for(let n=0;n<i;++n){let s=this.getPixel(n,r),a=d.getRed(s),o=d.getGreen(s),u=d.getBlue(s),l=d.getAlpha(s),h=e.getPixel(n,r),f=d.getRed(h),c=d.getGreen(h),p=d.getBlue(h),g=d.getAlpha(h);this.setPixel(n,r,d.getColor(a+f,o+c,u+p,l+g))}return this}subtractImage(e){let t=Math.min(this._height,e._height),i=Math.min(this._width,e._width);for(let r=0;r<t;++r)for(let n=0;n<i;++n){let s=this.getPixel(n,r),a=d.getRed(s),o=d.getGreen(s),u=d.getBlue(s),l=d.getAlpha(s),h=e.getPixel(n,r),f=d.getRed(h),c=d.getGreen(h),p=d.getBlue(h),g=d.getAlpha(h);this.setPixel(n,r,d.getColor(a-f,o-c,u-p,l-g))}return this}multiplyImage(e){let t=Math.min(this._height,e._height),i=Math.min(this._width,e._width);for(let r=0;r<t;++r)for(let n=0;n<i;++n){let s=this.getPixel(n,r),a=d.getRed(s),o=d.getGreen(s),u=d.getBlue(s),l=d.getAlpha(s),h=e.getPixel(n,r),f=d.getRed(h),c=d.getGreen(h),p=d.getBlue(h),g=d.getAlpha(h);this.setPixel(n,r,d.getColor(a*f,o*c,u*p,l*g))}return this}orImage(e){let t=Math.min(this._height,e._height),i=Math.min(this._width,e._width);for(let r=0;r<t;++r)for(let n=0;n<i;++n){let s=this.getPixel(n,r),a=d.getRed(s),o=d.getGreen(s),u=d.getBlue(s),l=d.getAlpha(s),h=e.getPixel(n,r),f=d.getRed(h),c=d.getGreen(h),p=d.getBlue(h),g=d.getAlpha(h);this.setPixel(n,r,d.getColor(a|f,o|c,u|p,l|g))}return this}andImage(e){let t=Math.min(this._height,e._height),i=Math.min(this._width,e._width);for(let r=0;r<t;++r)for(let n=0;n<i;++n){let s=this.getPixel(n,r),a=d.getRed(s),o=d.getGreen(s),u=d.getBlue(s),l=d.getAlpha(s),h=e.getPixel(n,r),f=d.getRed(h),c=d.getGreen(h),p=d.getBlue(h),g=d.getAlpha(h);this.setPixel(n,r,d.getColor(a&f,o&c,u&p,l&g))}return this}modImage(e){let t=Math.min(this._height,e._height),i=Math.min(this._width,e._width);for(let r=0;r<t;++r)for(let n=0;n<i;++n){let s=this.getPixel(n,r),a=d.getRed(s),o=d.getGreen(s),u=d.getBlue(s),l=d.getAlpha(s),h=e.getPixel(n,r),f=d.getRed(h),c=d.getGreen(h),p=d.getBlue(h),g=d.getAlpha(h);this.setPixel(n,r,d.getColor(a%f,o%c,u%p,l%g))}return this}getPixelByIndex(e){return this._data[e]}setPixelByIndex(e,t){this._data[e]=t}getBufferIndex(e,t){return t*this._width+e}boundsSafe(e,t){return e>=0&&e<this._width&&t>=0&&t<this._height}getPixel(e,t){let i=this.getBufferIndex(e,t);return this._data[i]}getPixelSafe(e,t){let i=this.getBufferIndex(e,t);return this.boundsSafe(e,t)?this._data[i]:0}getPixelInterpolate(e,t,i=1){return i===2?this.getPixelCubic(e,t):i===1?this.getPixelLinear(e,t):this.getPixelSafe(Math.trunc(e),Math.trunc(t))}getPixelLinear(e,t){let i=Math.trunc(e)-(e>=0?0:1),r=i+1,n=Math.trunc(t)-(t>=0?0:1),s=n+1,a=e-i,o=t-n,u=(p,g,b,x)=>Math.trunc(p+a*(g-p+o*(p+x-b-g))+o*(b-p)),l=this.getPixelSafe(i,n),h=s>=this._height?l:this.getPixelSafe(i,s),f=r>=this._width?l:this.getPixelSafe(r,n),c=r>=this._width||s>=this._height?l:this.getPixelSafe(r,s);return d.getColor(u(d.getRed(l),d.getRed(f),d.getRed(h),d.getRed(c)),u(d.getGreen(l),d.getGreen(f),d.getGreen(h),d.getGreen(c)),u(d.getBlue(l),d.getBlue(f),d.getBlue(h),d.getBlue(c)),u(d.getAlpha(l),d.getAlpha(f),d.getAlpha(h),d.getAlpha(c)))}getPixelCubic(e,t){let i=Math.trunc(e)-(e>=0?0:1),r=i-1,n=i+1,s=i+2,a=Math.trunc(t)-(t>=0?0:1),o=a-1,u=a+1,l=a+2,h=e-i,f=t-a,c=(Bt,mt,Gn,Hn,ls)=>Gn+.5*(Bt*(-mt+Hn)+(Bt*(Bt*(2*mt))-5*Gn+4*Hn-ls)+Bt*(Bt*(Bt*(-mt+3*Gn-3*Hn+ls)))),p=this.getPixelSafe(i,a),g=r<0||o<0?p:this.getPixelSafe(r,o),b=r<0?p:this.getPixelSafe(i,o),x=o<0||n>=this._width?p:this.getPixelSafe(n,o),y=s>=this._width||o<0?p:this.getPixelSafe(s,o),P=c(h,d.getRed(g),d.getRed(b),d.getRed(x),d.getRed(y)),w=c(h,d.getGreen(g),d.getGreen(b),d.getGreen(x),d.getGreen(y)),M=c(h,d.getBlue(g),d.getBlue(b),d.getBlue(x),d.getBlue(y)),B=c(h,d.getAlpha(g),d.getAlpha(b),d.getAlpha(x),d.getAlpha(y)),O=r<0?p:this.getPixelSafe(r,a),R=n>=this._width?p:this.getPixelSafe(n,a),N=s>=this._width?p:this.getPixelSafe(s,a),L=c(h,d.getRed(O),d.getRed(p),d.getRed(R),d.getRed(N)),D=c(h,d.getGreen(O),d.getGreen(p),d.getGreen(R),d.getGreen(N)),k=c(h,d.getBlue(O),d.getBlue(p),d.getBlue(R),d.getBlue(N)),Y=c(h,d.getAlpha(O),d.getAlpha(p),d.getAlpha(R),d.getAlpha(N)),Z=r<0||u>=this._height?p:this.getPixelSafe(r,u),j=u>=this._height?p:this.getPixelSafe(i,u),X=n>=this._width||u>=this._height?p:this.getPixelSafe(n,u),$=s>=this._width||u>=this._height?p:this.getPixelSafe(s,u),Ge=c(h,d.getRed(Z),d.getRed(j),d.getRed(X),d.getRed($)),Re=c(h,d.getGreen(Z),d.getGreen(j),d.getGreen(X),d.getGreen($)),be=c(h,d.getBlue(Z),d.getBlue(j),d.getBlue(X),d.getBlue($)),ee=c(h,d.getAlpha(Z),d.getAlpha(j),d.getAlpha(X),d.getAlpha($)),H=r<0||l>=this._height?p:this.getPixelSafe(r,l),Q=l>=this._height?p:this.getPixelSafe(i,l),Be=n>=this._width||l>=this._height?p:this.getPixelSafe(n,l),we=s>=this._width||l>=this._height?p:this.getPixelSafe(s,l),Te=c(h,d.getRed(H),d.getRed(Q),d.getRed(Be),d.getRed(we)),Xr=c(h,d.getGreen(H),d.getGreen(Q),d.getGreen(Be),d.getGreen(we)),qr=c(h,d.getBlue(H),d.getBlue(Q),d.getBlue(Be),d.getBlue(we)),Zr=c(h,d.getAlpha(H),d.getAlpha(Q),d.getAlpha(Be),d.getAlpha(we)),me=c(f,P,L,Ge,Te),_n=c(f,w,D,Re,Xr),wn=c(f,M,k,be,qr),In=c(f,B,Y,ee,Zr);return d.getColor(Math.trunc(me),Math.trunc(_n),Math.trunc(wn),Math.trunc(In))}setPixel(e,t,i){let r=this.getBufferIndex(e,t);this._data[r]=i}setPixelSafe(e,t,i){if(this.boundsSafe(e,t)){let r=this.getBufferIndex(e,t);this._data[r]=i}}setPixelRgba(e,t,i,r,n,s=255){let a=this.getBufferIndex(e,t);this._data[a]=d.getColor(i,r,n,s)}getWhiteBalance(e=!1){let t=this._data.length,i=0,r=0,n=0,s=1;for(let o=0;o<t;++o)i+=(d.getRed(this._data[o])-i)/s,r+=(d.getGreen(this._data[o])-r)/s,n+=(d.getBlue(this._data[o])-n)/s,++s;let a=(i+r+n)/3;return e?a:Math.trunc(a)}getColorExtremes(){let e=255,t=0;for(let i=0;i<this.length;++i){let r=this.getPixelByIndex(i),n=d.getRed(r),s=d.getGreen(r),a=d.getBlue(r);if(n<e&&(e=n),n>t&&(t=n),s<e&&(e=s),s>t&&(t=s),a<e&&(e=a),a>t&&(t=a),this.rgbChannelSet===1){let o=d.getAlpha(r);o<e&&(e=o),o>t&&(t=o)}}return{min:e,max:t}}addTextData(e){this._textData===void 0&&(this._textData=new Map);for(let[t,i]of e)this._textData.set(t,i)}}});var J,le,hi=C(()=>{"use strict";ge();J=class{constructor(e,t=256,i=10){this.netIndex=new Int32Array(256);this.netSize=16;this.specials=3;this.bgColor=0;this.cutNetSize=0;this.maxNetPos=0;this.initRadius=0;this.initBiasRadius=0;this.samplingFactor=i,this.initialize(t),this.addImage(e)}get colorMap8(){return this._colorMap8}get colorMap32(){return this._colorMap32}get numColors(){return this.netSize}initialize(e){this.netSize=Math.max(e,4),this.cutNetSize=this.netSize-this.specials,this.maxNetPos=this.netSize-1,this.initRadius=Math.floor(this.netSize/8),this.initBiasRadius=this.initRadius*J.radiusBias,this._colorMap32=new Int32Array(this.netSize*4),this._colorMap8=new Uint8Array(this.netSize*3),this.specials=3,this.bgColor=this.specials-1,this.radiusPower=new Int32Array(this.netSize>>3),this.network=new Array(this.netSize*3).fill(0),this.bias=new Array(this.netSize).fill(0),this.freq=new Array(this.netSize).fill(0),this.network[0]=0,this.network[1]=0,this.network[2]=0,this.network[3]=255,this.network[4]=255,this.network[5]=255;let t=1/this.netSize;for(let i=0;i<this.specials;++i)this.freq[i]=t,this.bias[i]=0;for(let i=this.specials,r=this.specials*3;i<this.netSize;++i)this.network[r++]=255*(i-this.specials)/this.cutNetSize,this.network[r++]=255*(i-this.specials)/this.cutNetSize,this.network[r++]=255*(i-this.specials)/this.cutNetSize,this.freq[i]=t,this.bias[i]=0}updateRadiusPower(e,t){for(let i=0;i<e;i++)this.radiusPower[i]=Math.trunc(t*((e*e-i*i)*J.radiusBias/(e*e)))}specialFind(e,t,i){for(let r=0,n=0;r<this.specials;r++)if(this.network[n++]===e&&this.network[n++]===t&&this.network[n++]===i)return r;return-1}contest(e,t,i){let r=1e30,n=r,s=-1,a=s;for(let o=this.specials,u=this.specials*3;o<this.netSize;o++){let l=this.network[u++]-e;l<0&&(l=-l);let h=this.network[u++]-t;h<0&&(h=-h),l+=h,h=this.network[u++]-i,h<0&&(h=-h),l+=h,l<r&&(r=l,s=o);let f=l-this.bias[o];f<n&&(n=f,a=o),this.freq[o]-=J.beta*this.freq[o],this.bias[o]+=J.betaGamma*this.freq[o]}return this.freq[s]+=J.beta,this.bias[s]-=J.betaGamma,a}alterSingle(e,t,i,r,n){let s=t*3;this.network[s]-=e*(this.network[s]-i),this.network[s+1]-=e*(this.network[s+1]-r),this.network[s+2]-=e*(this.network[s+2]-n)}alterNeighbors(e,t,i,r,n,s){let a=i-t;a<this.specials-1&&(a=this.specials-1);let o=i+t;o>this.netSize&&(o=this.netSize);let u=i+1,l=i-1,h=1;for(;u<o||l>a;){let f=this.radiusPower[h++];if(u<o){let c=u*3;this.network[c]-=f*(this.network[c]-r)/J.alphaRadiusBias,this.network[c+1]-=f*(this.network[c+1]-n)/J.alphaRadiusBias,this.network[c+2]-=f*(this.network[c+2]-s)/J.alphaRadiusBias,u++}if(l>a){let c=l*3;this.network[c]-=f*(this.network[c]-r)/J.alphaRadiusBias,this.network[c+1]-=f*(this.network[c+1]-n)/J.alphaRadiusBias,this.network[c+2]-=f*(this.network[c+2]-s)/J.alphaRadiusBias,l--}}}learn(e){let t=this.initBiasRadius,i=30+Math.floor((this.samplingFactor-1)/3),r=e.length,n=Math.floor(r/this.samplingFactor),s=Math.max(Math.floor(n/J.numCycles),1),a=J.initAlpha;s===0&&(s=1);let o=t>>J.radiusBiasShift;o<=1&&(o=0),this.updateRadiusPower(o,a);let u=0,l=0;r<J.smallImageBytes?(this.samplingFactor=1,u=1):r%J.prime1!==0?u=J.prime1:r%J.prime2!==0?u=J.prime2:r%J.prime3!==0?u=J.prime3:u=J.prime4;let h=0;for(;h<n;){let f=e.getPixelByIndex(l),c=d.getRed(f),p=d.getGreen(f),g=d.getBlue(f);h===0&&(this.network[this.bgColor*3]=g,this.network[this.bgColor*3+1]=p,this.network[this.bgColor*3+2]=c);let b=this.specialFind(g,p,c);if(b=b<0?this.contest(g,p,c):b,b>=this.specials){let x=Number(a)/J.initAlpha;this.alterSingle(x,b,g,p,c),o>0&&this.alterNeighbors(x,o,b,g,p,c)}for(l+=u;l>=r;)l-=r;h++,h%s===0&&(a-=Math.floor(a/i),t-=Math.floor(t/J.radiusDec),o=t>>J.radiusBiasShift,o<=1&&(o=0),this.updateRadiusPower(o,a))}}fix(){for(let e=0,t=0,i=0;e<this.netSize;e++,i+=4){for(let r=0;r<3;++r,++t){let n=Math.trunc(.5+this.network[t]);n<0&&(n=0),n>255&&(n=255),this._colorMap32[i+r]=n}this._colorMap32[i+3]=e}}inxBuild(){let e=0,t=0;for(let i=0,r=0;i<this.netSize;i++,r+=4){let n=i,s=this._colorMap32[r+1];for(let o=i+1,u=r+4;o<this.netSize;o++,u+=4)this._colorMap32[u+1]<s&&(n=o,s=this._colorMap32[u+1]);let a=n*4;if(i!==n){let o=this._colorMap32[a];this._colorMap32[a]=this._colorMap32[r],this._colorMap32[r]=o,o=this._colorMap32[a+1],this._colorMap32[a+1]=this._colorMap32[r+1],this._colorMap32[r+1]=o,o=this._colorMap32[a+2],this._colorMap32[a+2]=this._colorMap32[r+2],this.colorMap32[r+2]=o,o=this._colorMap32[a+3],this._colorMap32[a+3]=this._colorMap32[r+3],this._colorMap32[r+3]=o}if(s!==e){this.netIndex[e]=t+i>>1;for(let o=e+1;o<s;o++)this.netIndex[o]=i;e=s,t=i}}this.netIndex[e]=t+this.maxNetPos>>1;for(let i=e+1;i<256;i++)this.netIndex[i]=this.maxNetPos}copyColorMap(){for(let e=0,t=0,i=0;e<this.netSize;++e)this._colorMap8[t++]=Math.abs(this._colorMap32[i+2])&255,this._colorMap8[t++]=Math.abs(this._colorMap32[i+1])&255,this._colorMap8[t++]=Math.abs(this._colorMap32[i])&255,i+=4}addImage(e){this.learn(e),this.fix(),this.inxBuild(),this.copyColorMap()}inxSearch(e,t,i){let r=1e3,n=-1,s=this.netIndex[t],a=s-1;for(;s<this.netSize||a>=0;){if(s<this.netSize){let o=s*4,u=this._colorMap32[o+1]-t;if(u>=r)s=this.netSize;else{u<0&&(u=-u);let l=this._colorMap32[o]-e;l<0&&(l=-l),u+=l,u<r&&(l=this._colorMap32[o+2]-i,l<0&&(l=-l),u+=l,u<r&&(r=u,n=s)),s++}}if(a>=0){let o=a*4,u=t-this._colorMap32[o+1];if(u>=r)a=-1;else{u<0&&(u=-u);let l=this._colorMap32[o]-e;l<0&&(l=-l),u+=l,u<r&&(l=this._colorMap32[o+2]-i,l<0&&(l=-l),u+=l,u<r&&(r=u,n=a)),a--}}}return n}color(e){return d.getColor(this._colorMap8[e*3],this._colorMap8[e*3+1],this._colorMap8[e*3+2])}lookup(e){let t=d.getRed(e),i=d.getGreen(e),r=d.getBlue(e);return this.inxSearch(r,i,t)}lookupRGB(e,t,i){return this.inxSearch(i,t,e)}getQuantizedColor(e){let t=d.getRed(e),i=d.getGreen(e),r=d.getBlue(e),n=d.getAlpha(e),s=this.inxSearch(r,i,t)*3;return d.getColor(this._colorMap8[s],this._colorMap8[s+1],this._colorMap8[s+2],n)}getIndexMap(e){let t=new Uint8Array(e.width*e.height);for(let i=0,r=e.length;i<r;++i)t[i]=this.lookup(e.getPixelByIndex(i));return t}},le=J;le.numCycles=100,le.alphaBiasShift=10,le.initAlpha=1<<J.alphaBiasShift,le.radiusBiasShift=8,le.radiusBias=1<<J.radiusBiasShift,le.alphaRadiusBiasShift=J.alphaBiasShift+J.radiusBiasShift,le.alphaRadiusBias=1<<J.alphaRadiusBiasShift,le.radiusDec=30,le.gamma=1024,le.beta=1/1024,le.betaGamma=J.beta*J.gamma,le.prime1=499,le.prime2=491,le.prime3=487,le.prime4=503,le.smallImageBytes=3*J.prime4});var fi,Ri=C(()=>{"use strict";fi=class{constructor(e,t,i){this._r=0;this._g=0;this._b=0;this._count=0;this._heapIndex=0;this._children=new Array(8).fill(void 0);this._childCount=0;this._childIndex=0;this._flags=0;this._depth=0;this._childIndex=e,this._depth=t,this._parent=i,i!==void 0&&i._childCount++}get r(){return this._r}set r(e){this._r=e}get g(){return this._g}set g(e){this._g=e}get b(){return this._b}set b(e){this._b=e}get count(){return this._count}set count(e){this._count=e}get heapIndex(){return this._heapIndex}set heapIndex(e){this._heapIndex=e}get parent(){return this._parent}get children(){return this._children}get childCount(){return this._childCount}set childCount(e){this._childCount=e}get childIndex(){return this._childIndex}get flags(){return this._flags}set flags(e){this._flags=e}get depth(){return this._depth}}});var On,ci,Di=C(()=>{"use strict";ge();Ti();Ri();On=class{constructor(e,t=256){this.root=new fi(0,0);let i=new Bi;for(let n=0;n<e.length;++n){let s=e.getPixelByIndex(n),a=d.getRed(s),o=d.getGreen(s),u=d.getBlue(s);this.heapAdd(i,this.nodeInsert(this.root,a,o,u))}let r=t+1;for(;i.n>r;)this.heapAdd(i,this.nodeFold(this.popHeap(i)));for(let n=1;n<i.n;n++){let s=i.buf[n],a=s.count;s.r=Math.round(s.r/a),s.g=Math.round(s.g/a),s.b=Math.round(s.b/a)}}nodeInsert(e,t,i,r){let n=e,s=0;for(let a=1<<7;++s<8;a>>=1){let o=((i&a)!==0?1:0)*4+((t&a)!==0?1:0)*2+((r&a)!==0?1:0);n.children[o]===void 0&&(n.children[o]=new fi(o,s,n)),n=n.children[o]}return n.r+=t,n.g+=i,n.b+=r,n.count++,n}popHeap(e){if(e.n<=1)return;let t=e.buf[1];return e.buf[1]=e.buf.pop(),e.buf[1].heapIndex=1,this.downHeap(e,e.buf[1]),t}heapAdd(e,t){if((t.flags&On.ON_INHEAP)!==0){this.downHeap(e,t),this.upHeap(e,t);return}t.flags|=On.ON_INHEAP,t.heapIndex=e.n,e.buf.push(t),this.upHeap(e,t)}downHeap(e,t){let i=t.heapIndex;for(;;){let r=i*2;if(r>=e.n||(r+1<e.n&&this.compareNode(e.buf[r],e.buf[r+1])>0&&r++,this.compareNode(t,e.buf[r])<=0))break;e.buf[i]=e.buf[r],e.buf[i].heapIndex=i,i=r}e.buf[i]=t,t.heapIndex=i}upHeap(e,t){let i=t.heapIndex,r;for(;i>1&&(r=e.buf[Math.trunc(i/2)],!(this.compareNode(t,r)>=0));)e.buf[i]=r,r.heapIndex=i,i=Math.trunc(i/2);e.buf[i]=t,t.heapIndex=i}nodeFold(e){if(e.childCount>0)return;let t=e.parent;return t.count+=e.count,t.r+=e.r,t.g+=e.g,t.b+=e.b,t.childCount--,t.children[e.childIndex]=void 0,t}compareNode(e,t){if(e.childCount<t.childCount)return-1;if(e.childCount>t.childCount)return 1;let i=e.count>>e.depth,r=t.count>>t.depth;return i<r?-1:i>r?1:0}getQuantizedColor(e){let t=d.getRed(e),i=d.getGreen(e),r=d.getBlue(e),n=this.root;for(let s=1<<7;s!==0;s>>=1){let a=((i&s)!==0?1:0)*4+((t&s)!==0?1:0)*2+((r&s)!==0?1:0);if(n.children[a]===void 0)break;n=n.children[a]}return t=n.r,i=n.g,r=n.b,d.getColor(t,i,r)}},ci=On;ci.ON_INHEAP=1});var jr,he,st=C(()=>{"use strict";ut();jr=class{get buffer(){return this._buffer}get bigEndian(){return this._bigEndian}set bigEndian(e){this._bigEndian=e}get length(){return this._length}set length(e){this._length=e}constructor(e){var t,i;this._bigEndian=(t=e==null?void 0:e.bigEndian)!=null?t:!1,this._buffer=new Uint8Array((i=e==null?void 0:e.size)!=null?i:jr.BLOCK_SIZE),this._length=0}expandBuffer(e){let t=jr.BLOCK_SIZE;e!==void 0?t=e:this._buffer.length>0&&(t=this._buffer.length*2);let i=new Uint8Array(this._buffer.length+t);te.setRange(i,0,this._buffer.length,this._buffer),this._buffer=i}rewind(){this._length=0}clear(){this._buffer=new Uint8Array(jr.BLOCK_SIZE),this._length=0}getBytes(){return new Uint8Array(this._buffer.buffer,0,this._length)}writeByte(e){this._length===this._buffer.length&&this.expandBuffer(),this._buffer[this._length++]=e&255}writeBytes(e,t){let i=t!=null?t:e.length;for(;this._length+i>this._buffer.length;)this.expandBuffer(this._length+i-this._buffer.length);te.setRange(this._buffer,this._length,this._length+i,e),this._length+=i}writeBuffer(e){for(;length+e.length>this._buffer.length;)this.expandBuffer(length+e.length-this._buffer.length);te.setRange(this._buffer,length,length+e.length,e.buffer,e.offset),this._length+=e.length}writeUint16(e){if(this._bigEndian){this.writeByte(e>>8&255),this.writeByte(e&255);return}this.writeByte(e&255),this.writeByte(e>>8&255)}writeUint32(e){if(this._bigEndian){this.writeByte(e>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(e&255);return}this.writeByte(e&255),this.writeByte(e>>8&255),this.writeByte(e>>16&255),this.writeByte(e>>24&255)}writeFloat32(e){let t=new Float32Array(1);t[0]=e;let i=new Uint8Array(t.buffer);if(this._bigEndian){this.writeByte(i[3]),this.writeByte(i[2]),this.writeByte(i[1]),this.writeByte(i[0]);return}this.writeByte(i[0]),this.writeByte(i[1]),this.writeByte(i[2]),this.writeByte(i[3])}writeFloat64(e){let t=new Float64Array(1);t[0]=e;let i=new Uint8Array(t.buffer);if(this._bigEndian){this.writeByte(i[7]),this.writeByte(i[6]),this.writeByte(i[5]),this.writeByte(i[4]),this.writeByte(i[3]),this.writeByte(i[2]),this.writeByte(i[1]),this.writeByte(i[0]);return}this.writeByte(i[0]),this.writeByte(i[1]),this.writeByte(i[2]),this.writeByte(i[3]),this.writeByte(i[4]),this.writeByte(i[5]),this.writeByte(i[6]),this.writeByte(i[7])}subarray(e,t){let i=e>=0?e:this._length+e,r=t!=null?t:this._length;return r<0&&(r=this._length+r),new Uint8Array(this._buffer.buffer,i,r-i)}},he=jr;he.BLOCK_SIZE=8192});var z,di=C(()=>{"use strict";z=class{get x(){return this._x}get y(){return this._y}get xt(){return Math.trunc(this.x)}get yt(){return Math.trunc(this.y)}constructor(e,t){this._x=e,this._y=t}static from(e){return new z(e._x,e._y)}move(e,t){return this._x=e,this._y=t,this}offset(e,t){return this.move(this._x+e,this._y+t)}mul(e){return this.move(this._x*e,this._y*e)}add(e){return this.move(this._x+e.x,this._y+e.y)}equals(e){return e instanceof z&&this._x===e._x&&this._y===e._y}}});var Qr=C(()=>{"use strict"});var xe,Li=C(()=>{"use strict";xe=class{static crand(){return 1-2*Math.random()}static grand(){let e=0,t=0;do{let i=2*Math.random()-1;e=2*Math.random()-1,t=e*e+i*i}while(t<=0||t>=1);return e*Math.sqrt(-2*Math.log(t)/t)}static prand(e){if(e<=1e-10)return 0;if(e>100)return Math.trunc(Math.sqrt(e)*xe.grand()+e);let t=0,i=Math.exp(-e);for(let r=1;r>=i;++t)r*=Math.random();return t-1}}});var at,Et=C(()=>{"use strict";at=class{constructor(e,t,i,r){this._left=0;this._top=0;this._right=0;this._bottom=0;this._width=0;this._height=0;this.initialize(e,t,i,r)}get left(){return this._left}get top(){return this._top}get right(){return this._right}get bottom(){return this._bottom}get width(){return this._width}get height(){return this._height}static fromXYWH(e,t,i,r){return new at(e,t,e+i,t+r)}static from(e){return new at(e.left,e.top,e.right,e.bottom)}initialize(e,t,i,r){this._left=Math.min(e,i),this._top=Math.min(t,r),this._right=Math.max(e,i),this._bottom=Math.max(t,r),this._width=this._right-this._left,this._height=this._bottom-this._top}}});var Jr=C(()=>{"use strict"});var en=C(()=>{"use strict"});var tn=C(()=>{"use strict"});var V,Ze,mi=C(()=>{"use strict";ge();Ei();Qe();di();Et();V=class{static calculateCircumference(e,t,i){if(i<0||t.x+i<0||t.x-i>=e.width||t.y+i<0||t.y-i>=e.height)return[];if(i===0)return[t];let r=[new z(t.x-i,t.y),new z(t.x+i,t.y),new z(t.x,t.y-i),new z(t.x,t.y+i)];if(i===1)return r;for(let n=1-i,s=0,a=-(i<<1),o=0,u=i;o<u;)if(n>=0&&(a+=2,n+=a,--u),++o,s+=2,n+=s+1,o!==u+1){let l=t.x-u,h=t.x+u,f=t.y-o,c=t.y+o,p=t.x-o,g=t.x+o,b=t.y-u,x=t.y+u;r.push(new z(l,f)),r.push(new z(l,c)),r.push(new z(h,f)),r.push(new z(h,c)),o!==u&&(r.push(new z(p,b)),r.push(new z(g,x)),r.push(new z(g,b)),r.push(new z(p,x)))}return r}static computeOutCode(e,t){let i=V.OUTCODE_INSIDE;return t.x<e.left?i|=V.OUTCODE_LEFT:t.x>e.right&&(i|=V.OUTCODE_RIGHT),t.y<e.top?i|=V.OUTCODE_TOP:t.y>e.bottom&&(i|=V.OUTCODE_BOTTOM),i}static clipLine(e,t){let i=e.left,r=e.top,n=e.right,s=e.bottom,a=V.computeOutCode(e,new z(t.startX,t.startY)),o=V.computeOutCode(e,new z(t.endX,t.endY)),u=!1;for(;;)if((a|o)===0){u=!0;break}else{if((a&o)!==0)break;{let l=a!==0?a:o,h=0,f=0;(l&V.OUTCODE_TOP)!==0?(h=t.startX+Math.trunc(t.dx*(r-t.startY)/t.dy),f=r):(l&V.OUTCODE_BOTTOM)!==0?(h=t.startX+Math.trunc(t.dx*(s-t.startY)/t.dy),f=s):(l&V.OUTCODE_RIGHT)!==0?(f=t.startY+Math.trunc(t.dy*(n-t.startX)/t.dx),h=n):(l&V.OUTCODE_LEFT)!==0&&(f=t.startY+Math.trunc(t.dy*(i-t.startX)/t.dx),h=i),l===a?(t.moveStart(h,f),a=V.computeOutCode(e,new z(t.startX,t.startY))):(t.moveEnd(h,f),o=V.computeOutCode(e,new z(t.endX,t.endY)))}}return u}static testPixelLabColorDistance(e,t,i,r,n){let s=e.getPixel(t,i),a=r.length>3,o=d.rgbToLab(d.getRed(s),d.getGreen(s),d.getBlue(s));return a&&o.push(d.getAlpha(s)),d.distance(o,r,a)>n}static fill4(e,t,i,r,n,s){let a=t,o=i;if(s[o*e.width+a]!==1){for(;;){let u=a,l=o;for(;o!==0&&!r(o-1,a);)o--;for(;a!==0&&!r(o,a-1);)a--;if(a===u&&o===l)break}V.fill4Core(e,a,o,r,n,s)}}static fill4Core(e,t,i,r,n,s){let a=t,o=i;if(s[o*e.width+a]===1)return;let u=0;do{let l=0,h=a;if(u!==0&&r(o,a)){do if(--u===0)return;while(r(o,++a));h=a}else for(;a!==0&&!r(o,a-1);l++,u++)n(o,--a),o!==0&&!r(o-1,a)&&V.fill4(e,a,o-1,r,n,s);for(;h<e.width&&!r(o,h);l++,h++)n(o,h);if(l<u)for(let f=a+u;++h<f;)r(o,h)||V.fill4Core(e,h,o,r,n,s);else if(l>u&&o!==0)for(let f=a+u;++f<h;)r(o-1,f)||V.fill4(e,f,o-1,r,n,s);u=l}while(u!==0&&++o<e.height)}static drawCircle(e,t,i,r){let n=V.calculateCircumference(e,t,i);for(let s of n)V.drawPixel(e,s,r);return e}static fillCircle(e,t,i,r){let n=V.calculateCircumference(e,t,i);if(n.sort((s,a)=>s.x===a.x?s.y-a.y:s.x-a.x),n.length>0){let s=n[0],a=n[0];for(let o=1;o<n.length;o++){let u=n[o];u.x===s.x||(V.drawLine({image:e,line:new qe(s.xt,s.yt,a.xt,a.yt),color:r}),s=u),a=u}V.drawLine({image:e,line:new qe(s.xt,s.yt,a.xt,a.yt),color:r})}return e}static drawImage(e){var h,f,c,p,g,b,x,y,P;let t=(h=e.dstX)!=null?h:0,i=(f=e.dstY)!=null?f:0,r=(c=e.srcX)!=null?c:0,n=(p=e.srcY)!=null?p:0,s=(g=e.srcW)!=null?g:e.src.width,a=(b=e.srcH)!=null?b:e.src.height,o=(x=e.dstW)!=null?x:Math.min(e.dst.width,e.src.width),u=(y=e.dstH)!=null?y:Math.min(e.dst.height,e.src.height);if((P=e.blend)!=null?P:!0)for(let w=0;w<u;++w)for(let M=0;M<o;++M){let B=Math.trunc(M*(s/o)),O=Math.trunc(w*(a/u)),R=e.src.getPixel(r+B,n+O),N=new z(t+M,i+w);V.drawPixel(e.dst,N,R)}else for(let w=0;w<u;++w)for(let M=0;M<o;++M){let B=Math.trunc(M*(s/o)),O=Math.trunc(w*(a/u)),R=e.src.getPixel(r+B,n+O);e.dst.setPixel(t+M,i+w,R)}return e.dst}static drawLine(e){var u;let t=qe.from(e.line);if(!V.clipLine(new at(0,0,e.image.width-1,e.image.height-1),t))return e.image;let r=(u=e.thickness)!=null?u:1,n=Math.floor(r/2);if(t.dx===0&&t.dy===0)return r===1?V.drawPixel(e.image,new z(t.startX,t.startY),e.color):V.fillCircle(e.image,new z(t.startX,t.startY),n,e.color),e.image;if(t.dx===0){for(let l=t.startY;l<=t.endY;++l)if(r<=1){let h=new z(t.startX,l);V.drawPixel(e.image,h,e.color)}else for(let h=0;h<r;h++){let f=new z(t.startX-n+h,l);V.drawPixel(e.image,f,e.color)}return e.image}else if(t.dy===0){for(let l=t.startX;l<=t.endX;++l)if(r<=1){let h=new z(l,t.startY);V.drawPixel(e.image,h,e.color)}else for(let h=0;h<r;h++){let f=new z(l,t.startY-n+h);V.drawPixel(e.image,f,e.color)}return e.image}let s=l=>~l+65536&65535;if(!e.antialias){if(t.dy<=t.dx){let l=Math.cos(Math.atan2(t.dy,t.dx)),h=0;l!==0?h=Math.trunc(r/l):h=1,h===0&&(h=1);let f=2*t.dy-t.dx,c=2*t.dy,p=2*(t.dy-t.dx),g=t.startX,b=t.startY,x=Math.trunc(b-h/2);for(let y=x;y<x+h;y++){let P=new z(g,y);V.drawPixel(e.image,P,e.color)}if(t.dy>0)for(;g<t.endX;){g++,f<0?f+=c:(b++,f+=p),x=Math.trunc(b-h/2);for(let y=x;y<x+h;y++){let P=new z(g,y);V.drawPixel(e.image,P,e.color)}}else for(;g<t.endX;){g++,f<0?f+=c:(b--,f+=p),x=Math.trunc(b-h/2);for(let y=x;y<x+h;y++){let P=new z(g,y);V.drawPixel(e.image,P,e.color)}}}else{let l=Math.sin(Math.atan2(t.dy,t.dx)),h=0;l!==0?h=Math.trunc(r/l):h=1,h===0&&(h=1);let f=2*t.dx-t.dy,c=2*t.dx,p=2*(t.dx-t.dy),g=t.startX,b=t.startY,x=Math.trunc(g-h/2);for(let y=x;y<x+h;y++){let P=new z(y,b);V.drawPixel(e.image,P,e.color)}if(t.endX-t.startX>0)for(;b<t.endY;){b++,f<0?f+=c:(g++,f+=p),x=Math.trunc(g-h/2);for(let y=x;y<x+h;y++){let P=new z(y,b);V.drawPixel(e.image,P,e.color)}}else for(;b<t.endY;){b++,f<0?f+=c:(g--,f+=p),x=Math.trunc(g-h/2);for(let y=x;y<x+h;y++){let P=new z(y,b);V.drawPixel(e.image,P,e.color)}}}return e.image}let a=t.dy<t.dx?Math.cos(Math.atan2(t.dy,t.dx)):Math.sin(Math.atan2(t.dy,t.dx)),o=0;if(a!==0?o=Math.trunc(Math.abs(r/a)):o=1,o===0&&(o=1),t.dx>t.dy){let l=t.startY,h=Math.trunc(t.dy*65536/t.dx),f=0;for(let c=t.startX;c<=t.endX;c++){let p=l-Math.trunc(o/2);for(let g=p;g<p+o;g++){let b=new z(c,g);V.drawPixel(e.image,b,e.color,f>>8&255),b.offset(0,1),V.drawPixel(e.image,b,e.color,s(f)>>8&255)}f+=h,f>=65536?(f-=65536,l++):f<0&&(f+=65536,l--)}}else{let l=t.startX,h=Math.trunc(t.dx*65536/t.dy),f=0;for(let c=t.startY;c<=t.endY;c++){let p=l-Math.trunc(o/2);for(let g=p;g<p+o;g++){let b=new z(g,c);V.drawPixel(e.image,b,e.color,f>>8&255),b.offset(1,0),V.drawPixel(e.image,b,e.color,s(f)>>8&255)}f+=h,f>=65536?(f-=65536,l++):f<0&&(f+=65536,l--)}}return e.image}static drawPixel(e,t,i,r=255){if(e.boundsSafe(t.xt,t.yt)){let n=e.getBufferIndex(t.xt,t.yt),s=e.getPixelByIndex(n);e.setPixelByIndex(n,d.alphaBlendColors(s,i,r))}return e}static drawRect(e,t,i){return V.drawLine({image:e,line:new qe(t.left,t.top,t.right,t.top),color:i}),V.drawLine({image:e,line:new qe(t.right,t.top,t.right,t.bottom),color:i}),V.drawLine({image:e,line:new qe(t.right,t.bottom,t.left,t.bottom),color:i}),V.drawLine({image:e,line:new qe(t.left,t.bottom,t.left,t.top),color:i}),e}static fillFlood(e){var o,u;let t=(o=e.threshold)!=null?o:0,i=(u=e.compareAlpha)!=null?u:!1,r=new Uint8Array(e.src.width*e.src.height),n=e.src.getPixel(e.x,e.y);i||(n=d.setAlpha(n,0));let s;if(t>0){let l=d.rgbToLab(d.getRed(n),d.getGreen(n),d.getBlue(n));i&&l.push(d.getAlpha(n)),s=(h,f)=>r[h*e.src.width+f]===0&&V.testPixelLabColorDistance(e.src,f,h,l,t)}else i?s=(l,h)=>r[l*e.src.width+h]===0&&e.src.getPixel(h,l)!==n:s=(l,h)=>r[l*e.src.width+h]===0&&d.setAlpha(e.src.getPixel(h,l),0)!==n;let a=(l,h)=>{e.src.setPixel(h,l,e.color),r[l*e.src.width+h]=1};return V.fill4(e.src,e.x,e.y,s,a,r),e.src}static maskFlood(e){var l,h,f;let t=(l=e.threshold)!=null?l:0,i=(h=e.compareAlpha)!=null?h:!1,r=(f=e.fillValue)!=null?f:255,n=new Uint8Array(e.src.width*e.src.height),s=e.src.getPixel(e.x,e.y);i||(s=d.setAlpha(s,0));let a=new Uint8Array(e.src.width*e.src.height),o;if(t>0){let c=d.rgbToLab(d.getRed(s),d.getGreen(s),d.getBlue(s));i&&c.push(d.getAlpha(s)),o=(p,g)=>n[p*e.src.width+g]===0&&(a[p*e.src.width+g]!==0||V.testPixelLabColorDistance(e.src,g,p,c,t))}else i?o=(c,p)=>n[c*e.src.width+p]===0&&(a[c*e.src.width+p]!==0||e.src.getPixel(p,c)!==s):o=(c,p)=>n[c*e.src.width+p]===0&&(a[c*e.src.width+p]!==0||d.setAlpha(e.src.getPixel(p,c),0)!==s);let u=(c,p)=>{a[c*e.src.width+p]=r,n[c*e.src.width+p]=1};return V.fill4(e.src,e.x,e.y,o,u,n),a}static fillRect(e,t,i){let r=F.clamp(t.left,0,e.width-1),n=F.clamp(t.top,0,e.height-1),s=F.clamp(t.right,0,e.width-1),a=F.clamp(t.bottom,0,e.height-1);if(d.getAlpha(i)===255){let o=e.width,u=n*o+r,l=u+(s-r)+1;for(let h=n;h<=a;++h)e.data.fill(i,u,l),u+=o,l+=o}else for(let o=n;o<=a;++o){let u=o*e.width+r;for(let l=r;l<=s;++l,++u)e.setPixelByIndex(u,d.alphaBlendColors(e.getPixelByIndex(u),i))}return e}static fill(e,t){return e.fill(t)}},Ze=V;Ze.OUTCODE_INSIDE=0,Ze.OUTCODE_LEFT=1,Ze.OUTCODE_RIGHT=2,Ze.OUTCODE_BOTTOM=4,Ze.OUTCODE_TOP=8});var rn=C(()=>{"use strict"});var nn=C(()=>{"use strict"});var Pt,Ot=C(()=>{"use strict";Pt=class extends Error{toString(){return this.message.length>0?`NotImplementedError: ${this.message}`:"NotImplementedError"}}});var sn=C(()=>{"use strict"});var an=C(()=>{"use strict"});var on=C(()=>{"use strict"});var Ni=C(()=>{"use strict"});var ki=C(()=>{"use strict"});var Gi=C(()=>{"use strict"});var Hi,Vi=C(()=>{"use strict";ge();Hi=class{get length(){return this.coefficients.length}constructor(e){this.size=e,this.coefficients=new Array(2*e+1).fill(0)}reflect(e,t){return t<0?-t:t>=e?e-(t-e)-1:t}applyCoeffsLine(e,t,i,r,n){for(let s=0;s<r;s++){let a=0,o=0,u=0,l=0;for(let f=-this.size,c=0;f<=this.size;++f,++c){let p=this.coefficients[c],g=this.reflect(r,s+f),b=n?e.getPixel(g,i):e.getPixel(i,g);a+=p*d.getRed(b),o+=p*d.getGreen(b),u+=p*d.getBlue(b),l+=p*d.getAlpha(b)}let h=d.getColor(a>255?255:a,o>255?255:o,u>255?255:u,l>255?255:l);n?t.setPixel(s,i,h):t.setPixel(i,s,h)}}getCoefficient(e){return this.coefficients[e]}setCoefficient(e,t){this.coefficients[e]=t}apply(e,t,i=!0){if(i)for(let r=0;r<e.height;++r)this.applyCoeffsLine(e,t,r,e.width,i);else for(let r=0;r<e.width;++r)this.applyCoeffsLine(e,t,r,e.height,i)}scaleCoefficients(e){for(let t=0;t<this.coefficients.length;++t)this.coefficients[t]*=e}}});var St,kr,Gr=C(()=>{"use strict";ge();Vt();Qe();Ye();hi();Di();Li();Et();mi();Ni();ki();Gi();Vi();St=class{static smoothVignetteStep(e,t,i){let r=i;return r=(r-e)/(t-e),r<0&&(r=0),r>1&&(r=1),r*r*(3-2*r)}static adjustColor(e){if(e.amount===0)return e.src;let t=e.contrast!==void 0?F.clamp(e.contrast,0,1):void 0,i=e.saturation!==void 0?F.clamp(e.saturation,0,1):void 0,r=e.brightness!==void 0?F.clamp(e.brightness,0,1):void 0,n=e.gamma!==void 0?F.clamp(e.gamma,0,1e3):void 0,s=e.exposure!==void 0?F.clamp(e.exposure,0,1e3):void 0,a=e.amount!==void 0?F.clamp(e.amount,0,1e3):void 0,o=.0174532925,u=.5,l=.5,h=.5,f=.2125,c=.7154,p=.0721,g=e.blacks!==void 0||e.whites!==void 0||e.mids!==void 0,b=0,x=0,y=0,P=0,w=0,M=0,B=0,O=0,R=0;g&&(b=e.blacks!==void 0?d.getRed(e.blacks)/255:0,x=e.blacks!==void 0?d.getGreen(e.blacks)/255:0,y=e.blacks!==void 0?d.getBlue(e.blacks)/255:0,P=e.whites!==void 0?d.getRed(e.whites)/255:1,w=e.whites!==void 0?d.getGreen(e.whites)/255:1,M=e.whites!==void 0?d.getBlue(e.whites)/255:1,B=e.mids!==void 0?d.getRed(e.mids)/255:.5,O=e.mids!==void 0?d.getGreen(e.mids)/255:.5,R=e.mids!==void 0?d.getBlue(e.mids)/255:.5,B=1/(1+2*(B-.5)),O=1/(1+2*(O-.5)),R=1/(1+2*(R-.5)));let N=i!==void 0?1-F.clamp(i,0,1):0,L=t!==void 0?1-F.clamp(t,0,1):0;s!==void 0&&(s=Math.pow(2,s));let D=0,k=0,Y=0;if(e.hue!==void 0){e.hue*=o;let X=Math.sin(e.hue),$=Math.cos(e.hue);D=2*$/3,k=(-Math.sqrt(3)*X-$)/3,Y=(Math.sqrt(3)*X-$+1)/3}let Z=a!==void 0?1-F.clamp(a,0,1):0,j=e.src.getBytes();for(let X=0,$=j.length;X<$;X+=4){let Ge=j[X]/255,Re=j[X+1]/255,be=j[X+2]/255,ee=Ge,H=Re,Q=be;if(g&&(ee=Math.pow((ee+b)*P,B),H=Math.pow((H+x)*w,O),Q=Math.pow((Q+y)*M,R)),r!==void 0&&r!==1){let Be=F.clamp(r,0,1e3);ee*=Be,H*=Be,Q*=Be}if(i!==void 0){let Be=ee*f+H*c+Q*p;ee=Be*N+ee*i,H=Be*N+H*i,Q=Be*N+Q*i}if(t!==void 0&&(ee=u*L+ee*t,H=l*L+H*t,Q=h*L+Q*t),n!==void 0&&(ee=Math.pow(ee,n),H=Math.pow(H,n),Q=Math.pow(Q,n)),s!==void 0&&(ee*=s,H*=s,Q*=s),e.hue!==void 0&&e.hue!==0){let Be=ee*D+H*k+Q*Y,we=ee*Y+H*D+Q*k,Te=ee*k+H*Y+Q*D;ee=Be,H=we,Q=Te}a!==void 0&&(ee=ee*a+Ge*Z,H=H*a+Re*Z,Q=Q*a+be*Z),j[X]=F.clampInt255(ee*255),j[X+1]=F.clampInt255(H*255),j[X+2]=F.clampInt255(Q*255)}return e.src}static brightness(e,t){if(t===0)return e;let i=e.getBytes();for(let r=0,n=i.length;r<n;r+=4)i[r]=F.clampInt255(i[r]+t),i[r+1]=F.clampInt255(i[r+1]+t),i[r+2]=F.clampInt255(i[r+2]+t);return e}static bumpToNormal(e,t=2){let i=W.from(e);for(let r=0;r<e.height;++r)for(let n=0;n<e.width;++n){let s=d.getRed(e.getPixel(n,r))/255,a=(s-d.getRed(e.getPixel(n<e.width-1?n+1:n,r))/255)*t,o=(s-d.getRed(e.getPixel(n,r<e.height-1?r+1:r))/255)*t,u=Math.abs(a)+Math.abs(o);u>1&&(a/=u,o/=u);let l=Math.sqrt(1-a*a-o*o),h=a*.5+.5,f=o*.5+.5,c=l;i.setPixelRgba(n,r,Math.floor(255*h),Math.floor(255*f),Math.floor(255*c))}return i}static colorOffset(e){var i,r,n,s;let t=e.src.getBytes();for(let a=0,o=t.length;a<o;a+=4)t[a]=F.clampInt255(t[a]+((i=e.red)!=null?i:0)),t[a+1]=F.clampInt255(t[a+1]+((r=e.green)!=null?r:0)),t[a+2]=F.clampInt255(t[a+2]+((n=e.blue)!=null?n:0)),t[a+3]=F.clampInt255(t[a+3]+((s=e.alpha)!=null?s:0));return e.src}static contrast(e,t){if(t===100)return e;let i=t/100;i*=i;let r=new Uint8Array(256);for(let s=0;s<256;++s)r[s]=F.clampInt255(((s/255-.5)*i+.5)*255);let n=e.getBytes();for(let s=0,a=n.length;s<a;s+=4)n[s]=r[n[s]],n[s+1]=r[n[s+1]],n[s+2]=r[n[s+2]];return e}static convolution(e){var i,r;let t=W.from(e.src);for(let n=0;n<e.src.height;++n)for(let s=0;s<e.src.width;++s){let a=t.getPixel(s,n),o=0,u=0,l=0,h=d.getAlpha(a);for(let p=0,g=0;p<3;++p){let b=Math.min(Math.max(n-1+p,0),e.src.height-1);for(let x=0;x<3;++x,++g){let y=Math.min(Math.max(s-1+x,0),e.src.width-1),P=t.getPixel(y,b);o+=d.getRed(P)*e.filter[g],u+=d.getGreen(P)*e.filter[g],l+=d.getBlue(P)*e.filter[g]}}let f=(i=e.div)!=null?i:1,c=(r=e.offset)!=null?r:0;o=o/f+c,u=u/f+c,l=l/f+c,o=o>255?255:o<0?0:o,u=u>255?255:u<0?0:u,l=l>255?255:l<0?0:l,e.src.setPixel(s,n,d.getColor(o,u,l,h))}return e.src}static emboss(e){let t=[1.5,0,0,0,0,0,0,0,-1.5];return St.convolution({src:e,filter:t,div:1,offset:127})}static gaussianBlur(e,t){if(t<=0)return e;let i;if(St.gaussianKernelCache.has(t))i=St.gaussianKernelCache.get(t);else{let r=t*2/3,n=2*r*r;i=new Hi(t);let s=0;for(let a=-t;a<=t;++a){let o=Math.exp(-(a*a)/n);s+=o,i.setCoefficient(a+t,o)}i.scaleCoefficients(1/s),St.gaussianKernelCache.set(t,i)}return St.separableConvolution(e,i)}static grayscale(e){let t=e.getBytes();for(let i=0,r=t.length;i<r;i+=4){let n=d.getLuminanceRgb(t[i],t[i+1],t[i+2]);t[i]=n,t[i+1]=n,t[i+2]=n}return e}static invert(e){let t=e.getBytes();for(let i=0,r=t.length;i<r;i+=4)t[i]=255-t[i],t[i+1]=255-t[i+1],t[i+2]=255-t[i+2];return e}static noise(e,t,i=0){let r=t,n=0,s=0;if(r===0&&i!==3)return e;if(r<0||i===2){let o=e.getColorExtremes();n=o.min,s=o.max}r<0&&(r=-r*(s-n)/100);let a=e.length;switch(i){case 0:for(let o=0;o<a;++o){let u=e.getPixelByIndex(o),l=Math.trunc(d.getRed(u)+r*xe.grand()),h=Math.trunc(d.getGreen(u)+r*xe.grand()),f=Math.trunc(d.getBlue(u)+r*xe.grand()),c=d.getAlpha(u);e.setPixelByIndex(o,d.getColor(l,h,f,c))}break;case 1:for(let o=0;o<a;++o){let u=e.getPixelByIndex(o),l=Math.trunc(d.getRed(u)+r*xe.crand()),h=Math.trunc(d.getGreen(u)+r*xe.crand()),f=Math.trunc(d.getBlue(u)+r*xe.crand()),c=d.getAlpha(u);e.setPixelByIndex(o,d.getColor(l,h,f,c))}break;case 2:r<0&&(r=-r),s===n&&(n=0,s=255);for(let o=0;o<a;++o){let u=e.getPixelByIndex(o);if(Math.random()*100<r){let l=Math.random()<.5?s:n,h=Math.random()<.5?s:n,f=Math.random()<.5?s:n,c=d.getAlpha(u);e.setPixelByIndex(o,d.getColor(l,h,f,c))}}break;case 3:for(let o=0;o<a;++o){let u=e.getPixelByIndex(o),l=xe.prand(d.getRed(u)),h=xe.prand(d.getGreen(u)),f=xe.prand(d.getBlue(u)),c=d.getAlpha(u);e.setPixelByIndex(o,d.getColor(l,h,f,c))}break;case 4:{let o=Math.sqrt(2);for(let u=0;u<a;++u){let l=e.getPixelByIndex(u),h=d.getRed(l)/o,f=h+r*xe.grand(),c=h+r*xe.grand(),p=Math.sqrt(f*f+c*c),g=Math.trunc(p);h=d.getGreen(l)/o,f=h+r*xe.grand(),c=h+r*xe.grand(),p=Math.sqrt(f*f+c*c);let b=Math.trunc(p);h=d.getBlue(l)/o,f=h+r*xe.grand(),c=h+r*xe.grand(),p=Math.sqrt(f*f+c*c);let x=Math.trunc(p),y=d.getAlpha(l);e.setPixelByIndex(u,d.getColor(g,b,x,y))}break}}return e}static normalize(e,t,i){let r=t<i?t:i,n=t<i?i:t,s=e.getColorExtremes(),a=s.min,o=s.max;if(a===o)return e.fill(t);if(a!==r||o!==n){let u=e.getBytes();for(let l=0,h=u.length;l<h;l+=4)u[l]=Math.trunc((u[l]-a)/(o-a)*(n-r)+r),u[l+1]=Math.trunc((u[l+1]-a)/(o-a)*(n-r)+r),u[l+2]=Math.trunc((u[l+2]-a)/(o-a)*(n-r)+r),u[l+3]=Math.trunc((u[l+3]-a)/(o-a)*(n-r)+r)}return e}static pixelate(e,t,i=0){if(t<=1)return e;let r=t-1;switch(i){case 0:for(let n=0;n<e.height;n+=t)for(let s=0;s<e.width;s+=t)if(e.boundsSafe(s,n)){let a=e.getPixel(s,n),o=new at(s,n,s+r,n+r);Ze.fillRect(e,o,a)}break;case 1:for(let n=0;n<e.height;n+=t)for(let s=0;s<e.width;s+=t){let a=0,o=0,u=0,l=0,h=0;for(let f=0;f<t;++f)for(let c=0;c<t;++c){if(!e.boundsSafe(s+c,n+f))continue;let p=e.getPixel(s+c,n+f);a+=d.getAlpha(p),o+=d.getRed(p),u+=d.getGreen(p),l+=d.getBlue(p),h++}if(h>0){let f=d.getColor(Math.trunc(o/h),Math.trunc(u/h),Math.trunc(l/h),Math.trunc(a/h)),c=new at(s,n,s+r,n+r);Ze.fillRect(e,c,f)}}break}return e}static quantize(e){var n,s;let t=(n=e.numberOfColors)!=null?n:256;if(((s=e.method)!=null?s:0)===1||t<4){let a=new ci(e.src,t);for(let o=0,u=e.src.length;o<u;++o)e.src.setPixelByIndex(o,a.getQuantizedColor(e.src.getPixelByIndex(o)));return e.src}let r=new le(e.src,t);for(let a=0,o=e.src.length;a<o;++a)e.src.setPixelByIndex(a,r.getQuantizedColor(e.src.getPixelByIndex(a)));return e.src}static remapColors(e){var o,u,l,h;let t=(o=e.red)!=null?o:0,i=(u=e.red)!=null?u:0,r=(l=e.red)!=null?l:0,n=(h=e.red)!=null?h:0,s=[0,0,0,0,0],a=e.src.getBytes();for(let f=0,c=a.length;f<c;f+=4)s[0]=a[f],s[1]=a[f+1],s[2]=a[f+2],s[3]=a[f+3],(t===4||i===4||r===4||n===4)&&(s[4]=d.getLuminanceRgb(s[0],s[1],s[2])),a[f]=s[t],a[f+1]=s[i],a[f+2]=s[r],a[f+3]=s[n];return e.src}static scaleRgba(e,t,i,r,n){let s=t/255,a=i/255,o=r/255,u=n/255,l=e.getBytes();for(let h=0,f=l.length;h<f;h+=4)l[h]=Math.floor(l[h]*s),l[h+1]=Math.floor(l[h+1]*a),l[h+2]=Math.floor(l[h+2]*o),l[h+3]=Math.floor(l[h+3]*u);return e}static separableConvolution(e,t){let i=W.from(e);return t.apply(e,i),t.apply(i,e,!1),e}static sepia(e,t=1){if(t===0)return e;let i=e.getBytes();for(let r=0,n=i.length;r<n;r+=4){let s=i[r],a=i[r+1],o=i[r+2],u=d.getLuminanceRgb(s,a,o);i[r]=F.clampInt255(t*(u+38)+(1-t)*s),i[r+1]=F.clampInt255(t*(u+18)+(1-t)*a),i[r+2]=F.clampInt255(t*(u-31)+(1-t)*o)}return e}static smooth(e,t){let i=[1,1,1,1,t,1,1,1,1];return St.convolution({src:e,filter:i,div:t+8,offset:0})}static sobel(e,t=1){let i=1-t,n=St.grayscale(W.from(e)).getBytes(),s=e.width*4,a=e.getBytes(),o=a.length;for(let u=0,l=0;u<e.height;++u)for(let h=0;h<e.width;++h,l+=4){let f=l+s-4,c=l+s,p=l+s+4,g=l-4,b=l+4,x=l-s-4,y=l-s,P=l-s+4,w=x<0?0:n[x]/255,M=y<0?0:n[y]/255,B=P<0?0:n[P]/255,O=g<0?0:n[g]/255,R=b<o?n[b]/255:0,N=f<o?n[f]/255:0,L=c<o?n[c]/255:0,D=p<o?n[p]/255:0,k=-w-2*M-B+N+2*L+D,Y=-N-2*O-w+D+2*R+B,Z=F.clampInt255(Math.sqrt(k*k+Y*Y)*255);a[l]=F.clampInt255(Z*t+a[l]*i),a[l+1]=F.clampInt255(Z*t+a[l+1]*i),a[l+2]=F.clampInt255(Z*t+a[l+2]*i)}return e}static vignette(e){var u,l,h;let t=(u=e.start)!=null?u:.3,i=(l=e.end)!=null?l:.75,r=(h=e.amount)!=null?h:.8,n=e.src.height-1,s=e.src.width-1,a=1-r,o=e.src.getBytes();for(let f=0,c=0;f<=n;++f){let p=.5-f/n;for(let g=0;g<=s;++g,c+=4){let b=.5-g/s,x=Math.sqrt(b*b+p*p);x=St.smoothVignetteStep(i,t,x),o[c]=F.clampInt255(r*o[c]*x+a*o[c]),o[c+1]=F.clampInt255(r*o[c+1]*x+a*o[c+1]),o[c+2]=F.clampInt255(r*o[c+2]*x+a*o[c+2])}}return e.src}},kr=St;kr.gaussianKernelCache=new Map});var un=C(()=>{"use strict"});var ln=C(()=>{"use strict"});var hn=C(()=>{"use strict"});var ie,Ne,pi=C(()=>{"use strict";je();ie=class{constructor(e){this.bits=e}static convert(e){let t=e>>16&32768,i=(e>>23&255)-(127-15),r=e&8388607;if(i<=0){if(i<-10)return t;r|=8388608;let n=14-i,s=(1<<n-1)-1,a=r>>n&1;return r=r+s+a>>n,t|r}else return i===255-(127-15)?r===0?t|31744:(r>>=13,t|31744|r|(r===0?1:0)):(r=r+4095+(r>>13&1),(r&8388608)!==0&&(r=0,i+=1),i>30?t|31744:t|i<<10|r>>13)}static halfToFloat(e){let t=e>>15&1,i=e>>10&31,r=e&1023;if(i===0){if(r===0)return t<<31;for(;(r&1024)===0;)r<<=1,i-=1;i+=1,r&=-1025}else if(i===31)return r===0?t<<31|2139095040:t<<31|2139095040|r<<13;return i+=127-15,r<<=13,t<<31|i<<23|r}static fromBits(e){return new ie(e)}static halfToDouble(e){return this.toFloatFloat32[e]}static doubleToHalf(e){let t=e,i=E.toUint32(t);if(t===0)return i>>16;let r=i>>23&511;if(r=this.eLut[r],r!==0){let n=i&8388607;return r+(n+4095+(n>>13&1)>>13)}return this.convert(i)}static positiveInfinity(){return ie.fromBits(31744)}static negativeInfinity(){return ie.fromBits(64512)}static qNan(){return ie.fromBits(32767)}static sNan(){return ie.fromBits(32255)}toDouble(){return ie.toFloatFloat32[this.bits]}unaryMinus(){return ie.fromBits(this.bits^32768)}add(e){let t=0;e instanceof ie?t=e.toDouble():typeof e=="number"&&(t=e);let i=ie.doubleToHalf(this.toDouble()+t);return new ie(i)}subtract(e){let t=0;e instanceof ie?t=e.toDouble():typeof e=="number"&&(t=e);let i=ie.doubleToHalf(this.toDouble()-t);return new ie(i)}multiply(e){let t=0;e instanceof ie?t=e.toDouble():typeof e=="number"&&(t=e);let i=ie.doubleToHalf(this.toDouble()*t);return new ie(i)}divide(e){let t=0;e instanceof ie?t=e.toDouble():typeof e=="number"&&(t=e);let i=ie.doubleToHalf(this.toDouble()/t);return new ie(i)}round(e){if(e>=10)return this;let t=this.bits&32768,i=this.bits&32767;return i>>=9-e,i+=i&1,i<<=9-e,i>=31744&&(i=this.bits,i>>=10-e,i<<=10-e),ie.fromBits(t|i)}isFinite(){return(this.bits>>10&31)<31}isNormalized(){let e=this.bits>>10&31;return e>0&&e<31}isDenormalized(){let e=this.bits>>10&31,t=this.bits&1023;return e===0&&t!==0}isZero(){return(this.bits&32767)===0}isNan(){let e=this.bits>>10&31,t=this.bits&1023;return e===31&&t!==0}isInfinity(){let e=this.bits>>10&31,t=this.bits&1023;return e===31&&t===0}isNegative(){return(this.bits&32768)!==0}getBits(){return this.bits}setBits(e){this.bits=e}},Ne=ie;(()=>{ie.toFloatUint32=new Uint32Array(1<<16),ie.toFloatFloat32=new Float32Array(ie.toFloatUint32.buffer),ie.eLut=new Uint16Array(1<<9);for(let t=0;t<256;t++){let i=(t&255)-112;i<=0||i>=30?(ie.eLut[t]=0,ie.eLut[t|256]=0):(ie.eLut[t]=i<<10,ie.eLut[t|256]=i<<10|32768)}let e=1<<16;for(let t=0;t<e;t++)ie.toFloatUint32[t]=ie.halfToFloat(t)})()});var ht,ye,Ut=C(()=>{"use strict";ut();Ot();pi();ht=class{get data(){return this._data}get name(){return this._name}get width(){return this._width}get height(){return this._height}get format(){return this._format}get bitsPerSample(){return this._bitsPerSample}get maxIntSize(){let e=4294967295;return this._bitsPerSample===8?e=255:this._bitsPerSample===16&&(e=65535),this._format===ht.INT&&(e-=1),e}get isFloat(){return this._format===ht.FLOAT}constructor(e){var t;this._name=e.name,this._width=e.width,this._height=e.height,this._format=e.format,this._bitsPerSample=e.bitsPerSample,this._data=(t=e.data)!=null?t:ht.allocateDataForType(e.width*e.height,e.format,e.bitsPerSample)}static allocateDataForType(e,t,i){switch(t){case ht.INT:if(i===8)return new Int8Array(e);if(i===16)return new Int16Array(e);if(i===32)return new Int32Array(e);break;case ht.UINT:if(i===8)return new Uint8Array(e);if(i===16)return new Uint16Array(e);if(i===32)return new Uint32Array(e);break;case ht.FLOAT:if(i===16)return new Uint16Array(e);if(i===32)return new Float32Array(e);if(i===64)return new Float64Array(e);break}throw new Pt}static from(e){return new ht({name:e._name,width:e._width,height:e._height,format:e._format,bitsPerSample:e._bitsPerSample,data:te.copy(e.data)})}getBytes(){return new Uint8Array(this._data.buffer)}getFloat(e,t){let i=t*this._width+e;return this._format===ht.INT||this._format===ht.UINT?Math.trunc(this._data[i])/this.maxIntSize:this._format===ht.FLOAT&&this._bitsPerSample===16?Ne.halfToDouble(this._data[i]):this._data[i]}setFloat(e,t,i){if(this._format!==ht.FLOAT)return;let r=t*this._width+e;this._bitsPerSample===16?this._data[r]=Ne.doubleToHalf(i):this._data[r]=i}getInt(e,t){let i=t*this._width+e;return Math.trunc(this._data[i])}setInt(e,t,i){let r=t*this._width+e;this._data[r]=Math.trunc(i)}},ye=ht;ye.UINT=0,ye.INT=1,ye.FLOAT=3});var Ue,de,ft=C(()=>{"use strict";Ve();Ut();Ue=class{constructor(){this._slices=new Map;this._red=void 0;this._green=void 0;this._blue=void 0;this._alpha=void 0;this._depth=void 0;this._exifData=void 0}get slices(){return this._slices}get red(){return this._red}get green(){return this._green}get blue(){return this._blue}get alpha(){return this._alpha}get depth(){return this._depth}get exifData(){return this._exifData}set exifData(e){this._exifData=e}get hasColor(){return this.red!==void 0||this.green!==void 0||this.blue!==void 0}get hasAlpha(){return this.alpha!==void 0}get hasDepth(){return this.depth!==void 0}get width(){return this.slices.size>0?this.slices.values().next().value.width:0}get height(){return this.slices.size>0?this.slices.values().next().value.height:0}get bitsPerSample(){return this.red!==void 0?this.red.bitsPerSample:this.slices.size>0?this.slices.values().next().value.bitsPerSample:0}get sampleFormat(){return this.red!==void 0?this.red.format:this.slices.size>0?this.slices.values().next().value.format:0}get numberOfChannels(){return this.slices.size}static create(e,t,i,r,n){let s=new Ue;if(0<=i&&i<=4){let a=[Ue.R,Ue.G,Ue.B,Ue.A];for(let o=0;o<i;++o)s.addChannel(new ye({name:a[o],width:e,height:t,format:r,bitsPerSample:n}));return s}else return s}static from(e){let t=new Ue;for(let[,i]of e.slices)t.addChannel(ye.from(i));return t}static fromImage(e,t=ye.FLOAT,i=16){let r=new Ue;r.addChannel(new ye({name:Ue.R,width:e.width,height:e.height,format:t,bitsPerSample:i})),r.addChannel(new ye({name:Ue.G,width:e.width,height:e.height,format:t,bitsPerSample:i})),r.addChannel(new ye({name:Ue.B,width:e.width,height:e.height,format:t,bitsPerSample:i})),e.rgbChannelSet===1&&r.addChannel(new ye({name:Ue.A,width:e.width,height:e.height,format:t,bitsPerSample:i}));let n=e.getBytes();for(let s=0,a=0;s<e.height;++s)for(let o=0;o<e.width;++o)r.setRed(o,s,n[a++]/255),r.setGreen(o,s,n[a++]/255),r.setBlue(o,s,n[a++]/255),r.alpha!==void 0&&r.setAlpha(o,s,n[a++]/255);return r}getRed(e,t){return this.red!==void 0?this.red.isFloat?this.red.getFloat(e,t):this.red.getInt(e,t):0}setRed(e,t,i){this.red!==void 0&&(this.red.isFloat?this.red.setFloat(e,t,i):this.red.setInt(e,t,i))}setRedInt(e,t,i){this.red!==void 0&&this.red.setInt(e,t,i)}getGreen(e,t){return this.green!==void 0?this.green.isFloat?this.green.getFloat(e,t):this.green.getInt(e,t):0}setGreen(e,t,i){this.green!==void 0&&(this.green.isFloat?this.green.setFloat(e,t,i):this.green.setInt(e,t,i))}setGreenInt(e,t,i){this.green!==void 0&&this.green.setInt(e,t,i)}getBlue(e,t){return this.blue!==void 0?this.blue.isFloat?this.blue.getFloat(e,t):this.blue.getInt(e,t):0}setBlue(e,t,i){this.blue!==void 0&&(this.blue.isFloat?this.blue.setFloat(e,t,i):this.blue.setInt(e,t,i))}setBlueInt(e,t,i){this.blue!==void 0&&this.blue.setInt(e,t,i)}getAlpha(e,t){return this.alpha!==void 0?this.alpha.isFloat?this.alpha.getFloat(e,t):this.alpha.getInt(e,t):0}setAlpha(e,t,i){this.alpha!==void 0&&(this.alpha.isFloat?this.alpha.setFloat(e,t,i):this.alpha.setInt(e,t,i))}setAlphaInt(e,t,i){this.alpha!==void 0&&this.alpha.setInt(e,t,i)}getDepth(e,t){return this.depth!==void 0?this.depth.isFloat?this.depth.getFloat(e,t):this.depth.getInt(e,t):0}setDepth(e,t,i){this.depth!==void 0&&(this.depth.isFloat?this.depth.setFloat(e,t,i):this.depth.setInt(e,t,i))}setDepthInt(e,t,i){this.depth!==void 0&&this.depth.setInt(e,t,i)}hasChannel(e){return this.slices.has(e)}getChannel(e){return this.slices.get(e)}addChannel(e){let t=e.name;switch(this.slices.set(t,e),t){case Ue.R:this._red=e;break;case Ue.G:this._green=e;break;case Ue.B:this._blue=e;break;case Ue.A:this._alpha=e;break;case Ue.Z:this._depth=e;break}}toFloatRgba(){let e=new Float32Array(this.width*this.height*4),t=this.width,i=this.height;for(let r=0,n=0;r<i;++r)for(let s=0;s<t;++s)e[n++]=this.red===void 0?0:this.red.getFloat(s,r),e[n++]=this.green===void 0?0:this.green.getFloat(s,r),e[n++]=this.blue===void 0?0:this.blue.getFloat(s,r),e[n++]=this.alpha===void 0?1:this.alpha.getFloat(s,r);return e}},de=Ue;de.R="R",de.G="G",de.B="B",de.A="A",de.Z="Z"});var fn,Ct,Mt=C(()=>{"use strict";He();ue();fn=class{get fileLength(){return this._fileLength}set offset(e){this._offset=e}get offset(){return this._offset}constructor(e){if(!fn.isValidFile(e))throw new T("Not a bitmap file.");e.skip(2),this._fileLength=e.readInt32(),e.skip(4),this._offset=e.readInt32()}static isValidFile(e){return e.length<2?!1:G.from(e).readUint16()===fn.BMP_HEADER_FILETYPE}toJson(){return new Map([["offset",this._offset],["fileLength",this.fileLength],["fileType",fn.BMP_HEADER_FILETYPE]])}},Ct=fn;Ct.BMP_HEADER_FILETYPE=66+(77<<8)});var Yi=C(()=>{"use strict"});var bi=C(()=>{"use strict";je();ge();ue();Ot();Yi();Mt()});var gi=C(()=>{"use strict";bt();He();Ye();ft();Mt();bi()});var zi=C(()=>{"use strict";ge();st();Ve();Mt()});var cn=C(()=>{"use strict"});var dn=C(()=>{"use strict"});var Hr=C(()=>{"use strict";gi()});var mn=C(()=>{"use strict"});var Wi=C(()=>{"use strict"});var fe,Ft=C(()=>{"use strict";Ye();Ve();ue();di();Wi();mi();Zt();ge();Qe();wt();fe=class{static copyRotate(e,t,i=0){let r=t%360;if(r%90===0){let x=e.width-1,y=e.height-1;switch(Math.floor(r/90)){case 1:{let w=new W({width:e.height,height:e.width,rgbChannelSet:e.rgbChannelSet,exifData:e.exifData,iccProfile:e.iccProfile});for(let M=0;M<w.height;++M)for(let B=0;B<w.width;++B)w.setPixel(B,M,e.getPixel(M,y-B));return w}case 2:{let w=new W({width:e.width,height:e.height,rgbChannelSet:e.rgbChannelSet,exifData:e.exifData,iccProfile:e.iccProfile});for(let M=0;M<w.height;++M)for(let B=0;B<w.width;++B)w.setPixel(B,M,e.getPixel(x-B,y-M));return w}case 3:{let w=new W({width:e.height,height:e.width,rgbChannelSet:e.rgbChannelSet,exifData:e.exifData,iccProfile:e.iccProfile});for(let M=0;M<w.height;++M)for(let B=0;B<w.width;++B)w.setPixel(B,M,e.getPixel(x-M,B));return w}default:return W.from(e)}}let n=r*Math.PI/180,s=Math.cos(n),a=Math.sin(n),o=Math.abs(e.width*s),u=Math.abs(e.width*a),l=Math.abs(e.height*a),h=Math.abs(e.height*s),f=.5*e.width,c=.5*e.height,p=.5*(o+l),g=.5*(u+h),b=new W({width:Math.trunc(o+l),height:Math.trunc(u+h),rgbChannelSet:1,exifData:e.exifData,iccProfile:e.iccProfile});for(let x=0;x<b.height;++x)for(let y=0;y<b.width;++y){let P=e.getPixelInterpolate(f+(y-p)*s+(x-g)*a,c-(y-p)*a+(x-g)*s,i);b.setPixel(y,x,P)}return b}static bakeOrientation(e){let t=W.from(e);if(!e.exifData.imageIfd.hasOrientation||e.exifData.imageIfd.orientation===1)return t;switch(t.exifData=Ae.from(e.exifData),t.exifData.imageIfd.orientation=void 0,e.exifData.imageIfd.orientation){case 2:return fe.flipHorizontal(t);case 3:return fe.flip(t,2);case 4:{let i=fe.copyRotate(t,180);return fe.flipHorizontal(i)}case 5:{let i=fe.copyRotate(t,90);return fe.flipHorizontal(i)}case 6:return fe.copyRotate(t,90);case 7:{let i=fe.copyRotate(t,-90);return fe.flipHorizontal(i)}case 8:return fe.copyRotate(t,-90)}return t}static copyResize(e){var s,a,o;if((s=e.interpolation)!=null||(e.interpolation=0),(a=e.width)!=null||(e.width=0),(o=e.height)!=null||(e.height=0),e.width===0&&e.height===0)throw new T("CopyResize: wrong size");let t=fe.bakeOrientation(e.image);if(e.height===0&&(e.height=Math.trunc(e.width*(t.height/t.width))),e.width===0&&(e.width=Math.trunc(e.height*(t.width/t.height))),e.width===t.width&&e.height===t.height)return t.clone();let i=new W({width:e.width,height:e.height,rgbChannelSet:t.rgbChannelSet,exifData:t.exifData,iccProfile:t.iccProfile}),r=t.height/e.height,n=t.width/e.width;if(e.interpolation===3){let u=t.getBytes(),l=t.width*4;for(let h=0;h<e.height;++h){let f=Math.trunc(h*r),c=Math.trunc((h+1)*r);c===f&&c++;for(let p=0;p<e.width;++p){let g=Math.trunc(p*n),b=Math.trunc((p+1)*n);b===g&&b++;let x=0,y=0,P=0,w=0,M=0;for(let B=f;B<c;++B){let O=B*l+g*4;for(let R=g;R<b;++R,++M)x+=u[O++],y+=u[O++],P+=u[O++],w+=u[O++]}i.setPixel(p,h,d.getColor(Math.floor(x/M),Math.floor(y/M),Math.floor(P/M),Math.floor(w/M)))}}}else if(e.interpolation===0){let u=new Int32Array(e.width);for(let l=0;l<e.width;++l)u[l]=Math.trunc(l*n);for(let l=0;l<e.height;++l){let h=Math.trunc(l*r);for(let f=0;f<e.width;++f)i.setPixel(f,l,t.getPixel(u[f],h))}}else for(let u=0;u<e.height;++u){let l=u*r;for(let h=0;h<e.width;++h){let f=h*n;i.setPixel(h,u,t.getPixelInterpolate(f,l,e.interpolation))}}return i}static copyResizeCropSquare(e,t){if(t<=0)throw new T("Invalid size");let i=t,r=t;e.width<e.height?i=Math.trunc(t*(e.height/e.width)):e.width>e.height&&(r=Math.trunc(t*(e.width/e.height)));let n=new W({width:t,height:t,rgbChannelSet:e.rgbChannelSet,exifData:e.exifData,iccProfile:e.iccProfile}),s=e.height/i,a=e.width/r,o=Math.trunc((r-t)/2),u=Math.trunc((i-t)/2),l=new Int32Array(t);for(let h=0;h<t;++h)l[h]=Math.trunc((h+o)*a);for(let h=0;h<t;++h){let f=Math.trunc((h+u)*s);for(let c=0;c<t;++c)n.setPixel(c,h,e.getPixel(l[c],f))}return n}static copyInto(e){var t,i,r,n,s,a,o,u;if((t=e.dstX)!=null||(e.dstX=0),(i=e.dstY)!=null||(e.dstY=0),(r=e.srcX)!=null||(e.srcX=0),(n=e.srcY)!=null||(e.srcY=0),(s=e.srcW)!=null||(e.srcW=e.src.width),(a=e.srcH)!=null||(e.srcH=e.src.height),(o=e.blend)!=null||(e.blend=!0),(u=e.center)!=null||(e.center=!1),e.center){{let l=e.dst.width-e.src.width;l<0&&(l=0),e.dstX=Math.floor(l/2)}{let l=e.dst.height-e.src.height;l<0&&(l=0),e.dstY=Math.floor(l/2)}}if(e.blend)for(let l=0;l<e.srcH;++l)for(let h=0;h<e.srcW;++h){let f=new z(e.dstX+h,e.dstY+l);Ze.drawPixel(e.dst,f,e.src.getPixel(e.srcX+h,e.srcY+l))}else for(let l=0;l<e.srcH;++l)for(let h=0;h<e.srcW;++h)e.dst.setPixel(e.dstX+h,e.dstY+l,e.src.getPixel(e.srcX+h,e.srcY+l));return e.dst}static copyCrop(e,t,i,r,n){let s=F.clampInt(t,0,e.width-1),a=F.clampInt(i,0,e.height-1),o=r;s+o>e.width&&(o=e.width-s);let u=n;a+u>e.height&&(u=e.height-a);let l=new W({width:o,height:u,rgbChannelSet:e.rgbChannelSet,exifData:e.exifData,iccProfile:e.iccProfile});for(let h=0,f=a;h<u;++h,++f)for(let c=0,p=s;c<o;++c,++p)l.setPixel(c,h,e.getPixel(p,f));return l}static copyCropCircle(e,t,i){let r=Math.trunc(Math.min(e.width,e.height)/2),n=i!=null?i:new z(Math.trunc(e.width/2),Math.trunc(e.height/2)),s=t!=null?t:r;n.move(F.clampInt(n.x,0,e.width-1),F.clampInt(n.y,0,e.height-1)),s=s<1?r:s;let a=Math.trunc(n.x)-s,o=Math.trunc(n.y)-s,u=new W({width:s*2,height:s*2,iccProfile:e.iccProfile});for(let l=0,h=o;l<s*2;++l,++h)for(let f=0,c=a;f<s*2;++f,++c)(f-s)*(f-s)+(l-s)*(l-s)<=s*s&&u.setPixel(f,l,e.getPixelSafe(c,h));return u}static copyRectify(e,t,i){let r=i!=null?i:W.from(e);for(let n=0;n<r.height;++n){let s=n/(r.height-1);for(let a=0;a<r.width;++a){let o=a/(r.width-1),u=new z(t.left,t.top).mul(1-o).mul(1-s).add(new z(t.right,t.top).mul(o).mul(1-s)).add(new z(t.left,t.bottom).mul(1-o).mul(s)).add(new z(t.right,t.bottom).mul(o).mul(s)),l=e.getPixel(u.xt,u.yt);r.setPixel(a,n,l)}}return r}static flip(e,t){switch(t){case 0:fe.flipHorizontal(e);break;case 1:fe.flipVertical(e);break;case 2:fe.flipVertical(e),fe.flipHorizontal(e);break}return e}static flipVertical(e){let t=e.width,i=e.height,r=Math.floor(i/2);for(let n=0;n<r;++n){let s=n*t,a=(i-1-n)*t;for(let o=0;o<t;++o){let u=e.getPixelByIndex(a+o);e.setPixelByIndex(a+o,e.getPixelByIndex(s+o)),e.setPixelByIndex(s+o,u)}}return e}static flipHorizontal(e){let t=e.width,i=e.height,r=Math.floor(e.width/2);for(let n=0;n<i;++n){let s=n*t;for(let a=0;a<r;++a){let o=t-1-a,u=e.getPixelByIndex(s+o);e.setPixelByIndex(s+o,e.getPixelByIndex(s+a)),e.setPixelByIndex(s+a,u)}}return e}}});var ct,xi=C(()=>{"use strict";ge();ct=class{get colors(){return this._colors}get numColors(){return this._numColors}get bitsPerPixel(){return this._bitsPerPixel}set transparent(e){this._transparent=e}get transparent(){return this._transparent}constructor(e){var t,i;this._numColors=e.numColors,this._bitsPerPixel=(t=e.bitsPerPixel)!=null?t:ct.bitSize(e.numColors),this._colors=(i=e.colors)!=null?i:new Uint8Array(e.numColors*3),this._transparent=e.transparent}static bitSize(e){for(let t=1;t<=8;t++)if(1<<t>=e)return t;return 0}static from(e){return new ct({numColors:e.numColors,bitsPerPixel:e.bitsPerPixel,colors:e.colors,transparent:e.transparent})}getByte(e){return this._colors[e]}setByte(e,t){return this._colors[e]=t}getColor(e){let t=e*3,i=e===this._transparent?0:255;return d.getColor(this._colors[t],this._colors[t+1],this._colors[t+2],i)}setColor(e,t,i,r){let n=e*3;this._colors[n]=t,this._colors[n+1]=i,this._colors[n+2]=r}getRed(e){return this._colors[e*3]}getGreen(e){return this._colors[e*3+1]}getBlue(e){return this._colors[e*3+2]}getAlpha(e){return e===this._transparent?0:255}}});var Xi,qi=C(()=>{"use strict";xi();Xi=class{constructor(e){this._duration=80;this._clearFrame=!0;this._x=e.readUint16(),this._y=e.readUint16(),this._width=e.readUint16(),this._height=e.readUint16();let t=e.readByte(),i=(t&7)+1;if(this._interlaced=(t&64)!==0,(t&128)!==0){this._colorMap=new ct({numColors:1<<i});for(let r=0;r<this._colorMap.numColors;++r)this._colorMap.setColor(r,e.readByte(),e.readByte(),e.readByte())}this._inputPosition=e.position}get x(){return this._x}get y(){return this._y}get width(){return this._width}get height(){return this._height}get interlaced(){return this._interlaced}get colorMap(){return this._colorMap}set colorMap(e){this._colorMap=e}set duration(e){this._duration=e}get duration(){return this._duration}set clearFrame(e){this._clearFrame=e}get clearFrame(){return this._clearFrame}get inputPosition(){return this._inputPosition}}});var Zi,$i=C(()=>{"use strict";Zi=class{constructor(e){this._isGif89=!1;var t,i,r,n,s,a;this._width=(t=e==null?void 0:e.width)!=null?t:0,this._height=(i=e==null?void 0:e.height)!=null?i:0,this._backgroundColor=(r=e==null?void 0:e.backgroundColor)!=null?r:4294967295,this._frames=(n=e==null?void 0:e.frames)!=null?n:new Array,this._colorResolution=(s=e==null?void 0:e.colorResolution)!=null?s:0,this._globalColorMap=e==null?void 0:e.globalColorMap,this._isGif89=(a=e==null?void 0:e.isGif89)!=null?a:!1}get width(){return this._width}get height(){return this._height}get backgroundColor(){return this._backgroundColor}get frames(){return this._frames}get colorResolution(){return this._colorResolution}get globalColorMap(){return this._globalColorMap}get isGif89(){return this._isGif89}get numFrames(){return this.frames.length}}});var q,Se,Ki=C(()=>{"use strict";bt();He();ut();Ye();ue();ft();Ft();xi();qi();$i();q=class{constructor(e){this.repeat=0;this.bitsPerPixel=0;this.currentShiftDWord=0;this.currentShiftState=0;this.stackPtr=0;this.lastCode=0;this.maxCode1=0;this.runningBits=0;this.runningCode=0;this.eofCode=0;this.clearCode=0;e!==void 0&&this.startDecode(e)}get numFrames(){return this.info!==void 0?this.info.numFrames:0}static getPrefixChar(e,t,i){let r=t,n=0;for(;r>i&&n++<=q.LZ_MAX_CODE;){if(r>q.LZ_MAX_CODE)return q.NO_SUCH_CODE;r=e[t]}return r}static updateImage(e,t,i,r){if(i!==void 0)for(let n=0,s=r.length;n<s;++n)e.setPixel(n,t,i.getColor(r[n]))}getInfo(){if(this.input===void 0)return!1;let e=this.input.readString(q.STAMP_SIZE);if(e!==q.GIF87_STAMP&&e!==q.GIF89_STAMP)return!1;let t=this.input.readUint16(),i=this.input.readUint16(),r=this.input.readByte(),n=((r&112)+1>>4)+1,s=(r&7)+1,a=this.input.readByte();this.input.skip(1);let o;if((r&128)!==0){o=new ct({numColors:1<<s});for(let l=0;l<o.numColors;++l){let h=this.input.readByte(),f=this.input.readByte(),c=this.input.readByte();o.setColor(l,h,f,c)}}let u=e===q.GIF89_STAMP;return this.info=new Zi({width:t,height:i,colorResolution:n,backgroundColor:a,globalColorMap:o,isGif89:u}),!0}skipImage(){if(this.input===void 0||this.input.isEOS)return;let e=new Xi(this.input);return this.input.skip(1),this.skipRemainder(),e}skipRemainder(){if(this.input===void 0||this.input.isEOS)return!0;let e=this.input.readByte();for(;e!==0&&!this.input.isEOS;){if(this.input.skip(e),this.input.isEOS)return!0;e=this.input.readByte()}return!0}readApplicationExt(e){let t=e.readByte();if(e.readString(t)==="NETSCAPE2.0"){let r=e.readByte(),n=e.readByte();r===3&&n===1&&(this.repeat=e.readUint16())}else this.skipRemainder()}readGraphicsControlExt(e){e.readByte();let t=e.readByte(),i=e.readUint16(),r=e.readByte();e.readByte();let n=t>>2&7,s=t&1;if(e.peekBytes(1).getByte(0)===q.IMAGE_DESC_RECORD_TYPE){e.skip(1);let o=this.skipImage();if(o===void 0)return;o.duration=i,o.clearFrame=n===2,s!==0&&(o.colorMap===void 0&&this.info.globalColorMap!==void 0&&(o.colorMap=ct.from(this.info.globalColorMap)),o.colorMap!==void 0&&(o.colorMap.transparent=r)),this.info.frames.push(o)}}decodeFrameImage(e){this.buffer===void 0&&this.initDecode(),this.bitsPerPixel=this.input.readByte(),this.clearCode=1<<this.bitsPerPixel,this.eofCode=this.clearCode+1,this.runningCode=this.eofCode+1,this.runningBits=this.bitsPerPixel+1,this.maxCode1=1<<this.runningBits,this.stackPtr=0,this.lastCode=q.NO_SUCH_CODE,this.currentShiftState=0,this.currentShiftDWord=0,this.buffer[0]=0,this.prefix.fill(q.NO_SUCH_CODE,0,this.prefix.length);let t=e.width,i=e.height;if(e.x+t>this.info.width||e.y+i>this.info.height)return;let r=e.colorMap!==void 0?e.colorMap:this.info.globalColorMap;this.pixelCount=t*i;let n=new W({width:t,height:i}),s=new Uint8Array(t);if(e.interlaced){let a=e.y;for(let o=0,u=0;o<4;++o)for(let l=a+q.INTERLACED_OFFSET[o];l<a+i;l+=q.INTERLACED_JUMP[o],++u){if(!this.getLine(s))return n;q.updateImage(n,l,r,s)}}else for(let a=0;a<i;++a){if(!this.getLine(s))return n;q.updateImage(n,a,r,s)}return n}getLine(e){return this.pixelCount=this.pixelCount-e.length,this.decompressLine(e)?(this.pixelCount===0&&this.skipRemainder(),!0):!1}decompressLine(e){if(this.stackPtr>q.LZ_MAX_CODE)return!1;let t=e.length,i=0;if(this.stackPtr!==0)for(;this.stackPtr!==0&&i<t;)e[i++]=this.stack[--this.stackPtr];let r;for(;i<t;){if(this.currentCode=this.decompressInput(),this.currentCode===void 0||this.currentCode===this.eofCode)return!1;if(this.currentCode===this.clearCode){for(let n=0;n<=q.LZ_MAX_CODE;n++)this.prefix[n]=q.NO_SUCH_CODE;this.runningCode=this.eofCode+1,this.runningBits=this.bitsPerPixel+1,this.maxCode1=1<<this.runningBits,this.lastCode=q.NO_SUCH_CODE}else{if(this.currentCode<this.clearCode)e[i++]=this.currentCode;else{if(this.prefix[this.currentCode]===q.NO_SUCH_CODE)if(this.currentCode===this.runningCode-2){r=this.lastCode;let s=q.getPrefixChar(this.prefix,this.lastCode,this.clearCode);this.stack[this.stackPtr++]=s,this.suffix[this.runningCode-2]=s}else return!1;else r=this.currentCode;let n=0;for(;n++<=q.LZ_MAX_CODE&&r>this.clearCode&&r<=q.LZ_MAX_CODE;)this.stack[this.stackPtr++]=this.suffix[r],r=this.prefix[r];if(n>=q.LZ_MAX_CODE||r>q.LZ_MAX_CODE)return!1;for(this.stack[this.stackPtr++]=r;this.stackPtr!==0&&i<t;)e[i++]=this.stack[--this.stackPtr]}this.lastCode!==q.NO_SUCH_CODE&&this.prefix[this.runningCode-2]===q.NO_SUCH_CODE&&(this.prefix[this.runningCode-2]=this.lastCode,this.currentCode===this.runningCode-2?this.suffix[this.runningCode-2]=q.getPrefixChar(this.prefix,this.lastCode,this.clearCode):this.suffix[this.runningCode-2]=q.getPrefixChar(this.prefix,this.currentCode,this.clearCode)),this.lastCode=this.currentCode}}return!0}decompressInput(){if(this.runningBits>q.LZ_BITS)return;for(;this.currentShiftState<this.runningBits;){let t=this.bufferedInput();this.currentShiftDWord|=t<<this.currentShiftState,this.currentShiftState+=8}let e=this.currentShiftDWord&q.CODE_MASKS[this.runningBits];return this.currentShiftDWord>>=this.runningBits,this.currentShiftState-=this.runningBits,this.runningCode<q.LZ_MAX_CODE+2&&++this.runningCode>this.maxCode1&&this.runningBits<q.LZ_BITS&&(this.maxCode1<<=1,this.runningBits++),e}bufferedInput(){let e=0;if(this.buffer[0]===0){if(this.buffer[0]=this.input.readByte(),this.buffer[0]===0)return;let t=this.input.readBytes(this.buffer[0]).toUint8Array();te.setRange(this.buffer,1,1+this.buffer[0],t),e=this.buffer[1],this.buffer[1]=2,this.buffer[0]--}else e=this.buffer[this.buffer[1]++],this.buffer[0]--;return e}initDecode(){this.buffer=new Uint8Array(256),this.stack=new Uint8Array(q.LZ_MAX_CODE),this.suffix=new Uint8Array(q.LZ_MAX_CODE+1),this.prefix=new Uint32Array(q.LZ_MAX_CODE+1)}isValidFile(e){return this.input=new G({buffer:e}),this.getInfo()}startDecode(e){if(this.input=new G({buffer:e}),!!this.getInfo()){try{for(;!this.input.isEOS;)switch(this.input.readByte()){case q.IMAGE_DESC_RECORD_TYPE:{let i=this.skipImage();if(i===void 0)return this.info;this.info.frames.push(i);break}case q.EXTENSION_RECORD_TYPE:{let i=this.input.readByte();i===q.APPLICATION_EXT?this.readApplicationExt(this.input):i===q.GRAPHIC_CONTROL_EXT?this.readGraphicsControlExt(this.input):this.skipRemainder();break}case q.TERMINATE_RECORD_TYPE:return this.info;default:break}}catch(t){let i=JSON.stringify(t);throw new T(i)}return this.info}}decodeFrame(e){if(this.input===void 0||this.info===void 0||e>=this.info.frames.length||e<0)return;let t=this.info.frames[e];return this.input.offset=t.inputPosition,this.decodeFrameImage(this.info.frames[e])}decodeHdrFrame(e){let t=this.decodeFrame(e);if(t!==void 0)return de.fromImage(t)}decodeAnimation(e){if(this.startDecode(e)===void 0||this.input===void 0||this.info===void 0)return;let t=new Xe({width:this.info.width,height:this.info.height,loopCount:this.repeat}),i;for(let r=0;r<this.info.numFrames;++r){let n=this.info.frames[r],s=this.decodeFrame(r);if(s===void 0)return;if(i===void 0){i=s,i.duration=n.duration*10,t.addFrame(i);continue}if(s.width===i.width&&s.height===i.height&&n.x===0&&n.y===0&&n.clearFrame){i=s,i.duration=n.duration*10,t.addFrame(i);continue}if(n.clearFrame){i=new W({width:i.width,height:i.height});let a=n.colorMap!==void 0?n.colorMap:this.info.globalColorMap;i.fill(a.getColor(this.info.backgroundColor))}else i=W.from(i);fe.copyInto({dst:i,src:s,dstX:n.x,dstY:n.y}),i.duration=n.duration*10,t.addFrame(i)}return t}decodeImage(e,t=0){if(this.startDecode(e)!==void 0)return this.decodeFrame(t)}decodeHdrImage(e,t=0){let i=this.decodeImage(e,t);if(i!==void 0)return de.fromImage(i)}},Se=q;Se.STAMP_SIZE=6,Se.GIF87_STAMP="GIF87a",Se.GIF89_STAMP="GIF89a",Se.IMAGE_DESC_RECORD_TYPE=44,Se.EXTENSION_RECORD_TYPE=33,Se.TERMINATE_RECORD_TYPE=59,Se.GRAPHIC_CONTROL_EXT=249,Se.APPLICATION_EXT=255,Se.LZ_MAX_CODE=4095,Se.LZ_BITS=12,Se.NO_SUCH_CODE=4098,Se.CODE_MASKS=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095],Se.INTERLACED_OFFSET=[0,4,2,1],Se.INTERLACED_JUMP=[8,8,4,2]});var Pe,ze,ji=C(()=>{"use strict";Wt();Mi();hi();st();xt();Pe=class{constructor(e){this.curAccum=0;this.curBits=0;this.nBits=0;this.initBits=0;this.EOFCode=0;this.maxCode=0;this.clearCode=0;this.freeEnt=0;this.clearFlag=!1;this.blockSize=0;this._supportsAnimation=!0;var t,i,r,n,s;this.delay=(t=e==null?void 0:e.delay)!=null?t:80,this.repeat=(i=e==null?void 0:e.repeat)!=null?i:0,this.samplingFactor=(r=e==null?void 0:e.samplingFactor)!=null?r:10,this.dither=(n=e==null?void 0:e.dither)!=null?n:2,this.ditherSerpentine=(s=e==null?void 0:e.ditherSerpentine)!=null?s:!1,this.encodedFrames=0}get supportsAnimation(){return this._supportsAnimation}addImage(e,t,i,r,n){this.outputBuffer.writeByte(Pe.imageDescRecordType),this.outputBuffer.writeUint16(0),this.outputBuffer.writeUint16(0),this.outputBuffer.writeUint16(t),this.outputBuffer.writeUint16(i),this.outputBuffer.writeByte(135),this.outputBuffer.writeBytes(r);for(let s=n;s<256;++s)this.outputBuffer.writeByte(0),this.outputBuffer.writeByte(0),this.outputBuffer.writeByte(0);this.encodeLZW(e,t,i)}encodeLZW(e,t,i){this.curAccum=0,this.curBits=0,this.blockSize=0,this.block=new Uint8Array(256);let r=8;this.outputBuffer.writeByte(r);let n=new Int32Array(Pe.hsize),s=new Int32Array(Pe.hsize),a=t*i,o=0;this.initBits=r+1,this.nBits=this.initBits,this.maxCode=(1<<this.nBits)-1,this.clearCode=1<<this.initBits-1,this.EOFCode=this.clearCode+1,this.clearFlag=!1,this.freeEnt=this.clearCode+2;let u=()=>a===0?Pe.eof:(--a,e[o++]&255),l=u(),h=0;for(let p=Pe.hsize;p<65536;p*=2)h++;h=8-h;let f=Pe.hsize;for(let p=0;p<f;++p)n[p]=-1;this.output(this.clearCode);let c=!0;for(;c;){c=!1;let p=u();for(;p!==Pe.eof;){let g=(p<<Pe.bits)+l,b=p<<h^l;if(n[b]===g){l=s[b],p=u();continue}else if(n[b]>=0){let x=f-b;b===0&&(x=1);do if((b-=x)<0&&(b+=f),n[b]===g){l=s[b],c=!0;break}while(n[b]>=0);if(c)break}if(this.output(l),l=p,this.freeEnt<1<<Pe.bits)s[b]=this.freeEnt++,n[b]=g;else{for(let x=0;x<Pe.hsize;++x)n[x]=-1;this.freeEnt=this.clearCode+2,this.clearFlag=!0,this.output(this.clearCode)}p=u()}}this.output(l),this.output(this.EOFCode),this.outputBuffer.writeByte(0)}output(e){for(this.curAccum&=Pe.masks[this.curBits],this.curBits>0?this.curAccum|=e<<this.curBits:this.curAccum=e,this.curBits+=this.nBits;this.curBits>=8;)this.addToBlock(this.curAccum&255),this.curAccum>>=8,this.curBits-=8;if((this.freeEnt>this.maxCode||this.clearFlag)&&(this.clearFlag?(this.nBits=this.initBits,this.maxCode=(1<<this.nBits)-1,this.clearFlag=!1):(++this.nBits,this.nBits===Pe.bits?this.maxCode=1<<Pe.bits:this.maxCode=(1<<this.nBits)-1)),e===this.EOFCode){for(;this.curBits>0;)this.addToBlock(this.curAccum&255),this.curAccum>>=8,this.curBits-=8;this.writeBlock()}}writeBlock(){this.blockSize>0&&(this.outputBuffer.writeByte(this.blockSize),this.outputBuffer.writeBytes(this.block,this.blockSize),this.blockSize=0)}addToBlock(e){this.block[this.blockSize++]=e,this.blockSize>=254&&this.writeBlock()}writeApplicationExt(){this.outputBuffer.writeByte(Pe.extensionRecordType),this.outputBuffer.writeByte(Pe.applicationExt),this.outputBuffer.writeByte(11);let e=ce.getCodePoints("NETSCAPE2.0");this.outputBuffer.writeBytes(e),this.outputBuffer.writeBytes(new Uint8Array([3,1])),this.outputBuffer.writeUint16(this.repeat),this.outputBuffer.writeByte(0)}writeGraphicsCtrlExt(){var i;this.outputBuffer.writeByte(Pe.extensionRecordType),this.outputBuffer.writeByte(Pe.graphicControlExt),this.outputBuffer.writeByte(4);let e=0,t=0;this.outputBuffer.writeByte(0|t|0|e),this.outputBuffer.writeUint16((i=this.lastImageDuration)!=null?i:this.delay),this.outputBuffer.writeByte(0),this.outputBuffer.writeByte(0)}writeHeader(e,t){let i=ce.getCodePoints(Pe.gif89Id);this.outputBuffer.writeBytes(i),this.outputBuffer.writeUint16(e),this.outputBuffer.writeUint16(t),this.outputBuffer.writeByte(0),this.outputBuffer.writeByte(0),this.outputBuffer.writeByte(0)}finish(){let e;return this.outputBuffer===void 0||(this.encodedFrames===0?(this.writeHeader(this.width,this.height),this.writeApplicationExt()):this.writeGraphicsCtrlExt(),this.addImage(this.lastImage,this.width,this.height,this.lastColorMap.colorMap8,256),this.outputBuffer.writeByte(Pe.terminateRecordType),this.lastImage=void 0,this.lastColorMap=void 0,this.encodedFrames=0,e=this.outputBuffer.getBytes(),this.outputBuffer=void 0),e}addFrame(e,t){if(this.outputBuffer===void 0){this.outputBuffer=new he,this.lastColorMap=new le(e,256,this.samplingFactor),this.lastImage=Tt.getDitherPixels(e,this.lastColorMap,this.dither,this.ditherSerpentine),this.lastImageDuration=t,this.width=e.width,this.height=e.height;return}this.encodedFrames===0&&(this.writeHeader(this.width,this.height),this.writeApplicationExt()),this.writeGraphicsCtrlExt(),this.addImage(this.lastImage,this.width,this.height,this.lastColorMap.colorMap8,256),this.encodedFrames++,this.lastColorMap=new le(e,256,this.samplingFactor),this.lastImage=Tt.getDitherPixels(e,this.lastColorMap,this.dither,this.ditherSerpentine),this.lastImageDuration=t}encodeImage(e){return this.addFrame(e),this.finish()}encodeAnimation(e){this.repeat=e.loopCount;for(let t of e)this.addFrame(t,Math.floor(t.duration/10));return this.finish()}},ze=Pe;ze.gif89Id="GIF89a",ze.imageDescRecordType=44,ze.extensionRecordType=33,ze.terminateRecordType=59,ze.applicationExt=255,ze.graphicControlExt=249,ze.eof=-1,ze.bits=12,ze.hsize=5003,ze.masks=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535]});var Qi=C(()=>{"use strict";bi()});var Ji=C(()=>{"use strict"});var er=C(()=>{"use strict";Ji()});var We,tr=C(()=>{"use strict";We=class{constructor(e){this._fdat=[];this._sequenceNumber=e==null?void 0:e.sequenceNumber,this._width=e==null?void 0:e.width,this._height=e==null?void 0:e.height,this._xOffset=e==null?void 0:e.xOffset,this._yOffset=e==null?void 0:e.yOffset,this._delayNum=e==null?void 0:e.delayNum,this._delayDen=e==null?void 0:e.delayDen,this._dispose=e==null?void 0:e.dispose,this._blend=e==null?void 0:e.blend}get fdat(){return this._fdat}get sequenceNumber(){return this._sequenceNumber}get width(){return this._width}get height(){return this._height}get xOffset(){return this._xOffset}get yOffset(){return this._yOffset}get delayNum(){return this._delayNum}get delayDen(){return this._delayDen}get dispose(){return this._dispose}get blend(){return this._blend}get delay(){return this._delayNum===void 0||this._delayDen===void 0||this._delayDen===0?0:this._delayNum/this._delayDen}};We.APNG_DISPOSE_OP_NONE=0,We.APNG_DISPOSE_OP_BACKGROUND=1,We.APNG_DISPOSE_OP_PREVIOUS=2,We.APNG_BLEND_OP_SOURCE=0,We.APNG_BLEND_OP_OVER=1});var yi,ir=C(()=>{"use strict";yi=class{constructor(e){this._width=0;this._height=0;this._backgroundColor=16777215;this._numFrames=1;this._iCCPName="";this._iCCPCompression=0;this._textData=new Map;this._repeat=0;this._idat=[];this._frames=[];var t,i;this._width=(t=e==null?void 0:e.width)!=null?t:0,this._height=(i=e==null?void 0:e.height)!=null?i:0,this._bits=e==null?void 0:e.bits,this._colorType=e==null?void 0:e.colorType,this._compressionMethod=e==null?void 0:e.compressionMethod,this._filterMethod=e==null?void 0:e.filterMethod,this._interlaceMethod=e==null?void 0:e.interlaceMethod}set width(e){this._width=e}get width(){return this._width}set height(e){this._height=e}get height(){return this._height}set backgroundColor(e){this._backgroundColor=e}get backgroundColor(){return this._backgroundColor}set numFrames(e){this._numFrames=e}get numFrames(){return this._numFrames}get bits(){return this._bits}get colorType(){return this._colorType}get compressionMethod(){return this._compressionMethod}get filterMethod(){return this._filterMethod}get interlaceMethod(){return this._interlaceMethod}set palette(e){this._palette=e}get palette(){return this._palette}set transparency(e){this._transparency=e}get transparency(){return this._transparency}set colorLut(e){this._colorLut=e}get colorLut(){return this._colorLut}set gamma(e){this._gamma=e}get gamma(){return this._gamma}set iCCPName(e){this._iCCPName=e}get iCCPName(){return this._iCCPName}set iCCPCompression(e){this._iCCPCompression=e}get iCCPCompression(){return this._iCCPCompression}set iCCPData(e){this._iCCPData=e}get iCCPData(){return this._iCCPData}get textData(){return this._textData}set repeat(e){this._repeat=e}get repeat(){return this._repeat}get idat(){return this._idat}get frames(){return this._frames}get isAnimated(){return this._frames.length>0}}});var ps,U,ke,_i=C(()=>{"use strict";ps=An(pn());ge();Yt();bt();qt();rr();He();ut();Ye();Ve();xt();ue();Ot();ft();Ft();tr();ir();U=class{constructor(){this._progressY=0;this._bitBuffer=0;this._bitBufferLen=0}get info(){return this._info}get input(){return this._input}get progressY(){return this._progressY}get bitBuffer(){return this._bitBuffer}get bitBufferLen(){return this._bitBufferLen}get numFrames(){return this._info!==void 0?this._info.numFrames:0}static unfilter(e,t,i,r){let n=i.length;switch(e){case U.FILTER_NONE:break;case U.FILTER_SUB:for(let s=t;s<n;++s)i[s]=i[s]+i[s-t]&255;break;case U.FILTER_UP:for(let s=0;s<n;++s)i[s]=i[s]+r[s]&255;break;case U.FILTER_AVERAGE:for(let s=0;s<n;++s){let a=s<t?0:i[s-t],o=r[s];i[s]=i[s]+(a+o>>1)&255}break;case U.FILTER_PAETH:for(let s=0;s<n;++s){let a=s<t?0:i[s-t],o=r[s],u=s<t?0:r[s-t],l=a+o-u,h=Math.abs(l-a),f=Math.abs(l-o),c=Math.abs(l-u),p=0;h<=f&&h<=c?p=a:f<=c?p=o:p=u,i[s]=i[s]+p&255}break;default:throw new T(`Invalid filter value: ${e}`)}}static convert16to8(e){return e>>8}static convert1to8(e){return e===0?0:255}static convert2to8(e){return e*85}static convert4to8(e){return e<<4}static crc(e,t){let i=ce.getCodePoints(e),r=pt.getChecksum({buffer:i});return pt.getChecksum({buffer:t,baseCrc:r})}processPass(e,t,i,r,n,s,a,o){let u=1;this._info.colorType===U.GRAYSCALE_ALPHA?u=2:this._info.colorType===U.RGB?u=3:this._info.colorType===U.RGBA&&(u=4);let l=u*this._info.bits,h=l+7>>3,f=l*a+7>>3,c=new Uint8Array(f),p=[c,c],g=[0,0,0,0];for(let b=0,x=r,y=0;b<o;++b,x+=s,y=1-y,this._progressY++){let P=e.readByte();p[y]=e.readBytes(f).toUint8Array();let w=p[y],M=p[1-y];U.unfilter(P,h,w,M),this.resetBits();let B=new G({buffer:w,bigEndian:!0}),O=n,R=n-i;for(let N=0,L=i;N<a;++N,L+=n){this.readPixel(B,g);let D=this.getColor(g);if(t.setPixel(L,x,D),R>1||O>1)for(let k=0;k<O;++k)for(let Y=0;Y<R;++Y)t.setPixelSafe(L+Y,x+Y,D)}}}process(e,t){let i=1;this._info.colorType===U.GRAYSCALE_ALPHA?i=2:this._info.colorType===U.RGB?i=3:this._info.colorType===U.RGBA&&(i=4);let r=i*this._info.bits,n=this._info.width,s=this._info.height,a=n*r+7>>3,o=r+7>>3,u=new Uint8Array(a),l=[u,u],h=[0,0,0,0];for(let f=0,c=0,p=0;f<s;++f,p=1-p){let g=e.readByte();l[p]=e.readBytes(a).toUint8Array();let b=l[p],x=l[1-p];U.unfilter(g,o,b,x),this.resetBits();let y=new G({buffer:l[p],bigEndian:!0});for(let P=0;P<n;++P)this.readPixel(y,h),t.setPixelByIndex(c++,this.getColor(h))}}resetBits(){this._bitBuffer=0,this._bitBufferLen=0}readBits(e,t){if(t===0)return 0;if(t===8)return e.readByte();if(t===16)return e.readUint16();for(;this._bitBufferLen<t;){if(e.isEOS)throw new T("Invalid PNG data.");let n=e.readByte();this._bitBuffer=n<<this._bitBufferLen,this._bitBufferLen+=8}let i=0;switch(t){case 1:i=1;break;case 2:i=3;break;case 4:i=15;break;case 8:i=255;break;case 16:i=65535;break;default:i=0;break}let r=this._bitBuffer>>this._bitBufferLen-t&i;return this._bitBufferLen-=t,r}readPixel(e,t){switch(this._info.colorType){case U.GRAYSCALE:t[0]=this.readBits(e,this._info.bits);return;case U.RGB:t[0]=this.readBits(e,this._info.bits),t[1]=this.readBits(e,this._info.bits),t[2]=this.readBits(e,this._info.bits);return;case U.INDEXED:t[0]=this.readBits(e,this._info.bits);return;case U.GRAYSCALE_ALPHA:t[0]=this.readBits(e,this._info.bits),t[1]=this.readBits(e,this._info.bits);return;case U.RGBA:t[0]=this.readBits(e,this._info.bits),t[1]=this.readBits(e,this._info.bits),t[2]=this.readBits(e,this._info.bits),t[3]=this.readBits(e,this._info.bits);return}throw new Pt(`Invalid color type: ${this._info.colorType}.`)}getColor(e){switch(this._info.colorType){case U.GRAYSCALE:{let t=0;switch(this._info.bits){case 1:t=U.convert1to8(e[0]);break;case 2:t=U.convert2to8(e[0]);break;case 4:t=U.convert4to8(e[0]);break;case 8:t=e[0];break;case 16:t=U.convert16to8(e[0]);break}if(t=this._info.colorLut[t],this._info.transparency!==void 0){let i=(this._info.transparency[0]&255)<<24|this._info.transparency[1]&255;if(e[0]===i)return d.getColor(t,t,t,0)}return d.getColor(t,t,t)}case U.RGB:{let t=0,i=0,r=0;switch(this._info.bits){case 1:t=U.convert1to8(e[0]),i=U.convert1to8(e[1]),r=U.convert1to8(e[2]);break;case 2:t=U.convert2to8(e[0]),i=U.convert2to8(e[1]),r=U.convert2to8(e[2]);break;case 4:t=U.convert4to8(e[0]),i=U.convert4to8(e[1]),r=U.convert4to8(e[2]);break;case 8:t=e[0],i=e[1],r=e[2];break;case 16:t=U.convert16to8(e[0]),i=U.convert16to8(e[1]),r=U.convert16to8(e[2]);break}if(t=this._info.colorLut[t],i=this._info.colorLut[i],r=this._info.colorLut[r],this._info.transparency!==void 0){let n=(this._info.transparency[0]&255)<<8|this._info.transparency[1]&255,s=(this._info.transparency[2]&255)<<8|this._info.transparency[3]&255,a=(this._info.transparency[4]&255)<<8|this._info.transparency[5]&255;if(e[0]===n&&e[1]===s&&e[2]===a)return d.getColor(t,i,r,0)}return d.getColor(t,i,r)}case U.INDEXED:{let t=e[0]*3,i=this._info.transparency!==void 0&&e[0]<this._info.transparency.length?this._info.transparency[e[0]]:255;if(t>=this._info.palette.length)return d.getColor(255,255,255,i);let r=this._info.palette[t],n=this._info.palette[t+1],s=this._info.palette[t+2];return d.getColor(r,n,s,i)}case U.GRAYSCALE_ALPHA:{let t=0,i=0;switch(this._info.bits){case 1:t=U.convert1to8(e[0]),i=U.convert1to8(e[1]);break;case 2:t=U.convert2to8(e[0]),i=U.convert2to8(e[1]);break;case 4:t=U.convert4to8(e[0]),i=U.convert4to8(e[1]);break;case 8:t=e[0],i=e[1];break;case 16:t=U.convert16to8(e[0]),i=U.convert16to8(e[1]);break}return t=this._info.colorLut[t],d.getColor(t,t,t,i)}case U.RGBA:{let t=0,i=0,r=0,n=0;switch(this._info.bits){case 1:t=U.convert1to8(e[0]),i=U.convert1to8(e[1]),r=U.convert1to8(e[2]),n=U.convert1to8(e[3]);break;case 2:t=U.convert2to8(e[0]),i=U.convert2to8(e[1]),r=U.convert2to8(e[2]),n=U.convert2to8(e[3]);break;case 4:t=U.convert4to8(e[0]),i=U.convert4to8(e[1]),r=U.convert4to8(e[2]),n=U.convert4to8(e[3]);break;case 8:t=e[0],i=e[1],r=e[2],n=e[3];break;case 16:t=U.convert16to8(e[0]),i=U.convert16to8(e[1]),r=U.convert16to8(e[2]),n=U.convert16to8(e[3]);break}return t=this._info.colorLut[t],i=this._info.colorLut[i],r=this._info.colorLut[r],d.getColor(t,i,r,n)}}throw new T(`Invalid color type: ${this._info.colorType}.`)}isValidFile(e){let i=new G({buffer:e,bigEndian:!0}).readBytes(8),r=[137,80,78,71,13,10,26,10];for(let n=0;n<8;++n)if(i.getByte(n)!==r[n])return!1;return!0}startDecode(e){this._input=new G({buffer:e,bigEndian:!0});let t=this._input.readBytes(8),i=[137,80,78,71,13,10,26,10];for(let r=0;r<8;++r)if(t.getByte(r)!==i[r])return;for(;;){let r=this._input.position,n=this._input.readUint32(),s=this._input.readString(4);switch(s){case"tEXt":{this._info===void 0&&(this._info=new yi);let a=this._input.readBytes(n).toUint8Array();for(let o=0,u=a.length;o<u;++o)if(a[o]===0){let l=ce.latin1Decoder.decode(te.copyUint8(a,0,o)),h=ce.latin1Decoder.decode(te.copyUint8(a,o+1));this._info.textData.set(l,h);break}this._input.skip(4);break}case"IHDR":{let a=G.from(this._input.readBytes(n)),o=a.toUint8Array(),u=a.readUint32(),l=a.readUint32(),h=a.readByte(),f=a.readByte(),c=a.readByte(),p=a.readByte(),g=a.readByte();if(this._info=new yi({width:u,height:l,bits:h,colorType:f,compressionMethod:c,filterMethod:p,interlaceMethod:g}),![U.GRAYSCALE,U.RGB,U.INDEXED,U.GRAYSCALE_ALPHA,U.RGBA].includes(this._info.colorType)||this._info.filterMethod!==0)return;switch(this._info.colorType){case U.GRAYSCALE:if(![1,2,4,8,16].includes(this._info.bits))return;break;case U.RGB:if(![8,16].includes(this._info.bits))return;break;case U.INDEXED:if(![1,2,4,8].includes(this._info.bits))return;break;case U.GRAYSCALE_ALPHA:if(![8,16].includes(this._info.bits))return;break;case U.RGBA:if(![8,16].includes(this._info.bits))return;break}let b=this._input.readUint32(),x=U.crc(s,o);if(b!==x)throw new T(`Invalid ${s} checksum`);break}case"PLTE":{this._info.palette=this._input.readBytes(n).toUint8Array();let a=this._input.readUint32(),o=U.crc(s,this._info.palette);if(a!==o)throw new T(`Invalid ${s} checksum`);break}case"tRNS":{this._info.transparency=this._input.readBytes(n).toUint8Array();let a=this._input.readUint32(),o=U.crc(s,this._info.transparency);if(a!==o)throw new T(`Invalid ${s} checksum`);break}case"IEND":{this._input.skip(4);break}case"gAMA":{if(n!==4)throw new T("Invalid gAMA chunk");let a=this._input.readUint32();this._input.skip(4),a!==1e5&&(this._info.gamma=a/1e5);break}case"IDAT":{this._info.idat.push(r),this._input.skip(n),this._input.skip(4);break}case"acTL":{this._info.numFrames=this._input.readUint32(),this._info.repeat=this._input.readUint32(),this._input.skip(4);break}case"fcTL":{let a=this._input.readUint32(),o=this._input.readUint32(),u=this._input.readUint32(),l=this._input.readUint32(),h=this._input.readUint32(),f=this._input.readUint16(),c=this._input.readUint16(),p=this._input.readByte(),g=this._input.readByte();this._input.skip(4);let b=new We({sequenceNumber:a,width:o,height:u,xOffset:l,yOffset:h,delayNum:f,delayDen:c,dispose:p,blend:g});this._info.frames.push(b);break}case"fdAT":{let a=this._input.readUint32();this._info.frames[this._info.frames.length-1].fdat.push(r),this._input.skip(n-4),this._input.skip(4);break}case"bKGD":{if(this._info.colorType===3){let a=this._input.readByte();n--;let o=a*3,u=this._info.palette[o],l=this._info.palette[o+1],h=this._info.palette[o+2];this._info.backgroundColor=d.fromRgb(u,l,h)}else this._info.colorType===0||this._info.colorType===4?(this._input.readUint16(),n-=2):(this._info.colorType===2||this._info.colorType===6)&&(this._input.readUint16(),this._input.readUint16(),this._input.readUint16(),n-=24);n>0&&this._input.skip(n),this._input.skip(4);break}case"iCCP":{this._info.iCCPName=this._input.readString(),this._info.iCCPCompression=this._input.readByte(),n-=this._info.iCCPName.length+2;let a=this._input.readBytes(n);this._info.iCCPData=a.toUint8Array(),this._input.skip(4);break}default:{this._input.skip(n),this._input.skip(4);break}}if(s==="IEND")break;if(this._input.isEOS)return}return this._info}decodeFrame(e){if(this._input===void 0||this._info===void 0)return;let t,i=this._info.width,r=this._info.height;if(!this._info.isAnimated||e===0){let c=0,p=new Array;for(let b=0,x=this._info.idat.length;b<x;++b){this._input.offset=this._info.idat[b];let y=this._input.readUint32(),P=this._input.readString(4),w=this._input.readBytes(y).toUint8Array();c+=w.length,p.push(w);let M=this._input.readUint32(),B=U.crc(P,w);if(M!==B)throw new T(`Invalid ${P} checksum`)}t=new Uint8Array(c);let g=0;for(let b of p)t.set(b,g),g+=b.length}else{if(e<0||e>=this._info.frames.length)throw new T(`Invalid Frame Number: ${e}`);let c=this._info.frames[e];i=c.width,r=c.height;let p=0,g=new Array;for(let x=0;x<c.fdat.length;++x){this._input.offset=c.fdat[x];let y=this._input.readUint32();this._input.readString(4),this._input.skip(4);let P=this._input.readBytes(y-4).toUint8Array();p+=P.length,g.push(P)}t=new Uint8Array(p);let b=0;for(let x of g)t.set(x,b),b+=x.length}let n=this._info.colorType===U.GRAYSCALE_ALPHA||this._info.colorType===U.RGBA||this._info.transparency!==void 0?1:0,s=new W({width:i,height:r,rgbChannelSet:n}),a;try{a=(0,ps.inflate)(t)}catch(c){console.error(c);return}let o=new G({buffer:a,bigEndian:!0});if(this.resetBits(),this._info.colorLut===void 0){this._info.colorLut=[];for(let c=0;c<256;c++){let p=c;this._info.colorLut.push(p)}if(this._info.palette!==void 0&&this._info.gamma!==void 0)for(let c=0;c<this._info.palette.length;++c)this._info.palette[c]=this._info.colorLut[this._info.palette[c]]}let u=this._info.width,l=this._info.height;this._info.width=i,this._info.height=r;let h=i,f=r;return this._progressY=0,this._info.interlaceMethod!==0?(this.processPass(o,s,0,0,8,8,h+7>>3,f+7>>3),this.processPass(o,s,4,0,8,8,h+3>>3,f+7>>3),this.processPass(o,s,0,4,4,8,h+3>>2,f+3>>3),this.processPass(o,s,2,0,4,4,h+1>>2,f+3>>2),this.processPass(o,s,0,2,2,4,h+1>>1,f+1>>2),this.processPass(o,s,1,0,2,2,h>>1,f+1>>1),this.processPass(o,s,0,1,1,2,h,f>>1)):this.process(o,s),this._info.width=u,this._info.height=l,this._info.iCCPData!==void 0&&(s.iccProfile=new Rt(this._info.iCCPName,1,this._info.iCCPData)),this._info.textData.size>0&&s.addTextData(this._info.textData),s}decodeHdrFrame(e){let t=this.decodeFrame(e);if(t!==void 0)return de.fromImage(t)}decodeAnimation(e){if(this.startDecode(e)===void 0)return;let t=new Xe({width:this._info.width,height:this._info.height});if(!this._info.isAnimated){let r=this.decodeFrame(0);return t.addFrame(r),t}let i;for(let r=0;r<this._info.numFrames;++r){let n=this._info.frames[r],s=this.decodeFrame(r);if(s===void 0)continue;if(i===void 0){i=s,i.duration=Math.trunc(n.delay*1e3),t.addFrame(i);continue}if(s.width===i.width&&s.height===i.height&&n.xOffset===0&&n.yOffset===0&&n.blend===We.APNG_BLEND_OP_SOURCE){i=s,i.duration=Math.trunc(n.delay*1e3),t.addFrame(i);continue}let a=n.dispose;a===We.APNG_DISPOSE_OP_BACKGROUND?(i=new W({width:i.width,height:i.height}),i.fill(this._info.backgroundColor)):a===We.APNG_DISPOSE_OP_PREVIOUS?i=W.from(i):i=W.from(i),i.duration=Math.trunc(n.delay*1e3),fe.copyInto({dst:i,src:s,dstX:n.xOffset,dstY:n.yOffset,blend:n.blend===We.APNG_BLEND_OP_OVER}),t.addFrame(i)}return t}decodeImage(e,t=0){if(this.startDecode(e)!==void 0)return this.decodeFrame(t)}decodeHdrImage(e,t=0){let i=this.decodeImage(e,t);if(i!==void 0)return de.fromImage(i)}},ke=U;ke.GRAYSCALE=0,ke.RGB=2,ke.INDEXED=3,ke.GRAYSCALE_ALPHA=4,ke.RGBA=6,ke.FILTER_NONE=0,ke.FILTER_SUB=1,ke.FILTER_UP=2,ke.FILTER_AVERAGE=3,ke.FILTER_PAETH=4});var nr=C(()=>{"use strict";He();ut();st();Ot();ft();Mt();Hr();Qi();er();_i()});var gs,re,dt,wi=C(()=>{"use strict";gs=An(pn());Ht();ge();Yt();zt();st();Ve();xt();re=class{constructor(e){this.repeat=0;this.xOffset=0;this.yOffset=0;this.disposeMethod=0;this.blendMethod=0;this.width=0;this.height=0;this.frames=0;this.sequenceNumber=0;this.isAnimated=!1;this._supportsAnimation=!0;var t,i;this.filter=(t=e==null?void 0:e.filter)!=null?t:re.FILTER_PAETH,this.level=(i=e==null?void 0:e.level)!=null?i:6}get supportsAnimation(){return this._supportsAnimation}static crc(e,t){let i=ce.getCodePoints(e),r=pt.getChecksum({buffer:i});return pt.getChecksum({buffer:t,baseCrc:r})}static writeChunk(e,t,i){e.writeUint32(i.length);let r=ce.getCodePoints(t);e.writeBytes(r),e.writeBytes(i);let n=re.crc(t,i);e.writeUint32(n)}static filterSub(e,t,i,r){let n=t;r[n++]=re.FILTER_SUB,r[n++]=d.getRed(e.getPixel(0,i)),r[n++]=d.getGreen(e.getPixel(0,i)),r[n++]=d.getBlue(e.getPixel(0,i)),e.rgbChannelSet===1&&(r[n++]=d.getAlpha(e.getPixel(0,i)));for(let s=1;s<e.width;++s){let a=d.getRed(e.getPixel(s-1,i)),o=d.getGreen(e.getPixel(s-1,i)),u=d.getBlue(e.getPixel(s-1,i)),l=d.getRed(e.getPixel(s,i)),h=d.getGreen(e.getPixel(s,i)),f=d.getBlue(e.getPixel(s,i));if(r[n++]=l-a&255,r[n++]=h-o&255,r[n++]=f-u&255,e.rgbChannelSet===1){let c=d.getAlpha(e.getPixel(s-1,i)),p=d.getAlpha(e.getPixel(s,i));r[n++]=p-c&255}}return n}static filterUp(e,t,i,r){let n=t;r[n++]=re.FILTER_UP;for(let s=0;s<e.width;++s){let a=i===0?0:d.getRed(e.getPixel(s,i-1)),o=i===0?0:d.getGreen(e.getPixel(s,i-1)),u=i===0?0:d.getBlue(e.getPixel(s,i-1)),l=d.getRed(e.getPixel(s,i)),h=d.getGreen(e.getPixel(s,i)),f=d.getBlue(e.getPixel(s,i));if(r[n++]=l-a&255,r[n++]=h-o&255,r[n++]=f-u&255,e.rgbChannelSet===1){let c=i===0?0:d.getAlpha(e.getPixel(s,i-1)),p=d.getAlpha(e.getPixel(s,i));r[n++]=p-c&255}}return n}static filterAverage(e,t,i,r){let n=t;r[n++]=re.FILTER_AVERAGE;for(let s=0;s<e.width;++s){let a=s===0?0:d.getRed(e.getPixel(s-1,i)),o=s===0?0:d.getGreen(e.getPixel(s-1,i)),u=s===0?0:d.getBlue(e.getPixel(s-1,i)),l=i===0?0:d.getRed(e.getPixel(s,i-1)),h=i===0?0:d.getGreen(e.getPixel(s,i-1)),f=i===0?0:d.getBlue(e.getPixel(s,i-1)),c=d.getRed(e.getPixel(s,i)),p=d.getGreen(e.getPixel(s,i)),g=d.getBlue(e.getPixel(s,i));if(r[n++]=c-(a+l>>1)&255,r[n++]=p-(o+h>>1)&255,r[n++]=g-(u+f>>1)&255,e.rgbChannelSet===1){let b=s===0?0:d.getAlpha(e.getPixel(s-1,i)),x=i===0?0:d.getAlpha(e.getPixel(s,i-1)),y=d.getAlpha(e.getPixel(s,i));r[n++]=y-(b+x>>1)&255}}return n}static paethPredictor(e,t,i){let r=e+t-i,n=r>e?r-e:e-r,s=r>t?r-t:t-r,a=r>i?r-i:i-r;return n<=s&&n<=a?e:s<=a?t:i}static filterPaeth(e,t,i,r){let n=t;r[n++]=re.FILTER_PAETH;for(let s=0;s<e.width;++s){let a=s===0?0:d.getRed(e.getPixel(s-1,i)),o=s===0?0:d.getGreen(e.getPixel(s-1,i)),u=s===0?0:d.getBlue(e.getPixel(s-1,i)),l=i===0?0:d.getRed(e.getPixel(s,i-1)),h=i===0?0:d.getGreen(e.getPixel(s,i-1)),f=i===0?0:d.getBlue(e.getPixel(s,i-1)),c=i===0||s===0?0:d.getRed(e.getPixel(s-1,i-1)),p=i===0||s===0?0:d.getGreen(e.getPixel(s-1,i-1)),g=i===0||s===0?0:d.getBlue(e.getPixel(s-1,i-1)),b=d.getRed(e.getPixel(s,i)),x=d.getGreen(e.getPixel(s,i)),y=d.getBlue(e.getPixel(s,i)),P=re.paethPredictor(a,l,c),w=re.paethPredictor(o,h,p),M=re.paethPredictor(u,f,g);if(r[n++]=b-P&255,r[n++]=x-w&255,r[n++]=y-M&255,e.rgbChannelSet===1){let B=s===0?0:d.getAlpha(e.getPixel(s-1,i)),O=i===0?0:d.getAlpha(e.getPixel(s,i-1)),R=i===0||s===0?0:d.getAlpha(e.getPixel(s-1,i-1)),N=d.getAlpha(e.getPixel(s,i)),L=re.paethPredictor(B,O,R);r[n++]=N-L&255}}return n}static filterNone(e,t,i,r){let n=t;r[n++]=re.FILTER_NONE;for(let s=0;s<e.width;++s){let a=e.getPixel(s,i);r[n++]=d.getRed(a),r[n++]=d.getGreen(a),r[n++]=d.getBlue(a),e.rgbChannelSet===1&&(r[n++]=d.getAlpha(e.getPixel(s,i)))}return n}writeHeader(e,t){this.output.writeBytes(new Uint8Array([137,80,78,71,13,10,26,10]));let i=new he({bigEndian:!0});i.writeUint32(e),i.writeUint32(t),i.writeByte(8),i.writeByte(this.rgbChannelSet===0?2:6),i.writeByte(0),i.writeByte(0),i.writeByte(0),re.writeChunk(this.output,"IHDR",i.getBytes())}writeICCPChunk(e,t){if(t===void 0)return;let i=new he({bigEndian:!0}),r=ce.getCodePoints(t.name);i.writeBytes(r),i.writeByte(0),i.writeByte(0),i.writeBytes(t.compressed()),re.writeChunk(this.output,"iCCP",i.getBytes())}writeAnimationControlChunk(){let e=new he({bigEndian:!0});e.writeUint32(this.frames),e.writeUint32(this.repeat),re.writeChunk(this.output,"acTL",e.getBytes())}applyFilter(e,t){let i=0;for(let r=0;r<e.height;++r)switch(this.filter){case re.FILTER_SUB:i=re.filterSub(e,i,r,t);break;case re.FILTER_UP:i=re.filterUp(e,i,r,t);break;case re.FILTER_AVERAGE:i=re.filterAverage(e,i,r,t);break;case re.FILTER_PAETH:i=re.filterPaeth(e,i,r,t);break;case re.FILTER_AGRESSIVE:i=re.filterPaeth(e,i,r,t);break;default:i=re.filterNone(e,i,r,t);break}}writeFrameControlChunk(){let e=new he({bigEndian:!0});e.writeUint32(this.sequenceNumber),e.writeUint32(this.width),e.writeUint32(this.height),e.writeUint32(this.xOffset),e.writeUint32(this.yOffset),e.writeUint16(this.delay),e.writeUint16(1e3),e.writeByte(this.disposeMethod),e.writeByte(this.blendMethod),re.writeChunk(this.output,"fcTL",e.getBytes())}writeTextChunk(e,t){let i=new he({bigEndian:!0}),r=ce.getCodePoints(e),n=ce.getCodePoints(t);i.writeBytes(r),i.writeByte(0),i.writeBytes(n),re.writeChunk(this.output,"tEXt",i.getBytes())}addFrame(e){this.xOffset=e.xOffset,this.yOffset=e.xOffset,this.delay=e.duration,this.disposeMethod=e.disposeMethod,this.blendMethod=e.blendMethod,this.output===void 0&&(this.output=new he({bigEndian:!0}),this.rgbChannelSet=e.rgbChannelSet,this.width=e.width,this.height=e.height,this.writeHeader(this.width,this.height),this.writeICCPChunk(this.output,e.iccProfile),this.isAnimated&&this.writeAnimationControlChunk());let t=new Uint8Array(e.width*e.height*e.numberOfChannels+e.height);this.applyFilter(e,t);let i=(0,gs.deflate)(t,{level:this.level});if(e.textData!==void 0)for(let[r,n]of e.textData)this.writeTextChunk(r,n);if(this.isAnimated&&(this.writeFrameControlChunk(),this.sequenceNumber++),this.sequenceNumber<=1)re.writeChunk(this.output,"IDAT",i);else{let r=new he({bigEndian:!0});r.writeUint32(this.sequenceNumber),r.writeBytes(i),re.writeChunk(this.output,"fdAT",r.getBytes()),this.sequenceNumber++}}finish(){let e;return this.output===void 0||(re.writeChunk(this.output,"IEND",new Uint8Array),this.sequenceNumber=0,e=this.output.getBytes(),this.output=void 0),e}encodeImage(e){return this.isAnimated=!1,this.addFrame(e),this.finish()}encodeAnimation(e){this.isAnimated=!0,this.frames=e.frames.length,this.repeat=e.loopCount;for(let t of e)this.addFrame(t);return this.finish()}},dt=re;dt.FILTER_NONE=0,dt.FILTER_SUB=1,dt.FILTER_UP=2,dt.FILTER_AVERAGE=3,dt.FILTER_PAETH=4,dt.FILTER_AGRESSIVE=5});var Vr=C(()=>{"use strict";st();ue();wi()});var sr=C(()=>{"use strict";Vr()});var ar,or=C(()=>{"use strict";ar=class{get hSamples(){return this._hSamples}get maxHSamples(){return this._maxHSamples}get vSamples(){return this._vSamples}get maxVSamples(){return this._maxVSamples}get lines(){return this._lines}get hScaleShift(){return this._hScaleShift}get vScaleShift(){return this._vScaleShift}constructor(e,t,i,r,n){this._hSamples=e,this._maxHSamples=t,this._vSamples=i,this._maxVSamples=r,this._lines=n,this._hScaleShift=this._hSamples===1&&this._maxHSamples===2?1:0,this._vScaleShift=this._vSamples===1&&this._maxVSamples===2?1:0}}});var A,Dt=C(()=>{"use strict";A=class{};A.dctZigZag=[0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63],A.DCTSIZE=8,A.DCTSIZE2=64,A.NUM_QUANT_TBLS=4,A.NUM_HUFF_TBLS=4,A.NUM_ARITH_TBLS=16,A.MAX_COMPS_IN_SCAN=4,A.MAX_SAMP_FACTOR=4,A.M_SOF0=192,A.M_SOF1=193,A.M_SOF2=194,A.M_SOF3=195,A.M_SOF5=197,A.M_SOF6=198,A.M_SOF7=199,A.M_JPG=200,A.M_SOF9=201,A.M_SOF10=202,A.M_SOF11=203,A.M_SOF13=205,A.M_SOF14=206,A.M_SOF15=207,A.M_DHT=196,A.M_DAC=204,A.M_RST0=208,A.M_RST1=209,A.M_RST2=210,A.M_RST3=211,A.M_RST4=212,A.M_RST5=213,A.M_RST6=214,A.M_RST7=215,A.M_SOI=216,A.M_EOI=217,A.M_SOS=218,A.M_DQT=219,A.M_DNL=220,A.M_DRI=221,A.M_DHP=222,A.M_EXP=223,A.M_APP0=224,A.M_APP1=225,A.M_APP2=226,A.M_APP3=227,A.M_APP4=228,A.M_APP5=229,A.M_APP6=230,A.M_APP7=231,A.M_APP8=232,A.M_APP9=233,A.M_APP10=234,A.M_APP11=235,A.M_APP12=236,A.M_APP13=237,A.M_APP14=238,A.M_APP15=239,A.M_JPG0=240,A.M_JPG13=253,A.M_COM=254,A.M_TEM=1,A.M_ERROR=256});var ur,lr=C(()=>{"use strict";ur=class{get version(){return this._version}get flags0(){return this._flags0}get flags1(){return this._flags1}get transformCode(){return this._transformCode}constructor(e,t,i,r){this._version=e,this._flags0=t,this._flags1=i,this._transformCode=r}}});var hr,fr=C(()=>{"use strict";hr=class{constructor(e,t,i,r){this._blocks=new Array;this._blocksPerLine=0;this._blocksPerColumn=0;this._huffmanTableDC=[];this._huffmanTableAC=[];this._pred=0;this._hSamples=e,this._vSamples=t,this._quantizationTableList=i,this._quantizationIndex=r}get hSamples(){return this._hSamples}get vSamples(){return this._vSamples}get blocks(){return this._blocks}get blocksPerLine(){return this._blocksPerLine}get blocksPerColumn(){return this._blocksPerColumn}set huffmanTableDC(e){this._huffmanTableDC=e}get huffmanTableDC(){return this._huffmanTableDC}set huffmanTableAC(e){this._huffmanTableAC=e}get huffmanTableAC(){return this._huffmanTableAC}set pred(e){this._pred=e}get pred(){return this._pred}get quantizationTable(){return this._quantizationTableList[this._quantizationIndex]}setBlocks(e,t,i){this._blocks=e,this._blocksPerLine=t,this._blocksPerColumn=i}}});var Lt,cr=C(()=>{"use strict";Lt=class{constructor(e,t,i,r,n,s,a){this._maxHSamples=0;this._maxVSamples=0;this._mcusPerLine=0;this._mcusPerColumn=0;this._components=e,this._componentsOrder=t,this._extended=i,this._progressive=r,this._precision=n,this._scanLines=s,this._samplesPerLine=a}get components(){return this._components}get componentsOrder(){return this._componentsOrder}get extended(){return this._extended}get progressive(){return this._progressive}get precision(){return this._precision}get scanLines(){return this._scanLines}get samplesPerLine(){return this._samplesPerLine}get maxHSamples(){return this._maxHSamples}get maxVSamples(){return this._maxVSamples}get mcusPerLine(){return this._mcusPerLine}get mcusPerColumn(){return this._mcusPerColumn}static getEmptyBlocks(e,t){let i=new Array;for(let r=0;r<t;r++){let n=new Array(e);for(let s=0;s<e;s++)n[s]=new Int32Array(64);i[r]=n}return i}prepare(){for(let[e,t]of this._components)this._maxHSamples=Math.max(this._maxHSamples,t.hSamples),this._maxVSamples=Math.max(this._maxVSamples,t.vSamples);this._mcusPerLine=Math.ceil(this._samplesPerLine/8/this._maxHSamples),this._mcusPerColumn=Math.ceil(this._scanLines/8/this._maxVSamples);for(let[e,t]of this._components){let i=Math.ceil(Math.ceil(this._samplesPerLine/8)*t.hSamples/this._maxHSamples),r=Math.ceil(Math.ceil(this._scanLines/8)*t.vSamples/this.maxVSamples),n=this._mcusPerLine*t.hSamples,s=this._mcusPerColumn*t.vSamples,a=Lt.getEmptyBlocks(n,s);t.setBlocks(a,i,r)}}}});var Nt,dr=C(()=>{"use strict";Nt=class{constructor(){this._children=new Array;this._index=0}get children(){return this._children}get index(){return this._index}incrementIndex(){this._index++}}});var mr,pr=C(()=>{"use strict";mr=class{constructor(){this._width=0;this._height=0;this._backgroundColor=4294967295;this._numFrames=1}get width(){return this._width}get height(){return this._height}get backgroundColor(){return this._backgroundColor}get numFrames(){return this._numFrames}setSize(e,t){this._width=e,this._height=t}}});var br,gr=C(()=>{"use strict";br=class{get thumbWidth(){return this._thumbWidth}get thumbHeight(){return this._thumbHeight}get majorVersion(){return this._majorVersion}get minorVersion(){return this._minorVersion}get densityUnits(){return this._densityUnits}get xDensity(){return this._xDensity}get yDensity(){return this._yDensity}get thumbData(){return this._thumbData}constructor(e,t,i,r,n,s,a,o){this._thumbWidth=e,this._thumbHeight=t,this._majorVersion=i,this._minorVersion=r,this._densityUnits=n,this._xDensity=s,this._yDensity=a,this._thumbData=o}}});var $e,xr=C(()=>{"use strict";je();ge();Ye();Ve();ue();wt();$e=class{static clamp8(e){return e<0?0:e>255?255:e}static quantizeAndInverse(e,t,i,r){let n=r,s=256,a=768;if($e.dctClip===void 0){$e.dctClip=new Uint8Array(a);for(let x=-256;x<0;++x)$e.dctClip[s+x]=0;for(let x=0;x<256;++x)$e.dctClip[s+x]=x;for(let x=256;x<512;++x)$e.dctClip[s+x]=255}let o=4017,u=799,l=3406,h=2276,f=1567,c=3784,p=5793,g=2896;for(let x=0;x<64;x++)n[x]=t[x]*e[x];let b=0;for(let x=0;x<8;++x,b+=8){if(n[1+b]===0&&n[2+b]===0&&n[3+b]===0&&n[4+b]===0&&n[5+b]===0&&n[6+b]===0&&n[7+b]===0){let D=E.shiftR(p*n[0+b]+512,10);n[b+0]=D,n[b+1]=D,n[b+2]=D,n[b+3]=D,n[b+4]=D,n[b+5]=D,n[b+6]=D,n[b+7]=D;continue}let y=E.shiftR(p*n[0+b]+128,8),P=E.shiftR(p*n[4+b]+128,8),w=n[2+b],M=n[6+b],B=E.shiftR(g*(n[1+b]-n[7+b])+128,8),O=E.shiftR(g*(n[1+b]+n[7+b])+128,8),R=E.shiftL(n[3+b],4),N=E.shiftL(n[5+b],4),L=E.shiftR(y-P+1,1);y=E.shiftR(y+P+1,1),P=L,L=E.shiftR(w*c+M*f+128,8),w=E.shiftR(w*f-M*c+128,8),M=L,L=E.shiftR(B-N+1,1),B=E.shiftR(B+N+1,1),N=L,L=E.shiftR(O+R+1,1),R=E.shiftR(O-R+1,1),O=L,L=E.shiftR(y-M+1,1),y=E.shiftR(y+M+1,1),M=L,L=E.shiftR(P-w+1,1),P=E.shiftR(P+w+1,1),w=L,L=E.shiftR(B*h+O*l+2048,12),B=E.shiftR(B*l-O*h+2048,12),O=L,L=E.shiftR(R*u+N*o+2048,12),R=E.shiftR(R*o-N*u+2048,12),N=L,n[0+b]=y+O,n[7+b]=y-O,n[1+b]=P+N,n[6+b]=P-N,n[2+b]=w+R,n[5+b]=w-R,n[3+b]=M+B,n[4+b]=M-B}for(let x=0;x<8;++x){let y=x;if(n[1*8+y]===0&&n[2*8+y]===0&&n[3*8+y]===0&&n[4*8+y]===0&&n[5*8+y]===0&&n[6*8+y]===0&&n[7*8+y]===0){let k=E.shiftR(p*r[x]+8192,14);n[0*8+y]=k,n[1*8+y]=k,n[2*8+y]=k,n[3*8+y]=k,n[4*8+y]=k,n[5*8+y]=k,n[6*8+y]=k,n[7*8+y]=k;continue}let P=E.shiftR(p*n[0*8+y]+2048,12),w=E.shiftR(p*n[4*8+y]+2048,12),M=n[2*8+y],B=n[6*8+y],O=E.shiftR(g*(n[1*8+y]-n[7*8+y])+2048,12),R=E.shiftR(g*(n[1*8+y]+n[7*8+y])+2048,12),N=n[3*8+y],L=n[5*8+y],D=E.shiftR(P-w+1,1);P=E.shiftR(P+w+1,1),w=D,D=E.shiftR(M*c+B*f+2048,12),M=E.shiftR(M*f-B*c+2048,12),B=D,D=E.shiftR(O-L+1,1),O=E.shiftR(O+L+1,1),L=D,D=E.shiftR(R+N+1,1),N=E.shiftR(R-N+1,1),R=D,D=E.shiftR(P-B+1,1),P=E.shiftR(P+B+1,1),B=D,D=E.shiftR(w-M+1,1),w=E.shiftR(w+M+1,1),M=D,D=E.shiftR(O*h+R*l+2048,12),O=E.shiftR(O*l-R*h+2048,12),R=D,D=E.shiftR(N*u+L*o+2048,12),N=E.shiftR(N*o-L*u+2048,12),L=D,n[0*8+y]=P+R,n[7*8+y]=P-R,n[1*8+y]=w+L,n[6*8+y]=w-L,n[2*8+y]=M+N,n[5*8+y]=M-N,n[3*8+y]=B+O,n[4*8+y]=B-O}for(let x=0;x<64;++x)i[x]=$e.dctClip[s+128+E.shiftR(n[x]+8,4)]}static getImageFromJpeg(e){let t=e.exifData.imageIfd.hasOrientation?e.exifData.imageIfd.orientation:0,i=t>=5&&t<=8,r=i?e.height:e.width,n=i?e.width:e.height,s=new W({width:r,height:n,rgbChannelSet:0});s.exifData=Ae.from(e.exifData),s.exifData.imageIfd.orientation=void 0;let a,o,u,l,h,f,c,p,g=0,b=0,x=0,y=0,P=0,w=0,M=0,B=0,O=0,R=0,N=0,L=!1,D=e.height-1,k=e.width-1;switch(e.components.length){case 1:{let Y=e.components[0],Z=Y.lines,j=Y.hScaleShift,X=Y.vScaleShift;for(let $=0;$<e.height;$++){let Ge=$>>X,Re=Z[Ge];for(let be=0;be<e.width;be++){let ee=be>>j,H=Re[ee],Q=d.getColor(H,H,H);t===2?s.setPixel(k-be,$,Q):t===3?s.setPixel(k-be,D-$,Q):t===4?s.setPixel(be,D-$,Q):t===5?s.setPixel($,be,Q):t===6?s.setPixel(D-$,be,Q):t===7?s.setPixel(D-$,k-be,Q):t===8?s.setPixel($,k-be,Q):s.setPixelByIndex(g++,Q)}}break}case 3:{L=!0,a=e.components[0],o=e.components[1],u=e.components[2];let Y=a.lines,Z=o.lines,j=u.lines,X=a.hScaleShift,$=a.vScaleShift,Ge=o.hScaleShift,Re=o.vScaleShift,be=u.hScaleShift,ee=u.vScaleShift;for(let H=0;H<e.height;H++){let Q=H>>$,Be=H>>Re,we=H>>ee;h=Y[Q],f=Z[Be],c=j[we];for(let Te=0;Te<e.width;Te++){let Xr=Te>>X,qr=Te>>Ge,Zr=Te>>be;b=h[Xr]<<8,x=f[qr]-128,y=c[Zr]-128,O=b+359*y+128,R=b-88*x-183*y+128,N=b+454*x+128,O=this.clamp8(E.shiftR(O,8)),R=this.clamp8(E.shiftR(R,8)),N=this.clamp8(E.shiftR(N,8));let me=d.getColor(O,R,N);t===2?s.setPixel(k-Te,H,me):t===3?s.setPixel(k-Te,D-H,me):t===4?s.setPixel(Te,D-H,me):t===5?s.setPixel(H,Te,me):t===6?s.setPixel(D-H,Te,me):t===7?s.setPixel(D-H,k-Te,me):t===8?s.setPixel(H,k-Te,me):s.setPixelByIndex(g++,me)}}break}case 4:{if(e.adobe===void 0)throw new T("Unsupported color mode (4 components)");L=!1,e.adobe.transformCode!==0&&(L=!0),a=e.components[0],o=e.components[1],u=e.components[2],l=e.components[3];let Y=a.lines,Z=o.lines,j=u.lines,X=l.lines,$=a.hScaleShift,Ge=a.vScaleShift,Re=o.hScaleShift,be=o.vScaleShift,ee=u.hScaleShift,H=u.vScaleShift,Q=l.hScaleShift,Be=l.vScaleShift;for(let we=0;we<e.height;we++){let Te=we>>Ge,Xr=we>>be,qr=we>>H,Zr=we>>Be;h=Y[Te],f=Z[Xr],c=j[qr],p=X[Zr];for(let me=0;me<e.width;me++){let _n=me>>$,wn=me>>Re,In=me>>ee,Bt=me>>Q;L?(b=h[_n],x=f[wn],y=c[In],P=p[Bt],w=255-this.clamp8(Math.trunc(b+1.402*(y-128))),M=255-this.clamp8(Math.trunc(b-.3441363*(x-128)-.71413636*(y-128))),B=255-this.clamp8(Math.trunc(b+1.772*(x-128)))):(w=h[_n],M=f[wn],B=c[In],P=p[Bt]),O=E.shiftR(w*P,8),R=E.shiftR(M*P,8),N=E.shiftR(B*P,8);let mt=d.getColor(O,R,N);t===2?s.setPixel(k-me,we,mt):t===3?s.setPixel(k-me,D-we,mt):t===4?s.setPixel(me,D-we,mt):t===5?s.setPixel(we,me,mt):t===6?s.setPixel(D-we,me,mt):t===7?s.setPixel(D-we,k-me,mt):t===8?s.setPixel(we,k-me,mt):s.setPixelByIndex(g++,mt)}}break}default:throw new T("Unsupported color mode")}return s}}});var yr,_r=C(()=>{"use strict";ue();Dt();yr=class{constructor(e,t,i,r,n,s,a,o){this._bitsData=0;this._bitsCount=0;this._eobrun=0;this._successiveACState=0;this._successiveACNextValue=0;this._input=e,this._frame=t,this._precision=t.precision,this._samplesPerLine=t.samplesPerLine,this._scanLines=t.scanLines,this._mcusPerLine=t.mcusPerLine,this._progressive=t.progressive,this._maxH=t.maxHSamples,this._maxV=t.maxVSamples,this._components=i,this._resetInterval=o,this._spectralStart=r,this._spectralEnd=n,this._successivePrev=s,this._successive=a}get input(){return this._input}get frame(){return this._frame}get precision(){return this._precision}get samplesPerLine(){return this._samplesPerLine}get scanLines(){return this._scanLines}get mcusPerLine(){return this._mcusPerLine}get progressive(){return this._progressive}get maxH(){return this._maxH}get maxV(){return this._maxV}get components(){return this._components}get resetInterval(){return this._resetInterval}get spectralStart(){return this._spectralStart}get spectralEnd(){return this._spectralEnd}get successivePrev(){return this._successivePrev}get successive(){return this._successive}get bitsData(){return this._bitsData}get bitsCount(){return this._bitsCount}get eobrun(){return this._eobrun}get successiveACState(){return this._successiveACState}get successiveACNextValue(){return this._successiveACNextValue}readBit(){if(this.bitsCount>0)return this._bitsCount--,this._bitsData>>this._bitsCount&1;if(!this._input.isEOS){if(this._bitsData=this._input.readByte(),this._bitsData===255){let e=this.input.readByte();if(e!==0)throw new T(`unexpected marker: ${(this._bitsData<<8|e).toString(16)}`)}return this._bitsCount=7,this._bitsData>>7&1}}decodeHuffman(e){let t=e,i;for(;(i=this.readBit())!==void 0;)if(t=t[i],typeof t=="number")return Math.trunc(t)}receive(e){let t=0,i=e;for(;i>0;){let r=this.readBit();if(r===void 0)return;t=t<<1|r,i--}return t}receiveAndExtend(e){if(e===1)return this.readBit()===1?1:-1;let t=this.receive(e);return t>=1<<(e!=null?e:0)-1?t:t+(-1<<(e!=null?e:0))+1}decodeBaseline(e,t){let i=this.decodeHuffman(e.huffmanTableDC),r=i===0?0:this.receiveAndExtend(i);e.pred+=r,t[0]=e.pred;let n=1;for(;n<64;){let s=this.decodeHuffman(e.huffmanTableAC),a=s&15,o=s>>4;if(a===0){if(o<15)break;n+=16;continue}n+=o,a=this.receiveAndExtend(a);let u=A.dctZigZag[n];t[u]=a,n++}}decodeDCFirst(e,t){let i=this.decodeHuffman(e.huffmanTableDC),r=i===0?0:this.receiveAndExtend(i)<<this._successive;e.pred+=r,t[0]=e.pred}decodeDCSuccessive(e,t){t[0]|=this.readBit()<<this._successive}decodeACFirst(e,t){if(this._eobrun>0){this._eobrun--;return}let i=this._spectralStart,r=this._spectralEnd;for(;i<=r;){let n=this.decodeHuffman(e.huffmanTableAC),s=n&15,a=n>>4;if(s===0){if(a<15){this._eobrun=this.receive(a)+(1<<a)-1;break}i+=16;continue}i+=a;let o=A.dctZigZag[i];t[o]=this.receiveAndExtend(s)*(1<<this._successive),i++}}decodeACSuccessive(e,t){let i=this._spectralStart,r=this._spectralEnd,n=0,s=0;for(;i<=r;){let a=A.dctZigZag[i];switch(this._successiveACState){case 0:{let o=this.decodeHuffman(e.huffmanTableAC);if(o===void 0)throw new T("Invalid progressive encoding");if(n=o&15,s=o>>4,n===0)s<15?(this._eobrun=this.receive(s)+(1<<s),this._successiveACState=4):(s=16,this._successiveACState=1);else{if(n!==1)throw new T("invalid ACn encoding");this._successiveACNextValue=this.receiveAndExtend(n),this._successiveACState=s!==0?2:3}continue}case 1:case 2:{t[a]!==0?t[a]+=this.readBit()<<this._successive:(s--,s===0&&(this._successiveACState=this._successiveACState===2?3:0));break}case 3:{t[a]!==0?t[a]+=this.readBit()<<this._successive:(t[a]=this._successiveACNextValue<<this._successive,this._successiveACState=0);break}case 4:{t[a]!==0&&(t[a]+=this.readBit()<<this._successive);break}}i++}this._successiveACState===4&&(this._eobrun--,this._eobrun===0&&(this._successiveACState=0))}decodeMcu(e,t,i,r,n){let s=Math.floor(i/this._mcusPerLine),a=i%this._mcusPerLine,o=s*e.vSamples+r,u=a*e.hSamples+n;if(o>=e.blocks.length)return;let l=e.blocks[o].length;u>=l||t.call(this,e,e.blocks[o][u])}decodeBlock(e,t,i){let r=Math.floor(i/e.blocksPerLine),n=i%e.blocksPerLine;t.call(this,e,e.blocks[r][n])}decode(){let e=this._components.length,t,i;this._progressive?this._spectralStart===0?i=this._successivePrev===0?this.decodeDCFirst:this.decodeDCSuccessive:i=this._successivePrev===0?this.decodeACFirst:this.decodeACSuccessive:i=this.decodeBaseline;let r=0,n;e===1?n=this._components[0].blocksPerLine*this._components[0].blocksPerColumn:n=this._mcusPerLine*this._frame.mcusPerColumn,(this._resetInterval===void 0||this._resetInterval===0)&&(this._resetInterval=n);let s,a;for(;r<n;){for(let l=0;l<e;l++)this._components[l].pred=0;if(this._eobrun=0,e===1){t=this._components[0];for(let l=0;l<this._resetInterval;l++)this.decodeBlock(t,i,r),r++}else for(let l=0;l<this._resetInterval;l++){for(let h=0;h<e;h++){t=this.components[h],s=t.hSamples,a=t.vSamples;for(let f=0;f<a;f++)for(let c=0;c<s;c++)this.decodeMcu(t,i,r,f,c)}r++}this._bitsCount=0;let o=this._input.getByte(0),u=this._input.getByte(1);if(o===255)if(u>=A.M_RST0&&u<=A.M_RST7)this._input.skip(2);else break}}}});var Dn,ot,wr=C(()=>{"use strict";He();ue();or();Dt();lr();fr();cr();dr();pr();gr();xr();_r();wt();Dn=class{constructor(){this._exifData=new Ae;this._quantizationTables=new Array(A.NUM_QUANT_TBLS);this._frames=new Array;this._huffmanTablesAC=new Array;this._huffmanTablesDC=new Array;this._components=new Array}get input(){return this._input}get jfif(){return this._jfif}get adobe(){return this._adobe}get frame(){return this._frame}get resetInterval(){return this._resetInterval}get comment(){return this._comment}get exifData(){return this._exifData}get quantizationTables(){return this._quantizationTables}get frames(){return this._frames}get huffmanTablesAC(){return this._huffmanTablesAC}get huffmanTablesDC(){return this._huffmanTablesDC}get components(){return this._components}get width(){return this._frame.samplesPerLine}get height(){return this._frame.scanLines}readMarkers(){let e=this.nextMarker();if(e!==A.M_SOI)throw new T("Start Of Image marker not found.");for(e=this.nextMarker();e!==A.M_EOI&&!this._input.isEOS;){let t=this.readBlock();switch(e){case A.M_APP0:case A.M_APP1:case A.M_APP2:case A.M_APP3:case A.M_APP4:case A.M_APP5:case A.M_APP6:case A.M_APP7:case A.M_APP8:case A.M_APP9:case A.M_APP10:case A.M_APP11:case A.M_APP12:case A.M_APP13:case A.M_APP14:case A.M_APP15:case A.M_COM:this.readAppData(e,t);break;case A.M_DQT:this.readDQT(t);break;case A.M_SOF0:case A.M_SOF1:case A.M_SOF2:this.readFrame(e,t);break;case A.M_SOF3:case A.M_SOF5:case A.M_SOF6:case A.M_SOF7:case A.M_JPG:case A.M_SOF9:case A.M_SOF10:case A.M_SOF11:case A.M_SOF13:case A.M_SOF14:case A.M_SOF15:throw new T(`Unhandled frame type ${e.toString(16)}`);case A.M_DHT:this.readDHT(t);break;case A.M_DRI:this.readDRI(t);break;case A.M_SOS:this.readSOS(t);break;case 255:this._input.getByte(0)!==255&&this._input.skip(-1);break;default:if(this._input.getByte(-3)===255&&this._input.getByte(-2)>=192&&this._input.getByte(-2)<=254){this._input.skip(-3);break}if(e!==0)throw new T(`Unknown JPEG marker ${e.toString(16)}`);break}e=this.nextMarker()}}skipBlock(){let e=this._input.readUint16();if(e<2)throw new T("Invalid Block");this._input.skip(e-2)}validate(e){this._input=new G({buffer:e,bigEndian:!0});let t=this._input.peekBytes(2);if(t.getByte(0)!==255||t.getByte(1)!==216)return!1;let i=this.nextMarker();if(i!==A.M_SOI)return!1;let r=!1,n=!1;for(i=this.nextMarker();i!==A.M_EOI&&!this._input.isEOS;){let s=this._input.readUint16();if(s<2)break;switch(this._input.skip(s-2),i){case A.M_SOF0:case A.M_SOF1:case A.M_SOF2:r=!0;break;case A.M_SOS:n=!0;break;default:}i=this.nextMarker()}return r&&n}readInfo(e){this._input=new G({buffer:e,bigEndian:!0});let t=this.nextMarker();if(t!==A.M_SOI)return;let i=new mr,r=!1,n=!1;for(t=this.nextMarker();t!==A.M_EOI&&!this._input.isEOS;){switch(t){case A.M_SOF0:case A.M_SOF1:case A.M_SOF2:r=!0,this.readFrame(t,this.readBlock());break;case A.M_SOS:n=!0,this.skipBlock();break;default:this.skipBlock();break}t=this.nextMarker()}return this._frame!==void 0&&(i.setSize(this._frame.samplesPerLine,this._frame.scanLines),this._frame=void 0),this.frames.length=0,r&&n?i:void 0}read(e){if(this._input=new G({buffer:e,bigEndian:!0}),this.readMarkers(),this._frames.length!==1)throw new T("Only single frame JPEGs supported");if(this._frame!==void 0)for(let t=0;t<this._frame.componentsOrder.length;++t){let i=this._frame.components.get(this._frame.componentsOrder[t]);i!==void 0&&this.components.push(new ar(i.hSamples,this._frame.maxHSamples,i.vSamples,this._frame.maxVSamples,Dn.buildComponentData(i)))}}getImage(){return $e.getImageFromJpeg(this)}static buildHuffmanTable(e,t){let i=0,r=new Array,n=16;for(;n>0&&e[n-1]===0;)n--;r.push(new Nt);let s=r[0];for(let a=0;a<n;a++){for(let o=0;o<e[a];o++){for(s=r.pop(),s.children.length<=s.index&&(s.children.length=s.index+1),s.children[s.index]=t[i];s.index>0;)s=r.pop();for(s.incrementIndex(),r.push(s);r.length<=a;){let u=new Nt;r.push(u),s.children.length<=s.index&&(s.children.length=s.index+1),s.children[s.index]=u.children,s=u}i++}if(a+1<n){let o=new Nt;r.push(o),s.children.length<=s.index&&(s.children.length=s.index+1),s.children[s.index]=o.children,s=o}}return r[0].children}static buildComponentData(e){let t=e.blocksPerLine,i=e.blocksPerColumn,r=t<<3,n=new Int32Array(64),s=new Uint8Array(64),a=new Array(i*8),o=0;for(let u=0;u<i;u++){let l=u<<3;for(let h=0;h<8;h++)a[o++]=new Uint8Array(r);for(let h=0;h<t;h++){$e.quantizeAndInverse(e.quantizationTable,e.blocks[u][h],s,n);let f=0,c=h<<3;for(let p=0;p<8;p++){let g=a[l+p];for(let b=0;b<8;b++)g[c+b]=s[f++]}}}return a}static toFix(e){return Math.trunc(e*1048576)&4294967295}readBlock(){let e=this._input.readUint16();if(e<2)throw new T("Invalid Block");return this._input.readBytes(e-2)}nextMarker(){let e=0;if(this._input.isEOS)return e;do{do e=this._input.readByte();while(e!==255&&!this._input.isEOS);if(this._input.isEOS)return e;do e=this._input.readByte();while(e===255&&!this._input.isEOS)}while(e===0&&!this._input.isEOS);return e}readExifData(e){e.readUint32()===1165519206&&e.readUint16()===0&&this.exifData.read(e)}readAppData(e,t){let i=t;if(e===A.M_APP0){if(i.getByte(0)===74&&i.getByte(1)===70&&i.getByte(2)===73&&i.getByte(3)===70&&i.getByte(4)===0){let r=i.getByte(5),n=i.getByte(6),s=i.getByte(7),a=i.getByte(8)<<8|i.getByte(9),o=i.getByte(10)<<8|i.getByte(11),u=i.getByte(12),l=i.getByte(13),h=3*u*l,f=i.subarray(14+h,void 0,14);this._jfif=new br(u,l,r,n,s,a,o,f)}}else if(e===A.M_APP1)this.readExifData(i);else if(e===A.M_APP14){if(i.getByte(0)===65&&i.getByte(1)===100&&i.getByte(2)===111&&i.getByte(3)===98&&i.getByte(4)===101&&i.getByte(5)===0){let r=i.getByte(6),n=i.getByte(7)<<8|i.getByte(8),s=i.getByte(9)<<8|i.getByte(10),a=i.getByte(11);this._adobe=new ur(r,n,s,a)}}else if(e===A.M_COM)try{this._comment=i.readStringUtf8()}catch(r){}}readDQT(e){for(;!e.isEOS;){let t=e.readByte(),i=t>>4;if(t&=15,t>=A.NUM_QUANT_TBLS)throw new T("Invalid number of quantization tables");this._quantizationTables[t]===void 0&&(this._quantizationTables[t]=new Int16Array(64));let r=this._quantizationTables[t];if(r!==void 0)for(let n=0;n<A.DCTSIZE2;n++){let s=i!==0?e.readUint16():e.readByte();r[A.dctZigZag[n]]=s}}if(!e.isEOS)throw new T("Bad length for DQT block")}readFrame(e,t){if(this._frame!==void 0)throw new T("Duplicate JPG frame data found.");let i=e===A.M_SOF1,r=e===A.M_SOF2,n=t.readByte(),s=t.readUint16(),a=t.readUint16(),o=t.readByte(),u=new Map,l=new Array;for(let h=0;h<o;h++){let f=t.readByte(),c=t.readByte(),p=c>>4&15,g=c&15,b=t.readByte();l.push(f);let x=new hr(p,g,this._quantizationTables,b);u.set(f,x)}this._frame=new Lt(u,l,i,r,n,s,a),this._frame.prepare(),this.frames.push(this._frame)}readDHT(e){for(;!e.isEOS;){let t=e.readByte(),i=new Uint8Array(16),r=0;for(let a=0;a<16;a++)i[a]=e.readByte(),r+=i[a];let n=new Uint8Array(r);for(let a=0;a<r;a++)n[a]=e.readByte();let s=[];(t&16)!==0?(t-=16,s=this._huffmanTablesAC):s=this._huffmanTablesDC,s.length<=t&&(s.length=t+1),s[t]=Dn.buildHuffmanTable(i,n)}}readDRI(e){this._resetInterval=e.readUint16()}readSOS(e){let t=e.readByte();if(t<1||t>A.MAX_COMPS_IN_SCAN)throw new T("Invalid SOS block");let i=new Array;for(let l=0;l<t;l++){let h=e.readByte(),f=e.readByte();if(!this._frame.components.has(h))throw new T("Invalid Component in SOS block");let c=this._frame.components.get(h);if(c!==void 0){let p=f>>4&15,g=f&15;p<this._huffmanTablesDC.length&&(c.huffmanTableDC=this._huffmanTablesDC[p]),g<this._huffmanTablesAC.length&&(c.huffmanTableAC=this._huffmanTablesAC[g]),i.push(c)}}let r=e.readByte(),n=e.readByte(),s=e.readByte(),a=s>>4&15,o=s&15;new yr(this._input,this._frame,i,r,n,a,o,this._resetInterval).decode()}},ot=Dn;ot.CRR=[-179,-178,-177,-175,-174,-172,-171,-170,-168,-167,-165,-164,-163,-161,-160,-158,-157,-156,-154,-153,-151,-150,-149,-147,-146,-144,-143,-142,-140,-139,-137,-136,-135,-133,-132,-130,-129,-128,-126,-125,-123,-122,-121,-119,-118,-116,-115,-114,-112,-111,-109,-108,-107,-105,-104,-102,-101,-100,-98,-97,-95,-94,-93,-91,-90,-88,-87,-86,-84,-83,-81,-80,-79,-77,-76,-74,-73,-72,-70,-69,-67,-66,-64,-63,-62,-60,-59,-57,-56,-55,-53,-52,-50,-49,-48,-46,-45,-43,-42,-41,-39,-38,-36,-35,-34,-32,-31,-29,-28,-27,-25,-24,-22,-21,-20,-18,-17,-15,-14,-13,-11,-10,-8,-7,-6,-4,-3,-1,0,1,3,4,6,7,8,10,11,13,14,15,17,18,20,21,22,24,25,27,28,29,31,32,34,35,36,38,39,41,42,43,45,46,48,49,50,52,53,55,56,57,59,60,62,63,64,66,67,69,70,72,73,74,76,77,79,80,81,83,84,86,87,88,90,91,93,94,95,97,98,100,101,102,104,105,107,108,109,111,112,114,115,116,118,119,121,122,123,125,126,128,129,130,132,133,135,136,137,139,140,142,143,144,146,147,149,150,151,153,154,156,157,158,160,161,163,164,165,167,168,170,171,172,174,175,177,178],ot.CRG=[5990656,5943854,5897052,5850250,5803448,5756646,5709844,5663042,5616240,5569438,5522636,5475834,5429032,5382230,5335428,5288626,5241824,5195022,5148220,5101418,5054616,5007814,4961012,4914210,4867408,4820606,4773804,4727002,4680200,4633398,4586596,4539794,4492992,4446190,4399388,4352586,4305784,4258982,4212180,4165378,4118576,4071774,4024972,3978170,3931368,3884566,3837764,3790962,3744160,3697358,3650556,3603754,3556952,3510150,3463348,3416546,3369744,3322942,3276140,3229338,3182536,3135734,3088932,3042130,2995328,2948526,2901724,2854922,2808120,2761318,2714516,2667714,2620912,2574110,2527308,2480506,2433704,2386902,2340100,2293298,2246496,2199694,2152892,2106090,2059288,2012486,1965684,1918882,1872080,1825278,1778476,1731674,1684872,1638070,1591268,1544466,1497664,1450862,1404060,1357258,1310456,1263654,1216852,1170050,1123248,1076446,1029644,982842,936040,889238,842436,795634,748832,702030,655228,608426,561624,514822,468020,421218,374416,327614,280812,234010,187208,140406,93604,46802,0,-46802,-93604,-140406,-187208,-234010,-280812,-327614,-374416,-421218,-468020,-514822,-561624,-608426,-655228,-702030,-748832,-795634,-842436,-889238,-936040,-982842,-1029644,-1076446,-1123248,-1170050,-1216852,-1263654,-1310456,-1357258,-1404060,-1450862,-1497664,-1544466,-1591268,-1638070,-1684872,-1731674,-1778476,-1825278,-1872080,-1918882,-1965684,-2012486,-2059288,-2106090,-2152892,-2199694,-2246496,-2293298,-2340100,-2386902,-2433704,-2480506,-2527308,-2574110,-2620912,-2667714,-2714516,-2761318,-2808120,-2854922,-2901724,-2948526,-2995328,-3042130,-3088932,-3135734,-3182536,-3229338,-3276140,-3322942,-3369744,-3416546,-3463348,-3510150,-3556952,-3603754,-3650556,-3697358,-3744160,-3790962,-3837764,-3884566,-3931368,-3978170,-4024972,-4071774,-4118576,-4165378,-4212180,-4258982,-4305784,-4352586,-4399388,-4446190,-4492992,-4539794,-4586596,-4633398,-4680200,-4727002,-4773804,-4820606,-4867408,-4914210,-4961012,-5007814,-5054616,-5101418,-5148220,-5195022,-5241824,-5288626,-5335428,-5382230,-5429032,-5475834,-5522636,-5569438,-5616240,-5663042,-5709844,-5756646,-5803448,-5850250,-5897052,-5943854],ot.CBG=[2919680,2897126,2874572,2852018,2829464,2806910,2784356,2761802,2739248,2716694,2694140,2671586,2649032,2626478,2603924,2581370,2558816,2536262,2513708,2491154,2468600,2446046,2423492,2400938,2378384,2355830,2333276,2310722,2288168,2265614,2243060,2220506,2197952,2175398,2152844,2130290,2107736,2085182,2062628,2040074,2017520,1994966,1972412,1949858,1927304,1904750,1882196,1859642,1837088,1814534,1791980,1769426,1746872,1724318,1701764,1679210,1656656,1634102,1611548,1588994,1566440,1543886,1521332,1498778,1476224,1453670,1431116,1408562,1386008,1363454,1340900,1318346,1295792,1273238,1250684,1228130,1205576,1183022,1160468,1137914,1115360,1092806,1070252,1047698,1025144,1002590,980036,957482,934928,912374,889820,867266,844712,822158,799604,777050,754496,731942,709388,686834,664280,641726,619172,596618,574064,551510,528956,506402,483848,461294,438740,416186,393632,371078,348524,325970,303416,280862,258308,235754,213200,190646,168092,145538,122984,100430,77876,55322,32768,10214,-12340,-34894,-57448,-80002,-102556,-125110,-147664,-170218,-192772,-215326,-237880,-260434,-282988,-305542,-328096,-350650,-373204,-395758,-418312,-440866,-463420,-485974,-508528,-531082,-553636,-576190,-598744,-621298,-643852,-666406,-688960,-711514,-734068,-756622,-779176,-801730,-824284,-846838,-869392,-891946,-914500,-937054,-959608,-982162,-1004716,-1027270,-1049824,-1072378,-1094932,-1117486,-1140040,-1162594,-1185148,-1207702,-1230256,-1252810,-1275364,-1297918,-1320472,-1343026,-1365580,-1388134,-1410688,-1433242,-1455796,-1478350,-1500904,-1523458,-1546012,-1568566,-1591120,-1613674,-1636228,-1658782,-1681336,-1703890,-1726444,-1748998,-1771552,-1794106,-1816660,-1839214,-1861768,-1884322,-1906876,-1929430,-1951984,-1974538,-1997092,-2019646,-2042200,-2064754,-2087308,-2109862,-2132416,-2154970,-2177524,-2200078,-2222632,-2245186,-2267740,-2290294,-2312848,-2335402,-2357956,-2380510,-2403064,-2425618,-2448172,-2470726,-2493280,-2515834,-2538388,-2560942,-2583496,-2606050,-2628604,-2651158,-2673712,-2696266,-2718820,-2741374,-2763928,-2786482,-2809036,-2831590],ot.CBB=[-227,-225,-223,-222,-220,-218,-216,-214,-213,-211,-209,-207,-206,-204,-202,-200,-198,-197,-195,-193,-191,-190,-188,-186,-184,-183,-181,-179,-177,-175,-174,-172,-170,-168,-167,-165,-163,-161,-159,-158,-156,-154,-152,-151,-149,-147,-145,-144,-142,-140,-138,-136,-135,-133,-131,-129,-128,-126,-124,-122,-120,-119,-117,-115,-113,-112,-110,-108,-106,-105,-103,-101,-99,-97,-96,-94,-92,-90,-89,-87,-85,-83,-82,-80,-78,-76,-74,-73,-71,-69,-67,-66,-64,-62,-60,-58,-57,-55,-53,-51,-50,-48,-46,-44,-43,-41,-39,-37,-35,-34,-32,-30,-28,-27,-25,-23,-21,-19,-18,-16,-14,-12,-11,-9,-7,-5,-4,-2,0,2,4,5,7,9,11,12,14,16,18,19,21,23,25,27,28,30,32,34,35,37,39,41,43,44,46,48,50,51,53,55,57,58,60,62,64,66,67,69,71,73,74,76,78,80,82,83,85,87,89,90,92,94,96,97,99,101,103,105,106,108,110,112,113,115,117,119,120,122,124,126,128,129,131,133,135,136,138,140,142,144,145,147,149,151,152,154,156,158,159,161,163,165,167,168,170,172,174,175,177,179,181,183,184,186,188,190,191,193,195,197,198,200,202,204,206,207,209,211,213,214,216,218,220,222,223,225]});var Ii,Ai=C(()=>{"use strict";bt();He();ue();ft();wr();Ii=class{get numFrames(){return this.info!==void 0?this.info.numFrames:0}isValidFile(e){return new ot().validate(e)}startDecode(e){return this.input=new G({buffer:e,bigEndian:!0}),this.info=new ot().readInfo(e),this.info}decodeFrame(e){if(this.input===void 0)return;let t=new ot;if(t.read(this.input.buffer),t.frames.length!==1)throw new T("only single frame JPEGs supported");return t.getImage()}decodeHdrFrame(e){let t=this.decodeFrame(e);if(t!==void 0)return de.fromImage(t)}decodeAnimation(e){let t=this.decodeImage(e);if(t===void 0)return;let i=new Xe({width:t.width,height:t.height});return i.addFrame(t),i}decodeImage(e,t){let i=new ot;if(i.read(e),i.frames.length!==1)throw new T("only single frame JPEGs supported");return i.getImage()}decodeHdrImage(e,t=0){let i=this.decodeImage(e,t);if(i!==void 0)return de.fromImage(i)}}});var K,Ke,Ir=C(()=>{"use strict";Qe();st();Dt();K=class{constructor(e=100){this.tableY=new Uint8Array(64);this.tableUV=new Uint8Array(64);this.ftableY=new Float32Array(64);this.ftableUV=new Float32Array(64);this.bitcode=new Array(65535).fill(void 0);this.category=new Array(65535).fill(void 0);this.outputfDCTQuant=new Array(64).fill(void 0);this.DU=new Array(64).fill(void 0);this.YDU=new Float32Array(64);this.UDU=new Float32Array(64);this.VDU=new Float32Array(64);this.tableRGBYUV=new Int32Array(2048);this.byteNew=0;this.bytePos=7;this._supportsAnimation=!1;this.initHuffmanTable(),this.initCategoryNumber(),this.initRGBYUVTable(),this.setQuality(e)}get supportsAnimation(){return this._supportsAnimation}static computeHuffmanTable(e,t){let i=0,r=0,n=new Array;for(let s=1;s<=16;s++){for(let a=1;a<=e[s];a++){let o=t[r];n.length<=o&&(n.length=o+1),n[o]=[i,s],r++,i++}i*=2}return n}static writeMarker(e,t){e.writeByte(255),e.writeByte(t&255)}static writeAPP0(e){K.writeMarker(e,A.M_APP0),e.writeUint16(16),e.writeByte(74),e.writeByte(70),e.writeByte(73),e.writeByte(70),e.writeByte(0),e.writeByte(1),e.writeByte(1),e.writeByte(0),e.writeUint16(1),e.writeUint16(1),e.writeByte(0),e.writeByte(0)}static writeAPP1(e,t){if(t.isEmpty)return;let i=new he;t.write(i);let r=i.getBytes();this.writeMarker(e,A.M_APP1),e.writeUint16(r.length+8);let n=1165519206;e.writeUint32(n),e.writeUint16(0),e.writeBytes(r)}static writeSOF0(e,t,i){K.writeMarker(e,A.M_SOF0),e.writeUint16(17),e.writeByte(8),e.writeUint16(i),e.writeUint16(t),e.writeByte(3),e.writeByte(1),e.writeByte(17),e.writeByte(0),e.writeByte(2),e.writeByte(17),e.writeByte(1),e.writeByte(3),e.writeByte(17),e.writeByte(1)}static writeSOS(e){K.writeMarker(e,A.M_SOS),e.writeUint16(12),e.writeByte(3),e.writeByte(1),e.writeByte(0),e.writeByte(2),e.writeByte(17),e.writeByte(3),e.writeByte(17),e.writeByte(0),e.writeByte(63),e.writeByte(0)}static writeDHT(e){K.writeMarker(e,A.M_DHT),e.writeUint16(418),e.writeByte(0);for(let t=0;t<16;t++)e.writeByte(K.STD_DC_LUMINANCE_NR_CODES[t+1]);for(let t=0;t<=11;t++)e.writeByte(K.STD_DC_LUMINANCE_VALUES[t]);e.writeByte(16);for(let t=0;t<16;t++)e.writeByte(K.STD_AC_LUMINANCE_NR_CODES[t+1]);for(let t=0;t<=161;t++)e.writeByte(K.STD_AC_LUMINANCE_VALUES[t]);e.writeByte(1);for(let t=0;t<16;t++)e.writeByte(K.STD_DC_CHROMINANCE_NR_CODES[t+1]);for(let t=0;t<=11;t++)e.writeByte(K.STD_DC_CHROMINANCE_VALUES[t]);e.writeByte(17);for(let t=0;t<16;t++)e.writeByte(K.STD_AC_CHROMINANCE_NR_CODES[t+1]);for(let t=0;t<=161;t++)e.writeByte(K.STD_AC_CHROMINANCE_VALUES[t])}initHuffmanTable(){this.htYDC=K.computeHuffmanTable(K.STD_DC_LUMINANCE_NR_CODES,K.STD_DC_LUMINANCE_VALUES),this.htUVDC=K.computeHuffmanTable(K.STD_DC_CHROMINANCE_NR_CODES,K.STD_DC_CHROMINANCE_VALUES),this.htYAC=K.computeHuffmanTable(K.STD_AC_LUMINANCE_NR_CODES,K.STD_AC_LUMINANCE_VALUES),this.htUVAC=K.computeHuffmanTable(K.STD_AC_CHROMINANCE_NR_CODES,K.STD_AC_CHROMINANCE_VALUES)}initCategoryNumber(){let e=1,t=2;for(let i=1;i<=15;i++){for(let r=e;r<t;r++)this.category[32767+r]=i,this.bitcode[32767+r]=[r,i];for(let r=-(t-1);r<=-e;r++)this.category[32767+r]=i,this.bitcode[32767+r]=[t-1+r,i];e<<=1,t<<=1}}initRGBYUVTable(){for(let e=0;e<256;e++)this.tableRGBYUV[e]=19595*e,this.tableRGBYUV[e+256]=38470*e,this.tableRGBYUV[e+512]=7471*e+32768,this.tableRGBYUV[e+768]=-11059*e,this.tableRGBYUV[e+1024]=-21709*e,this.tableRGBYUV[e+1280]=32768*e+8421375,this.tableRGBYUV[e+1536]=-27439*e,this.tableRGBYUV[e+1792]=-5329*e}setQuality(e){let t=F.clampInt(e,1,100);if(this.currentQuality===t)return;let i=0;t<50?i=Math.floor(5e3/t):i=Math.floor(200-t*2),this.initQuantTables(i),this.currentQuality=t}initQuantTables(e){let t=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99];for(let s=0;s<64;s++){let a=Math.floor((t[s]*e+50)/100);a<1?a=1:a>255&&(a=255),this.tableY[K.ZIGZAG[s]]=a}let i=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99];for(let s=0;s<64;s++){let a=Math.floor((i[s]*e+50)/100);a<1?a=1:a>255&&(a=255),this.tableUV[K.ZIGZAG[s]]=a}let r=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],n=0;for(let s=0;s<8;s++)for(let a=0;a<8;a++)this.ftableY[n]=1/(this.tableY[K.ZIGZAG[n]]*r[s]*r[a]*8),this.ftableUV[n]=1/(this.tableUV[K.ZIGZAG[n]]*r[s]*r[a]*8),n++}fDCTQuant(e,t){let i=0,r=8,n=64;for(let s=0;s<r;++s){let a=e[i],o=e[i+1],u=e[i+2],l=e[i+3],h=e[i+4],f=e[i+5],c=e[i+6],p=e[i+7],g=a+p,b=a-p,x=o+c,y=o-c,P=u+f,w=u-f,M=l+h,B=l-h,O=g+M,R=g-M,N=x+P,L=x-P;e[i]=O+N,e[i+4]=O-N;let D=(L+R)*.707106781;e[i+2]=R+D,e[i+6]=R-D,O=B+w,N=w+y,L=y+b;let k=(O-L)*.382683433,Y=.5411961*O+k,Z=1.306562965*L+k,j=N*.707106781,X=b+j,$=b-j;e[i+5]=$+Y,e[i+3]=$-Y,e[i+1]=X+Z,e[i+7]=X-Z,i+=8}i=0;for(let s=0;s<r;++s){let a=e[i],o=e[i+8],u=e[i+16],l=e[i+24],h=e[i+32],f=e[i+40],c=e[i+48],p=e[i+56],g=a+p,b=a-p,x=o+c,y=o-c,P=u+f,w=u-f,M=l+h,B=l-h,O=g+M,R=g-M,N=x+P,L=x-P;e[i]=O+N,e[i+32]=O-N;let D=(L+R)*.707106781;e[i+16]=R+D,e[i+48]=R-D,O=B+w,N=w+y,L=y+b;let k=(O-L)*.382683433,Y=.5411961*O+k,Z=1.306562965*L+k,j=N*.707106781,X=b+j,$=b-j;e[i+40]=$+Y,e[i+24]=$-Y,e[i+8]=X+Z,e[i+56]=X-Z,i++}for(let s=0;s<n;++s){let a=e[s]*t[s];this.outputfDCTQuant[s]=a>0?Math.trunc(a+.5):Math.trunc(a-.5)}return this.outputfDCTQuant}writeDQT(e){K.writeMarker(e,A.M_DQT),e.writeUint16(132),e.writeByte(0);for(let t=0;t<64;t++)e.writeByte(this.tableY[t]);e.writeByte(1);for(let t=0;t<64;t++)e.writeByte(this.tableUV[t])}writeBits(e,t){let i=t[0],r=t[1]-1;for(;r>=0;)(i&1<<r)!==0&&(this.byteNew|=1<<this.bytePos),r--,this.bytePos--,this.bytePos<0&&(this.byteNew===255?(e.writeByte(255),e.writeByte(0)):e.writeByte(this.byteNew),this.bytePos=7,this.byteNew=0)}resetBits(){this.byteNew=0,this.bytePos=7}processDU(e,t,i,r,n,s){let a=n[0],o=n[240],u=16,l=63,h=64,f=this.fDCTQuant(t,i),c=r,p=0;for(let y=0;y<h;++y)this.DU[K.ZIGZAG[y]]=f[y];let g=this.DU[0]-c;c=this.DU[0],g===0?this.writeBits(e,s[0]):(p=32767+g,this.writeBits(e,s[this.category[p]]),this.writeBits(e,this.bitcode[p]));let b=63;for(;b>0&&this.DU[b]===0;b--);if(b===0)return this.writeBits(e,a),c;let x=1;for(;x<=b;){let y=x;for(;this.DU[x]===0&&x<=b;++x);let P=x-y;if(P>=u){let w=P>>4;for(let M=1;M<=w;++M)this.writeBits(e,o);P&=15}p=32767+this.DU[x],this.writeBits(e,n[(P<<4)+this.category[p]]),this.writeBits(e,this.bitcode[p]),x++}return b!==l&&this.writeBits(e,a),c}encodeImage(e){let t=new he({bigEndian:!0});K.writeMarker(t,A.M_SOI),K.writeAPP0(t),K.writeAPP1(t,e.exifData),this.writeDQT(t),K.writeSOF0(t,e.width,e.height),K.writeDHT(t),K.writeSOS(t);let i=0,r=0,n=0;this.resetBits();let s=e.width,a=e.height,o=e.getBytes(),u=s*4,l=0;for(;l<a;){let h=0;for(;h<u;){let f=u*l+h;for(let c=0;c<64;c++){let p=c>>3,g=(c&7)*4,b=f+p*u+g;l+p>=a&&(b-=u*(l+1+p-a)),h+g>=u&&(b-=h+g-u+4);let x=o[b++],y=o[b++],P=o[b++];this.YDU[c]=(this.tableRGBYUV[x]+this.tableRGBYUV[y+256]+this.tableRGBYUV[P+512]>>16)-128,this.UDU[c]=(this.tableRGBYUV[x+768]+this.tableRGBYUV[y+1024]+this.tableRGBYUV[P+1280]>>16)-128,this.VDU[c]=(this.tableRGBYUV[x+1280]+this.tableRGBYUV[y+1536]+this.tableRGBYUV[P+1792]>>16)-128}i=this.processDU(t,this.YDU,this.ftableY,i,this.htYAC,this.htYDC),r=this.processDU(t,this.UDU,this.ftableUV,r,this.htUVAC,this.htUVDC),n=this.processDU(t,this.VDU,this.ftableUV,n,this.htUVAC,this.htUVDC),h+=32}l+=8}if(this.bytePos>=0){let h=[(1<<this.bytePos+1)-1,this.bytePos+1];this.writeBits(t,h)}return K.writeMarker(t,A.M_EOI),t.getBytes()}encodeAnimation(e){}},Ke=K;Ke.ZIGZAG=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],Ke.STD_DC_LUMINANCE_NR_CODES=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],Ke.STD_DC_LUMINANCE_VALUES=[0,1,2,3,4,5,6,7,8,9,10,11],Ke.STD_AC_LUMINANCE_NR_CODES=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],Ke.STD_AC_LUMINANCE_VALUES=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],Ke.STD_DC_CHROMINANCE_NR_CODES=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],Ke.STD_DC_CHROMINANCE_VALUES=[0,1,2,3,4,5,6,7,8,9,10,11],Ke.STD_AC_CHROMINANCE_NR_CODES=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Ke.STD_AC_CHROMINANCE_VALUES=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250]});var Ar=C(()=>{"use strict"});var vr=C(()=>{"use strict";ge();bt();He();Ye();Ve();ft();Ar()});var Pr=C(()=>{"use strict";ge();st();Ve()});var Ln,vi,Sr=C(()=>{"use strict";Ln=class{constructor(e){this.bitBuffer=0;this.bitPosition=0;this.input=e}readBits(e){let t=e;if(t===0)return 0;this.bitPosition===0&&(this.bitPosition=8,this.bitBuffer=this.input.readByte());let i=0;for(;t>this.bitPosition;)i=(i<<this.bitPosition)+(this.bitBuffer&Ln.BITMASK[this.bitPosition]),t-=this.bitPosition,this.bitPosition=8,this.bitBuffer=this.input.readByte();return t>0&&(this.bitPosition===0&&(this.bitPosition=8,this.bitBuffer=this.input.readByte()),i=(i<<t)+(this.bitBuffer>>this.bitPosition-t&Ln.BITMASK[t]),this.bitPosition-=t),i}readByte(){return this.readBits(8)}flushByte(){return this.bitPosition=0}},vi=Ln;vi.BITMASK=[0,1,3,7,15,31,63,127,255]});var pe,_e,Pi=C(()=>{"use strict";ue();kt();pe=class{get tag(){return this._tag}get type(){return this._type}get numValues(){return this._numValues}get valueOffset(){return this._valueOffset}set valueOffset(e){this._valueOffset=e}get p(){return this._p}get isValid(){return this._type<13&&this._type>0}get typeSize(){return this.isValid?pe.SIZE_OF_TYPE[this._type]:0}get isString(){return this._type===pe.TYPE_ASCII}constructor(e){this._tag=e.tag,this._type=e.type,this._numValues=e.numValues,this._p=e.p}readValueInternal(){switch(this._type){case pe.TYPE_BYTE:case pe.TYPE_ASCII:return this._p.readByte();case pe.TYPE_SHORT:return this._p.readUint16();case pe.TYPE_LONG:return this._p.readUint32();case pe.TYPE_RATIONAL:{let e=this._p.readUint32(),t=this._p.readUint32();return t===0?0:Math.trunc(e/t)}case pe.TYPE_SBYTE:throw new T("Unhandled value type: SBYTE");case pe.TYPE_UNDEFINED:return this._p.readByte();case pe.TYPE_SSHORT:throw new T("Unhandled value type: SSHORT");case pe.TYPE_SLONG:throw new T("Unhandled value type: SLONG");case pe.TYPE_SRATIONAL:throw new T("Unhandled value type: SRATIONAL");case pe.TYPE_FLOAT:throw new T("Unhandled value type: FLOAT");case pe.TYPE_DOUBLE:throw new T("Unhandled value type: DOUBLE")}return 0}toString(){return S.TAG_NAME.has(this._tag)?`${S.TAG_NAME.get(this._tag)}: $type $numValues`:`<${this._tag}>: ${this._type} ${this._numValues}`}readValue(){return this._p.offset=this._valueOffset,this.readValueInternal()}readValues(){this._p.offset=this._valueOffset;let e=[];for(let t=0;t<this._numValues;++t)e.push(this.readValueInternal());return e}readString(){if(this._type!==pe.TYPE_ASCII)throw new T("readString requires ASCII entity");return String.fromCharCode(...this.readValues())}read(){this._p.offset=this._valueOffset;let e=[];for(let t=0;t<this._numValues;++t)switch(this._type){case pe.TYPE_BYTE:case pe.TYPE_ASCII:e.push(this._p.readByte());break;case pe.TYPE_SHORT:e.push(this._p.readUint16());break;case pe.TYPE_LONG:e.push(this._p.readUint32());break;case pe.TYPE_RATIONAL:{let i=this._p.readUint32(),r=this._p.readUint32();r!==0&&e.push(i/r);break}case pe.TYPE_FLOAT:e.push(this._p.readFloat32());break;case pe.TYPE_DOUBLE:e.push(this._p.readFloat64());break}return e}},_e=pe;_e.SIZE_OF_TYPE=[0,1,1,2,4,8,1,1,2,4,8,4,8,0],_e.TYPE_BYTE=1,_e.TYPE_ASCII=2,_e.TYPE_SHORT=3,_e.TYPE_LONG=4,_e.TYPE_RATIONAL=5,_e.TYPE_SBYTE=6,_e.TYPE_UNDEFINED=7,_e.TYPE_SSHORT=8,_e.TYPE_SLONG=9,_e.TYPE_SRATIONAL=10,_e.TYPE_FLOAT=11,_e.TYPE_DOUBLE=12});var oe,Fe,Cr=C(()=>{"use strict";ue();oe=class{constructor(e){this.changingElemSize=0;this.bitPointer=0;this.bytePointer=0;this.lastChangingElement=0;this.compression=2;this.uncompressedMode=0;this.fillBits=0;this.oneD=0;this._fillOrder=e.fillOrder,this._width=e.width,this._height=e.height,this.prevChangingElems=new Array(this._width),this.prevChangingElems.fill(0),this.currChangingElems=new Array(this._width),this.currChangingElems.fill(0)}get width(){return this._width}get height(){return this._height}get fillOrder(){return this._fillOrder}nextNBits(e){let t=0,i=0,r=0,n=this.data.length-1,s=this.bytePointer;if(this._fillOrder===1)t=this.data.getByte(s),s===n?(i=0,r=0):s+1===n?(i=this.data.getByte(s+1),r=0):(i=this.data.getByte(s+1),r=this.data.getByte(s+2));else if(this._fillOrder===2)t=oe.FLIP_TABLE[this.data.getByte(s)&255],s===n?(i=0,r=0):s+1===n?(i=oe.FLIP_TABLE[this.data.getByte(s+1)&255],r=0):(i=oe.FLIP_TABLE[this.data.getByte(s+1)&255],r=oe.FLIP_TABLE[this.data.getByte(s+2)&255]);else throw new T("TIFFFaxDecoder7");let a=8-this.bitPointer,o=e-a,u=0;o>8&&(u=o-8,o=8),this.bytePointer=this.bytePointer+1;let l=(t&oe.TABLE1[a])<<e-a,h=(i&oe.TABLE2[o])>>8-o,f=0;return u!==0?(h<<=u,f=(r&oe.TABLE2[u])>>8-u,h|=f,this.bytePointer+=1,this.bitPointer=u):o===8?(this.bitPointer=0,this.bytePointer+=1):this.bitPointer=o,l|h}nextLesserThan8Bits(e){let t=0,i=0,r=this.data.length-1,n=this.bytePointer;if(this._fillOrder===1)t=this.data.getByte(n),n===r?i=0:i=this.data.getByte(n+1);else if(this._fillOrder===2)t=oe.FLIP_TABLE[this.data.getByte(n)&255],n===r?i=0:i=oe.FLIP_TABLE[this.data.getByte(n+1)&255];else throw new T("TIFFFaxDecoder7");let s=8-this.bitPointer,a=e-s,o=s-e,u=0,l=0;return o>=0?(u=(t&oe.TABLE1[s])>>o,this.bitPointer+=e,this.bitPointer===8&&(this.bitPointer=0,this.bytePointer+=1)):(u=(t&oe.TABLE1[s])<<-o,l=(i&oe.TABLE2[a])>>8-a,u|=l,this.bytePointer+=1,this.bitPointer=a),u}updatePointer(e){let t=this.bitPointer-e;t<0?(this.bytePointer-=1,this.bitPointer=8+t):this.bitPointer=t}advancePointer(){return this.bitPointer!==0&&(this.bytePointer+=1,this.bitPointer=0),!0}setToBlack(e,t,i,r){let n=8*t+i,s=n+r,a=n>>3,o=n&7;if(o>0){let u=1<<7-o,l=e.getByte(a);for(;u>0&&n<s;)l|=u,u>>=1,++n;e.setByte(a,l)}for(a=n>>3;n<s-7;)e.setByte(a++,255),n+=8;for(;n<s;)a=n>>3,e.setByte(a,e.getByte(a)|1<<7-(n&7)),++n}decodeNextScanline(e,t,i){let r=i,n=0,s=0,a=0,o=0,u=0,l=0,h=!0;for(this.changingElemSize=0;r<this._width;){for(;h;)if(o=this.nextNBits(10),u=oe.WHITE[o],a=u&1,n=u>>1&15,n===12)l=this.nextLesserThan8Bits(2),o=o<<2&12|l,u=oe.ADDITIONAL_MAKEUP[o],n=u>>1&7,s=u>>4&4095,r+=s,this.updatePointer(4-n);else{if(n===0)throw new T("TIFFFaxDecoder0");if(n===15)throw new T("TIFFFaxDecoder1");s=u>>5&2047,r+=s,this.updatePointer(10-n),a===0&&(h=!1,this.currChangingElems[this.changingElemSize++]=r)}if(r===this._width){this.compression===2&&this.advancePointer();break}for(;h===!1;)if(o=this.nextLesserThan8Bits(4),u=oe.INIT_BLACK[o],a=u&1,n=u>>1&15,s=u>>5&2047,s===100)if(o=this.nextNBits(9),u=oe.BLACK[o],a=u&1,n=u>>1&15,s=u>>5&2047,n===12)this.updatePointer(5),o=this.nextLesserThan8Bits(4),u=oe.ADDITIONAL_MAKEUP[o],n=u>>1&7,s=u>>4&4095,this.setToBlack(e,t,r,s),r+=s,this.updatePointer(4-n);else{if(n===15)throw new T("TIFFFaxDecoder2");this.setToBlack(e,t,r,s),r+=s,this.updatePointer(9-n),a===0&&(h=!0,this.currChangingElems[this.changingElemSize++]=r)}else s===200?(o=this.nextLesserThan8Bits(2),u=oe.TWO_BIT_BLACK[o],s=u>>5&2047,n=u>>1&15,this.setToBlack(e,t,r,s),r+=s,this.updatePointer(2-n),h=!0,this.currChangingElems[this.changingElemSize++]=r):(this.setToBlack(e,t,r,s),r+=s,this.updatePointer(4-n),h=!0,this.currChangingElems[this.changingElemSize++]=r);if(r===this._width){this.compression===2&&this.advancePointer();break}}this.currChangingElems[this.changingElemSize++]=r}readEOL(){if(this.fillBits===0){if(this.nextNBits(12)!==1)throw new T("TIFFFaxDecoder6")}else if(this.fillBits===1){let e=8-this.bitPointer;if(this.nextNBits(e)!==0)throw new T("TIFFFaxDecoder8");if(e<4&&this.nextNBits(8)!==0)throw new T("TIFFFaxDecoder8");let t=0;for(;(t=this.nextNBits(8))!==1;)if(t!==0)throw new T("TIFFFaxDecoder8")}return this.oneD===0?1:this.nextLesserThan8Bits(1)}getNextChangingElement(e,t,i){let r=this.prevChangingElems,n=this.changingElemSize,s=this.lastChangingElement>0?this.lastChangingElement-1:0;t?s&=-2:s|=1;let a=s;for(;a<n;a+=2){let o=r[a];if(o>e){this.lastChangingElement=a,i[0]=o;break}}a+1<n&&(i[1]=r[a+1])}decodeWhiteCodeWord(){let e=0,t=0,i=0,r=0,n=0,s=-1,a=0,o=!0;for(;o;)if(e=this.nextNBits(10),t=oe.WHITE[e],r=t&1,i=t>>1&15,i===12)n=this.nextLesserThan8Bits(2),e=e<<2&12|n,t=oe.ADDITIONAL_MAKEUP[e],i=t>>1&7,s=t>>4&4095,a+=s,this.updatePointer(4-i);else{if(i===0)throw new T("TIFFFaxDecoder0");if(i===15)throw new T("TIFFFaxDecoder1");s=t>>5&2047,a+=s,this.updatePointer(10-i),r===0&&(o=!1)}return a}decodeBlackCodeWord(){let e=0,t=0,i=0,r=0,n=-1,s=0,a=!1;for(;!a;)if(e=this.nextLesserThan8Bits(4),t=oe.INIT_BLACK[e],r=t&1,i=t>>1&15,n=t>>5&2047,n===100)if(e=this.nextNBits(9),t=oe.BLACK[e],r=t&1,i=t>>1&15,n=t>>5&2047,i===12)this.updatePointer(5),e=this.nextLesserThan8Bits(4),t=oe.ADDITIONAL_MAKEUP[e],i=t>>1&7,n=t>>4&4095,s+=n,this.updatePointer(4-i);else{if(i===15)throw new T("TIFFFaxDecoder2");s+=n,this.updatePointer(9-i),r===0&&(a=!0)}else n===200?(e=this.nextLesserThan8Bits(2),t=oe.TWO_BIT_BLACK[e],n=t>>5&2047,s+=n,i=t>>1&15,this.updatePointer(2-i),a=!0):(s+=n,this.updatePointer(4-i),a=!0);return s}decode1D(e,t,i,r){this.data=t,this.bitPointer=0,this.bytePointer=0;let n=0,s=Math.trunc((this._width+7)/8);for(let a=0;a<r;a++)this.decodeNextScanline(e,n,i),n+=s}decode2D(e,t,i,r,n){this.data=t,this.compression=3,this.bitPointer=0,this.bytePointer=0;let s=Math.trunc((this._width+7)/8),a=0,o=0,u=0,l=0,h=0,f=!1,c=0,p,g=new Array(2);if(g.fill(0),this.oneD=n&1,this.uncompressedMode=(n&2)>>1,this.fillBits=(n&4)>>2,this.readEOL()!==1)throw new T("TIFFFaxDecoder3");let b=0,x=0;this.decodeNextScanline(e,b,i),b+=s;for(let y=1;y<r;y++){if(this.readEOL()===0){for(p=this.prevChangingElems,this.prevChangingElems=this.currChangingElems,this.currChangingElems=p,c=0,a=-1,f=!0,x=i,this.lastChangingElement=0;x<this._width;){this.getNextChangingElement(a,f,g);let P=g[0],w=g[1];if(u=this.nextLesserThan8Bits(7),u=oe.TWO_D_CODES[u]&255,l=(u&120)>>3,h=u&7,l===0)f||this.setToBlack(e,b,x,w-x),a=w,x=a,this.updatePointer(7-h);else if(l===1){this.updatePointer(7-h);let M=0;f?(M=this.decodeWhiteCodeWord(),x+=M,this.currChangingElems[c++]=x,M=this.decodeBlackCodeWord(),this.setToBlack(e,b,x,M),x+=M,this.currChangingElems[c++]=x):(M=this.decodeBlackCodeWord(),this.setToBlack(e,b,x,M),x+=M,this.currChangingElems[c++]=x,M=this.decodeWhiteCodeWord(),x+=M,this.currChangingElems[c++]=x),a=x}else if(l<=8)o=P+(l-5),this.currChangingElems[c++]=o,f||this.setToBlack(e,b,x,o-x),a=o,x=a,f=!f,this.updatePointer(7-h);else throw new T("TIFFFaxDecoder4")}this.currChangingElems[c++]=x,this.changingElemSize=c}else this.decodeNextScanline(e,b,i);b+=s}}decodeT6(e,t,i,r,n){this.data=t,this.compression=4,this.bitPointer=0,this.bytePointer=0;let s=Math.trunc((this._width+7)/8),a=0,o=0,u=0,l=0,h=0,f=0,c=0,p=!1,g=0,b,x=new Array(2);x.fill(0),this.uncompressedMode=(n&2)>>1;let y=this.currChangingElems;this.changingElemSize=0,y[this.changingElemSize++]=this._width,y[this.changingElemSize++]=this._width;let P=0,w=0;for(let M=0;M<r;M++){for(a=-1,p=!0,b=this.prevChangingElems,this.prevChangingElems=this.currChangingElems,y=this.currChangingElems=b,g=0,w=i,this.lastChangingElement=0;w<this._width;)if(this.getNextChangingElement(a,p,x),u=x[0],l=x[1],h=this.nextLesserThan8Bits(7),h=oe.TWO_D_CODES[h]&255,f=(h&120)>>3,c=h&7,f===0)p||this.setToBlack(e,P,w,l-w),a=l,w=a,this.updatePointer(7-c);else if(f===1){this.updatePointer(7-c);let B=0;p?(B=this.decodeWhiteCodeWord(),w+=B,y[g++]=w,B=this.decodeBlackCodeWord(),this.setToBlack(e,P,w,B),w+=B,y[g++]=w):(B=this.decodeBlackCodeWord(),this.setToBlack(e,P,w,B),w+=B,y[g++]=w,B=this.decodeWhiteCodeWord(),w+=B,y[g++]=w),a=w}else if(f<=8)o=u+(f-5),y[g++]=o,p||this.setToBlack(e,P,w,o-w),a=o,w=a,p=!p,this.updatePointer(7-c);else if(f===11){if(this.nextLesserThan8Bits(3)!==7)throw new T("TIFFFaxDecoder5");let B=0,O=!1;for(;!O;){for(;this.nextLesserThan8Bits(1)!==1;)B++;B>5&&(B-=6,!p&&B>0&&(y[g++]=w),w+=B,B>0&&(p=!0),this.nextLesserThan8Bits(1)===0?(p||(y[g++]=w),p=!0):(p&&(y[g++]=w),p=!1),O=!0),B===5?(p||(y[g++]=w),w+=B,p=!0):(w+=B,y[g++]=w,this.setToBlack(e,P,w,1),++w,p=!1)}}else throw new T(`TIFFFaxDecoder5 ${f}`);y[g++]=w,this.changingElemSize=g,P+=s}}},Fe=oe;Fe.TABLE1=[0,1,3,7,15,31,63,127,255],Fe.TABLE2=[0,128,192,224,240,248,252,254,255],Fe.FLIP_TABLE=[0,-128,64,-64,32,-96,96,-32,16,-112,80,-48,48,-80,112,-16,8,-120,72,-56,40,-88,104,-24,24,-104,88,-40,56,-72,120,-8,4,-124,68,-60,36,-92,100,-28,20,-108,84,-44,52,-76,116,-12,12,-116,76,-52,44,-84,108,-20,28,-100,92,-36,60,-68,124,-4,2,-126,66,-62,34,-94,98,-30,18,-110,82,-46,50,-78,114,-14,10,-118,74,-54,42,-86,106,-22,26,-102,90,-38,58,-70,122,-6,6,-122,70,-58,38,-90,102,-26,22,-106,86,-42,54,-74,118,-10,14,-114,78,-50,46,-82,110,-18,30,-98,94,-34,62,-66,126,-2,1,-127,65,-63,33,-95,97,-31,17,-111,81,-47,49,-79,113,-15,9,-119,73,-55,41,-87,105,-23,25,-103,89,-39,57,-71,121,-7,5,-123,69,-59,37,-91,101,-27,21,-107,85,-43,53,-75,117,-11,13,-115,77,-51,45,-83,109,-19,29,-99,93,-35,61,-67,125,-3,3,-125,67,-61,35,-93,99,-29,19,-109,83,-45,51,-77,115,-13,11,-117,75,-53,43,-85,107,-21,27,-101,91,-37,59,-69,123,-5,7,-121,71,-57,39,-89,103,-25,23,-105,87,-41,55,-73,119,-9,15,-113,79,-49,47,-81,111,-17,31,-97,95,-33,63,-65,127,-1],Fe.WHITE=[6430,6400,6400,6400,3225,3225,3225,3225,944,944,944,944,976,976,976,976,1456,1456,1456,1456,1488,1488,1488,1488,718,718,718,718,718,718,718,718,750,750,750,750,750,750,750,750,1520,1520,1520,1520,1552,1552,1552,1552,428,428,428,428,428,428,428,428,428,428,428,428,428,428,428,428,654,654,654,654,654,654,654,654,1072,1072,1072,1072,1104,1104,1104,1104,1136,1136,1136,1136,1168,1168,1168,1168,1200,1200,1200,1200,1232,1232,1232,1232,622,622,622,622,622,622,622,622,1008,1008,1008,1008,1040,1040,1040,1040,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,396,396,396,396,396,396,396,396,396,396,396,396,396,396,396,396,1712,1712,1712,1712,1744,1744,1744,1744,846,846,846,846,846,846,846,846,1264,1264,1264,1264,1296,1296,1296,1296,1328,1328,1328,1328,1360,1360,1360,1360,1392,1392,1392,1392,1424,1424,1424,1424,686,686,686,686,686,686,686,686,910,910,910,910,910,910,910,910,1968,1968,1968,1968,2e3,2e3,2e3,2e3,2032,2032,2032,2032,16,16,16,16,10257,10257,10257,10257,12305,12305,12305,12305,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,878,878,878,878,878,878,878,878,1904,1904,1904,1904,1936,1936,1936,1936,-18413,-18413,-16365,-16365,-14317,-14317,-10221,-10221,590,590,590,590,590,590,590,590,782,782,782,782,782,782,782,782,1584,1584,1584,1584,1616,1616,1616,1616,1648,1648,1648,1648,1680,1680,1680,1680,814,814,814,814,814,814,814,814,1776,1776,1776,1776,1808,1808,1808,1808,1840,1840,1840,1840,1872,1872,1872,1872,6157,6157,6157,6157,6157,6157,6157,6157,6157,6157,6157,6157,6157,6157,6157,6157,-12275,-12275,-12275,-12275,-12275,-12275,-12275,-12275,-12275,-12275,-12275,-12275,-12275,-12275,-12275,-12275,14353,14353,14353,14353,16401,16401,16401,16401,22547,22547,24595,24595,20497,20497,20497,20497,18449,18449,18449,18449,26643,26643,28691,28691,30739,30739,-32749,-32749,-30701,-30701,-28653,-28653,-26605,-26605,-24557,-24557,-22509,-22509,-20461,-20461,8207,8207,8207,8207,8207,8207,8207,8207,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,524,524,524,524,524,524,524,524,524,524,524,524,524,524,524,524,556,556,556,556,556,556,556,556,556,556,556,556,556,556,556,556,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,460,460,460,460,460,460,460,460,460,460,460,460,460,460,460,460,492,492,492,492,492,492,492,492,492,492,492,492,492,492,492,492,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232],Fe.ADDITIONAL_MAKEUP=[28679,28679,31752,-32759,-31735,-30711,-29687,-28663,29703,29703,30727,30727,-27639,-26615,-25591,-24567],Fe.INIT_BLACK=[3226,6412,200,168,38,38,134,134,100,100,100,100,68,68,68,68],Fe.TWO_BIT_BLACK=[292,260,226,226],Fe.BLACK=[62,62,30,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,588,588,588,588,588,588,588,588,1680,1680,20499,22547,24595,26643,1776,1776,1808,1808,-24557,-22509,-20461,-18413,1904,1904,1936,1936,-16365,-14317,782,782,782,782,814,814,814,814,-12269,-10221,10257,10257,12305,12305,14353,14353,16403,18451,1712,1712,1744,1744,28691,30739,-32749,-30701,-28653,-26605,2061,2061,2061,2061,2061,2061,2061,2061,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,750,750,750,750,1616,1616,1648,1648,1424,1424,1456,1456,1488,1488,1520,1520,1840,1840,1872,1872,1968,1968,8209,8209,524,524,524,524,524,524,524,524,556,556,556,556,556,556,556,556,1552,1552,1584,1584,2e3,2e3,2032,2032,976,976,1008,1008,1040,1040,1072,1072,1296,1296,1328,1328,718,718,718,718,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,490,490,490,490,490,490,490,490,490,490,490,490,490,490,490,490,4113,4113,6161,6161,848,848,880,880,912,912,944,944,622,622,622,622,654,654,654,654,1104,1104,1136,1136,1168,1168,1200,1200,1232,1232,1264,1264,686,686,686,686,1360,1360,1392,1392,12,12,12,12,12,12,12,12,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390],Fe.TWO_D_CODES=[80,88,23,71,30,30,62,62,4,4,4,4,4,4,4,4,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41]});var Mr,It,Br=C(()=>{"use strict";ue();Mr=class{constructor(){this.buffer=new Uint8Array(4096);this.bitsToGet=9;this.bytePointer=0;this.nextData=0;this.nextBits=0}addString(e,t){this.table[this.tableIndex]=t,this.prefix[this.tableIndex]=e,this.tableIndex=this.tableIndex+1,this.tableIndex===511?this.bitsToGet=10:this.tableIndex===1023?this.bitsToGet=11:this.tableIndex===2047&&(this.bitsToGet=12)}getString(e){this.bufferLength=0;let t=e;for(this.buffer[this.bufferLength++]=this.table[t],t=this.prefix[t];t!==Mr.NO_SUCH_CODE;)this.buffer[this.bufferLength++]=this.table[t],t=this.prefix[t]}getNextCode(){if(this.bytePointer>=this.dataLength)return 257;for(;this.nextBits<this.bitsToGet;){if(this.bytePointer>=this.dataLength)return 257;this.nextData=(this.nextData<<8)+this.data[this.bytePointer++]&4294967295,this.nextBits+=8}return this.nextBits-=this.bitsToGet,this.nextData>>this.nextBits&Mr.AND_TABLE[this.bitsToGet-9]}initializeStringTable(){this.table=new Uint8Array(Mr.LZ_MAX_CODE+1),this.prefix=new Uint32Array(Mr.LZ_MAX_CODE+1),this.prefix.fill(Mr.NO_SUCH_CODE,0,this.prefix.length);for(let e=0;e<256;e++)this.table[e]=e;this.bitsToGet=9,this.tableIndex=258}decode(e,t){this.out=t;let i=t.length;if(this.outPointer=0,this.data=e.buffer,this.dataLength=this.data.length,this.bytePointer=e.offset,this.data[0]===0&&this.data[1]===1)throw new T("Invalid LZW Data");this.initializeStringTable(),this.nextData=0,this.nextBits=0;let r=0,n=this.getNextCode();for(;n!==257&&this.outPointer<i;){if(n===256){if(this.initializeStringTable(),n=this.getNextCode(),this.bufferLength=0,n===257)break;this.out[this.outPointer++]=n,r=n}else if(n<this.tableIndex){this.getString(n);for(let s=this.bufferLength-1;s>=0;--s)this.out[this.outPointer++]=this.buffer[s];this.addString(r,this.buffer[this.bufferLength-1]),r=n}else{this.getString(r);for(let s=this.bufferLength-1;s>=0;--s)this.out[this.outPointer++]=this.buffer[s];this.out[this.outPointer++]=this.buffer[this.bufferLength-1],this.addString(r,this.buffer[this.bufferLength-1]),r=n}n=this.getNextCode()}}},It=Mr;It.LZ_MAX_CODE=4095,It.NO_SUCH_CODE=4098,It.AND_TABLE=[511,1023,2047,4095]});var bn,I,S,kt=C(()=>{"use strict";bn=An(pn());je();ge();He();Qe();Ye();ue();pi();ft();Ut();Ai();Sr();Pi();Cr();Br();I=class{constructor(e){this._tags=new Map;this._width=0;this._height=0;this._compression=1;this._bitsPerSample=1;this._samplesPerPixel=1;this._sampleFormat=I.FORMAT_UINT;this._imageType=I.TYPE_UNSUPPORTED;this._isWhiteZero=!1;this._predictor=1;this._chromaSubH=0;this._chromaSubV=0;this._tiled=!1;this._tileWidth=0;this._tileHeight=0;this._tilesX=0;this._tilesY=0;this._fillOrder=1;this._t4Options=0;this._t6Options=0;this.colorMapRed=0;this.colorMapGreen=0;this.colorMapBlue=0;let t=G.from(e),i=e.readUint16();for(let r=0;r<i;++r){let n=e.readUint16(),s=e.readUint16(),a=e.readUint32(),o=new _e({tag:n,type:s,numValues:a,p:t});o.numValues*o.typeSize>4?o.valueOffset=e.readUint32():(o.valueOffset=e.offset,e.offset+=4),this._tags.set(o.tag,o),o.tag===I.TAG_IMAGE_WIDTH?this._width=o.readValue():o.tag===I.TAG_IMAGE_LENGTH?this._height=o.readValue():o.tag===I.TAG_PHOTOMETRIC_INTERPRETATION?this._photometricType=o.readValue():o.tag===I.TAG_COMPRESSION?this._compression=o.readValue():o.tag===I.TAG_BITS_PER_SAMPLE?this._bitsPerSample=o.readValue():o.tag===I.TAG_SAMPLES_PER_PIXEL?this._samplesPerPixel=o.readValue():o.tag===I.TAG_PREDICTOR?this._predictor=o.readValue():o.tag===I.TAG_SAMPLE_FORMAT?this._sampleFormat=o.readValue():o.tag===I.TAG_COLOR_MAP&&(this._colorMap=o.readValues(),this.colorMapRed=0,this.colorMapGreen=Math.trunc(this._colorMap.length/3),this.colorMapBlue=this.colorMapGreen*2)}if(!(this._width===0||this._height===0)){if(this._colorMap!==void 0&&this._bitsPerSample===8)for(let r=0,n=this._colorMap.length;r<n;++r)this._colorMap[r]>>=8;if(this._photometricType===0&&(this._isWhiteZero=!0),this.hasTag(I.TAG_TILE_OFFSETS))this._tiled=!0,this._tileWidth=this.readTag(I.TAG_TILE_WIDTH),this._tileHeight=this.readTag(I.TAG_TILE_LENGTH),this._tileOffsets=this.readTagList(I.TAG_TILE_OFFSETS),this._tileByteCounts=this.readTagList(I.TAG_TILE_BYTE_COUNTS);else{if(this._tiled=!1,this._tileWidth=this.readTag(I.TAG_TILE_WIDTH,this._width),!this.hasTag(I.TAG_ROWS_PER_STRIP))this._tileHeight=this.readTag(I.TAG_TILE_LENGTH,this._height);else{let r=this.readTag(I.TAG_ROWS_PER_STRIP),n=1;n=(n<<32)-1,r===n?this._tileHeight=this._height:this._tileHeight=r}this._tileOffsets=this.readTagList(I.TAG_STRIP_OFFSETS),this._tileByteCounts=this.readTagList(I.TAG_STRIP_BYTE_COUNTS)}switch(this._tilesX=Math.trunc((this._width+this._tileWidth-1)/this._tileWidth),this._tilesY=Math.trunc((this._height+this._tileHeight-1)/this._tileHeight),this._tileSize=this._tileWidth*this._tileHeight*this._samplesPerPixel,this._fillOrder=this.readTag(I.TAG_FILL_ORDER,1),this._t4Options=this.readTag(I.TAG_T4_OPTIONS),this._t6Options=this.readTag(I.TAG_T6_OPTIONS),this._extraSamples=this.readTag(I.TAG_EXTRA_SAMPLES),this._photometricType){case 0:case 1:this._bitsPerSample===1&&this._samplesPerPixel===1?this._imageType=I.TYPE_BILEVEL:this._bitsPerSample===4&&this._samplesPerPixel===1?this._imageType=I.TYPE_GRAY_4BIT:this._bitsPerSample%8===0&&(this._samplesPerPixel===1?this._imageType=I.TYPE_GRAY:this._samplesPerPixel===2?this._imageType=I.TYPE_GRAY_ALPHA:this._imageType=I.TYPE_GENERIC);break;case 2:this._bitsPerSample%8===0&&(this._samplesPerPixel===3?this._imageType=I.TYPE_RGB:this._samplesPerPixel===4?this._imageType=I.TYPE_RGB_ALPHA:this._imageType=I.TYPE_GENERIC);break;case 3:this._samplesPerPixel===1&&(this._bitsPerSample===4||this._bitsPerSample===8||this._bitsPerSample===16)&&(this._imageType=I.TYPE_PALETTE);break;case 4:this._bitsPerSample===1&&this._samplesPerPixel===1&&(this._imageType=I.TYPE_BILEVEL);break;case 6:if(this._compression===I.COMPRESSION_JPEG&&this._bitsPerSample===8&&this._samplesPerPixel===3)this._imageType=I.TYPE_RGB;else{if(this.hasTag(I.TAG_YCBCR_SUBSAMPLING)){let r=this._tags.get(I.TAG_YCBCR_SUBSAMPLING).readValues();this._chromaSubH=r[0],this._chromaSubV=r[1]}else this._chromaSubH=2,this._chromaSubV=2;this._chromaSubH*this._chromaSubV===1?this._imageType=I.TYPE_GENERIC:this._bitsPerSample===8&&this._samplesPerPixel===3&&(this._imageType=I.TYPE_YCBCR_SUB)}break;default:this._bitsPerSample%8===0&&(this._imageType=I.TYPE_GENERIC);break}}}get tags(){return this._tags}get width(){return this._width}get height(){return this._height}get photometricType(){return this._photometricType}get compression(){return this._compression}get bitsPerSample(){return this._bitsPerSample}get samplesPerPixel(){return this._samplesPerPixel}get sampleFormat(){return this._sampleFormat}get imageType(){return this._imageType}get isWhiteZero(){return this._isWhiteZero}get predictor(){return this._predictor}get chromaSubH(){return this._chromaSubH}get chromaSubV(){return this._chromaSubV}get tiled(){return this._tiled}get tileWidth(){return this._tileWidth}get tileHeight(){return this._tileHeight}get tileOffsets(){return this._tileOffsets}get tileByteCounts(){return this._tileByteCounts}get tilesX(){return this._tilesX}get tilesY(){return this._tilesY}get tileSize(){return this._tileSize}get fillOrder(){return this._fillOrder}get t4Options(){return this._t4Options}get t6Options(){return this._t6Options}get extraSamples(){return this._extraSamples}get colorMap(){return this._colorMap}get isValid(){return this._width!==0&&this._height!==0}readTag(e,t=0){return this.hasTag(e)?this._tags.get(e).readValue():t}readTagList(e){if(!!this.hasTag(e))return this._tags.get(e).readValues()}decodeBilevelTile(e,t,i){let r=i*this._tilesX+t;e.offset=this._tileOffsets[r];let n=t*this._tileWidth,s=i*this._tileHeight,a=this._tileByteCounts[r],o;if(this._compression===I.COMPRESSION_PACKBITS){let c=0;this._tileWidth%8===0?c=Math.trunc(this._tileWidth/8)*this._tileHeight:c=(Math.trunc(this._tileWidth/8)+1)*this._tileHeight,o=new G({buffer:new Uint8Array(this._tileWidth*this._tileHeight)}),this.decodePackbits(e,c,o.buffer)}else if(this._compression===I.COMPRESSION_LZW){if(o=new G({buffer:new Uint8Array(this._tileWidth*this._tileHeight)}),new It().decode(G.from(e,0,a),o.buffer),this._predictor===2){let p=0;for(let g=0;g<this._height;g++){p=this._samplesPerPixel*(g*this._width+1);for(let b=this._samplesPerPixel;b<this._width*this._samplesPerPixel;b++){let x=o.getByte(p)+o.getByte(p-this._samplesPerPixel);o.setByte(p,x),p++}}}}else if(this._compression===I.COMPRESSION_CCITT_RLE){o=new G({buffer:new Uint8Array(this._tileWidth*this._tileHeight)});try{new Fe({fillOrder:this._fillOrder,width:this._tileWidth,height:this._tileHeight}).decode1D(o,e,0,this._tileHeight)}catch(c){}}else if(this._compression===I.COMPRESSION_CCITT_FAX3){o=new G({buffer:new Uint8Array(this._tileWidth*this._tileHeight)});try{new Fe({fillOrder:this._fillOrder,width:this._tileWidth,height:this._tileHeight}).decode2D(o,e,0,this._tileHeight,this._t4Options)}catch(c){}}else if(this._compression===I.COMPRESSION_CCITT_FAX4){o=new G({buffer:new Uint8Array(this._tileWidth*this._tileHeight)});try{new Fe({fillOrder:this._fillOrder,width:this._tileWidth,height:this._tileHeight}).decodeT6(o,e,0,this._tileHeight,this._t6Options)}catch(c){}}else if(this._compression===I.COMPRESSION_ZIP){let c=e.toUint8Array(0,a),p=(0,bn.inflate)(c);o=new G({buffer:p})}else if(this._compression===I.COMPRESSION_DEFLATE){let c=e.toUint8Array(0,a),p=(0,bn.inflate)(c);o=new G({buffer:p})}else if(this._compression===I.COMPRESSION_NONE)o=e;else throw new T(`Unsupported Compression Type: ${this._compression}`);let u=new vi(o),l=this._isWhiteZero?4278190080:4294967295,h=this._isWhiteZero?4294967295:4278190080,f=this.image;for(let c=0,p=s;c<this._tileHeight;++c,++p){for(let g=0,b=n;g<this._tileWidth&&!(p>=f.height||b>=f.width);++g,++b)u.readBits(1)===0?f.setPixel(b,p,h):f.setPixel(b,p,l);u.flushByte()}}decodeTile(e,t,i){var l;if(this._imageType===I.TYPE_BILEVEL){this.decodeBilevelTile(e,t,i);return}let r=i*this._tilesX+t;e.offset=this._tileOffsets[r];let n=t*this._tileWidth,s=i*this._tileHeight,a=this._tileByteCounts[r],o=this._tileWidth*this._tileHeight*this._samplesPerPixel;this._bitsPerSample===16?o*=2:this._bitsPerSample===32&&(o*=4);let u;if(this._bitsPerSample===8||this._bitsPerSample===16||this._bitsPerSample===32||this._bitsPerSample===64){if(this._compression===I.COMPRESSION_NONE)u=e;else if(this._compression===I.COMPRESSION_LZW){u=new G({buffer:new Uint8Array(o)});let h=new It;try{h.decode(G.from(e,0,a),u.buffer)}catch(f){console.error(f)}if(this._predictor===2){let f=0;for(let c=0;c<this._tileHeight;c++){f=this._samplesPerPixel*(c*this._tileWidth+1);for(let p=this._samplesPerPixel,g=this._tileWidth*this._samplesPerPixel;p<g;p++){let b=u.getByte(f)+u.getByte(f-this._samplesPerPixel);u.setByte(f,b),f++}}}}else if(this._compression===I.COMPRESSION_PACKBITS)u=new G({buffer:new Uint8Array(o)}),this.decodePackbits(e,o,u.buffer);else if(this._compression===I.COMPRESSION_DEFLATE){let h=e.toUint8Array(0,a),f=(0,bn.inflate)(h);u=new G({buffer:f})}else if(this._compression===I.COMPRESSION_ZIP){let h=e.toUint8Array(0,a),f=(0,bn.inflate)(h);u=new G({buffer:f})}else if(this._compression===I.COMPRESSION_OLD_JPEG){(l=this.image)!=null||(this.image=new W({width:this._width,height:this._height}));let h=e.toUint8Array(0,a),f=new Ii().decodeImage(h);f!==void 0&&this.jpegToImage(f,this.image,n,s,this._tileWidth,this._tileHeight),this.hdrImage!==void 0&&(this.hdrImage=de.fromImage(this.image));return}else throw new T(`Unsupported Compression Type: ${this._compression}`);for(let h=0,f=s;h<this._tileHeight&&f<this._height;++h,++f)for(let c=0,p=n;c<this._tileWidth&&p<this._width;++c,++p)if(this._samplesPerPixel===1)if(this._sampleFormat===I.FORMAT_FLOAT){let g=0;if(this._bitsPerSample===32?g=u.readFloat32():this._bitsPerSample===64?g=u.readFloat64():this._bitsPerSample===16&&(g=Ne.halfToDouble(u.readUint16())),this.hdrImage!==void 0&&this.hdrImage.setRed(p,f,g),this.image!==void 0){let b=F.clampInt255(g*255),x=0;this._photometricType===3&&this._colorMap!==void 0?x=d.getColor(this._colorMap[this.colorMapRed+b],this._colorMap[this.colorMapGreen+b],this._colorMap[this.colorMapBlue+b]):x=d.getColor(b,b,b),this.image.setPixel(p,f,x)}}else{let g=0;if(this._bitsPerSample===8?g=this._sampleFormat===I.FORMAT_INT?u.readInt8():u.readByte():this._bitsPerSample===16?g=this._sampleFormat===I.FORMAT_INT?u.readInt16():u.readUint16():this._bitsPerSample===32&&(g=this._sampleFormat===I.FORMAT_INT?u.readInt32():u.readUint32()),this.hdrImage!==void 0&&this.hdrImage.setRed(p,f,g),this.image!==void 0){g=this._bitsPerSample===16?g>>8:this._bitsPerSample===32?g>>24:g,this._photometricType===0&&(g=255-g);let b=0;this._photometricType===3&&this._colorMap!==void 0?b=d.getColor(this._colorMap[this.colorMapRed+g],this._colorMap[this.colorMapGreen+g],this._colorMap[this.colorMapBlue+g]):b=d.getColor(g,g,g),this.image.setPixel(p,f,b)}}else if(this._samplesPerPixel===2){let g=0,b=0;if(this._bitsPerSample===8?(g=this._sampleFormat===I.FORMAT_INT?u.readInt8():u.readByte(),b=this._sampleFormat===I.FORMAT_INT?u.readInt8():u.readByte()):this._bitsPerSample===16?(g=this._sampleFormat===I.FORMAT_INT?u.readInt16():u.readUint16(),b=this._sampleFormat===I.FORMAT_INT?u.readInt16():u.readUint16()):this._bitsPerSample===32&&(g=this._sampleFormat===I.FORMAT_INT?u.readInt32():u.readUint32(),b=this._sampleFormat===I.FORMAT_INT?u.readInt32():u.readUint32()),this.hdrImage!==void 0&&(this.hdrImage.setRed(p,f,g),this.hdrImage.setGreen(p,f,b)),this.image!==void 0){g=this._bitsPerSample===16?g>>8:this._bitsPerSample===32?g>>24:g,b=this._bitsPerSample===16?b>>8:this._bitsPerSample===32?b>>24:b;let x=d.getColor(g,g,g,b);this.image.setPixel(p,f,x)}}else if(this._samplesPerPixel===3)if(this._sampleFormat===I.FORMAT_FLOAT){let g=0,b=0,x=0;if(this._bitsPerSample===32?(g=u.readFloat32(),b=u.readFloat32(),x=u.readFloat32()):this._bitsPerSample===64?(g=u.readFloat64(),b=u.readFloat64(),x=u.readFloat64()):this._bitsPerSample===16&&(g=Ne.halfToDouble(u.readUint16()),b=Ne.halfToDouble(u.readUint16()),x=Ne.halfToDouble(u.readUint16())),this.hdrImage!==void 0&&(this.hdrImage.setRed(p,f,g),this.hdrImage.setGreen(p,f,b),this.hdrImage.setBlue(p,f,x)),this.image!==void 0){let y=F.clampInt255(g*255),P=F.clampInt255(b*255),w=F.clampInt255(x*255),M=d.getColor(y,P,w);this.image.setPixel(p,f,M)}}else{let g=0,b=0,x=0;if(this._bitsPerSample===8?(g=this._sampleFormat===I.FORMAT_INT?u.readInt8():u.readByte(),b=this._sampleFormat===I.FORMAT_INT?u.readInt8():u.readByte(),x=this._sampleFormat===I.FORMAT_INT?u.readInt8():u.readByte()):this._bitsPerSample===16?(g=this._sampleFormat===I.FORMAT_INT?u.readInt16():u.readUint16(),b=this._sampleFormat===I.FORMAT_INT?u.readInt16():u.readUint16(),x=this._sampleFormat===I.FORMAT_INT?u.readInt16():u.readUint16()):this._bitsPerSample===32&&(g=this._sampleFormat===I.FORMAT_INT?u.readInt32():u.readUint32(),b=this._sampleFormat===I.FORMAT_INT?u.readInt32():u.readUint32(),x=this._sampleFormat===I.FORMAT_INT?u.readInt32():u.readUint32()),this.hdrImage!==void 0&&(this.hdrImage.setRed(p,f,g),this.hdrImage.setGreen(p,f,b),this.hdrImage.setBlue(p,f,x)),this.image!==void 0){g=this._bitsPerSample===16?g>>8:this._bitsPerSample===32?g>>24:g,b=this._bitsPerSample===16?b>>8:this._bitsPerSample===32?b>>24:b,x=this._bitsPerSample===16?x>>8:this._bitsPerSample===32?x>>24:x;let y=d.getColor(g,b,x);this.image.setPixel(p,f,y)}}else if(this._samplesPerPixel>=4)if(this._sampleFormat===I.FORMAT_FLOAT){let g=0,b=0,x=0,y=0;if(this._bitsPerSample===32?(g=u.readFloat32(),b=u.readFloat32(),x=u.readFloat32(),y=u.readFloat32()):this._bitsPerSample===64?(g=u.readFloat64(),b=u.readFloat64(),x=u.readFloat64(),y=u.readFloat64()):this._bitsPerSample===16&&(g=Ne.halfToDouble(u.readUint16()),b=Ne.halfToDouble(u.readUint16()),x=Ne.halfToDouble(u.readUint16()),y=Ne.halfToDouble(u.readUint16())),this.hdrImage!==void 0&&(this.hdrImage.setRed(p,f,g),this.hdrImage.setGreen(p,f,b),this.hdrImage.setBlue(p,f,x),this.hdrImage.setAlpha(p,f,y)),this.image!==void 0){let P=F.clampInt255(g*255),w=F.clampInt255(b*255),M=F.clampInt255(x*255),B=F.clampInt255(y*255),O=d.getColor(P,w,M,B);this.image.setPixel(p,f,O)}}else{let g=0,b=0,x=0,y=0;if(this._bitsPerSample===8?(g=this._sampleFormat===I.FORMAT_INT?u.readInt8():u.readByte(),b=this._sampleFormat===I.FORMAT_INT?u.readInt8():u.readByte(),x=this._sampleFormat===I.FORMAT_INT?u.readInt8():u.readByte(),y=this._sampleFormat===I.FORMAT_INT?u.readInt8():u.readByte()):this._bitsPerSample===16?(g=this._sampleFormat===I.FORMAT_INT?u.readInt16():u.readUint16(),b=this._sampleFormat===I.FORMAT_INT?u.readInt16():u.readUint16(),x=this._sampleFormat===I.FORMAT_INT?u.readInt16():u.readUint16(),y=this._sampleFormat===I.FORMAT_INT?u.readInt16():u.readUint16()):this._bitsPerSample===32&&(g=this._sampleFormat===I.FORMAT_INT?u.readInt32():u.readUint32(),b=this._sampleFormat===I.FORMAT_INT?u.readInt32():u.readUint32(),x=this._sampleFormat===I.FORMAT_INT?u.readInt32():u.readUint32(),y=this._sampleFormat===I.FORMAT_INT?u.readInt32():u.readUint32()),this.hdrImage!==void 0&&(this.hdrImage.setRed(p,f,g),this.hdrImage.setGreen(p,f,b),this.hdrImage.setBlue(p,f,x),this.hdrImage.setAlpha(p,f,y)),this.image!==void 0){g=this._bitsPerSample===16?g>>8:this._bitsPerSample===32?g>>24:g,b=this._bitsPerSample===16?b>>8:this._bitsPerSample===32?b>>24:b,x=this._bitsPerSample===16?x>>8:this._bitsPerSample===32?x>>24:x,y=this._bitsPerSample===16?y>>8:this._bitsPerSample===32?y>>24:y;let P=d.getColor(g,b,x,y);this.image.setPixel(p,f,P)}}}else throw new T(`Unsupported bitsPerSample: ${this._bitsPerSample}`)}jpegToImage(e,t,i,r,n,s){let a=n,o=s;for(let u=0;u<o;u++)for(let l=0;l<a;l++)t.setPixel(l+i,u+r,e.getPixel(l,u))}decodePackbits(e,t,i){let r=0,n=0;for(;n<t;){let s=E.toInt8(e.getByte(r++));if(s>=0&&s<=127)for(let a=0;a<s+1;++a)i[n++]=e.getByte(r++);else if(s<=-1&&s>=-127){let a=e.getByte(r++);for(let o=0;o<-s+1;++o)i[n++]=a}else r++}}decode(e){this.image=new W({width:this._width,height:this._height});for(let t=0,i=0;t<this._tilesY;++t)for(let r=0;r<this._tilesX;++r,++i)this.decodeTile(e,r,t);return this.image}decodeHdr(e){this.hdrImage=de.create(this._width,this._height,this._samplesPerPixel,this._sampleFormat===I.FORMAT_UINT?ye.UINT:this._sampleFormat===I.FORMAT_INT?ye.INT:ye.FLOAT,this._bitsPerSample);for(let t=0,i=0;t<this._tilesY;++t)for(let r=0;r<this._tilesX;++r,++i)this.decodeTile(e,r,t);return this.hdrImage}hasTag(e){return this._tags.has(e)}},S=I;S.COMPRESSION_NONE=1,S.COMPRESSION_CCITT_RLE=2,S.COMPRESSION_CCITT_FAX3=3,S.COMPRESSION_CCITT_FAX4=4,S.COMPRESSION_LZW=5,S.COMPRESSION_OLD_JPEG=6,S.COMPRESSION_JPEG=7,S.COMPRESSION_NEXT=32766,S.COMPRESSION_CCITT_RLEW=32771,S.COMPRESSION_PACKBITS=32773,S.COMPRESSION_THUNDERSCAN=32809,S.COMPRESSION_IT8CTPAD=32895,S.COMPRESSION_IT8LW=32896,S.COMPRESSION_IT8MP=32897,S.COMPRESSION_IT8BL=32898,S.COMPRESSION_PIXARFILM=32908,S.COMPRESSION_PIXARLOG=32909,S.COMPRESSION_DEFLATE=32946,S.COMPRESSION_ZIP=8,S.COMPRESSION_DCS=32947,S.COMPRESSION_JBIG=34661,S.COMPRESSION_SGILOG=34676,S.COMPRESSION_SGILOG24=34677,S.COMPRESSION_JP2000=34712,S.PHOTOMETRIC_BLACKISZERO=1,S.PHOTOMETRIC_RGB=2,S.TYPE_UNSUPPORTED=-1,S.TYPE_BILEVEL=0,S.TYPE_GRAY_4BIT=1,S.TYPE_GRAY=2,S.TYPE_GRAY_ALPHA=3,S.TYPE_PALETTE=4,S.TYPE_RGB=5,S.TYPE_RGB_ALPHA=6,S.TYPE_YCBCR_SUB=7,S.TYPE_GENERIC=8,S.FORMAT_UINT=1,S.FORMAT_INT=2,S.FORMAT_FLOAT=3,S.TAG_ARTIST=315,S.TAG_BITS_PER_SAMPLE=258,S.TAG_CELL_LENGTH=265,S.TAG_CELL_WIDTH=264,S.TAG_COLOR_MAP=320,S.TAG_COMPRESSION=259,S.TAG_DATE_TIME=306,S.TAG_EXIF_IFD=34665,S.TAG_EXTRA_SAMPLES=338,S.TAG_FILL_ORDER=266,S.TAG_FREE_BYTE_COUNTS=289,S.TAG_FREE_OFFSETS=288,S.TAG_GRAY_RESPONSE_CURVE=291,S.TAG_GRAY_RESPONSE_UNIT=290,S.TAG_HOST_COMPUTER=316,S.TAG_ICC_PROFILE=34675,S.TAG_IMAGE_DESCRIPTION=270,S.TAG_IMAGE_LENGTH=257,S.TAG_IMAGE_WIDTH=256,S.TAG_IPTC=33723,S.TAG_MAKE=271,S.TAG_MAX_SAMPLE_VALUE=281,S.TAG_MIN_SAMPLE_VALUE=280,S.TAG_MODEL=272,S.TAG_NEW_SUBFILE_TYPE=254,S.TAG_ORIENTATION=274,S.TAG_PHOTOMETRIC_INTERPRETATION=262,S.TAG_PHOTOSHOP=34377,S.TAG_PLANAR_CONFIGURATION=284,S.TAG_PREDICTOR=317,S.TAG_RESOLUTION_UNIT=296,S.TAG_ROWS_PER_STRIP=278,S.TAG_SAMPLES_PER_PIXEL=277,S.TAG_SOFTWARE=305,S.TAG_STRIP_BYTE_COUNTS=279,S.TAG_STRIP_OFFSETS=273,S.TAG_SUBFILE_TYPE=255,S.TAG_T4_OPTIONS=292,S.TAG_T6_OPTIONS=293,S.TAG_THRESHOLDING=263,S.TAG_TILE_WIDTH=322,S.TAG_TILE_LENGTH=323,S.TAG_TILE_OFFSETS=324,S.TAG_TILE_BYTE_COUNTS=325,S.TAG_SAMPLE_FORMAT=339,S.TAG_XMP=700,S.TAG_X_RESOLUTION=282,S.TAG_Y_RESOLUTION=283,S.TAG_YCBCR_COEFFICIENTS=529,S.TAG_YCBCR_SUBSAMPLING=530,S.TAG_YCBCR_POSITIONING=531,S.TAG_NAME=new Map([[I.TAG_ARTIST,"artist"],[I.TAG_BITS_PER_SAMPLE,"bitsPerSample"],[I.TAG_CELL_LENGTH,"cellLength"],[I.TAG_CELL_WIDTH,"cellWidth"],[I.TAG_COLOR_MAP,"colorMap"],[I.TAG_COMPRESSION,"compression"],[I.TAG_DATE_TIME,"dateTime"],[I.TAG_EXIF_IFD,"exifIFD"],[I.TAG_EXTRA_SAMPLES,"extraSamples"],[I.TAG_FILL_ORDER,"fillOrder"],[I.TAG_FREE_BYTE_COUNTS,"freeByteCounts"],[I.TAG_FREE_OFFSETS,"freeOffsets"],[I.TAG_GRAY_RESPONSE_CURVE,"grayResponseCurve"],[I.TAG_GRAY_RESPONSE_UNIT,"grayResponseUnit"],[I.TAG_HOST_COMPUTER,"hostComputer"],[I.TAG_ICC_PROFILE,"iccProfile"],[I.TAG_IMAGE_DESCRIPTION,"imageDescription"],[I.TAG_IMAGE_LENGTH,"imageLength"],[I.TAG_IMAGE_WIDTH,"imageWidth"],[I.TAG_IPTC,"iptc"],[I.TAG_MAKE,"make"],[I.TAG_MAX_SAMPLE_VALUE,"maxSampleValue"],[I.TAG_MIN_SAMPLE_VALUE,"minSampleValue"],[I.TAG_MODEL,"model"],[I.TAG_NEW_SUBFILE_TYPE,"newSubfileType"],[I.TAG_ORIENTATION,"orientation"],[I.TAG_PHOTOMETRIC_INTERPRETATION,"photometricInterpretation"],[I.TAG_PHOTOSHOP,"photoshop"],[I.TAG_PLANAR_CONFIGURATION,"planarConfiguration"],[I.TAG_PREDICTOR,"predictor"],[I.TAG_RESOLUTION_UNIT,"resolutionUnit"],[I.TAG_ROWS_PER_STRIP,"rowsPerStrip"],[I.TAG_SAMPLES_PER_PIXEL,"samplesPerPixel"],[I.TAG_SOFTWARE,"software"],[I.TAG_STRIP_BYTE_COUNTS,"stripByteCounts"],[I.TAG_STRIP_OFFSETS,"stropOffsets"],[I.TAG_SUBFILE_TYPE,"subfileType"],[I.TAG_T4_OPTIONS,"t4Options"],[I.TAG_T6_OPTIONS,"t6Options"],[I.TAG_THRESHOLDING,"thresholding"],[I.TAG_TILE_WIDTH,"tileWidth"],[I.TAG_TILE_LENGTH,"tileLength"],[I.TAG_TILE_OFFSETS,"tileOffsets"],[I.TAG_TILE_BYTE_COUNTS,"tileByteCounts"],[I.TAG_XMP,"xmp"],[I.TAG_X_RESOLUTION,"xResolution"],[I.TAG_Y_RESOLUTION,"yResolution"],[I.TAG_YCBCR_COEFFICIENTS,"yCbCrCoefficients"],[I.TAG_YCBCR_SUBSAMPLING,"yCbCrSubsampling"],[I.TAG_YCBCR_POSITIONING,"yCbCrPositioning"],[I.TAG_SAMPLE_FORMAT,"sampleFormat"]])});var Tr,Er=C(()=>{"use strict";Tr=class{constructor(e){this._images=[];this._width=0;this._height=0;this._backgroundColor=4294967295;this._bigEndian=e.bigEndian,this._signature=e.signature,this._ifdOffset=e.ifdOffset,this._images=e.images,this._images.length>0&&(this._width=this._images[0].width,this._height=this._images[0].height)}get bigEndian(){return this._bigEndian}get signature(){return this._signature}get ifdOffset(){return this._ifdOffset}get images(){return this._images}get width(){return this._width}get height(){return this._height}get backgroundColor(){throw this._backgroundColor}get numFrames(){return this._images.length}}});var Yr,Gt,Or=C(()=>{"use strict";bt();Xt();He();wt();kt();Er();Yr=class{constructor(){this._info=void 0;this._exifData=void 0}get info(){return this._info}get exifData(){return this._exifData}get numFrames(){return this._info!==void 0?this._info.images.length:0}readHeader(e){let t=e.readUint16();if(t!==Yr.TIFF_LITTLE_ENDIAN&&t!==Yr.TIFF_BIG_ENDIAN)return;let i=!1;t===Yr.TIFF_BIG_ENDIAN?(e.bigEndian=!0,i=!0):(e.bigEndian=!1,i=!1);let r=0;if(r=e.readUint16(),r!==Yr.TIFF_SIGNATURE)return;let n=e.readUint32(),s=G.from(e);s.offset=n;let a=[];for(;n!==0;){let o;try{if(o=new S(s),!o.isValid)break}catch(u){break}a.push(o),n=s.readUint32(),n!==0&&(s.offset=n)}return a.length>0?new Tr({bigEndian:i,signature:r,ifdOffset:n,images:a}):void 0}isValidFile(e){let t=new G({buffer:e});return this.readHeader(t)!==void 0}startDecode(e){if(this.input=new G({buffer:e}),this._info=this.readHeader(this.input),this.info!==void 0){let t=new G({buffer:e});this._exifData=Ae.fromInputBuffer(t)}return this._info}decodeFrame(e){if(this._info===void 0)return;let t=this._info.images[e].decode(this.input);return this._exifData!==void 0&&(t.exifData=this._exifData),t}decodeHdrFrame(e){if(this._info!==void 0)return this._info.images[e].decodeHdr(this.input)}decodeAnimation(e){if(this.startDecode(e)===void 0)return;let t=new Xe({width:this._info.width,height:this._info.height,frameType:1});for(let i=0,r=this.numFrames;i<r;++i){let n=this.decodeFrame(i);t.addFrame(n)}return t}decodeImage(e,t=0){if(this.input=new G({buffer:e}),this._info=this.readHeader(this.input),this._info===void 0)return;let i=this._info.images[t].decode(this.input),r=new G({buffer:e});return i.exifData=Ae.fromInputBuffer(r),i}decodeHdrImage(e,t=0){if(this.input=new G({buffer:e}),this._info=this.readHeader(this.input),this._info===void 0)return;let i=this._info.images[t].decodeHdr(this.input),r=new G({buffer:e});return i.exifData=Ae.fromInputBuffer(r),i}},Gt=Yr;Gt.TIFF_SIGNATURE=42,Gt.TIFF_LITTLE_ENDIAN=18761,Gt.TIFF_BIG_ENDIAN=19789});var Nn,Si,Ur=C(()=>{"use strict";st();Ut();Pi();kt();Nn=class{constructor(){this._supportsAnimation=!1}get supportsAnimation(){return this._supportsAnimation}writeHeader(e){e.writeUint16(Nn.LITTLE_ENDIAN),e.writeUint16(Nn.SIGNATURE),e.writeUint32(8)}writeImage(e,t){e.writeUint16(11),this.writeEntryUint32(e,S.TAG_IMAGE_WIDTH,t.width),this.writeEntryUint32(e,S.TAG_IMAGE_LENGTH,t.height),this.writeEntryUint16(e,S.TAG_BITS_PER_SAMPLE,8),this.writeEntryUint16(e,S.TAG_COMPRESSION,S.COMPRESSION_NONE),this.writeEntryUint16(e,S.TAG_PHOTOMETRIC_INTERPRETATION,S.PHOTOMETRIC_RGB),this.writeEntryUint16(e,S.TAG_SAMPLES_PER_PIXEL,4),this.writeEntryUint16(e,S.TAG_SAMPLE_FORMAT,S.FORMAT_UINT),this.writeEntryUint32(e,S.TAG_ROWS_PER_STRIP,t.height),this.writeEntryUint16(e,S.TAG_PLANAR_CONFIGURATION,1),this.writeEntryUint32(e,S.TAG_STRIP_BYTE_COUNTS,t.width*t.height*4),this.writeEntryUint32(e,S.TAG_STRIP_OFFSETS,e.length+4),e.writeBytes(t.getBytes())}writeHdrImage(e,t){e.writeUint16(11),this.writeEntryUint32(e,S.TAG_IMAGE_WIDTH,t.width),this.writeEntryUint32(e,S.TAG_IMAGE_LENGTH,t.height),this.writeEntryUint16(e,S.TAG_BITS_PER_SAMPLE,t.bitsPerSample),this.writeEntryUint16(e,S.TAG_COMPRESSION,S.COMPRESSION_NONE),this.writeEntryUint16(e,S.TAG_PHOTOMETRIC_INTERPRETATION,t.numberOfChannels===1?S.PHOTOMETRIC_BLACKISZERO:S.PHOTOMETRIC_RGB),this.writeEntryUint16(e,S.TAG_SAMPLES_PER_PIXEL,t.numberOfChannels),this.writeEntryUint16(e,S.TAG_SAMPLE_FORMAT,this.getSampleFormat(t));let i=Math.trunc(t.bitsPerSample/8),r=t.width*t.height*t.slices.size*i;this.writeEntryUint32(e,S.TAG_ROWS_PER_STRIP,t.height),this.writeEntryUint16(e,S.TAG_PLANAR_CONFIGURATION,1),this.writeEntryUint32(e,S.TAG_STRIP_BYTE_COUNTS,r),this.writeEntryUint32(e,S.TAG_STRIP_OFFSETS,e.length+4);let n=[];t.blue!==void 0&&n.push(t.blue.getBytes()),t.red!==void 0&&n.push(t.red.getBytes()),t.green!==void 0&&n.push(t.green.getBytes()),t.alpha!==void 0&&n.push(t.alpha.getBytes()),t.depth!==void 0&&n.push(t.depth.getBytes());for(let s=0,a=0;s<t.height;++s)for(let o=0;o<t.width;++o,a+=i)for(let u=0;u<n.length;++u){let l=n[u];for(let h=0;h<i;++h)e.writeByte(l[a+h])}}getSampleFormat(e){switch(e.sampleFormat){case ye.UINT:return S.FORMAT_UINT;case ye.INT:return S.FORMAT_INT}return S.FORMAT_FLOAT}writeEntryUint16(e,t,i){e.writeUint16(t),e.writeUint16(_e.TYPE_SHORT),e.writeUint32(1),e.writeUint16(i),e.writeUint16(0)}writeEntryUint32(e,t,i){e.writeUint16(t),e.writeUint16(_e.TYPE_LONG),e.writeUint32(1),e.writeUint32(i)}encodeImage(e){let t=new he;return this.writeHeader(t),this.writeImage(t,e),t.writeUint32(0),t.getBytes()}encodeAnimation(e){}encodeHdrImage(e){let t=new he;return this.writeHeader(t),this.writeHdrImage(t,e),t.writeUint32(0),t.getBytes()}},Si=Nn;Si.LITTLE_ENDIAN=18761,Si.SIGNATURE=42});var zr=C(()=>{"use strict";Qe();Ye();ue()});var gn=C(()=>{"use strict"});var xn=C(()=>{"use strict"});var Fr=C(()=>{"use strict"});var Rr,At,Dr=C(()=>{"use strict";Rr=class{constructor(...e){this.value=0;for(let t of e)this.value|=typeof t=="number"?t:t.value}has(e){return(this.value&e.value)!==0}},At=Rr;At.top=new Rr(1),At.bottom=new Rr(2),At.left=new Rr(4),At.right=new Rr(8),At.all=new Rr(15)});var Wr=C(()=>{"use strict";Ye();Ve();Et();Fr();Dr();Ft();ge()});var yn=C(()=>{"use strict";gi();zi();Ki();ji();nr();sr();Ai();Ir();_i();wi();vr();Pr();Or();Ur();ut();je();Ht();Vt();Ci();ge();Yt();zt();Wt();Mi();bt();Xt();Ti();rr();qt();He();Zt();Ei();Qe();Ye();hi();Ri();Di();st();di();Li();vt();Et();Ve();xt();mi();Qt();Jt();ei();ti();ii();ri();ni();si();ai();oi();ui();li();Ce();wt();Ui();$t();Kt();jt();Ie();Gr();Ni();ki();Gi();Vi();gi();zi();Ki();ji();nr();sr();Ai();Ir();_i();wi();vr();Pr();Or();Ur();Yi();Mt();bi();xi();qi();$i();Qi();Ji();er();or();lr();fr();wr();cr();dr();pr();gr();xr();_r();Dt();tr();ir();Ar();Sr();Pi();Cr();kt();Er();Br();pi();ft();Ut();zr();Wi();Ft();Fr();Dr();Wr()});var pn=Ms((Qm,us)=>{ut();je();Ht();Vt();Ci();ge();Yt();zt();Wt();Mi();bt();Xt();Ti();rr();qt();He();Zt();Ei();Qe();Ye();hi();Ri();Di();st();di();Qr();Li();vt();Et();Ve();xt();Jr();en();tn();mi();rn();nn();ue();Ot();wt();Ui();$t();Kt();jt();Ie();Qt();Jt();ei();ti();ii();ri();ni();si();ai();oi();ui();li();Ce();sn();an();on();Gr();Ni();ki();Gi();un();ln();Vi();hn();gi();zi();Yi();Mt();bi();cn();dn();Hr();mn();Ki();ji();xi();qi();$i();nr();sr();Qi();Ji();er();Ai();Ir();or();lr();fr();wr();cr();dr();pr();gr();xr();_r();Dt();_i();wi();tr();ir();vr();Pr();Ar();Or();Ur();Sr();Pi();Cr();kt();Er();Br();Vr();pi();ft();Ut();zr();yn();gn();xn();Wi();Ft();Fr();Dr();Wr();var v={};typeof us=="object"&&(us.exports=v);v.parse=function(m,e){for(var t=v.bin.readUshort,i=v.bin.readUint,a=0,r={},n=new Uint8Array(m),s=n.length-4;i(n,s)!=101010256;)s--;var a=s;a+=4,a+=4;var o=t(n,a);a+=2;var u=t(n,a);a+=2;var l=i(n,a);a+=4;var h=i(n,a);a+=4,a=h;for(var f=0;f<o;f++){var c=i(n,a);a+=4,a+=4,a+=4,a+=4;var p=i(n,a);a+=4;var l=i(n,a);a+=4;var g=i(n,a);a+=4;var b=t(n,a),x=t(n,a+2),y=t(n,a+4);a+=6,a+=8;var P=i(n,a);a+=4,a+=b+x+y,v._readLocal(n,P,r,l,g,e)}return r};v._readLocal=function(m,e,t,i,r,n){var s=v.bin.readUshort,a=v.bin.readUint,o=a(m,e);e+=4;var u=s(m,e);e+=2;var l=s(m,e);e+=2;var h=s(m,e);e+=2;var f=a(m,e);e+=4;var c=a(m,e);e+=4,e+=8;var p=s(m,e);e+=2;var g=s(m,e);e+=2;var b=v.bin.readUTF8(m,e,p);if(e+=p,e+=g,n){t[b]={size:r,csize:i};return}var x=new Uint8Array(m.buffer,e);if(h==0)t[b]=new Uint8Array(x.buffer.slice(e,e+i));else if(h==8){var y=new Uint8Array(r);v.inflateRaw(x,y),t[b]=y}else throw"unknown compression method: "+h};v.inflateRaw=function(m,e){return v.F.inflate(m,e)};v.inflate=function(m,e){var t=m[0],i=m[1],r=t&15,n=t>>>4;return v.inflateRaw(new Uint8Array(m.buffer,m.byteOffset+2,m.length-6),e)};v.deflate=function(m,e){e==null&&(e={level:6});var t=0,i=new Uint8Array(50+Math.floor(m.length*1.1));i[t]=120,i[t+1]=156,t+=2,t=v.F.deflateRaw(m,i,t,e.level);var r=v.adler(m,0,m.length);return i[t+0]=r>>>24&255,i[t+1]=r>>>16&255,i[t+2]=r>>>8&255,i[t+3]=r>>>0&255,new Uint8Array(i.buffer,0,t+4)};v.deflateRaw=function(m,e){e==null&&(e={level:6});var t=new Uint8Array(50+Math.floor(m.length*1.1)),i=v.F.deflateRaw(m,t,i,e.level);return new Uint8Array(t.buffer,0,i)};v.encode=function(m,e){e==null&&(e=!1);var t=0,i=v.bin.writeUint,r=v.bin.writeUshort,n={};for(var s in m){var a=!v._noNeed(s)&&!e,o=m[s],u=v.crc.crc(o,0,o.length);n[s]={cpr:a,usize:o.length,crc:u,file:a?v.deflateRaw(o):o}}for(var s in n)t+=n[s].file.length+30+46+2*v.bin.sizeUTF8(s);t+=22;var l=new Uint8Array(t),h=0,f=[];for(var s in n){var c=n[s];f.push(h),h=v._writeHeader(l,h,s,c,0)}var p=0,g=h;for(var s in n){var c=n[s];f.push(h),h=v._writeHeader(l,h,s,c,1,f[p++])}var b=h-g;return i(l,h,101010256),h+=4,h+=4,r(l,h,p),h+=2,r(l,h,p),h+=2,i(l,h,b),h+=4,i(l,h,g),h+=4,h+=2,l.buffer};v._noNeed=function(m){var e=m.split(".").pop().toLowerCase();return"png,jpg,jpeg,zip".indexOf(e)!=-1};v._writeHeader=function(m,e,t,i,r,n){var s=v.bin.writeUint,a=v.bin.writeUshort,o=i.file;s(m,e,r==0?67324752:33639248),e+=4,r==1&&(e+=2),a(m,e,20),e+=2,a(m,e,0),e+=2,a(m,e,i.cpr?8:0),e+=2,s(m,e,0),e+=4,s(m,e,i.crc),e+=4,s(m,e,o.length),e+=4,s(m,e,i.usize),e+=4,a(m,e,v.bin.sizeUTF8(t)),e+=2,a(m,e,0),e+=2,r==1&&(e+=2,e+=2,e+=6,s(m,e,n),e+=4);var u=v.bin.writeUTF8(m,e,t);return e+=u,r==0&&(m.set(o,e),e+=o.length),e};v.crc={table:function(){for(var m=new Uint32Array(256),e=0;e<256;e++){for(var t=e,i=0;i<8;i++)t&1?t=3988292384^t>>>1:t=t>>>1;m[e]=t}return m}(),update:function(m,e,t,i){for(var r=0;r<i;r++)m=v.crc.table[(m^e[t+r])&255]^m>>>8;return m},crc:function(m,e,t){return v.crc.update(4294967295,m,e,t)^4294967295}};v.adler=function(m,e,t){for(var i=1,r=0,n=e,s=e+t;n<s;){for(var a=Math.min(n+5552,s);n<a;)i+=m[n++],r+=i;i=i%65521,r=r%65521}return r<<16|i};v.bin={readUshort:function(m,e){return m[e]|m[e+1]<<8},writeUshort:function(m,e,t){m[e]=t&255,m[e+1]=t>>8&255},readUint:function(m,e){return m[e+3]*(256*256*256)+(m[e+2]<<16|m[e+1]<<8|m[e])},writeUint:function(m,e,t){m[e]=t&255,m[e+1]=t>>8&255,m[e+2]=t>>16&255,m[e+3]=t>>24&255},readASCII:function(m,e,t){for(var i="",r=0;r<t;r++)i+=String.fromCharCode(m[e+r]);return i},writeASCII:function(m,e,t){for(var i=0;i<t.length;i++)m[e+i]=t.charCodeAt(i)},pad:function(m){return m.length<2?"0"+m:m},readUTF8:function(m,e,t){for(var i="",r,n=0;n<t;n++)i+="%"+v.bin.pad(m[e+n].toString(16));try{r=decodeURIComponent(i)}catch{return v.bin.readASCII(m,e,t)}return r},writeUTF8:function(m,e,t){for(var i=t.length,r=0,n=0;n<i;n++){var s=t.charCodeAt(n);if((s&4294967295-(1<<7)+1)==0)m[e+r]=s,r++;else if((s&4294967295-(1<<11)+1)==0)m[e+r]=192|s>>6,m[e+r+1]=128|s>>0&63,r+=2;else if((s&4294967295-(1<<16)+1)==0)m[e+r]=224|s>>12,m[e+r+1]=128|s>>6&63,m[e+r+2]=128|s>>0&63,r+=3;else if((s&4294967295-(1<<21)+1)==0)m[e+r]=240|s>>18,m[e+r+1]=128|s>>12&63,m[e+r+2]=128|s>>6&63,m[e+r+3]=128|s>>0&63,r+=4;else throw"e"}return r},sizeUTF8:function(m){for(var e=m.length,t=0,i=0;i<e;i++){var r=m.charCodeAt(i);if((r&4294967295-(1<<7)+1)==0)t++;else if((r&4294967295-(1<<11)+1)==0)t+=2;else if((r&4294967295-(1<<16)+1)==0)t+=3;else if((r&4294967295-(1<<21)+1)==0)t+=4;else throw"e"}return t}};v.F={};v.F.deflateRaw=function(m,e,t,i){var r=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]],n=r[i],s=v.F.U,a=v.F._goodIndex,o=v.F._hash,u=v.F._putsE,l=0,h=t<<3,f=0,c=m.length;if(i==0){for(;l<c;){var p=Math.min(65535,c-l);u(e,h,l+p==c?1:0),h=v.F._copyExact(m,l,p,e,h+8),l+=p}return h>>>3}var g=s.lits,b=s.strt,x=s.prev,y=0,P=0,w=0,M=0,B=0,O=0;c>2&&(O=v.F._hash(m,0),b[O]=0);var R=0,N=0;for(l=0;l<c;l++){if(B=O,l+1<c-2){O=v.F._hash(m,l+1);var L=l+1&32767;x[L]=b[O],b[O]=L}if(f<=l){(y>14e3||P>26697)&&c-l>100&&(f<l&&(g[y]=l-f,y+=2,f=l),h=v.F._writeBlock(l==c-1||f==c?1:0,g,y,M,m,w,l-w,e,h),y=P=M=0,w=l);var D=0;l<c-2&&(D=v.F._bestMatch(m,l,x,B,Math.min(n[2],c-l),n[3]));var p=D>>>16,k=D&65535;if(D!=0){var p=D>>>16,k=D&65535,Y=a(p,s.of0);s.lhst[257+Y]++;var Z=a(k,s.df0);s.dhst[Z]++,M+=s.exb[Y]+s.dxb[Z],g[y]=p<<23|l-f,g[y+1]=k<<16|Y<<8|Z,y+=2,f=l+p}else s.lhst[m[l]]++;P++}}for((w!=l||m.length==0)&&(f<l&&(g[y]=l-f,y+=2,f=l),h=v.F._writeBlock(1,g,y,M,m,w,l-w,e,h),y=0,P=0,y=P=M=0,w=l);(h&7)!=0;)h++;return h>>>3};v.F._bestMatch=function(m,e,t,i,r,n){var s=e&32767,a=t[s],o=s-a+(1<<15)&32767;if(a==s||i!=v.F._hash(m,e-o))return 0;for(var u=0,l=0,h=Math.min(32767,e);o<=h&&--n!=0&&a!=s;){if(u==0||m[e+u]==m[e+u-o]){var f=v.F._howLong(m,e,o);if(f>u){if(u=f,l=o,u>=r)break;o+2<f&&(f=o+2);for(var c=0,p=0;p<f-2;p++){var g=e-o+p+32768&32767,b=t[g],x=g-b+(1<<15)&32767;x>c&&(c=x,a=g)}}}s=a,a=t[s],o+=s-a+(1<<15)&32767}return u<<16|l};v.F._howLong=function(m,e,t){if(m[e]!=m[e-t]||m[e+1]!=m[e+1-t]||m[e+2]!=m[e+2-t])return 0;var i=e,r=Math.min(m.length,e+258);for(e+=3;e<r&&m[e]==m[e-t];)e++;return e-i};v.F._hash=function(m,e){return(m[e]<<8|m[e+1])+(m[e+2]<<4)&65535};v.saved=0;v.F._writeBlock=function(m,e,t,i,r,n,s,a,o){var u=v.F.U,l=v.F._putsF,h=v.F._putsE,f,c,p,g,b,x,y,P,w;u.lhst[256]++,f=v.F.getTrees(),c=f[0],p=f[1],g=f[2],b=f[3],x=f[4],y=f[5],P=f[6],w=f[7];var M=((o+3&7)==0?0:8-(o+3&7))+32+(s<<3),B=i+v.F.contSize(u.fltree,u.lhst)+v.F.contSize(u.fdtree,u.dhst),O=i+v.F.contSize(u.ltree,u.lhst)+v.F.contSize(u.dtree,u.dhst);O+=14+3*y+v.F.contSize(u.itree,u.ihst)+(u.ihst[16]*2+u.ihst[17]*3+u.ihst[18]*7);for(var R=0;R<286;R++)u.lhst[R]=0;for(var R=0;R<30;R++)u.dhst[R]=0;for(var R=0;R<19;R++)u.ihst[R]=0;var N=M<B&&M<O?0:B<O?1:2;l(a,o,m),l(a,o+1,N),o+=3;var L=o;if(N==0){for(;(o&7)!=0;)o++;o=v.F._copyExact(r,n,s,a,o)}else{var D,k;if(N==1&&(D=u.fltree,k=u.fdtree),N==2){v.F.makeCodes(u.ltree,c),v.F.revCodes(u.ltree,c),v.F.makeCodes(u.dtree,p),v.F.revCodes(u.dtree,p),v.F.makeCodes(u.itree,g),v.F.revCodes(u.itree,g),D=u.ltree,k=u.dtree,h(a,o,b-257),o+=5,h(a,o,x-1),o+=5,h(a,o,y-4),o+=4;for(var Y=0;Y<y;Y++)h(a,o+Y*3,u.itree[(u.ordr[Y]<<1)+1]);o+=3*y,o=v.F._codeTiny(P,u.itree,a,o),o=v.F._codeTiny(w,u.itree,a,o)}for(var Z=n,j=0;j<t;j+=2){for(var X=e[j],$=X>>>23,Ge=Z+(X&(1<<23)-1);Z<Ge;)o=v.F._writeLit(r[Z++],D,a,o);if($!=0){var Re=e[j+1],be=Re>>16,ee=Re>>8&255,H=Re&255;o=v.F._writeLit(257+ee,D,a,o),h(a,o,$-u.of0[ee]),o+=u.exb[ee],o=v.F._writeLit(H,k,a,o),l(a,o,be-u.df0[H]),o+=u.dxb[H],Z+=$}}o=v.F._writeLit(256,D,a,o)}return o};v.F._copyExact=function(m,e,t,i,r){var n=r>>>3;return i[n]=t,i[n+1]=t>>>8,i[n+2]=255-i[n],i[n+3]=255-i[n+1],n+=4,i.set(new Uint8Array(m.buffer,e,t),n),r+(t+4<<3)};v.F.getTrees=function(){for(var m=v.F.U,e=v.F._hufTree(m.lhst,m.ltree,15),t=v.F._hufTree(m.dhst,m.dtree,15),i=[],r=v.F._lenCodes(m.ltree,i),n=[],s=v.F._lenCodes(m.dtree,n),a=0;a<i.length;a+=2)m.ihst[i[a]]++;for(var a=0;a<n.length;a+=2)m.ihst[n[a]]++;for(var o=v.F._hufTree(m.ihst,m.itree,7),u=19;u>4&&m.itree[(m.ordr[u-1]<<1)+1]==0;)u--;return[e,t,o,r,s,u,i,n]};v.F.getSecond=function(m){for(var e=[],t=0;t<m.length;t+=2)e.push(m[t+1]);return e};v.F.nonZero=function(m){for(var e="",t=0;t<m.length;t+=2)m[t+1]!=0&&(e+=(t>>1)+",");return e};v.F.contSize=function(m,e){for(var t=0,i=0;i<e.length;i++)t+=e[i]*m[(i<<1)+1];return t};v.F._codeTiny=function(m,e,t,i){for(var r=0;r<m.length;r+=2){var n=m[r],s=m[r+1];i=v.F._writeLit(n,e,t,i);var a=n==16?2:n==17?3:7;n>15&&(v.F._putsE(t,i,s,a),i+=a)}return i};v.F._lenCodes=function(m,e){for(var t=m.length;t!=2&&m[t-1]==0;)t-=2;for(var i=0;i<t;i+=2){var r=m[i+1],n=i+3<t?m[i+3]:-1,s=i+5<t?m[i+5]:-1,a=i==0?-1:m[i-1];if(r==0&&n==r&&s==r){for(var o=i+5;o+2<t&&m[o+2]==r;)o+=2;var u=Math.min(o+1-i>>>1,138);u<11?e.push(17,u-3):e.push(18,u-11),i+=u*2-2}else if(r==a&&n==r&&s==r){for(var o=i+5;o+2<t&&m[o+2]==r;)o+=2;var u=Math.min(o+1-i>>>1,6);e.push(16,u-3),i+=u*2-2}else e.push(r,0)}return t>>>1};v.F._hufTree=function(m,e,t){var i=[],r=m.length,n=e.length,s=0;for(s=0;s<n;s+=2)e[s]=0,e[s+1]=0;for(s=0;s<r;s++)m[s]!=0&&i.push({lit:s,f:m[s]});var a=i.length,o=i.slice(0);if(a==0)return 0;if(a==1){var u=i[0].lit,o=u==0?1:0;return e[(u<<1)+1]=1,e[(o<<1)+1]=1,1}i.sort(function(b,x){return b.f-x.f});var l=i[0],h=i[1],f=0,c=1,p=2;for(i[0]={lit:-1,f:l.f+h.f,l,r:h,d:0};c!=a-1;)f!=c&&(p==a||i[f].f<i[p].f)?l=i[f++]:l=i[p++],f!=c&&(p==a||i[f].f<i[p].f)?h=i[f++]:h=i[p++],i[c++]={lit:-1,f:l.f+h.f,l,r:h};var g=v.F.setDepth(i[c-1],0);for(g>t&&(v.F.restrictDepth(o,t,g),g=t),s=0;s<a;s++)e[(o[s].lit<<1)+1]=o[s].d;return g};v.F.setDepth=function(m,e){return m.lit!=-1?(m.d=e,e):Math.max(v.F.setDepth(m.l,e+1),v.F.setDepth(m.r,e+1))};v.F.restrictDepth=function(m,e,t){var i=0,r=1<<t-e,n=0;for(m.sort(function(a,o){return o.d==a.d?a.f-o.f:o.d-a.d}),i=0;i<m.length&&m[i].d>e;i++){var s=m[i].d;m[i].d=e,n+=r-(1<<t-s)}for(n=n>>>t-e;n>0;){var s=m[i].d;s<e?(m[i].d++,n-=1<<e-s-1):i++}for(;i>=0;i--)m[i].d==e&&n<0&&(m[i].d--,n++);n!=0&&console.log("debt left")};v.F._goodIndex=function(m,e){var t=0;return e[t|16]<=m&&(t|=16),e[t|8]<=m&&(t|=8),e[t|4]<=m&&(t|=4),e[t|2]<=m&&(t|=2),e[t|1]<=m&&(t|=1),t};v.F._writeLit=function(m,e,t,i){return v.F._putsF(t,i,e[m<<1]),i+e[(m<<1)+1]};v.F.inflate=function(m,e){var t=Uint8Array;if(m[0]==3&&m[1]==0)return e||new t(0);var i=v.F,r=i._bitsF,n=i._bitsE,s=i._decodeTiny,a=i.makeCodes,o=i.codes2map,u=i._get17,l=i.U,h=e==null;h&&(e=new t(m.length>>>2<<3));for(var f=0,c=0,p=0,g=0,b=0,x=0,y=0,P=0,w=0,M,B;f==0;){if(f=r(m,w,1),c=r(m,w+1,2),w+=3,c==0){(w&7)!=0&&(w+=8-(w&7));var O=(w>>>3)+4,R=m[O-4]|m[O-3]<<8;h&&(e=v.F._check(e,P+R)),e.set(new t(m.buffer,m.byteOffset+O,R),P),w=O+R<<3,P+=R;continue}if(h&&(e=v.F._check(e,P+(1<<17))),c==1&&(M=l.flmap,B=l.fdmap,x=(1<<9)-1,y=(1<<5)-1),c==2){p=n(m,w,5)+257,g=n(m,w+5,5)+1,b=n(m,w+10,4)+4,w+=14;for(var N=w,L=0;L<38;L+=2)l.itree[L]=0,l.itree[L+1]=0;for(var D=1,L=0;L<b;L++){var k=n(m,w+L*3,3);l.itree[(l.ordr[L]<<1)+1]=k,k>D&&(D=k)}w+=3*b,a(l.itree,D),o(l.itree,D,l.imap),M=l.lmap,B=l.dmap,w=s(l.imap,(1<<D)-1,p+g,m,w,l.ttree);var Y=i._copyOut(l.ttree,0,p,l.ltree);x=(1<<Y)-1;var Z=i._copyOut(l.ttree,p,g,l.dtree);y=(1<<Z)-1,a(l.ltree,Y),o(l.ltree,Y,M),a(l.dtree,Z),o(l.dtree,Z,B)}for(;;){var j=M[u(m,w)&x];w+=j&15;var X=j>>>4;if(X>>>8==0)e[P++]=X;else{if(X==256)break;var $=P+X-254;if(X>264){var Ge=l.ldef[X-257];$=P+(Ge>>>3)+n(m,w,Ge&7),w+=Ge&7}var Re=B[u(m,w)&y];w+=Re&15;var be=Re>>>4,ee=l.ddef[be],H=(ee>>>4)+r(m,w,ee&15);for(w+=ee&15,h&&(e=v.F._check(e,P+(1<<17)));P<$;)e[P]=e[P++-H],e[P]=e[P++-H],e[P]=e[P++-H],e[P]=e[P++-H];P=$}}}return e.length==P?e:e.slice(0,P)};v.F._check=function(m,e){var t=m.length;if(e<=t)return m;var i=new Uint8Array(Math.max(t<<1,e));return i.set(m,0),i};v.F._decodeTiny=function(m,e,t,i,r,n){for(var s=v.F._bitsE,a=v.F._get17,o=0;o<t;){var u=m[a(i,r)&e];r+=u&15;var l=u>>>4;if(l<=15)n[o]=l,o++;else{var h=0,f=0;l==16?(f=3+s(i,r,2),r+=2,h=n[o-1]):l==17?(f=3+s(i,r,3),r+=3):l==18&&(f=11+s(i,r,7),r+=7);for(var c=o+f;o<c;)n[o]=h,o++}}return r};v.F._copyOut=function(m,e,t,i){for(var r=0,n=0,s=i.length>>>1;n<t;){var a=m[n+e];i[n<<1]=0,i[(n<<1)+1]=a,a>r&&(r=a),n++}for(;n<s;)i[n<<1]=0,i[(n<<1)+1]=0,n++;return r};v.F.makeCodes=function(m,e){for(var t=v.F.U,i=m.length,r,n,s,a,o,u=t.bl_count,a=0;a<=e;a++)u[a]=0;for(a=1;a<i;a+=2)u[m[a]]++;var l=t.next_code;for(r=0,u[0]=0,n=1;n<=e;n++)r=r+u[n-1]<<1,l[n]=r;for(s=0;s<i;s+=2)o=m[s+1],o!=0&&(m[s]=l[o],l[o]++)};v.F.codes2map=function(m,e,t){for(var i=m.length,r=v.F.U,n=r.rev15,s=0;s<i;s+=2)if(m[s+1]!=0)for(var a=s>>1,o=m[s+1],u=a<<4|o,l=e-o,h=m[s]<<l,f=h+(1<<l);h!=f;){var c=n[h]>>>15-e;t[c]=u,h++}};v.F.revCodes=function(m,e){for(var t=v.F.U.rev15,i=15-e,r=0;r<m.length;r+=2){var n=m[r]<<e-m[r+1];m[r]=t[n]>>>i}};v.F._putsE=function(m,e,t){t=t<<(e&7);var i=e>>>3;m[i]|=t,m[i+1]|=t>>>8};v.F._putsF=function(m,e,t){t=t<<(e&7);var i=e>>>3;m[i]|=t,m[i+1]|=t>>>8,m[i+2]|=t>>>16};v.F._bitsE=function(m,e,t){return(m[e>>>3]|m[(e>>>3)+1]<<8)>>>(e&7)&(1<<t)-1};v.F._bitsF=function(m,e,t){return(m[e>>>3]|m[(e>>>3)+1]<<8|m[(e>>>3)+2]<<16)>>>(e&7)&(1<<t)-1};v.F._get17=function(m,e){return(m[e>>>3]|m[(e>>>3)+1]<<8|m[(e>>>3)+2]<<16)>>>(e&7)};v.F._get25=function(m,e){return(m[e>>>3]|m[(e>>>3)+1]<<8|m[(e>>>3)+2]<<16|m[(e>>>3)+3]<<24)>>>(e&7)};v.F.U=function(){var m=Uint16Array,e=Uint32Array;return{next_code:new m(16),bl_count:new m(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new m(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new e(32),flmap:new m(512),fltree:[],fdmap:new m(32),fdtree:[],lmap:new m(32768),ltree:[],ttree:[],dmap:new m(32768),dtree:[],imap:new m(512),itree:[],rev15:new m(1<<15),lhst:new e(286),dhst:new e(30),ihst:new e(19),lits:new e(15e3),strt:new m(1<<16),prev:new m(1<<15)}}();(function(){for(var m=v.F.U,e=1<<15,t=0;t<e;t++){var i=t;i=(i&2863311530)>>>1|(i&1431655765)<<1,i=(i&3435973836)>>>2|(i&858993459)<<2,i=(i&4042322160)>>>4|(i&252645135)<<4,i=(i&4278255360)>>>8|(i&16711935)<<8,m.rev15[t]=(i>>>16|i<<16)>>>17}function r(n,s,a){for(;s--!=0;)n.push(0,a)}for(var t=0;t<32;t++)m.ldef[t]=m.of0[t]<<3|m.exb[t],m.ddef[t]=m.df0[t]<<4|m.dxb[t];r(m.fltree,144,8),r(m.fltree,255-143,9),r(m.fltree,279-255,7),r(m.fltree,287-279,8),v.F.makeCodes(m.fltree,9),v.F.codes2map(m.fltree,9,m.flmap),v.F.revCodes(m.fltree,9),r(m.fdtree,32,5),v.F.makeCodes(m.fdtree,5),v.F.codes2map(m.fdtree,5,m.fdmap),v.F.revCodes(m.fdtree,5),r(m.itree,19,0),r(m.ltree,286,0),r(m.dtree,30,0),r(m.ttree,320,0)})()});var kn,Rt,rr=C(()=>{"use strict";kn=An(pn());qt();ut();Rt=class{get name(){return this._name}get compression(){return this._compression}get data(){return this._data}constructor(e,t,i){this._name=e,this._compression=t,this._data=i}static from(e){return new Rt(e._name,e._compression,te.copyUint8(e._data))}compressed(){return this._compression===1?this._data:(this._data=(0,kn.deflate)(this._data),this._compression=1,this._data)}decompressed(){return this._compression===1?this._data:(this._data=(0,kn.inflate)(this._data),this._compression=0,this._data)}}});ut();je();Ht();Vt();Ci();ge();Yt();zt();Wt();Mi();bt();Xt();Ti();rr();qt();He();Zt();Ei();Qe();Ye();hi();Ri();Di();st();di();Qr();Li();vt();Et();Ve();xt();Jr();en();tn();mi();rn();nn();ue();Ot();wt();Ui();$t();Kt();jt();Ie();Qt();Jt();ei();ti();ii();ri();ni();si();ai();oi();ui();li();Ce();sn();an();on();Gr();Ni();ki();Gi();un();ln();Vi();hn();gi();zi();Yi();Mt();bi();cn();dn();Hr();mn();Ki();ji();xi();qi();$i();nr();sr();Qi();Ji();er();Ai();Ir();or();lr();fr();wr();cr();dr();pr();gr();xr();_r();Dt();_i();wi();tr();ir();vr();Pr();Ar();Or();Ur();Sr();Pi();Cr();kt();Er();Br();Vr();pi();ft();Ut();zr();yn();gn();xn();Wi();Ft();Fr();Dr();Wr();})();
//# sourceMappingURL=index.js.map
