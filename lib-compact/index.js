(()=>{var Au=Object.create;var Cu=Object.defineProperty;var Fu=Object.getOwnPropertyDescriptor;var Bu=Object.getOwnPropertyNames;var Uu=Object.getPrototypeOf,Su=Object.prototype.hasOwnProperty;var A=(f,e)=>()=>(f&&(e=f(f=0)),e);var ku=(f,e)=>()=>(e||f((e={exports:{}}).exports,e),e.exports);var zu=(f,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Bu(e))!Su.call(f,i)&&i!==t&&Cu(f,i,{get:()=>e[i],enumerable:!(n=Fu(e,i))||n.enumerable});return f};var ws=(f,e,t)=>(t=f!=null?Au(Uu(f)):{},zu(e||!f||!f.__esModule?Cu(t,"default",{value:f,enumerable:!0}):t,f));var Ja,De=A(()=>{"use strict";Ja=new Map([[0,4],[1,4],[2,4],[3,4],[4,3],[5,3],[6,2],[7,1]])});var oe=A(()=>{"use strict"});var T,be=A(()=>{"use strict";T=class extends Error{toString(){return`${this.constructor.name} (${this.message})`}}});var _,_e=A(()=>{"use strict";_=class{static fract(e){return e-Math.floor(e)}static smoothStep(e,t,n){let i=(n-e)/(t-e),r=_.clamp(i,0,1);return r*r*(3-2*r)}static mix(e,t,n){return e*(1-n)+t*n}static sign(e){return e<0?-1:e>0?1:0}static step(e,t){return t<e?0:1}static length3(e,t,n){return Math.sqrt(e*e+t*t+n*n)}static gcd(e,t){let n=Math.abs(e),i=Math.abs(t);for(;i;){let r=i;i=n%i,n=r}return n}static clamp(e,t,n){return Math.max(t,Math.min(e,n))}static clampInt(e,t,n){return Math.trunc(_.clamp(e,t,n))}static clampInt255(e){return Math.trunc(_.clamp(e,0,255))}}});var fe,sn=A(()=>{"use strict";_e();fe=class{get numerator(){return this._numerator}get denominator(){return this._denominator}get toInt(){return this.denominator!==0?Math.trunc(this.numerator/this.denominator):0}get toDouble(){return this.denominator!==0?this.numerator/this.denominator:0}constructor(e,t){this._numerator=e,this._denominator=t}simplify(){let e=_.gcd(this.numerator,this.denominator);e!==0&&(this._numerator=Math.trunc(this.numerator/e),this._denominator=Math.trunc(this.denominator/e))}equals(e){return this._numerator===e._numerator&&this._denominator===e._denominator}toString(){return`${this.constructor.name} (${this._numerator}/${this._denominator})`}}});var U,G=A(()=>{"use strict";be();sn();U=class{static copyInt8(e,t,n){return Int8Array.from(e.subarray(t,n))}static copyUint8(e,t,n){return Uint8Array.from(e.subarray(t,n))}static copyInt16(e,t,n){return Int16Array.from(e.subarray(t,n))}static copyUint16(e,t,n){return Uint16Array.from(e.subarray(t,n))}static copyInt32(e,t,n){return Int32Array.from(e.subarray(t,n))}static copyUint32(e,t,n){return Uint32Array.from(e.subarray(t,n))}static copyFloat32(e,t,n){return Float32Array.from(e.subarray(t,n))}static copyFloat64(e,t,n){return Float64Array.from(e.subarray(t,n))}static copy(e,t,n){if(e instanceof Int8Array)return U.copyInt8(e,t,n);if(e instanceof Uint8Array)return U.copyUint8(e,t,n);if(e instanceof Int16Array)return U.copyInt16(e,t,n);if(e instanceof Uint16Array)return U.copyUint16(e,t,n);if(e instanceof Int32Array)return U.copyInt32(e,t,n);if(e instanceof Uint32Array)return U.copyUint32(e,t,n);if(e instanceof Float32Array)return U.copyFloat32(e,t,n);if(e instanceof Float64Array)return U.copyFloat64(e,t,n);throw new T("Unknown array type")}static copyRange(e,t,n,i,r){let a=e.subarray(t,n);i.set(a,r)}static fill(e,t){return new Array(e).fill(t)}static generate(e,t){let n=new Array(e);for(let i=0;i<e;++i)n[i]=t(i);return n}static equals(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0,i=e.length;n<i;n++)if(U.isNumArrayOrTypedArray(e[n])&&U.isNumArrayOrTypedArray(t[n])){if(!U.equals(e[n],t[n]))return!1}else if(e[n]!==t[n])return!1;return!0}static equalsRationalArray(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0,i=e.length;n<i;n++)if(!e[n].equals(t[n]))return!1;return!0}static getNumEnumValues(e){return Object.values(e).filter(t=>typeof t=="number")}static isNumArrayOrTypedArray(e){return Boolean(e&&typeof e=="object"&&(Array.isArray(e)&&e.every(t=>typeof t=="number")||ArrayBuffer.isView(e)&&!(e instanceof DataView)))}static isArrayOfRational(e){return Boolean(e&&typeof e=="object"&&Array.isArray(e)&&e.every(t=>t instanceof fe))}}});var Rt,K,Jt=A(()=>{"use strict";Rt=class{static countTrailingZeroBits(e){let t=32,n=e&-e;return n!==0&&t--,n&65535&&(t-=16),n&16711935&&(t-=8),n&252645135&&(t-=4),n&858993459&&(t-=2),n&1431655765&&(t-=1),t}static reverseByte(e){return this._reverseByteTable[e]}static signed(e,t){return t&1<<e-1?t-(1<<e):t}static shiftR(e,t){return Rt.signed(32,e>>t)}static shiftL(e,t){return Rt.signed(32,e<<t)}static uint8ToInt8(e){return this._uint8[0]=e,this._uint8ToInt8[0]}static int8ToUint8(e){return this._int8[0]=e,this._int8ToUint8[0]}static uint16ToInt16(e){return this._uint16[0]=e,this._uint16ToInt16[0]}static int16ToUint16(e){return this._int16[0]=e,this._int16ToUint16[0]}static uint32ToInt32(e){return this._uint32[0]=e,this._uint32ToInt32[0]}static uint32ToFloat32(e){return this._uint32[0]=e,this._uint32ToFloat32[0]}static uint64ToFloat64(e){return this._uint64[0]=e,this._uint64ToFloat64[0]}static int32ToUint32(e){return this._int32[0]=e,this._int32ToUint32[0]}static float32ToUint32(e){return this._float32[0]=e,this._float32ToUint32[0]}static debugBits32(e){if(e===void 0)return"undefined";let t=32,n="";for(let i=t;i>-1;i--)n+=e&1<<i?"1":"0";return n}},K=Rt;K._uint8=new Uint8Array(1),K._uint8ToInt8=new Int8Array(Rt._uint8.buffer),K._int8=new Int8Array(1),K._int8ToUint8=new Uint8Array(Rt._int8.buffer),K._uint16=new Uint16Array(1),K._uint16ToInt16=new Int16Array(Rt._uint16.buffer),K._int16=new Int16Array(1),K._int16ToUint16=new Uint16Array(Rt._int16.buffer),K._uint32=new Uint32Array(1),K._uint32ToInt32=new Int32Array(Rt._uint32.buffer),K._uint32ToFloat32=new Float32Array(Rt._uint32.buffer),K._int32=new Int32Array(1),K._int32ToUint32=new Uint32Array(Rt._int32.buffer),K._float32=new Float32Array(1),K._float32ToUint32=new Uint32Array(Rt._float32.buffer),K._uint64=new BigUint64Array(1),K._uint64ToFloat64=new Float64Array(Rt._uint64.buffer),K._reverseByteTable=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255]});var R,un=A(()=>{"use strict";Jt();R=class{static get _toFloatFloat32(){return this._toFloatFloat32Data!==void 0?this._toFloatFloat32Data:this.initialize()}constructor(e){this.bits=e!==void 0?R.doubleToFloat16(e):0}static convert(e){let t=e>>16&32768,n=(e>>23&255)-(127-15),i=e&8388607;if(n<=0){if(n<-10)return t;i|=8388608;let r=14-n,a=(1<<r-1)-1,s=i>>r&1;return i=i+a+s>>r,t|i}else return n===255-(127-15)?i===0?t|31744:(i>>=13,t|31744|i|(i===0?1:0)):(i=i+4095+(i>>13&1),i&8388608&&(i=0,n+=1),n>30?t|31744:t|n<<10|i>>13)}static initialize(){if(this._toFloatFloat32Data!==void 0)return this._toFloatFloat32Data;let e=new Uint32Array(1<<16);this._toFloatFloat32Data=new Float32Array(e.buffer),this._eLut=new Uint16Array(1<<9);for(let n=0;n<256;n++){let i=(n&255)-112;i<=0||i>=30?(this._eLut[n]=0,this._eLut[n|256]=0):(this._eLut[n]=i<<10,this._eLut[n|256]=i<<10|32768)}let t=1<<16;for(let n=0;n<t;n++)e[n]=this.halfToFloat(n);return this._toFloatFloat32Data}static halfToFloat(e){let t=e>>15&1,n=e>>10&31,i=e&1023;if(n===0){if(i===0)return t<<31;for(;!(i&1024);)i<<=1,n-=1;n+=1,i&=-1025}else if(n===31)return i===0?t<<31|2139095040:t<<31|2139095040|i<<13;return n+=127-15,i<<=13,t<<31|n<<23|i}static from(e){let t=new R;return t.bits=e.bits,t}static fromBits(e){let t=new R;return t.bits=e,t}static float16ToDouble(e){return this._toFloatFloat32[e]}static doubleToFloat16(e){let t=e,n=K.float32ToUint32(t);if(t===0)return n>>16;this._toFloatFloat32Data===void 0&&this.initialize();let i=n>>23&511;if(i=this._eLut[i],i!==0){let r=n&8388607;return i+(r+4095+(r>>13&1)>>13)}return this.convert(n)}static posInf(){return R.fromBits(31744)}static negInf(){return R.fromBits(64512)}static qNan(){return R.fromBits(32767)}static sNan(){return R.fromBits(32255)}toDouble(){return R._toFloatFloat32[this.bits]}minus(){return R.fromBits(this.bits^32768)}add(e){let t=e instanceof R?e.toDouble():typeof e=="number"?e:0;return new R(this.toDouble()+t)}sub(e){let t=e instanceof R?e.toDouble():typeof e=="number"?e:0;return new R(this.toDouble()-t)}mul(e){let t=e instanceof R?e.toDouble():typeof e=="number"?e:0;return new R(this.toDouble()*t)}div(e){let t=e instanceof R?e.toDouble():typeof e=="number"?e:0;return new R(this.toDouble()/t)}round(e){if(e>=10)return R.from(this);let t=this.bits&32768,n=this.bits&32767;return n>>=9-e,n+=n&1,n<<=9-e,n>=31744&&(n=this.bits,n>>=10-e,n<<=10-e),R.fromBits(t|n)}isFinite(){return(this.bits>>10&31)<31}isNormalized(){let e=this.bits>>10&31;return e>0&&e<31}isDenormalized(){let e=this.bits>>10&31,t=this.bits&1023;return e===0&&t!==0}isZero(){return(this.bits&32767)===0}isNaN(){let e=this.bits>>10&31,t=this.bits&1023;return e===31&&t!==0}isInfinity(){let e=this.bits>>10&31,t=this.bits&1023;return e===31&&t===0}isNegative(){return(this.bits&32768)!==0}}});function ar(f,e,t){if(e===t)return f;switch(e){case 0:return f===0?0:Xa.get(t);case 1:switch(t){case 0:return f===0?0:1;case 1:return f;case 2:return f*5;case 3:return f*75;case 4:return f*21845;case 5:return f*1431655765;case 6:return f*42;case 7:return f*10922;case 8:return f*715827882;case 9:case 10:case 11:return f/3}break;case 2:switch(t){case 0:return f===0?0:1;case 1:return Math.trunc(f)>>1;case 2:return f;case 3:return f*17;case 4:return f*4369;case 5:return f*286331153;case 6:return f*8;case 7:return f*2184;case 8:return f*143165576;case 9:case 10:case 11:return f/3}break;case 3:switch(t){case 0:return f===0?0:1;case 1:return Math.trunc(f)>>6;case 2:return Math.trunc(f)>>4;case 3:return f;case 4:return f*257;case 5:return f*16843009;case 6:return Math.trunc(f)>>1;case 7:return f*128;case 8:return f*8421504;case 9:case 10:case 11:return f/255}break;case 4:switch(t){case 0:return f===0?0:1;case 1:return Math.trunc(f)>>14;case 2:return Math.trunc(f)>>12;case 3:return Math.trunc(f)>>8;case 4:return f;case 5:return Math.trunc(f)<<8;case 6:return Math.trunc(f)>>9;case 7:return Math.trunc(f)>>1;case 8:return f*524296;case 9:case 10:case 11:return f/65535}break;case 5:switch(t){case 0:return f===0?0:1;case 1:return Math.trunc(f)>>30;case 2:return Math.trunc(f)>>28;case 3:return Math.trunc(f)>>24;case 4:return Math.trunc(f)>>16;case 5:return f;case 6:return Math.trunc(f)>>25;case 7:return Math.trunc(f)>>17;case 8:return Math.trunc(f)>>1;case 9:case 10:case 11:return f/4294967295}break;case 6:switch(t){case 0:return f===0?0:1;case 1:return f<=0?0:Math.trunc(f)>>5;case 2:return f<=0?0:Math.trunc(f)>>3;case 3:return f<=0?0:Math.trunc(f)<<1;case 4:return f<=0?0:Math.trunc(f)*516;case 5:return f<=0?0:Math.trunc(f)*33818640;case 6:return f;case 7:return f*258;case 8:return f*16909320;case 9:case 10:case 11:return f/127}break;case 7:switch(t){case 0:return f===0?0:1;case 1:return f<=0?0:Math.trunc(f)>>15;case 2:return f<=0?0:Math.trunc(f)>>11;case 3:return f<=0?0:Math.trunc(f)>>7;case 4:return f<=0?0:Math.trunc(f)<<1;case 5:return f<=0?0:Math.trunc(f)*131076;case 6:return Math.trunc(f)>>8;case 7:return f;case 8:return Math.trunc(f)*65538;case 9:case 10:case 11:return f/32767}break;case 8:switch(t){case 0:return f===0?0:1;case 1:return f<=0?0:Math.trunc(f)>>29;case 2:return f<=0?0:Math.trunc(f)>>27;case 3:return f<=0?0:Math.trunc(f)>>23;case 4:return f<=0?0:Math.trunc(f)>>16;case 5:return f<=0?0:Math.trunc(f)<<1;case 6:return Math.trunc(f)>>24;case 7:return Math.trunc(f)>>16;case 8:return f;case 9:case 10:case 11:return f/2147483647}break;case 9:case 10:case 11:switch(t){case 0:return f===0?0:1;case 1:return Math.trunc(_.clamp(f,0,1)*3);case 2:return Math.trunc(_.clamp(f,0,1)*15);case 3:return Math.trunc(_.clamp(f,0,1)*255);case 4:return Math.trunc(_.clamp(f,0,1)*65535);case 5:return Math.trunc(_.clamp(f,0,1)*4294967295);case 6:return Math.trunc(f<0?_.clamp(f,-1,1)*128:_.clamp(f,-1,1)*127);case 7:return Math.trunc(f<0?_.clamp(f,-1,1)*32768:_.clamp(f,-1,1)*32767);case 8:return Math.trunc(f<0?_.clamp(f,-1,1)*2147483648:_.clamp(f,-1,1)*2147483647);case 9:case 10:case 11:return f}break}throw new T("Unknown format.")}var q,es,Xa,H=A(()=>{"use strict";_e();be();q=(b=>(b[b.uint1=0]="uint1",b[b.uint2=1]="uint2",b[b.uint4=2]="uint4",b[b.uint8=3]="uint8",b[b.uint16=4]="uint16",b[b.uint32=5]="uint32",b[b.int8=6]="int8",b[b.int16=7]="int16",b[b.int32=8]="int32",b[b.float16=9]="float16",b[b.float32=10]="float32",b[b.float64=11]="float64",b))(q||{}),es=new Map([[0,1],[1,1],[2,1],[3,1],[4,2],[5,4],[6,1],[7,2],[8,4],[9,2],[10,4],[11,8]]),Xa=new Map([[0,1],[1,3],[2,15],[3,255],[4,65535],[5,4294967295],[6,127],[7,32767],[8,2147483647],[9,1],[10,1],[11,1]])});var ot,ri=A(()=>{"use strict";G();oe();ae();H();ot=class{get format(){return 10}get length(){return this.data.length}get maxChannelValue(){return 1}get maxIndexValue(){return 1}get isLdrFormat(){return!1}get isHdrFormat(){return!0}get hasPalette(){return!1}get palette(){}get index(){return this.r}set index(e){this.r=e}get r(){return this.getChannel(0)}set r(e){this.setChannel(0,e)}get g(){return this.getChannel(1)}set g(e){this.setChannel(1,e)}get b(){return this.getChannel(2)}set b(e){this.setChannel(2,e)}get a(){return this.getChannel(3)}set a(e){this.setChannel(3,e)}get rNormalized(){return this.r/this.maxChannelValue}set rNormalized(e){this.r=e*this.maxChannelValue}get gNormalized(){return this.g/this.maxChannelValue}set gNormalized(e){this.g=e*this.maxChannelValue}get bNormalized(){return this.b/this.maxChannelValue}set bNormalized(e){this.b=e*this.maxChannelValue}get aNormalized(){return this.a/this.maxChannelValue}set aNormalized(e){this.a=e*this.maxChannelValue}get luminance(){return z.getLuminance(this)}get luminanceNormalized(){return z.getLuminanceNormalized(this)}constructor(e){typeof e=="number"?this.data=new Float32Array(e):this.data=e.slice()}static from(e){let t=new ot(e.length);return t.data=e.data,t}static fromArray(e){return new ot(e)}static rgb(e,t,n){let i=new Float32Array([e,t,n]);return new ot(i)}static rgba(e,t,n,i){let r=new Float32Array([e,t,n,i]);return new ot(r)}getChannel(e){return e===4?this.luminance:e<this.data.length?this.data[e]:0}getChannelNormalized(e){return this.getChannel(e)/this.maxChannelValue}setChannel(e,t){e<this.data.length&&(this.data[e]=t)}set(e){this.setRgba(e.r,e.g,e.b,e.a)}setRgb(e,t,n){this.data[0]=e;let i=this.data.length;i>1&&(this.data[1]=t,i>2&&(this.data[2]=n))}setRgba(e,t,n,i){this.data[0]=e;let r=this.data.length;r>1&&(this.data[1]=t,r>2&&(this.data[2]=n,r>3&&(this.data[3]=i)))}toArray(){return U.generate(this.length,e=>this.getChannel(e))}clone(){return ot.from(this)}equals(e){if(e.length!==this.length)return!1;for(let t=0;t<this.length;t++)if(e.getChannel(t)!==this.getChannel(t))return!1;return!0}convert(e){return z.convertColor({from:this,format:e==null?void 0:e.format,numChannels:e==null?void 0:e.numChannels,alpha:e==null?void 0:e.alpha})}}});var lt,ai=A(()=>{"use strict";G();oe();ae();H();lt=class{get format(){return 11}get length(){return this.data.length}get maxChannelValue(){return 1}get maxIndexValue(){return 1}get isLdrFormat(){return!0}get isHdrFormat(){return!1}get hasPalette(){return!1}get palette(){}get index(){return this.r}set index(e){this.r=e}get r(){return this.getChannel(0)}set r(e){this.setChannel(0,e)}get g(){return this.getChannel(1)}set g(e){this.setChannel(1,e)}get b(){return this.getChannel(2)}set b(e){this.setChannel(2,e)}get a(){return this.getChannel(3)}set a(e){this.setChannel(3,e)}get rNormalized(){return this.r/this.maxChannelValue}set rNormalized(e){this.r=e*this.maxChannelValue}get gNormalized(){return this.g/this.maxChannelValue}set gNormalized(e){this.g=e*this.maxChannelValue}get bNormalized(){return this.b/this.maxChannelValue}set bNormalized(e){this.b=e*this.maxChannelValue}get aNormalized(){return this.a/this.maxChannelValue}set aNormalized(e){this.a=e*this.maxChannelValue}get luminance(){return z.getLuminance(this)}get luminanceNormalized(){return z.getLuminanceNormalized(this)}constructor(e){typeof e=="number"?this.data=new Float64Array(e):this.data=e.slice()}static from(e){let t=new lt(e.length);return t.data=e.data,t}static fromArray(e){return new lt(e)}static rgb(e,t,n){let i=new Float64Array([e,t,n]);return new lt(i)}static rgba(e,t,n,i){let r=new Float64Array([e,t,n,i]);return new lt(r)}getChannel(e){return e===4?this.luminance:e<this.data.length?this.data[e]:0}getChannelNormalized(e){return this.getChannel(e)/this.maxChannelValue}setChannel(e,t){e<this.data.length&&(this.data[e]=t)}set(e){this.setRgba(e.r,e.g,e.b,e.a)}setRgb(e,t,n){this.data[0]=e;let i=this.data.length;i>1&&(this.data[1]=t,i>2&&(this.data[2]=n))}setRgba(e,t,n,i){this.data[0]=e;let r=this.data.length;r>1&&(this.data[1]=t,r>2&&(this.data[2]=n,r>3&&(this.data[3]=i)))}toArray(){return U.generate(this.length,e=>this.getChannel(e))}clone(){return lt.from(this)}equals(e){if(e.length!==this.length)return!1;for(let t=0;t<this.length;t++)if(e.getChannel(t)!==this.getChannel(t))return!1;return!0}convert(e){return z.convertColor({from:this,format:e==null?void 0:e.format,numChannels:e==null?void 0:e.numChannels,alpha:e==null?void 0:e.alpha})}}});var mt,si=A(()=>{"use strict";G();oe();ae();H();mt=class{get format(){return 7}get length(){return this._data.length}get maxChannelValue(){return 32767}get maxIndexValue(){return 32767}get isLdrFormat(){return!1}get isHdrFormat(){return!0}get hasPalette(){return!1}get palette(){}get index(){return this.r}set index(e){this.r=e}get r(){return this._data.length>0?this._data[0]:0}set r(e){this._data.length>0&&(this._data[0]=Math.trunc(e))}get g(){return this._data.length>1?this._data[1]:0}set g(e){this._data.length>1&&(this._data[1]=Math.trunc(e))}get b(){return this._data.length>2?this._data[2]:0}set b(e){this._data.length>2&&(this._data[2]=Math.trunc(e))}get a(){return this._data.length>3?this._data[3]:0}set a(e){this._data.length>3&&(this._data[3]=Math.trunc(e))}get rNormalized(){return this.r/this.maxChannelValue}set rNormalized(e){this.r=e*this.maxChannelValue}get gNormalized(){return this.g/this.maxChannelValue}set gNormalized(e){this.g=e*this.maxChannelValue}get bNormalized(){return this.b/this.maxChannelValue}set bNormalized(e){this.b=e*this.maxChannelValue}get aNormalized(){return this.a/this.maxChannelValue}set aNormalized(e){this.a=e*this.maxChannelValue}get luminance(){return z.getLuminance(this)}get luminanceNormalized(){return z.getLuminanceNormalized(this)}constructor(e){typeof e=="number"?this._data=new Int16Array(e):this._data=e.slice()}static from(e){let t=new mt(e.length);return t._data=e._data,t}static fromArray(e){let t=new Int16Array(e);return new mt(t)}static rgb(e,t,n){let i=new Int16Array([e,t,n]);return new mt(i)}static rgba(e,t,n,i){let r=new Int16Array([e,t,n,i]);return new mt(r)}getChannel(e){return e===4?this.luminance:e<this._data.length?this._data[e]:0}getChannelNormalized(e){return this.getChannel(e)/this.maxChannelValue}setChannel(e,t){e<this._data.length&&(this._data[e]=Math.trunc(t))}set(e){this.setRgba(e.r,e.g,e.b,e.a)}setRgb(e,t,n){this._data[0]=Math.trunc(e);let i=this._data.length;i>1&&(this._data[1]=Math.trunc(t),i>2&&(this._data[2]=Math.trunc(n)))}setRgba(e,t,n,i){this._data[0]=Math.trunc(e);let r=this._data.length;r>1&&(this._data[1]=Math.trunc(t),r>2&&(this._data[2]=Math.trunc(n),r>3&&(this._data[3]=Math.trunc(i))))}toArray(){return U.generate(this.length,e=>this.getChannel(e))}clone(){return mt.from(this)}equals(e){if(e.length!==this.length)return!1;for(let t=0;t<this.length;t++)if(e.getChannel(t)!==this.getChannel(t))return!1;return!0}convert(e){return z.convertColor({from:this,format:e==null?void 0:e.format,numChannels:e==null?void 0:e.numChannels,alpha:e==null?void 0:e.alpha})}}});var ht,ui=A(()=>{"use strict";G();oe();ae();H();ht=class{get format(){return 8}get length(){return this._data.length}get maxChannelValue(){return 2147483647}get maxIndexValue(){return 2147483647}get isLdrFormat(){return!1}get isHdrFormat(){return!0}get hasPalette(){return!1}get palette(){}get index(){return this.r}set index(e){this.r=e}get r(){return this._data.length>0?this._data[0]:0}set r(e){this._data.length>0&&(this._data[0]=Math.trunc(e))}get g(){return this._data.length>1?this._data[1]:0}set g(e){this._data.length>1&&(this._data[1]=Math.trunc(e))}get b(){return this._data.length>2?this._data[2]:0}set b(e){this._data.length>2&&(this._data[2]=Math.trunc(e))}get a(){return this._data.length>3?this._data[3]:0}set a(e){this._data.length>3&&(this._data[3]=Math.trunc(e))}get rNormalized(){return this.r/this.maxChannelValue}set rNormalized(e){this.r=e*this.maxChannelValue}get gNormalized(){return this.g/this.maxChannelValue}set gNormalized(e){this.g=e*this.maxChannelValue}get bNormalized(){return this.b/this.maxChannelValue}set bNormalized(e){this.b=e*this.maxChannelValue}get aNormalized(){return this.a/this.maxChannelValue}set aNormalized(e){this.a=e*this.maxChannelValue}get luminance(){return z.getLuminance(this)}get luminanceNormalized(){return z.getLuminanceNormalized(this)}constructor(e){typeof e=="number"?this._data=new Int32Array(e):this._data=e.slice()}static from(e){let t=new ht(e.length);return t._data=e._data,t}static fromArray(e){let t=new Int32Array(e);return new ht(t)}static rgb(e,t,n){let i=new Int32Array([e,t,n]);return new ht(i)}static rgba(e,t,n,i){let r=new Int32Array([e,t,n,i]);return new ht(r)}getChannel(e){return e===4?this.luminance:e<this._data.length?this._data[e]:0}getChannelNormalized(e){return this.getChannel(e)/this.maxChannelValue}setChannel(e,t){e<this._data.length&&(this._data[e]=Math.trunc(t))}set(e){this.setRgba(e.r,e.g,e.b,e.a)}setRgb(e,t,n){this._data[0]=Math.trunc(e);let i=this._data.length;i>1&&(this._data[1]=Math.trunc(t),i>2&&(this._data[2]=Math.trunc(n)))}setRgba(e,t,n,i){this._data[0]=Math.trunc(e);let r=this._data.length;r>1&&(this._data[1]=Math.trunc(t),r>2&&(this._data[2]=Math.trunc(n),r>3&&(this._data[3]=Math.trunc(i))))}toArray(){return U.generate(this.length,e=>this.getChannel(e))}clone(){return ht.from(this)}equals(e){if(e.length!==this.length)return!1;for(let t=0;t<this.length;t++)if(e.getChannel(t)!==this.getChannel(t))return!1;return!0}convert(e){return z.convertColor({from:this,format:e==null?void 0:e.format,numChannels:e==null?void 0:e.numChannels,alpha:e==null?void 0:e.alpha})}}});var ct,oi=A(()=>{"use strict";G();oe();ae();H();ct=class{get format(){return 6}get length(){return this._data.length}get maxChannelValue(){return 127}get maxIndexValue(){return 127}get isLdrFormat(){return!1}get isHdrFormat(){return!0}get hasPalette(){return!1}get palette(){}get index(){return this.r}set index(e){this.r=e}get r(){return this._data.length>0?this._data[0]:0}set r(e){this._data.length>0&&(this._data[0]=Math.trunc(e))}get g(){return this._data.length>1?this._data[1]:0}set g(e){this._data.length>1&&(this._data[1]=Math.trunc(e))}get b(){return this._data.length>2?this._data[2]:0}set b(e){this._data.length>2&&(this._data[2]=Math.trunc(e))}get a(){return this._data.length>3?this._data[3]:0}set a(e){this._data.length>3&&(this._data[3]=Math.trunc(e))}get rNormalized(){return this.r/this.maxChannelValue}set rNormalized(e){this.r=e*this.maxChannelValue}get gNormalized(){return this.g/this.maxChannelValue}set gNormalized(e){this.g=e*this.maxChannelValue}get bNormalized(){return this.b/this.maxChannelValue}set bNormalized(e){this.b=e*this.maxChannelValue}get aNormalized(){return this.a/this.maxChannelValue}set aNormalized(e){this.a=e*this.maxChannelValue}get luminance(){return z.getLuminance(this)}get luminanceNormalized(){return z.getLuminanceNormalized(this)}constructor(e){typeof e=="number"?this._data=new Int8Array(e):this._data=e.slice()}static from(e){let t=new ct(e.length);return t._data=e._data,t}static fromArray(e){let t=new Int8Array(e);return new ct(t)}static rgb(e,t,n){let i=new Int8Array([e,t,n]);return new ct(i)}static rgba(e,t,n,i){let r=new Int8Array([e,t,n,i]);return new ct(r)}getChannel(e){return e===4?this.luminance:e<this._data.length?this._data[e]:0}getChannelNormalized(e){return this.getChannel(e)/this.maxChannelValue}setChannel(e,t){e<this._data.length&&(this._data[e]=Math.trunc(t))}set(e){this.setRgba(e.r,e.g,e.b,e.a)}setRgb(e,t,n){this._data[0]=Math.trunc(e);let i=this._data.length;i>1&&(this._data[1]=Math.trunc(t),i>2&&(this._data[2]=Math.trunc(n)))}setRgba(e,t,n,i){this._data[0]=Math.trunc(e);let r=this._data.length;r>1&&(this._data[1]=Math.trunc(t),r>2&&(this._data[2]=Math.trunc(n),r>3&&(this._data[3]=Math.trunc(i))))}toArray(){return U.generate(this.length,e=>this.getChannel(e))}clone(){return ct.from(this)}equals(e){if(e.length!==this.length)return!1;for(let t=0;t<this.length;t++)if(e.getChannel(t)!==this.getChannel(t))return!1;return!0}convert(e){return z.convertColor({from:this,format:e==null?void 0:e.format,numChannels:e==null?void 0:e.numChannels,alpha:e==null?void 0:e.alpha})}}});var bt,li=A(()=>{"use strict";G();ae();H();bt=class{get format(){return 0}get length(){return this._length}get maxChannelValue(){return 1}get maxIndexValue(){return 1}get isLdrFormat(){return!0}get isHdrFormat(){return!1}get hasPalette(){return!1}get palette(){}get index(){return this.r}set index(e){this.r=e}get r(){return this.getChannel(0)}set r(e){this.setChannel(0,e)}get g(){return this.getChannel(1)}set g(e){this.setChannel(1,e)}get b(){return this.getChannel(2)}set b(e){this.setChannel(2,e)}get a(){return this.getChannel(3)}set a(e){this.setChannel(3,e)}get rNormalized(){return this.r/this.maxChannelValue}set rNormalized(e){this.r=e*this.maxChannelValue}get gNormalized(){return this.g/this.maxChannelValue}set gNormalized(e){this.g=e*this.maxChannelValue}get bNormalized(){return this.b/this.maxChannelValue}set bNormalized(e){this.b=e*this.maxChannelValue}get aNormalized(){return this.a/this.maxChannelValue}set aNormalized(e){this.a=e*this.maxChannelValue}get luminance(){return z.getLuminance(this)}get luminanceNormalized(){return z.getLuminanceNormalized(this)}constructor(e){typeof e=="number"?(this._length=e,this._data=0):(this._length=e.length,this._data=0,this.setRgba(e.length>0?e[0]:0,e.length>1?e[1]:0,e.length>2?e[2]:0,e.length>3?e[3]:0))}static from(e){let t=new bt(e._length);return t._data=e._data,t}static fromArray(e){return new bt(e)}static rgb(e,t,n){return new bt([e,t,n])}static rgba(e,t,n,i){return new bt([e,t,n,i])}getChannel(e){return e<this.length?this._data>>7-e&1:0}getChannelNormalized(e){return this.getChannel(e)/this.maxChannelValue}setChannel(e,t){let n=e;if(n>=this.length)return;n=7-n;let i=this._data;t!==0?i|=1<<n:i&=~(1<<n&255),this._data=i}set(e){this.setRgba(e.r,e.g,e.b,e.a)}setRgb(e,t,n){this.r=e,this.g=t,this.b=n}setRgba(e,t,n,i){this.r=e,this.g=t,this.b=n,this.a=i}toArray(){return U.generate(this.length,e=>this.getChannel(e))}clone(){return bt.from(this)}equals(e){if(e.length!==this.length)return!1;for(let t=0;t<this.length;t++)if(e.getChannel(t)!==this.getChannel(t))return!1;return!0}convert(e){return z.convertColor({from:this,format:e==null?void 0:e.format,numChannels:e==null?void 0:e.numChannels,alpha:e==null?void 0:e.alpha})}}});var ft,mi=A(()=>{"use strict";G();oe();ae();H();ft=class{get format(){return 4}get length(){return this.data.length}get maxChannelValue(){return 65535}get maxIndexValue(){return 65535}get isLdrFormat(){return!1}get isHdrFormat(){return!0}get hasPalette(){return!1}get palette(){}get index(){return this.r}set index(e){this.r=e}get r(){return this.getChannel(0)}set r(e){this.setChannel(0,e)}get g(){return this.getChannel(1)}set g(e){this.setChannel(1,e)}get b(){return this.getChannel(2)}set b(e){this.setChannel(2,e)}get a(){return this.getChannel(3)}set a(e){this.setChannel(3,e)}get rNormalized(){return this.r/this.maxChannelValue}set rNormalized(e){this.r=e*this.maxChannelValue}get gNormalized(){return this.g/this.maxChannelValue}set gNormalized(e){this.g=e*this.maxChannelValue}get bNormalized(){return this.b/this.maxChannelValue}set bNormalized(e){this.b=e*this.maxChannelValue}get aNormalized(){return this.a/this.maxChannelValue}set aNormalized(e){this.a=e*this.maxChannelValue}get luminance(){return z.getLuminance(this)}get luminanceNormalized(){return z.getLuminanceNormalized(this)}constructor(e){typeof e=="number"?this.data=new Uint16Array(e):this.data=e.slice()}static from(e){let t=new ft(e.length);return t.data=e.data,t}static fromArray(e){return new ft(e)}static rgb(e,t,n){let i=new Uint16Array([e,t,n]);return new ft(i)}static rgba(e,t,n,i){let r=new Uint16Array([e,t,n,i]);return new ft(r)}getChannel(e){return e===4?this.luminance:e<this.data.length?this.data[e]:0}getChannelNormalized(e){return this.getChannel(e)/this.maxChannelValue}setChannel(e,t){e<this.data.length&&(this.data[e]=Math.trunc(t))}set(e){this.setRgba(e.r,e.g,e.b,e.a)}setRgb(e,t,n){this.data[0]=Math.trunc(e);let i=this.data.length;i>1&&(this.data[1]=Math.trunc(t),i>2&&(this.data[2]=Math.trunc(n)))}setRgba(e,t,n,i){this.data[0]=Math.trunc(e);let r=this.data.length;r>1&&(this.data[1]=Math.trunc(t),r>2&&(this.data[2]=Math.trunc(n),r>3&&(this.data[3]=Math.trunc(i))))}toArray(){return U.generate(this.length,e=>this.getChannel(e))}clone(){return ft.from(this)}equals(e){if(e.length!==this.length)return!1;for(let t=0;t<this.length;t++)if(e.getChannel(t)!==this.getChannel(t))return!1;return!0}convert(e){return z.convertColor({from:this,format:e==null?void 0:e.format,numChannels:e==null?void 0:e.numChannels,alpha:e==null?void 0:e.alpha})}}});var dt,hi=A(()=>{"use strict";G();ae();H();dt=class{get format(){return 1}get length(){return this._length}get maxChannelValue(){return 3}get maxIndexValue(){return 3}get isLdrFormat(){return!0}get isHdrFormat(){return!1}get hasPalette(){return!1}get palette(){}get index(){return this.r}set index(e){this.r=e}get r(){return this.getChannel(0)}set r(e){this.setChannel(0,e)}get g(){return this.getChannel(1)}set g(e){this.setChannel(1,e)}get b(){return this.getChannel(2)}set b(e){this.setChannel(2,e)}get a(){return this.getChannel(3)}set a(e){this.setChannel(3,e)}get rNormalized(){return this.r/this.maxChannelValue}set rNormalized(e){this.r=e*this.maxChannelValue}get gNormalized(){return this.g/this.maxChannelValue}set gNormalized(e){this.g=e*this.maxChannelValue}get bNormalized(){return this.b/this.maxChannelValue}set bNormalized(e){this.b=e*this.maxChannelValue}get aNormalized(){return this.a/this.maxChannelValue}set aNormalized(e){this.a=e*this.maxChannelValue}get luminance(){return z.getLuminance(this)}get luminanceNormalized(){return z.getLuminanceNormalized(this)}constructor(e){typeof e=="number"?(this._length=e,this._data=0):(this._length=e.length,this._data=0,this.setRgba(e.length>0?e[0]:0,e.length>1?e[1]:0,e.length>2?e[2]:0,e.length>3?e[3]:0))}static from(e){let t=new dt(e._length);return t._data=e._data,t}static fromArray(e){return new dt(e)}static rgb(e,t,n){return new dt([e,t,n])}static rgba(e,t,n,i){return new dt([e,t,n,i])}getChannel(e){return e<this.length?this._data>>6-(e<<1)&3:0}getChannelNormalized(e){return this.getChannel(e)/this.maxChannelValue}setChannel(e,t){if(e>=this.length)return;let r=[~(3<<6-(0<<1))&255,~(3<<6-(1<<1))&255,~(3<<6-(2<<1))&255,~(3<<6-(3<<1))&255][e],a=Math.trunc(t)&3;this._data=this._data&r|a<<6-(e<<1)}set(e){this.setRgba(e.r,e.g,e.b,e.a)}setRgb(e,t,n){this.r=e,this.g=t,this.b=n}setRgba(e,t,n,i){this.r=e,this.g=t,this.b=n,this.a=i}toArray(){return U.generate(this.length,e=>this.getChannel(e))}clone(){return dt.from(this)}equals(e){if(e.length!==this.length)return!1;for(let t=0;t<this.length;t++)if(e.getChannel(t)!==this.getChannel(t))return!1;return!0}convert(e){return z.convertColor({from:this,format:e==null?void 0:e.format,numChannels:e==null?void 0:e.numChannels,alpha:e==null?void 0:e.alpha})}}});var pt,ci=A(()=>{"use strict";G();oe();ae();H();pt=class{get format(){return 5}get length(){return this.data.length}get maxChannelValue(){return 4294967295}get maxIndexValue(){return 4294967295}get isLdrFormat(){return!1}get isHdrFormat(){return!0}get hasPalette(){return!1}get palette(){}get index(){return this.r}set index(e){this.r=e}get r(){return this.getChannel(0)}set r(e){this.setChannel(0,e)}get g(){return this.getChannel(1)}set g(e){this.setChannel(1,e)}get b(){return this.getChannel(2)}set b(e){this.setChannel(2,e)}get a(){return this.getChannel(3)}set a(e){this.setChannel(3,e)}get rNormalized(){return this.r/this.maxChannelValue}set rNormalized(e){this.r=e*this.maxChannelValue}get gNormalized(){return this.g/this.maxChannelValue}set gNormalized(e){this.g=e*this.maxChannelValue}get bNormalized(){return this.b/this.maxChannelValue}set bNormalized(e){this.b=e*this.maxChannelValue}get aNormalized(){return this.a/this.maxChannelValue}set aNormalized(e){this.a=e*this.maxChannelValue}get luminance(){return z.getLuminance(this)}get luminanceNormalized(){return z.getLuminanceNormalized(this)}constructor(e){typeof e=="number"?this.data=new Uint32Array(e):this.data=e.slice()}static from(e){let t=new pt(e.length);return t.data=e.data,t}static fromArray(e){return new pt(e)}static rgb(e,t,n){let i=new Uint32Array([e,t,n]);return new pt(i)}static rgba(e,t,n,i){let r=new Uint32Array([e,t,n,i]);return new pt(r)}getChannel(e){return e===4?this.luminance:e<this.data.length?this.data[e]:0}getChannelNormalized(e){return this.getChannel(e)/this.maxChannelValue}setChannel(e,t){e<this.data.length&&(this.data[e]=Math.trunc(t))}set(e){this.setRgba(e.r,e.g,e.b,e.a)}setRgb(e,t,n){this.data[0]=Math.trunc(e);let i=this.data.length;i>1&&(this.data[1]=Math.trunc(t),i>2&&(this.data[2]=Math.trunc(n)))}setRgba(e,t,n,i){this.data[0]=Math.trunc(e);let r=this.data.length;r>1&&(this.data[1]=Math.trunc(t),r>2&&(this.data[2]=Math.trunc(n),r>3&&(this.data[3]=Math.trunc(i))))}toArray(){return U.generate(this.length,e=>this.getChannel(e))}clone(){return pt.from(this)}equals(e){if(e.length!==this.length)return!1;for(let t=0;t<this.length;t++)if(e.getChannel(t)!==this.getChannel(t))return!1;return!0}convert(e){return z.convertColor({from:this,format:e==null?void 0:e.format,numChannels:e==null?void 0:e.numChannels,alpha:e==null?void 0:e.alpha})}}});var gt,bi=A(()=>{"use strict";G();_e();ae();H();gt=class{get format(){return 2}get length(){return this._length}get maxChannelValue(){return 15}get maxIndexValue(){return 15}get isLdrFormat(){return!0}get isHdrFormat(){return!1}get hasPalette(){return!1}get palette(){}get index(){return this.r}set index(e){this.r=e}get r(){return this.getChannel(0)}set r(e){this.setChannel(0,e)}get g(){return this.getChannel(1)}set g(e){this.setChannel(1,e)}get b(){return this.getChannel(2)}set b(e){this.setChannel(2,e)}get a(){return this.getChannel(3)}set a(e){this.setChannel(3,e)}get rNormalized(){return this.r/this.maxChannelValue}set rNormalized(e){this.r=e*this.maxChannelValue}get gNormalized(){return this.g/this.maxChannelValue}set gNormalized(e){this.g=e*this.maxChannelValue}get bNormalized(){return this.b/this.maxChannelValue}set bNormalized(e){this.b=e*this.maxChannelValue}get aNormalized(){return this.a/this.maxChannelValue}set aNormalized(e){this.a=e*this.maxChannelValue}get luminance(){return z.getLuminance(this)}get luminanceNormalized(){return z.getLuminanceNormalized(this)}constructor(e){typeof e=="number"?(this._length=e,this._data=new Uint8Array(this.length<3?1:2)):(this._length=e.length,this._data=new Uint8Array(this._length<3?1:2),this.setRgba(this._length>0?e[0]:0,this._length>1?e[1]:0,this._length>2?e[2]:0,this._length>3?e[3]:0))}static from(e){let t=new gt(e._length);return t._data=e._data,t}static fromArray(e){return new gt(e)}static rgb(e,t,n){let i=new gt(3);return i.setRgb(e,t,n),i}static rgba(e,t,n,i){let r=new gt(4);return r.setRgba(e,t,n,i),r}getChannel(e){return e<0||e>=this.length?0:e<2?this._data[0]>>4-(e<<2)&15:this._data[1]>>4-((e&1)<<2)&15}getChannelNormalized(e){return this.getChannel(e)/this.maxChannelValue}setChannel(e,t){let n=e;if(n>=this.length)return;let i=_.clamp(Math.trunc(t),0,15),r=0;n>1&&(n&=1,r=1),n===0?this._data[r]=this._data[r]&15|i<<4:n===1&&(this._data[r]=this._data[r]&240|i)}set(e){this.setRgba(e.r,e.g,e.b,e.a)}setRgb(e,t,n){this.r=e,this.g=t,this.b=n}setRgba(e,t,n,i){this.r=e,this.g=t,this.b=n,this.a=i}toArray(){return U.generate(this.length,e=>this.getChannel(e))}clone(){return gt.from(this)}equals(e){if(e.length!==this.length)return!1;for(let t=0;t<this.length;t++)if(e.getChannel(t)!==this.getChannel(t))return!1;return!0}convert(e){return z.convertColor({from:this,format:e==null?void 0:e.format,numChannels:e==null?void 0:e.numChannels,alpha:e==null?void 0:e.alpha})}}});var ge,en=A(()=>{"use strict";G();oe();ae();H();ge=class{get format(){return 3}get length(){return this.data.length}get maxChannelValue(){return 255}get maxIndexValue(){return 255}get isLdrFormat(){return!0}get isHdrFormat(){return!1}get hasPalette(){return!1}get palette(){}get index(){return this.r}set index(e){this.r=e}get r(){return this.getChannel(0)}set r(e){this.setChannel(0,e)}get g(){return this.getChannel(1)}set g(e){this.setChannel(1,e)}get b(){return this.getChannel(2)}set b(e){this.setChannel(2,e)}get a(){return this.getChannel(3,255)}set a(e){this.setChannel(3,e)}get rNormalized(){return this.r/this.maxChannelValue}set rNormalized(e){this.r=e*this.maxChannelValue}get gNormalized(){return this.g/this.maxChannelValue}set gNormalized(e){this.g=e*this.maxChannelValue}get bNormalized(){return this.b/this.maxChannelValue}set bNormalized(e){this.b=e*this.maxChannelValue}get aNormalized(){return this.a/this.maxChannelValue}set aNormalized(e){this.a=e*this.maxChannelValue}get luminance(){return z.getLuminance(this)}get luminanceNormalized(){return z.getLuminanceNormalized(this)}constructor(e){typeof e=="number"?this.data=new Uint8Array(e):this.data=e.slice()}static from(e){let t=new ge(e.length);return t.data=e.data,t}static fromArray(e){return new ge(e)}static rgb(e,t,n){let i=new Uint8Array([e,t,n]);return new ge(i)}static rgba(e,t,n,i){let r=new Uint8Array([e,t,n,i]);return new ge(r)}getChannel(e,t=0){return e===4?this.luminance:e<this.data.length?this.data[e]:t}getChannelNormalized(e){return this.getChannel(e)/this.maxChannelValue}setChannel(e,t){e<this.data.length&&(this.data[e]=Math.trunc(t))}set(e){this.setRgba(e.r,e.g,e.b,e.a)}setRgb(e,t,n){this.data[0]=Math.trunc(e);let i=this.data.length;i>1&&(this.data[1]=Math.trunc(t),i>2&&(this.data[2]=Math.trunc(n)))}setRgba(e,t,n,i){this.data[0]=Math.trunc(e);let r=this.data.length;r>1&&(this.data[1]=Math.trunc(t),r>2&&(this.data[2]=Math.trunc(n),r>3&&(this.data[3]=Math.trunc(i))))}toArray(){return U.generate(this.length,e=>this.getChannel(e))}clone(){return ge.from(this)}equals(e){if(e.length!==this.length)return!1;for(let t=0;t<this.length;t++)if(e.getChannel(t)!==this.getChannel(t))return!1;return!0}convert(e){return z.convertColor({from:this,format:e==null?void 0:e.format,numChannels:e==null?void 0:e.numChannels,alpha:e==null?void 0:e.alpha})}}});var z,ae=A(()=>{"use strict";_e();be();fi();ri();ai();si();ui();oi();li();mi();hi();ci();bi();en();H();z=class{static convertColorInternal(e,t,n){var u,o;let i=t.length,r=t.format,a=(o=(u=e.palette)==null?void 0:u.format)!=null?o:e.format,s=e.length;if(i===1){let l=Math.trunc(e.length>2?e.luminance:e.getChannel(0));t.setChannel(0,ar(l,a,r))}else if(i<=s)for(let l=0;l<i;++l)t.setChannel(l,ar(e.getChannel(l),a,r));else{for(let m=0;m<s;++m)t.setChannel(m,ar(e.getChannel(m),a,r));let l=s===1?t.getChannel(0):0;for(let m=s;m<i;++m)t.setChannel(m,m===3?n:l)}return t}static uint32ToRed(e){return e&255}static uint32ToGreen(e){return e>>8&255}static uint32ToBlue(e){return e>>16&255}static uint32ToAlpha(e){return e>>24&255}static rgbaToUint32(e,t,n,i){return _.clampInt255(e)|_.clampInt255(t)<<8|_.clampInt255(n)<<16|_.clampInt255(i)<<24}static convertColor(e){var a,s,u,o,l,m,b,h,c,d,p,g,x,y,C,I,P,F,M,w,k;let t=(s=(a=e.from.palette)==null?void 0:a.format)!=null?s:e.from.format,n=(l=(o=(u=e.to)==null?void 0:u.format)!=null?o:e.format)!=null?l:e.from.format,i=(h=(b=(m=e.to)==null?void 0:m.length)!=null?b:e.numChannels)!=null?h:e.from.length,r=(c=e.alpha)!=null?c:0;if(n===t&&i===e.from.length)return e.to===void 0?e.from.clone():(e.to.set(e.from),e.to);switch(n){case 3:{let B=(d=e.to)!=null?d:new ge(i);return this.convertColorInternal(e.from,B,r)}case 0:{let B=(p=e.to)!=null?p:new bt(i);return this.convertColorInternal(e.from,B,r)}case 1:{let B=(g=e.to)!=null?g:new dt(i);return this.convertColorInternal(e.from,B,r)}case 2:{let B=(x=e.to)!=null?x:new gt(i);return this.convertColorInternal(e.from,B,r)}case 4:{let B=(y=e.to)!=null?y:new ft(i);return this.convertColorInternal(e.from,B,r)}case 5:{let B=(C=e.to)!=null?C:new pt(i);return this.convertColorInternal(e.from,B,r)}case 6:{let B=(I=e.to)!=null?I:new ct(i);return this.convertColorInternal(e.from,B,r)}case 7:{let B=(P=e.to)!=null?P:new mt(i);return this.convertColorInternal(e.from,B,r)}case 8:{let B=(F=e.to)!=null?F:new ht(i);return this.convertColorInternal(e.from,B,r)}case 9:{let B=(M=e.to)!=null?M:new xt(i);return this.convertColorInternal(e.from,B,r)}case 10:{let B=(w=e.to)!=null?w:new ot(i);return this.convertColorInternal(e.from,B,r)}case 11:{let B=(k=e.to)!=null?k:new lt(i);return this.convertColorInternal(e.from,B,r)}}throw new T("Unknown format.")}static getLuminance(e){return .299*e.r+.587*e.g+.114*e.b}static getLuminanceNormalized(e){return .299*e.rNormalized+.587*e.gNormalized+.114*e.bNormalized}static getLuminanceRgb(e,t,n){return .299*e+.587*t+.114*n}static hslToRgb(e,t,n){if(t===0){let l=Math.trunc(n*255);return[l,l,l]}let i=(l,m,b)=>{let h=b;return h<0&&(h+=1),h>1&&(h-=1),h<1/6?l+(m-l)*6*h:h<1/2?m:h<2/3?l+(m-l)*(2/3-h)*6:l},r=n<.5?n*(1+t):n+t-n*t,a=2*n-r,s=i(a,r,e+1/3),u=i(a,r,e),o=i(a,r,e-1/3);return[Math.round(s*255),Math.round(u*255),Math.round(o*255)]}static hsvToRgb(e,t,n){if(t===0){let o=Math.round(n*255);return[o,o,o]}let i=(e-Math.floor(e))*6,r=i-Math.floor(i),a=n*(1-t),s=n*(1-t*r),u=n*(1-t*(1-r));switch(Math.trunc(i)){case 0:return[Math.round(n*255),Math.round(u*255),Math.round(a*255)];case 1:return[Math.round(s*255),Math.round(n*255),Math.round(a*255)];case 2:return[Math.round(a*255),Math.round(n*255),Math.round(u*255)];case 3:return[Math.round(a*255),Math.round(s*255),Math.round(n*255)];case 4:return[Math.round(u*255),Math.round(a*255),Math.round(n*255)];case 5:return[Math.round(n*255),Math.round(a*255),Math.round(s*255)];default:throw new T("Invalid hue.")}}static rgbToHsl(e,t,n){let i=e/255,r=t/255,a=n/255,s=Math.max(i,Math.max(r,a)),u=Math.min(i,Math.min(r,a)),o=(s+u)/2;if(s===u)return[0,0,o];let l=s-u,m=o>.5?l/(2-s-u):l/(s+u),b=0;return s===i?b=(r-a)/l+(r<a?6:0):s===r?b=(a-i)/l+2:b=(i-r)/l+4,b/=6,[b,m,o]}static labToXyz(e,t,n){let i=(e+16)/116,r=i+t/500,a=i-n/200;return Math.pow(r,3)>.008856?r=Math.pow(r,3):r=(r-16/116)/7.787,Math.pow(i,3)>.008856?i=Math.pow(i,3):i=(i-16/116)/7.787,Math.pow(a,3)>.008856?a=Math.pow(a,3):a=(a-16/116)/7.787,[Math.trunc(r*95.047),Math.trunc(i*100),Math.trunc(a*108.883)]}static xyzToRgb(e,t,n){let i=e/100,r=t/100,a=n/100,s=3.2406*i+-1.5372*r+-.4986*a,u=-.9689*i+1.8758*r+.0415*a,o=.0557*i+-.204*r+1.057*a;return s>.0031308?s=1.055*Math.pow(s,.4166666667)-.055:s*=12.92,u>.0031308?u=1.055*Math.pow(u,.4166666667)-.055:u*=12.92,o>.0031308?o=1.055*Math.pow(o,.4166666667)-.055:o*=12.92,[_.clampInt255(s*255),_.clampInt255(u*255),_.clampInt255(o*255)]}static cmykToRgb(e,t,n,i){let r=e/255,a=t/255,s=n/255,u=i/255;return[Math.round(255*(1-r)*(1-u)),Math.round(255*(1-a)*(1-u)),Math.round(255*(1-s)*(1-u))]}static labToRgb(e,t,n){let s=(e+16)/116,u=t/500+s,o=s-n/200,l=Math.pow(s,3);l>.008856?s=l:s=(s-16/116)/7.787;let m=Math.pow(u,3);m>.008856?u=m:u=(u-16/116)/7.787;let b=Math.pow(o,3);b>.008856?o=b:o=(o-16/116)/7.787,u*=95.047,s*=100,o*=108.883,u/=100,s/=100,o/=100;let h=u*3.2406+s*-1.5372+o*-.4986,c=u*-.9689+s*1.8758+o*.0415,d=u*.0557+s*-.204+o*1.057;return h>.0031308?h=1.055*Math.pow(h,1/2.4)-.055:h*=12.92,c>.0031308?c=1.055*Math.pow(c,1/2.4)-.055:c*=12.92,d>.0031308?d=1.055*Math.pow(d,1/2.4)-.055:d*=12.92,[_.clampInt255(h*255),_.clampInt255(c*255),_.clampInt255(d*255)]}static rgbToXyz(e,t,n){let i=e/255,r=t/255,a=n/255;return i>.04045?i=Math.pow((i+.055)/1.055,2.4):i/=12.92,r>.04045?r=Math.pow((r+.055)/1.055,2.4):r/=12.92,a>.04045?a=Math.pow((a+.055)/1.055,2.4):a/=12.92,i*=100,r*=100,a*=100,[i*.4124+r*.3576+a*.1805,i*.2126+r*.7152+a*.0722,i*.0193+r*.1192+a*.9505]}static xyzToLab(e,t,n){let i=e/95.047,r=t/100,a=n/108.883;return i>.008856?i=Math.pow(i,1/3):i=7.787*i+16/116,r>.008856?r=Math.pow(r,1/3):r=7.787*r+16/116,a>.008856?a=Math.pow(a,1/3):a=7.787*a+16/116,[116*r-16,500*(i-r),200*(r-a)]}static rgbToLab(e,t,n){let i=e/255,r=t/255,a=n/255;i>.04045?i=Math.pow((i+.055)/1.055,2.4):i/=12.92,r>.04045?r=Math.pow((r+.055)/1.055,2.4):r/=12.92,a>.04045?a=Math.pow((a+.055)/1.055,2.4):a/=12.92,i*=100,r*=100,a*=100;let s=i*.4124+r*.3576+a*.1805,u=i*.2126+r*.7152+a*.0722,o=i*.0193+r*.1192+a*.9505;return s/=95.047,u/=100,o/=108.883,s>.008856?s=Math.pow(s,1/3):s=7.787*s+16/116,u>.008856?u=Math.pow(u,1/3):u=7.787*u+16/116,o>.008856?o=Math.pow(o,1/3):o=7.787*o+16/116,[116*u-16,500*(s-u),200*(u-o)]}}});var xt,fi=A(()=>{"use strict";G();un();oe();ae();H();xt=class{get format(){return 9}get length(){return this.data.length}get maxChannelValue(){return 1}get maxIndexValue(){return 1}get isLdrFormat(){return!1}get isHdrFormat(){return!0}get hasPalette(){return!1}get palette(){}get index(){return this.r}set index(e){this.r=e}get r(){return this.getChannel(0)}set r(e){this.setChannel(0,e)}get g(){return this.getChannel(1)}set g(e){this.setChannel(1,e)}get b(){return this.getChannel(2)}set b(e){this.setChannel(2,e)}get a(){return this.getChannel(3)}set a(e){this.setChannel(3,e)}get rNormalized(){return this.r/this.maxChannelValue}set rNormalized(e){this.r=e*this.maxChannelValue}get gNormalized(){return this.g/this.maxChannelValue}set gNormalized(e){this.g=e*this.maxChannelValue}get bNormalized(){return this.b/this.maxChannelValue}set bNormalized(e){this.b=e*this.maxChannelValue}get aNormalized(){return this.a/this.maxChannelValue}set aNormalized(e){this.a=e*this.maxChannelValue}get luminance(){return z.getLuminance(this)}get luminanceNormalized(){return z.getLuminanceNormalized(this)}constructor(e){typeof e=="number"?this.data=new Uint16Array(e):this.data=e.slice()}static from(e){let t=new xt(e.length);return t.data=e.data,t}static fromArray(e){let t=new xt(e),n=e.length;for(let i=0;i<n;++i)t.data[i]=R.doubleToFloat16(e[i]);return t}static rgb(e,t,n){let i=new Uint16Array([R.doubleToFloat16(e),R.doubleToFloat16(t),R.doubleToFloat16(n)]);return new xt(i)}static rgba(e,t,n,i){let r=new Uint16Array([R.doubleToFloat16(e),R.doubleToFloat16(t),R.doubleToFloat16(n),R.doubleToFloat16(i)]);return new xt(r)}getChannel(e){return e===4?this.luminance:e<this.data.length?R.float16ToDouble(this.data[e]):0}getChannelNormalized(e){return this.getChannel(e)/this.maxChannelValue}setChannel(e,t){e<this.data.length&&(this.data[e]=R.doubleToFloat16(t))}set(e){this.setRgba(e.r,e.g,e.b,e.a)}setRgb(e,t,n){this.data[0]=R.doubleToFloat16(e);let i=this.data.length;i>1&&(this.data[1]=R.doubleToFloat16(t),i>2&&(this.data[2]=R.doubleToFloat16(n)))}setRgba(e,t,n,i){this.data[0]=R.doubleToFloat16(e);let r=this.data.length;r>1&&(this.data[1]=R.doubleToFloat16(t),r>2&&(this.data[2]=R.doubleToFloat16(n),r>3&&(this.data[3]=R.doubleToFloat16(i))))}toArray(){return U.generate(this.length,e=>this.getChannel(e))}clone(){return xt.from(this)}equals(e){if(e.length!==this.length)return!1;for(let t=0;t<this.length;t++)if(e.getChannel(t)!==this.getChannel(t))return!1;return!0}convert(e){return z.convertColor({from:this,format:e==null?void 0:e.format,numChannels:e==null?void 0:e.numChannels,alpha:e==null?void 0:e.alpha})}}});var tn,dn=A(()=>{"use strict";en();tn=class extends ge{constructor(e,t,n){let i=new Uint8Array([e,t,n]);super(i)}static from(e){let t=new Uint8Array([e.getChannel(0),e.getChannel(1),e.getChannel(2)]);return new ge(t)}}});var Dt,pn=A(()=>{"use strict";en();Dt=class extends ge{constructor(e,t,n,i){let r=new Uint8Array([e,t,n,i]);super(r)}static from(e){let t=new Uint8Array([e.getChannel(0),e.getChannel(1),e.getChannel(2),e.getChannel(3)]);return new ge(t)}}});var ts=A(()=>{"use strict"});var vs,di,pi=A(()=>{"use strict";vs=class{static makeTable(){let e=[],t=0;for(let n=0;n<256;n++){t=n;for(let i=0;i<8;i++)t=t&1?3988292384^t>>>1:t>>>1;e[n]=t}return e}static getChecksum(e){var s,u,o;let t=vs._crcTable,n=(s=e.length)!=null?s:e.buffer.length,i=(u=e.position)!=null?u:0,r=i+n,a=((o=e.baseCrc)!=null?o:0)^-1;for(let l=i;l<r;l++)a=a>>>8^t[(a^e.buffer[l])&255];return(a^-1)>>>0}},di=vs;di._crcTable=new Uint32Array(vs.makeTable())});var we,nn=A(()=>{"use strict";be();we=class{static getCodePoints(e){let t=new Uint8Array(e.length);for(let n=0;n<e.length;n++){let i=e.codePointAt(n);if(i!==void 0)if(0<=i&&i<256)t[n]=i;else throw new T(`Error encoding text "${e}": unknown character code point ${i}`);else throw new T(`Error encoding text "${e}"`)}return t}};we.utf8Decoder=new TextDecoder("utf8"),we.latin1Decoder=new TextDecoder("latin1")});var Y,je=A(()=>{"use strict";be();Jt();nn();Y=class{get buffer(){return this._buffer}set bigEndian(e){this._bigEndian=e}get bigEndian(){return this._bigEndian}set offset(e){this._offset=e}get offset(){return this._offset}get start(){return this._start}get end(){return this._end}get position(){return this._offset-this._start}get length(){return this._end-this._offset}get isEOS(){return this._offset>=this._end}constructor(e){var t,n;this._buffer=e.buffer,this._bigEndian=(t=e.bigEndian)!=null?t:!1,this._offset=(n=e.offset)!=null?n:0,this._start=this._offset,this._end=e.length!==void 0?this._start+e.length:this._buffer.length}static from(e,t,n){let i=t!=null?t:0,r=new Y({buffer:e._buffer,bigEndian:e._bigEndian,offset:e._offset+i,length:n});return r._start=e._start,r._end=n!==void 0?e.offset+i+n:e._end,r}rewind(){this._offset=this._start}getByte(e){return this._buffer[this._offset+e]}setByte(e,t){return this._buffer[this._offset+e]=t}memset(e,t,n){this._buffer.fill(this._offset+e,this._offset+e+t,n)}subarray(e,t,n=0){let i=t!==void 0?this._start+t:this._offset;return i+=n,new Y({buffer:this._buffer,bigEndian:this._bigEndian,offset:i,length:e})}indexOf(e,t=0){let n=this.offset+this.length;for(let i=this.offset+t;i<n;++i)if(this._buffer[i]===e)return i-this._start;return-1}peekBytes(e,t=0){return this.subarray(e,void 0,t)}skip(e){this._offset+=e}readByte(){return this._buffer[this._offset++]}readInt8(){return K.uint8ToInt8(this.readByte())}readBytes(e){let t=this.subarray(e);return this._offset+=t.length,t}readString(e){if(e===void 0){let r=[];for(;!this.isEOS;){let a=this.readByte();if(a===0)return String.fromCharCode(...r);r.push(a)}throw new T("EOF reached without finding string terminator.")}let n=this.readBytes(e).toUint8Array();return String.fromCharCode(...n)}readStringUtf8(){let e=[];for(;!this.isEOS;){let n=this.readByte();if(n===0){let i=new Uint8Array(e);return we.utf8Decoder.decode(i)}e.push(n)}let t=new Uint8Array(e);return we.utf8Decoder.decode(t)}readUint16(){let e=this._buffer[this._offset++]&255,t=this._buffer[this._offset++]&255;return this._bigEndian?e<<8|t:t<<8|e}readInt16(){return K.uint16ToInt16(this.readUint16())}readUint24(){let e=this._buffer[this._offset++]&255,t=this._buffer[this._offset++]&255,n=this._buffer[this._offset++]&255;return this._bigEndian?n|t<<8|e<<16:e|t<<8|n<<16}readUint32(){return K.int32ToUint32(this.readInt32())}readInt32(){let e=this._buffer[this._offset++]&255,t=this._buffer[this._offset++]&255,n=this._buffer[this._offset++]&255,i=this._buffer[this._offset++]&255;return this._bigEndian?e<<24|t<<16|n<<8|i:i<<24|n<<16|t<<8|e}readFloat32(){return K.uint32ToFloat32(this.readUint32())}readFloat64(){return K.uint64ToFloat64(this.readUint64())}readUint64(){let e=this._buffer[this._offset++]&255,t=this._buffer[this._offset++]&255,n=this._buffer[this._offset++]&255,i=this._buffer[this._offset++]&255,r=this._buffer[this._offset++]&255,a=this._buffer[this._offset++]&255,s=this._buffer[this._offset++]&255,u=this._buffer[this._offset++]&255;return this._bigEndian?BigInt(e<<56)|BigInt(t<<48)|BigInt(n<<40)|BigInt(i<<32)|BigInt(r<<24)|BigInt(a<<16)|BigInt(s<<8)|BigInt(u):BigInt(u<<56)|BigInt(s<<48)|BigInt(a<<40)|BigInt(r<<32)|BigInt(i<<24)|BigInt(n<<16)|BigInt(t<<8)|BigInt(e)}toUint8Array(e,t){let n=e!=null?e:0,i=t!=null?t:this.length-n;return new Uint8Array(this._buffer.buffer,this._buffer.byteOffset+this._offset+n,i)}toUint32Array(e){let t=e!=null?e:0;return new Uint32Array(this._buffer.buffer,this._buffer.byteOffset+this._offset+t)}}});var Sn=A(()=>{"use strict"});var ve,sr=A(()=>{"use strict";ve=class{get x1(){return this._x1}get y1(){return this._y1}get x2(){return this._x2}get y2(){return this._y2}get dx(){return this._x2-this._x1}get dy(){return this._y2-this._y1}constructor(e,t,n,i){this._x1=e,this._y1=t,this._x2=n,this._y2=i}static from(e){return new ve(e.x1,e.y1,e.x2,e.y2)}movePoint1(e,t){this._x1=e,this._y1=t}movePoint2(e,t){this._x2=e,this._y2=t}swapXY1(){let e=this._x1;this._x1=this._y1,this._y1=e}swapXY2(){let e=this._x2;this._x2=this._y2,this._y2=e}flipX(){let e=this._x1;this._x1=this._x2,this._x2=e}flipY(){let e=this._y1;this._y1=this._y2,this._y2=e}clone(){return new ve(this._x1,this._y1,this._x2,this._y2)}toString(){return`${this.constructor.name} (x1: ${this._x1}, y1: ${this._y1}, x2: ${this._x2}, y2: ${this._y2})`}}});var ns,Be,At=A(()=>{"use strict";G();ns=class{get buffer(){return this._buffer}get bigEndian(){return this._bigEndian}set bigEndian(e){this._bigEndian=e}get length(){return this._length}set length(e){this._length=e}constructor(e){var t,n;this._bigEndian=(t=e==null?void 0:e.bigEndian)!=null?t:!1,this._buffer=new Uint8Array((n=e==null?void 0:e.size)!=null?n:ns._blockSize),this._length=0}expandBuffer(e){let t=ns._blockSize;e!==void 0?t=e:this._buffer.length>0&&(t=this._buffer.length*2);let n=new Uint8Array(this._buffer.length+t);U.copyRange(this._buffer,0,this._buffer.length,n,0),this._buffer=n}rewind(){this._length=0}clear(){this._buffer=new Uint8Array(ns._blockSize),this._length=0}getBytes(){return new Uint8Array(this._buffer.buffer,0,this._length)}writeByte(e){this._length===this._buffer.length&&this.expandBuffer(),this._buffer[this._length++]=e&255}writeBytes(e,t){let n=t!=null?t:e.length;for(;this._length+n>this._buffer.length;)this.expandBuffer(this._length+n-this._buffer.length);U.copyRange(e,0,n,this._buffer,this._length),this._length+=n}writeBuffer(e){let t=e.length,n=this._length+t;for(;n>this._buffer.length;)this.expandBuffer(n-this._buffer.length);U.copyRange(e.buffer,e.offset,t,this._buffer,this._length),this._length+=t}writeUint16(e){if(this._bigEndian){this.writeByte(e>>8&255),this.writeByte(e&255);return}this.writeByte(e&255),this.writeByte(e>>8&255)}writeUint32(e){if(this._bigEndian){this.writeByte(e>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(e&255);return}this.writeByte(e&255),this.writeByte(e>>8&255),this.writeByte(e>>16&255),this.writeByte(e>>24&255)}writeFloat32(e){let t=new Float32Array(1);t[0]=e;let n=new Uint8Array(t.buffer);if(this._bigEndian){this.writeByte(n[3]),this.writeByte(n[2]),this.writeByte(n[1]),this.writeByte(n[0]);return}this.writeByte(n[0]),this.writeByte(n[1]),this.writeByte(n[2]),this.writeByte(n[3])}writeFloat64(e){let t=new Float64Array(1);t[0]=e;let n=new Uint8Array(t.buffer);if(this._bigEndian){this.writeByte(n[7]),this.writeByte(n[6]),this.writeByte(n[5]),this.writeByte(n[4]),this.writeByte(n[3]),this.writeByte(n[2]),this.writeByte(n[1]),this.writeByte(n[0]);return}this.writeByte(n[0]),this.writeByte(n[1]),this.writeByte(n[2]),this.writeByte(n[3]),this.writeByte(n[4]),this.writeByte(n[5]),this.writeByte(n[6]),this.writeByte(n[7])}subarray(e,t){let n=e>=0?e:this._length+e,i=t!=null?t:this._length;return i<0&&(i=this._length+i),new Uint8Array(this._buffer.buffer,n,i-n)}},Be=ns;Be._blockSize=8192});var L,gn=A(()=>{"use strict";L=class{get x(){return this._x}get y(){return this._y}get xt(){return Math.trunc(this.x)}get yt(){return Math.trunc(this.y)}constructor(e,t){this._x=e,this._y=t}static from(e){return new L(e._x,e._y)}move(e,t){return new L(e,t)}offset(e,t){return this.move(this._x+e,this._y+t)}mul(e){return this.move(this._x*e,this._y*e)}add(e){return this.move(this._x+e._x,this._y+e._y)}equals(e){return this._x===e._x&&this._y===e._y}toString(){return`${this.constructor.name} (x: ${this._x}, y: ${this._y})`}}});var ye,ur=A(()=>{"use strict";ye=class{static crand(){return 1-2*Math.random()}static grand(){let e=0,t=0;do{let n=2*Math.random()-1;e=2*Math.random()-1,t=e*e+n*n}while(t<=0||t>=1);return e*Math.sqrt(-2*Math.log(t)/t)}static prand(e){if(e<=1e-10)return 0;if(e>100)return Math.trunc(Math.sqrt(e)*ye.grand()+e);let t=0,n=Math.exp(-e);for(let i=1;i>=n;++t)i*=Math.random();return t-1}static intrand(e){return Math.floor(Math.random()*e)}}});var on,gi=A(()=>{"use strict";gn();on=class{get left(){return this._left}get top(){return this._top}get right(){return this._right}get bottom(){return this._bottom}get width(){return this._right-this._left}get height(){return this._bottom-this._top}get topLeft(){return new L(this._left,this._top)}get topRight(){return new L(this._right,this._top)}get bottomLeft(){return new L(this._left,this._bottom)}get bottomRight(){return new L(this._right,this._bottom)}constructor(e,t,n,i){this._left=Math.min(e,n),this._top=Math.min(t,i),this._right=Math.max(e,n),this._bottom=Math.max(t,i)}static fromXYWH(e,t,n,i){return new on(e,t,e+n,t+i)}static from(e){return new on(e._left,e._top,e._right,e._bottom)}toString(){return`${this.constructor.name} (l: ${this._left}, t: ${this._top}, r: ${this._right}, b: ${this._bottom}, w: ${this.width}, h: ${this.height})`}}});var is=A(()=>{"use strict"});var kn=A(()=>{"use strict"});var or=A(()=>{"use strict"});var Vt,xi=A(()=>{"use strict";gn();Vt=class{static circleTest(e,t,n,i=!0){let r=0,a=e.x-t.x,s=e.y-t.y,o=a*a+s*s<=n?1:0;r+=o;let l=e.x+1-t.x,m=e.y-t.y,h=l*l+m*m<=n?1:0;r+=h;let c=e.x+1-t.x,d=e.y+1-t.y,g=c*c+d*d<=n?1:0;r+=g;let x=e.x-t.x,y=e.y+1-t.y,I=x*x+y*y<=n?1:0;r+=I;let P=e.x+.5-t.x,F=e.y-t.y,w=P*P+F*F<=n?1:0;r+=w;let k=e.x+.5-t.x,B=e.y+1-t.y,O=k*k+B*B<=n?1:0;r+=O;let V=e.x-t.x,E=e.y+.5-t.y,X=V*V+E*E<=n?1:0;r+=X;let ie=e.x+1-t.x,te=e.y+.5-t.y,W=ie*ie+te*te<=n?1:0;r+=W;let j=e.x+.5-t.x,Re=e.y+.5-t.y,se=j*j+Re*Re<=n?1:0;return r+=se,i?r/9:r>0?1:0}static clipLine(e,t){let n=e.left,i=e.top,r=e.right,a=e.bottom,s=0,u=1,o=2,l=4,m=8,b=p=>{let g=s;return p.x<n?g|=u:p.x>r&&(g|=o),p.y<i?g|=l:p.y>a&&(g|=m),g},h=b(new L(t.x1,t.y1)),c=b(new L(t.x2,t.y2)),d=!1;for(;;)if(h|c){if(h&c)break;{let p=h!==0?h:c,g=0,x=0;p&m?(g=t.x1+Math.trunc(t.dx*(a-t.y1)/t.dy),x=a):p&l?(g=t.x1+Math.trunc(t.dx*(i-t.y1)/t.dy),x=i):p&o?(x=t.y1+Math.trunc(t.dy*(r-t.x1)/t.dx),g=r):p&u&&(x=t.y1+Math.trunc(t.dy*(n-t.x1)/t.dx),g=n),p===h?(t.movePoint1(g,x),h=b(new L(t.x1,t.y1))):(t.movePoint2(g,x),c=b(new L(t.x2,t.y2)))}}else{d=!0;break}return d}}});var D,zn=A(()=>{"use strict";oe();ae();G();sr();_e();gn();gi();xi();kn();or();D=class{static calculateCircumference(e,t,n){if(n<0||t.x+n<0||t.x-n>=e.width||t.y+n<0||t.y-n>=e.height)return[];if(n===0)return[t];let i=[new L(t.x-n,t.y),new L(t.x+n,t.y),new L(t.x,t.y-n),new L(t.x,t.y+n)];if(n===1)return i;for(let r=1-n,a=0,s=-(n<<1),u=0,o=n;u<o;)if(r>=0&&(s+=2,r+=s,--o),++u,a+=2,r+=a+1,u!==o+1){let l=t.x-o,m=t.x+o,b=t.y-u,h=t.y+u,c=t.x-u,d=t.x+u,p=t.y-o,g=t.y+o;i.push(new L(l,b)),i.push(new L(l,h)),i.push(new L(m,b)),i.push(new L(m,h)),u!==o&&(i.push(new L(c,p)),i.push(new L(d,g)),i.push(new L(d,p)),i.push(new L(c,g)))}return i}static drawAntialiasCircle(e){var s,u;let t=(o,l,m,b,h)=>{n&8&&D.drawPixel({image:e.image,pos:new L(o+m,l+b),color:e.color,alpha:h,maskChannel:i,mask:e.mask}),n&4&&D.drawPixel({image:e.image,pos:new L(o-m,l+b),color:e.color,alpha:h,maskChannel:i,mask:e.mask}),n&2&&D.drawPixel({image:e.image,pos:new L(o+m,l-b),color:e.color,alpha:h,maskChannel:i,mask:e.mask}),n&1&&D.drawPixel({image:e.image,pos:new L(o-m,l-b),color:e.color,alpha:h,maskChannel:i,mask:e.mask})},n=(s=e.quadrants)!=null?s:15,i=(u=e.maskChannel)!=null?u:4,r=e.radius*e.radius,a=Math.round(e.radius/Math.SQRT2);for(let o=0;o<=a;++o){let l=Math.sqrt(r-o*o),m=_.fract(l),b=m*(o===a?.25:1),h=Math.floor(l);t(e.x,e.y,o,h,1-m),t(e.x,e.y,o,h+1,b),t(e.x,e.y,h,o,1-m),t(e.x,e.y,h+1,o,b)}return e.image}static drawLineWu(e){let t=e.line.clone(),n=Math.abs(t.dy)>Math.abs(t.dx);n&&(t.swapXY1(),t.swapXY2()),t.x1>t.x2&&(t.flipX(),t.flipY());let i=t.dx===1?1:t.dy/t.dx,r=Math.floor(t.x1+.5),a=t.y1+i*(r-t.x1),s=1-(t.x1+.5-Math.floor(t.x1+.5)),u=r,o=Math.floor(a);n?(D.drawPixel({image:e.image,pos:new L(o,u),color:e.color,alpha:(1-(a-Math.floor(a)))*s,maskChannel:e.maskChannel,mask:e.mask}),D.drawPixel({image:e.image,pos:new L(o+1,u),color:e.color,alpha:(a-Math.floor(a))*s,maskChannel:e.maskChannel,mask:e.mask})):(D.drawPixel({image:e.image,pos:new L(u,o),color:e.color,alpha:(1-(a-Math.floor(a)))*s,maskChannel:e.maskChannel,mask:e.mask}),D.drawPixel({image:e.image,pos:new L(u,o+1),color:e.color,alpha:(a-Math.floor(a))*s,maskChannel:e.maskChannel,mask:e.mask}));let l=a+i;r=Math.floor(t.x2+.5),a=t.y2+i*(r-t.x2),s=t.x2+.5-Math.floor(t.x2+.5);let m=r,b=Math.floor(a);if(n){D.drawPixel({image:e.image,pos:new L(b,m),color:e.color,alpha:(1-(a-Math.floor(a)))*s,mask:e.mask,maskChannel:e.maskChannel}),D.drawPixel({image:e.image,pos:new L(b+1,m),color:e.color,alpha:(a-Math.floor(a))*s,maskChannel:e.maskChannel,mask:e.mask});for(let h=u+1;h<=m-1;h++)D.drawPixel({image:e.image,pos:new L(Math.floor(l),h),color:e.color,alpha:1-(l-Math.floor(l)),mask:e.mask,maskChannel:e.maskChannel}),D.drawPixel({image:e.image,pos:new L(Math.floor(l)+1,h),color:e.color,alpha:l-Math.floor(l),maskChannel:e.maskChannel,mask:e.mask}),l+=i}else{D.drawPixel({image:e.image,pos:new L(m,b),color:e.color,alpha:(1-(a-Math.floor(a)))*s,maskChannel:e.maskChannel,mask:e.mask}),D.drawPixel({image:e.image,pos:new L(m,b+1),color:e.color,alpha:(a-Math.floor(a))*s,maskChannel:e.maskChannel,mask:e.mask});for(let h=u+1;h<=m-1;h++)D.drawPixel({image:e.image,pos:new L(h,Math.floor(l)),color:e.color,alpha:1-(l-Math.floor(l)),maskChannel:e.maskChannel,mask:e.mask}),D.drawPixel({image:e.image,pos:new L(h,Math.floor(l)+1),color:e.color,alpha:l-Math.floor(l),maskChannel:e.maskChannel,mask:e.mask}),l+=i}return e.image}static setAlpha(e,t){return e.a=t,e}static colorDistance(e,t,n){let i=e[0]-t[0],r=e[1]-t[1],a=e[2]-t[2];if(n){let s=e[3]-t[3];return Math.sqrt(Math.max(i*i,(i-s)*(i-s))+Math.max(r*r,(r-s)*(r-s))+Math.max(a*a,(a-s)*(a-s)))}else return Math.sqrt(i*i+r*r+a*a)}static testPixelLabColorDistance(e,t,n,i,r){let a=e.getPixel(t,n),s=i.length>3,u=z.rgbToLab(a.r,a.g,a.b);return s&&u.push(a.a),D.colorDistance(u,i,s)>r}static fill4Core(e,t,n,i,r,a){let s=t,u=n;if(a[u*e.width+s]===1)return;let o=0;do{let l=0,m=s;if(o!==0&&i(u,s)){do if(--o===0)return;while(i(u,++s));m=s}else for(;s!==0&&!i(u,s-1);l++,o++)r(u,--s),u!==0&&!i(u-1,s)&&D.fill4(e,s,u-1,i,r,a);for(;m<e.width&&!i(u,m);l++,m++)r(u,m);if(l<o)for(let b=s+o;++m<b;)i(u,m)||D.fill4Core(e,m,u,i,r,a);else if(l>o&&u!==0)for(let b=s+o;++b<m;)i(u-1,b)||D.fill4(e,b,u-1,i,r,a);o=l}while(o!==0&&++u<e.height)}static fill4(e,t,n,i,r,a){let s=t,u=n;if(a[u*e.width+s]!==1){for(;;){let o=s,l=u;for(;u!==0&&!i(u-1,s);)u--;for(;s!==0&&!i(u,s-1);)s--;if(s===o&&u===l)break}D.fill4Core(e,s,u,i,r,a)}}static imgDirectComposite(e,t,n,i,r,a,s,u,o,l){let m;if(l!==void 0)for(let b=0;b<a;++b)for(let h=0;h<r;++h){let c=s[h],d=u[b];m=e.getPixel(c,d,m);let p=l.getPixel(c,d).getChannelNormalized(o);if(p===1)t.setPixel(n+h,i+b,m);else{let g=t.getPixel(n+h,i+b);g.r=_.mix(g.r,m.r,p),g.g=_.mix(g.g,m.g,p),g.b=_.mix(g.b,m.b,p),g.a=_.mix(g.a,m.a,p)}}else for(let b=0;b<a;++b)for(let h=0;h<r;++h)m=e.getPixel(s[h],u[b],m),t.setPixel(n+h,i+b,m)}static imgComposite(e,t,n,i,r,a,s,u,o,l,m,b){let h;for(let c=0;c<a;++c)for(let d=0;d<r;++d)h=e.getPixel(s[d],u[c],h),D.drawPixel({image:t,pos:new L(n+d,i+c),color:h,blend:o,linearBlend:l,maskChannel:m,mask:b})}static drawCircle(e){var r,a;let t=(r=e.antialias)!=null?r:!1,n=(a=e.maskChannel)!=null?a:4;if(t)return D.drawAntialiasCircle({image:e.image,x:e.center.x,y:e.center.y,radius:e.radius,color:e.color,mask:e.mask,maskChannel:n});let i=D.calculateCircumference(e.image,e.center,e.radius);for(let s of i)D.drawPixel({image:e.image,pos:new L(s.x,s.y),color:e.color,mask:e.mask,maskChannel:n});return e.image}static fillCircle(e){var m,b;let t=(m=e.antialias)!=null?m:!1,n=(b=e.maskChannel)!=null?b:4,i=e.radius*e.radius,r=Math.max(0,e.center.x-e.radius),a=Math.max(0,e.center.y-e.radius),s=Math.min(e.image.width-1,e.center.x+e.radius),u=Math.min(e.image.height-1,e.center.y+e.radius),o=e.image.getRange(r,a,s-r+1,u-a+1),l;for(;l=o.next(),!l.done;){let h=l.value;if(t){let c=Vt.circleTest(h,e.center,i,t);if(c>0){let d=e.color.aNormalized*c;D.drawPixel({image:e.image,pos:new L(h.x,h.y),color:e.color,alpha:d,maskChannel:n,mask:e.mask})}}else{let c=h.x-e.center.x,d=h.y-e.center.y;c*c+d*d<i&&D.drawPixel({image:e.image,pos:new L(h.x,h.y),color:e.color,maskChannel:n,mask:e.mask})}}return e.image}static drawLine(e){var l,m,b;let t=e.line.clone(),n=(l=e.antialias)!=null?l:!1,i=(m=e.thickness)!=null?m:1,r=(b=e.maskChannel)!=null?b:4;if(!Vt.clipLine(new on(0,0,e.image.width-1,e.image.height-1),t))return e.image;let a=Math.floor(i/2);if(t.dx===0&&t.dy===0)return e.thickness===1?D.drawPixel({image:e.image,pos:new L(t.x1,t.y1),color:e.color,maskChannel:e.maskChannel,mask:e.mask}):D.fillCircle({image:e.image,center:new L(t.x1,t.y1),radius:a,color:e.color,maskChannel:e.maskChannel,mask:e.mask}),e.image;if(t.dx===0){if(t.dy<0)for(let h=t.y2;h<=t.y1;++h)if(i<=1)D.drawPixel({image:e.image,pos:new L(t.x1,h),color:e.color,maskChannel:r,mask:e.mask});else for(let c=0;c<i;c++)D.drawPixel({image:e.image,pos:new L(t.x1-a+c,h),color:e.color,maskChannel:r,mask:e.mask});else for(let h=t.y1;h<=t.y2;++h)if(i<=1)D.drawPixel({image:e.image,pos:new L(t.x1,h),color:e.color,maskChannel:r,mask:e.mask});else for(let c=0;c<i;c++)D.drawPixel({image:e.image,pos:new L(t.x1-a+c,h),color:e.color,maskChannel:r,mask:e.mask});return e.image}else if(t.dy===0){if(t.dx<0)for(let h=t.x2;h<=t.x1;++h)if(i<=1)D.drawPixel({image:e.image,pos:new L(h,t.y1),color:e.color,maskChannel:r,mask:e.mask});else for(let c=0;c<i;c++)D.drawPixel({image:e.image,pos:new L(h,t.y1-a+c),color:e.color,maskChannel:r,mask:e.mask});else for(let h=t.x1;h<=t.x2;++h)if(i<=1)D.drawPixel({image:e.image,pos:new L(h,t.y1),color:e.color,maskChannel:r,mask:e.mask});else for(let c=0;c<i;c++)D.drawPixel({image:e.image,pos:new L(h,t.y1-a+c),color:e.color,maskChannel:r,mask:e.mask});return e.image}let s=h=>~h+65536&65535;if(!n){let h=Math.abs(t.dx),c=Math.abs(t.dy);if(c<=h){let d=Math.cos(Math.atan2(c,h)),p=0;d!==0?p=Math.trunc(i/d):p=1,p===0&&(p=1);let g=2*c-h,x=2*c,y=2*(c-h),C=0,I=0,P=0,F=0;t.x1>t.x2?(C=t.x2,I=t.y2,P=-1,F=t.x1):(C=t.x1,I=t.y1,P=1,F=t.x2);let M=Math.trunc(I-p/2);for(let w=M;w<M+p;w++)D.drawPixel({image:e.image,pos:new L(C,w),color:e.color,maskChannel:r,mask:e.mask});if((t.y2-t.y1)*P>0)for(;C<F;){C++,g<0?g+=x:(I++,g+=y),M=Math.trunc(I-p/2);for(let w=M;w<M+p;w++)D.drawPixel({image:e.image,pos:new L(C,w),color:e.color,maskChannel:r,mask:e.mask})}else for(;C<F;){C++,g<0?g+=x:(I--,g+=y),M=Math.trunc(I-p/2);for(let w=M;w<M+p;w++)D.drawPixel({image:e.image,pos:new L(C,w),color:e.color,maskChannel:r,mask:e.mask})}}else{let d=Math.sin(Math.atan2(c,h)),p=0;d!==0?p=Math.trunc(i/d):p=1,p===0&&(p=1);let g=2*h-c,x=2*h,y=2*(h-c),C=0,I=0,P=0,F=0;t.y1>t.y2?(I=t.y2,C=t.x2,P=t.y1,F=-1):(I=t.y1,C=t.x1,P=t.y2,F=1);let M=Math.trunc(C-p/2);for(let w=M;w<M+p;w++)D.drawPixel({image:e.image,pos:new L(w,I),color:e.color,maskChannel:r,mask:e.mask});if((t.x2-t.x1)*F>0)for(;I<P;){I++,g<0?g+=x:(C++,g+=y),M=Math.trunc(C-p/2);for(let w=M;w<M+p;w++)D.drawPixel({image:e.image,pos:new L(w,I),color:e.color,maskChannel:r,mask:e.mask})}else for(;I<P;){I++,g<0?g+=x:(C--,g+=y),M=Math.trunc(C-p/2);for(let w=M;w<M+p;w++)D.drawPixel({image:e.image,pos:new L(w,I),color:e.color,maskChannel:r,mask:e.mask})}}return e.image}if(i===1)return D.drawLineWu({image:e.image,line:new ve(t.x1,t.y1,t.x2,t.y2),color:e.color});let u=Math.abs(t.dy)<Math.abs(t.dx)?Math.cos(Math.atan2(t.dy,t.dx)):Math.sin(Math.atan2(t.dy,t.dx)),o=0;if(u!==0?o=Math.trunc(Math.abs(i/u)):o=1,o===0&&(o=1),Math.abs(t.dx)>Math.abs(t.dy)){t.dx<0&&(t.flipX(),t.flipY());let h=t.y1,c=Math.trunc(t.dy*65536/t.dx),d=0;for(let p=t.x1;p<=t.x2;p++){let g=h-Math.trunc(o/2);for(let x=g;x<g+o;x++)D.drawPixel({image:e.image,pos:new L(p,x),color:e.color,alpha:(d>>8&255)/255,maskChannel:r,mask:e.mask}),D.drawPixel({image:e.image,pos:new L(p,x+1),color:e.color,alpha:(s(d)>>8&255)/255,maskChannel:r,mask:e.mask});d+=c,d>=65536?(d-=65536,h++):d<0&&(d+=65536,h--)}}else{t.dy<0&&(t.flipX(),t.flipY());let h=t.x1,c=Math.trunc(t.dx*65536/t.dy),d=0;for(let p=t.y1;p<=t.y2;p++){let g=h-Math.trunc(o/2);for(let x=g;x<g+o;x++)D.drawPixel({image:e.image,pos:new L(x,p),color:e.color,alpha:(d>>8&255)/255,maskChannel:r,mask:e.mask}),D.drawPixel({image:e.image,pos:new L(x+1,p),color:e.color,alpha:(s(d)>>8&255)/255,maskChannel:r,mask:e.mask});d+=c,d>=65536?(d-=65536,h++):d<0&&(d+=65536,h--)}}return e.image}static drawPixel(e){var p,g,x,y,C,I;let t=(p=e.blend)!=null?p:1,n=(g=e.linearBlend)!=null?g:!1,i=(x=e.maskChannel)!=null?x:4;if(!e.image.isBoundsSafe(e.pos.x,e.pos.y))return e.image;if((t===0||e.image.hasPalette)&&e.image.isBoundsSafe(e.pos.x,e.pos.y))return e.image.getPixel(e.pos.x,e.pos.y).set(e.color),e.image;let r=(C=(y=e.mask)==null?void 0:y.getPixel(e.pos.x,e.pos.y).getChannelNormalized(i))!=null?C:1,a=e.filter!==void 0?e.color.rNormalized*e.filter.rNormalized:e.color.rNormalized,s=e.filter!==void 0?e.color.gNormalized*e.filter.gNormalized:e.color.gNormalized,u=e.filter!==void 0?e.color.bNormalized*e.filter.bNormalized:e.color.bNormalized,o=((I=e.alpha)!=null?I:e.color.length<4?1:e.color.aNormalized)*r;if(o===0)return e.image;let l=e.image.getPixel(e.pos.x,e.pos.y),m=l.rNormalized,b=l.gNormalized,h=l.bNormalized,c=l.aNormalized;switch(t){case 0:return e.image;case 1:break;case 2:a=Math.max(m,a),s=Math.max(b,s),u=Math.max(h,u);break;case 3:a=1-(1-a)*(1-m),s=1-(1-s)*(1-b),u=1-(1-u)*(1-h);break;case 4:{let P=o*c,F=a*(1-c)+m*(1-o),M=s*(1-c)+b*(1-o),w=u*(1-c)+h*(1-o),k=P+F,B=P+M,N=P+w,O=_.clamp(a/_.clamp(o,.01,1)*_.step(0,o),0,.99),V=_.clamp(s/_.clamp(o,.01,1)*_.step(0,o),0,.99),E=_.clamp(u/_.clamp(o,.01,1)*_.step(0,o),0,.99),$=m*o/(1-O)+F,X=b*o/(1-V)+M,ie=h*o/(1-E)+w,te=_.step(a*c+m*o,P),re=_.step(s*c+b*o,P),W=_.step(u*c+h*o,P);a=_.mix(k,$,te),s=_.mix(B,X,re),u=_.mix(N,ie,W)}break;case 5:a=m+a,s=b+s,u=h+u;break;case 6:a=Math.min(m,a),s=Math.min(b,s),u=Math.min(h,u);break;case 7:a*=m,s*=b,u*=h;break;case 8:a=a!==0?1-(1-m)/a:0,s=s!==0?1-(1-b)/s:0,u=u!==0?1-(1-h)/u:0;break;case 9:2*m<c?a=2*a*m+a*(1-c)+m*(1-o):a=o*c-2*(c-m)*(o-a)+a*(1-c)+m*(1-o),2*b<c?s=2*s*b+s*(1-c)+b*(1-o):s=o*c-2*(c-b)*(o-s)+s*(1-c)+b*(1-o),2*h<c?u=2*u*h+u*(1-c)+h*(1-o):u=o*c-2*(c-h)*(o-u)+u*(1-c)+h*(1-o);break;case 10:a=c===0?0:m*(o*(m/c)+2*a*(1-m/c))+a*(1-c)+m*(1-o),s=c===0?0:b*(o*(b/c)+2*s*(1-b/c))+s*(1-c)+b*(1-o),u=c===0?0:h*(o*(h/c)+2*u*(1-h/c))+u*(1-c)+h*(1-o);break;case 11:2*a<o?a=2*a*m+a*(1-c)+m*(1-o):a=o*c-2*(c-m)*(o-a)+a*(1-c)+m*(1-o),2*s<o?s=2*s*b+s*(1-c)+b*(1-o):s=o*c-2*(c-b)*(o-s)+s*(1-c)+b*(1-o),2*u<o?u=2*u*h+u*(1-c)+h*(1-o):u=o*c-2*(c-h)*(o-u)+u*(1-c)+h*(1-o);break;case 12:a=Math.abs(a-m),s=Math.abs(s-b),u=Math.abs(u-h);break;case 13:a=m-a,s=b-s,u=h-u;break;case 14:a=a!==0?m/a:0,s=s!==0?b/s:0,u=u!==0?h/u:0;break}let d=1-o;if(n){let P=Math.pow(m,2.2),F=Math.pow(b,2.2),M=Math.pow(h,2.2),w=Math.pow(a,2.2),k=Math.pow(s,2.2),B=Math.pow(u,2.2),N=Math.pow(w*o+P*c*d,1/2.2),O=Math.pow(k*o+F*c*d,1/2.2),V=Math.pow(B*o+M*c*d,1/2.2),E=o+c*d;l.rNormalized=N,l.gNormalized=O,l.bNormalized=V,l.aNormalized=E}else{let P=a*o+m*c*d,F=s*o+b*c*d,M=u*o+h*c*d,w=o+c*d;l.rNormalized=P,l.gNormalized=F,l.bNormalized=M,l.aNormalized=w}return e.image}static drawPolygon(e){var s,u,o;let t=(s=e.antialias)!=null?s:!1,n=(u=e.thickness)!=null?u:1,i=(o=e.maskChannel)!=null?o:4;if(e.color.a===0)return e.image;let r=e.vertices,a=r.length;if(a===0)return e.image;if(a===1)return D.drawPixel({image:e.image,pos:r[0],color:e.color,maskChannel:i,mask:e.mask});if(a===2)return D.drawLine({image:e.image,line:new ve(r[0].x,r[0].y,r[1].x,r[1].y),color:e.color,antialias:t,thickness:n,maskChannel:i,mask:e.mask});for(let l=0;l<a-1;++l)D.drawLine({image:e.image,line:new ve(r[l].x,r[l].y,r[l+1].x,r[l+1].y),color:e.color,antialias:t,thickness:n,maskChannel:i,mask:e.mask});return D.drawLine({image:e.image,line:new ve(r[a-1].x,r[a-1].y,r[0].x,r[0].y),color:e.color,antialias:t,thickness:n,maskChannel:i,mask:e.mask}),e.image}static drawRect(e){var g,x,y;let t=e.rect,n=(g=e.thickness)!=null?g:1,i=(x=e.radius)!=null?x:0,r=(y=e.maskChannel)!=null?y:4,a=t.left,s=t.top,u=t.right,o=t.bottom;if(i>0){let C=Math.round(i);D.drawLine({image:e.image,line:new ve(a+C,s,u-C,s),color:e.color}),D.drawLine({image:e.image,line:new ve(u,s+C,u,o-C),color:e.color}),D.drawLine({image:e.image,line:new ve(a+C,o,u-C,o),color:e.color}),D.drawLine({image:e.image,line:new ve(a,s+C,a,o-C),color:e.color});let I=a+C,P=s+C,F=u-C,M=s+C,w=u-C,k=o-C,B=a+C,N=o-C;return D.drawAntialiasCircle({image:e.image,x:I,y:P,radius:C,color:e.color,maskChannel:r,quadrants:1,mask:e.mask}),D.drawAntialiasCircle({image:e.image,x:F,y:M,radius:C,color:e.color,maskChannel:r,quadrants:2,mask:e.mask}),D.drawAntialiasCircle({image:e.image,x:w,y:k,radius:C,color:e.color,maskChannel:r,quadrants:8,mask:e.mask}),D.drawAntialiasCircle({image:e.image,x:B,y:N,radius:C,color:e.color,maskChannel:r,quadrants:4,mask:e.mask}),e.image}let l=n/2;D.drawLine({image:e.image,line:new ve(a,s,u,s),color:e.color,thickness:n,maskChannel:r,mask:e.mask}),D.drawLine({image:e.image,line:new ve(a,o,u,o),color:e.color,thickness:n,maskChannel:r,mask:e.mask});let b=l-Math.trunc(l)===0?1:0,h=Math.ceil(s+l),c=Math.floor(o-l-b),d=Math.floor(a+l),p=Math.ceil(u-l+b);return D.drawLine({image:e.image,line:new ve(d,h,d,c),color:e.color,thickness:n,maskChannel:r,mask:e.mask}),D.drawLine({image:e.image,line:new ve(p,h,p,c),color:e.color,thickness:n,maskChannel:r,mask:e.mask}),e.image}static fillFlood(e){var l,m,b;let t=(l=e.threshold)!=null?l:0,n=(m=e.compareAlpha)!=null?m:!1,i=(b=e.maskChannel)!=null?b:4;if(e.color.a===0)return e.image;let r=new Uint8Array(e.image.width*e.image.height),a=e.image.getPixel(e.start.x,e.start.y);n||(e.color.a=0);let s;if(t>0){let h=z.rgbToLab(a.r,a.g,a.b);n&&h.push(a.a),s=(c,d)=>r[c*e.image.width+d]===0&&D.testPixelLabColorDistance(e.image,d,c,h,t)}else n?s=(h,c)=>r[h*e.image.width+c]===0&&e.image.getPixel(c,h)!==a:s=(h,c)=>r[h*e.image.width+c]===0&&D.setAlpha(e.image.getPixel(c,h),0)!==a;let u,o=(h,c)=>{if(e.mask!==void 0){let d=e.mask.getPixel(c,h).getChannelNormalized(i);d>0&&(u=e.image.getPixel(c,h,u),u.r=_.mix(u.r,e.color.r,d),u.g=_.mix(u.g,e.color.g,d),u.b=_.mix(u.b,e.color.b,d),u.a=_.mix(u.a,e.color.a,d))}else e.image.setPixel(c,h,e.color);r[h*e.image.width+c]=1};return D.fill4(e.image,e.start.x,e.start.y,s,o,r),e.image}static fillPolygon(e){var m;let t=(m=e.maskChannel)!=null?m:4;if(e.color.a===0)return e.image;let n=e.vertices.length;if(n===0)return e.image;if(n===1)return D.drawPixel({image:e.image,pos:e.vertices[0],color:e.color,maskChannel:t,mask:e.mask});if(n===2)return D.drawLine({image:e.image,line:new ve(e.vertices[0].x,e.vertices[0].y,e.vertices[1].x,e.vertices[1].y),color:e.color,mask:e.mask,maskChannel:t});let i=0,r=0,a=0,s=0,u=!0;for(let b of e.vertices)u?(i=b.x,r=b.y,a=b.x,s=b.y,u=!1):(i=Math.min(i,b.x),r=Math.min(r,b.y),a=Math.max(a,b.x),s=Math.max(s,b.y));i=Math.max(i,0),r=Math.max(r,0),a=Math.min(a,e.image.width-1),s=Math.min(s,e.image.height-1);let o=U.fill(40,0),l=U.generate(n+1,b=>b<n?b:0);for(let b=r,h=r+.5;b<=s;++b,++h){let c=0;for(let d=0;d<n;++d){let p=e.vertices[l[d]],g=e.vertices[l[d+1]],x=p.x,y=p.y,C=g.x,I=g.y;if(I<y){let P=x;x=C,C=P,P=y,y=I,I=P}if(h<=I&&h>=y){let P=0;y-I===0?P=x:(P=(C-x)*(h-y)/(I-y),P+=x),P<=a&&P>=i&&(o[c++]=P)}}for(let d=0;d<c;d+=2){let p=o[d],g=o[d+1];if(p>g){let C=p;p=g,g=C}let x=Math.floor(p),y=Math.ceil(g);for(let C=x;C<=y;++C)D.drawPixel({image:e.image,pos:new L(C,b),color:e.color,maskChannel:t,mask:e.mask})}}return e.image}static fillRect(e){var l,m,b,h,c,d;let t=(l=e.radius)!=null?l:0,n=(m=e.maskChannel)!=null?m:4;if(e.color.a===0)return e.image;let i=_.clamp(e.rect.left,0,e.image.width-1),r=_.clamp(e.rect.top,0,e.image.height-1),a=_.clamp(e.rect.right,0,e.image.width-1),s=_.clamp(e.rect.bottom,0,e.image.height-1),u=a-i+1,o=s-r+1;if(t>0){let p=Math.round(t),g=p*p,x=i+p,y=r+p,C=a-p+1,I=r+p,P=a-p+1,F=s-p+1,M=i+p,w=s-p+1,k=e.image.getRange(i,r,u,o),B;for(;B=k.next(),!B.done;){let N=B.value,O=N.x,V=N.y,E=1;if(O<x&&V<y){if(E=Vt.circleTest(N,new L(x,y),g),E===0)continue}else if(O>C&&V<I){if(E=Vt.circleTest(N,new L(C,I),g),E===0)continue}else if(O>P&&V>F){if(E=Vt.circleTest(N,new L(P,F),g),E===0)continue}else if(O<M&&V>w&&(E=Vt.circleTest(N,new L(M,w),g),E===0))continue;E*=e.color.aNormalized;let $=(h=(b=e.mask)==null?void 0:b.getPixel(N.x,N.y).getChannelNormalized(n))!=null?h:1;N.r=_.mix(N.r,e.color.r,E*$),N.g=_.mix(N.g,e.color.g,E*$),N.b=_.mix(N.b,e.color.b,E*$),N.a*=1-e.color.a*$}return e.image}if(e.color.a===e.color.maxChannelValue&&e.mask===void 0){let p=e.image.getRange(i,r,u,o),g;for(;g=p.next(),!g.done;)g.value.set(e.color)}else{let p=e.color.a/e.color.maxChannelValue,g=e.image.getRange(i,r,u,o),x;for(;x=g.next(),!x.done;){let y=x.value,C=(d=(c=e.mask)==null?void 0:c.getPixel(y.x,y.y).getChannelNormalized(n))!=null?d:1;y.r=_.mix(y.r,e.color.r,p*C),y.g=_.mix(y.g,e.color.g,p*C),y.b=_.mix(y.b,e.color.b,p*C),y.a*=1-e.color.a*C}}return e.image}static fill(e){var n;let t=(n=e.maskChannel)!=null?n:4;if(e.mask===void 0)return e.image.clear(e.color),e.image;for(let i of e.image){let r=e.mask.getPixel(i.x,i.y).getChannelNormalized(t);i.r=_.mix(i.r,e.color.r,r),i.g=_.mix(i.g,e.color.g,r),i.b=_.mix(i.b,e.color.b,r),i.a=_.mix(i.a,e.color.a,r)}return e.image}static maskFlood(e){var l,m,b;let t=(l=e.threshold)!=null?l:0,n=(m=e.compareAlpha)!=null?m:!1,i=(b=e.fillValue)!=null?b:255,r=new Uint8Array(e.image.width*e.image.height),a=e.image.getPixel(e.start.x,e.start.y);n||(a=D.setAlpha(a,0));let s=new Uint8Array(e.image.width*e.image.height),u;if(t>0){let h=z.rgbToLab(a.r,a.g,a.b);n&&h.push(a.a),u=(c,d)=>r[c*e.image.width+d]===0&&(s[c*e.image.width+d]!==0||D.testPixelLabColorDistance(e.image,d,c,h,t))}else n?u=(h,c)=>r[h*e.image.width+c]===0&&(s[h*e.image.width+c]!==0||e.image.getPixel(c,h)!==a):u=(h,c)=>r[h*e.image.width+c]===0&&(s[h*e.image.width+c]!==0||D.setAlpha(e.image.getPixel(c,h),0)!==a);let o=(h,c)=>{s[h*e.image.width+c]=i,r[h*e.image.width+c]=1};return D.fill4(e.image,e.start.x,e.start.y,u,o,r),s}static compositeImage(e){var x,y,C,I,P,F,M,w,k,B,N,O;let t=(x=e.dstX)!=null?x:0,n=(y=e.dstY)!=null?y:0,i=(C=e.srcX)!=null?C:0,r=(I=e.srcY)!=null?I:0,a=(P=e.srcW)!=null?P:e.src.width,s=(F=e.srcH)!=null?F:e.src.height,u=(M=e.dstW)!=null?M:e.dst.width<e.src.width?e.dst.width:e.src.width,o=(w=e.dstH)!=null?w:e.dst.height<e.src.height?e.dst.height:e.src.height,l=(k=e.blend)!=null?k:1,m=(B=e.linearBlend)!=null?B:!1,b=(N=e.center)!=null?N:!1,h=(O=e.maskChannel)!=null?O:4;if(b){let V=e.dst.width-e.src.width;V<0&&(V=0),t=Math.trunc(V/2);let E=e.dst.height-e.src.height;E<0&&(E=0),n=Math.trunc(E/2)}e.dst.hasPalette&&e.dst.convert({numChannels:e.dst.numChannels});let c=s/o,d=a/u,p=Array.from({length:o},(V,E)=>r+Math.trunc(E*c)),g=Array.from({length:u},(V,E)=>i+Math.trunc(E*d));return l===0?D.imgDirectComposite(e.src,e.dst,t,n,u,o,g,p,h,e.mask):D.imgComposite(e.src,e.dst,t,n,u,o,g,p,l,m,h,e.mask),e.dst}}});var lr,mr=A(()=>{"use strict";lr=class{get tag(){return this._tag}get value(){return this._value}set value(e){this._value=e}constructor(e,t){this._tag=e,this._value=t}}});function as(f){return Ce[f]}function ss(f,e=1){return xn[f]*e}var Ce,xn,xe=A(()=>{"use strict";Ce=(h=>(h[h.none=0]="none",h[h.byte=1]="byte",h[h.ascii=2]="ascii",h[h.short=3]="short",h[h.long=4]="long",h[h.rational=5]="rational",h[h.sByte=6]="sByte",h[h.undefined=7]="undefined",h[h.sShort=8]="sShort",h[h.sLong=9]="sLong",h[h.sRational=10]="sRational",h[h.single=11]="single",h[h.double=12]="double",h))(Ce||{}),xn=[0,1,1,2,4,8,1,1,2,4,8,4,8]});var v,ne,On,qs,Gs,_n=A(()=>{"use strict";xe();v=class{get name(){return this._name}get type(){return this._type}get count(){return this._count}constructor(e){var t;this._name=e.name,this._type=(t=e.type)!=null?t:0,this._count=e.count}},ne=new Map([["ProcessingSoftware",11],["SubfileType",254],["OldSubfileType",255],["ImageWidth",256],["ImageLength",257],["ImageHeight",257],["BitsPerSample",258],["Compression",259],["PhotometricInterpretation",262],["Thresholding",263],["CellWidth",264],["CellLength",265],["FillOrder",266],["DocumentName",269],["ImageDescription",270],["Make",271],["Model",272],["StripOffsets",273],["Orientation",274],["SamplesPerPixel",277],["RowsPerStrip",278],["StripByteCounts",279],["MinSampleValue",280],["MaxSampleValue",281],["XResolution",282],["YResolution",283],["PlanarConfiguration",284],["PageName",285],["XPosition",286],["YPosition",287],["GrayResponseUnit",290],["GrayResponseCurve",291],["T4Options",292],["T6Options",293],["ResolutionUnit",296],["PageNumber",297],["ColorResponseUnit",300],["TransferFunction",301],["Software",305],["DateTime",306],["Artist",315],["HostComputer",316],["Predictor",317],["WhitePoint",318],["PrimaryChromaticities",319],["ColorMap",320],["HalftoneHints",321],["TileWidth",322],["TileLength",323],["TileOffsets",324],["TileByteCounts",325],["BadFaxLines",326],["CleanFaxData",327],["ConsecutiveBadFaxLines",328],["InkSet",332],["InkNames",333],["NumberofInks",334],["DotRange",336],["TargetPrinter",337],["ExtraSamples",338],["SampleFormat",339],["SMinSampleValue",340],["SMaxSampleValue",341],["TransferRange",342],["ClipPath",343],["JPEGProc",512],["JPEGInterchangeFormat",513],["JPEGInterchangeFormatLength",514],["YCbCrCoefficients",529],["YCbCrSubSampling",530],["YCbCrPositioning",531],["ReferenceBlackWhite",532],["ApplicationNotes",700],["Rating",18246],["CFARepeatPatternDim",33421],["CFAPattern",33422],["BatteryLevel",33423],["Copyright",33432],["ExposureTime",33434],["FNumber",33437],["IPTC-NAA",33723],["ExifOffset",34665],["InterColorProfile",34675],["ExposureProgram",34850],["SpectralSensitivity",34852],["GPSOffset",34853],["ISOSpeed",34855],["OECF",34856],["SensitivityType",34864],["RecommendedExposureIndex",34866],["ExifVersion",36864],["DateTimeOriginal",36867],["DateTimeDigitized",36868],["OffsetTime",36880],["OffsetTimeOriginal",36881],["OffsetTimeDigitized",36882],["ComponentsConfiguration",37121],["CompressedBitsPerPixel",37122],["ShutterSpeedValue",37377],["ApertureValue",37378],["BrightnessValue",37379],["ExposureBiasValue",37380],["MaxApertureValue",37381],["SubjectDistance",37382],["MeteringMode",37383],["LightSource",37384],["Flash",37385],["FocalLength",37386],["SubjectArea",37396],["MakerNote",37500],["UserComment",37510],["SubSecTime",37520],["SubSecTimeOriginal",37521],["SubSecTimeDigitized",37522],["XPTitle",40091],["XPComment",40092],["XPAuthor",40093],["XPKeywords",40094],["XPSubject",40095],["FlashPixVersion",40960],["ColorSpace",40961],["ExifImageWidth",40962],["ExifImageLength",40963],["RelatedSoundFile",40964],["InteroperabilityOffset",40965],["FlashEnergy",41483],["SpatialFrequencyResponse",41484],["FocalPlaneXResolution",41486],["FocalPlaneYResolution",41487],["FocalPlaneResolutionUnit",41488],["SubjectLocation",41492],["ExposureIndex",41493],["SensingMethod",41495],["FileSource",41728],["SceneType",41729],["CVAPattern",41730],["CustomRendered",41985],["ExposureMode",41986],["WhiteBalance",41987],["DigitalZoomRatio",41988],["FocalLengthIn35mmFilm",41989],["SceneCaptureType",41990],["GainControl",41991],["Contrast",41992],["Saturation",41993],["Sharpness",41994],["DeviceSettingDescription",41995],["SubjectDistanceRange",41996],["ImageUniqueID",42016],["CameraOwnerName",42032],["BodySerialNumber",42033],["LensSpecification",42034],["LensMake",42035],["LensModel",42036],["LensSerialNumber",42037],["Gamma",42240],["PrintIM",50341],["Padding",59932],["OffsetSchema",59933],["OwnerName",65e3],["SerialNumber",65001],["InteropIndex",1],["InteropVersion",2],["RelatedImageFileFormat",4096],["RelatedImageWidth",4097],["RelatedImageLength",4098],["GPSVersionID",0],["GPSLatitudeRef",1],["GPSLatitude",2],["GPSLongitudeRef",3],["GPSLongitude",4],["GPSAltitudeRef",5],["GPSAltitude",6],["GPSTimeStamp",7],["GPSSatellites",8],["GPSStatus",9],["GPSMeasureMode",10],["GPSDOP",11],["GPSSpeedRef",12],["GPSSpeed",13],["GPSTrackRef",14],["GPSTrack",15],["GPSImgDirectionRef",16],["GPSImgDirection",17],["GPSMapDatum",18],["GPSDestLatitudeRef",19],["GPSDestLatitude",20],["GPSDestLongitudeRef",21],["GPSDestLongitude",22],["GPSDestBearingRef",23],["GPSDestBearing",24],["GPSDestDistanceRef",25],["GPSDestDistance",26],["GPSProcessingMethod",27],["GPSAreaInformation",28],["GPSDate",29],["GPSDifferential",30]]),On=new Map([[11,new v({name:"ProcessingSoftware",type:2})],[254,new v({name:"SubfileType",type:4,count:1})],[255,new v({name:"OldSubfileType",type:4,count:1})],[256,new v({name:"ImageWidth",type:4,count:1})],[257,new v({name:"ImageLength",type:4,count:1})],[258,new v({name:"BitsPerSample",type:3,count:1})],[259,new v({name:"Compression",type:3,count:1})],[262,new v({name:"PhotometricInterpretation",type:3,count:1})],[263,new v({name:"Thresholding",type:3,count:1})],[264,new v({name:"CellWidth",type:3,count:1})],[265,new v({name:"CellLength",type:3,count:1})],[266,new v({name:"FillOrder",type:3,count:1})],[269,new v({name:"DocumentName",type:2})],[270,new v({name:"ImageDescription",type:2})],[271,new v({name:"Make",type:2})],[272,new v({name:"Model",type:2})],[273,new v({name:"StripOffsets",type:4})],[274,new v({name:"Orientation",type:3,count:1})],[277,new v({name:"SamplesPerPixel",type:3,count:1})],[278,new v({name:"RowsPerStrip",type:4,count:1})],[279,new v({name:"StripByteCounts",type:4,count:1})],[280,new v({name:"MinSampleValue",type:3,count:1})],[281,new v({name:"MaxSampleValue",type:3,count:1})],[282,new v({name:"XResolution",type:5,count:1})],[283,new v({name:"YResolution",type:5,count:1})],[284,new v({name:"PlanarConfiguration",type:3,count:1})],[285,new v({name:"PageName",type:2})],[286,new v({name:"XPosition",type:5,count:1})],[287,new v({name:"YPosition",type:5,count:1})],[290,new v({name:"GrayResponseUnit",type:3,count:1})],[291,new v({name:"GrayResponseCurve"})],[292,new v({name:"T4Options"})],[293,new v({name:"T6Options"})],[296,new v({name:"ResolutionUnit",type:3,count:1})],[297,new v({name:"PageNumber",type:3,count:2})],[300,new v({name:"ColorResponseUnit"})],[301,new v({name:"TransferFunction",type:3,count:768})],[305,new v({name:"Software",type:2})],[306,new v({name:"DateTime",type:2})],[315,new v({name:"Artist",type:2})],[316,new v({name:"HostComputer",type:2})],[317,new v({name:"Predictor",type:3,count:1})],[318,new v({name:"WhitePoint",type:5,count:2})],[319,new v({name:"PrimaryChromaticities",type:5,count:6})],[320,new v({name:"ColorMap",type:3})],[321,new v({name:"HalftoneHints",type:3,count:2})],[322,new v({name:"TileWidth",type:4,count:1})],[323,new v({name:"TileLength",type:4,count:1})],[324,new v({name:"TileOffsets",type:4})],[325,new v({name:"TileByteCounts"})],[326,new v({name:"BadFaxLines"})],[327,new v({name:"CleanFaxData"})],[328,new v({name:"ConsecutiveBadFaxLines"})],[332,new v({name:"InkSet"})],[333,new v({name:"InkNames"})],[334,new v({name:"NumberofInks"})],[336,new v({name:"DotRange"})],[337,new v({name:"TargetPrinter",type:2})],[338,new v({name:"ExtraSamples"})],[339,new v({name:"SampleFormat",type:3,count:1})],[340,new v({name:"SMinSampleValue"})],[341,new v({name:"SMaxSampleValue"})],[342,new v({name:"TransferRange"})],[343,new v({name:"ClipPath"})],[512,new v({name:"JPEGProc"})],[513,new v({name:"JPEGInterchangeFormat"})],[514,new v({name:"JPEGInterchangeFormatLength"})],[529,new v({name:"YCbCrCoefficients",type:5,count:3})],[530,new v({name:"YCbCrSubSampling",type:3,count:1})],[531,new v({name:"YCbCrPositioning",type:3,count:1})],[532,new v({name:"ReferenceBlackWhite",type:5,count:6})],[700,new v({name:"ApplicationNotes",type:3,count:1})],[18246,new v({name:"Rating",type:3,count:1})],[33421,new v({name:"CFARepeatPatternDim"})],[33422,new v({name:"CFAPattern"})],[33423,new v({name:"BatteryLevel"})],[33432,new v({name:"Copyright",type:2})],[33434,new v({name:"ExposureTime",type:5,count:1})],[33437,new v({name:"FNumber",type:5})],[33723,new v({name:"IPTC-NAA",type:4,count:1})],[34665,new v({name:"ExifOffset"})],[34675,new v({name:"InterColorProfile"})],[34850,new v({name:"ExposureProgram",type:3})],[34852,new v({name:"SpectralSensitivity",type:2})],[34853,new v({name:"GPSOffset"})],[34855,new v({name:"ISOSpeed",type:4,count:1})],[34856,new v({name:"OECF"})],[34864,new v({name:"SensitivityType",type:3,count:1})],[34866,new v({name:"RecommendedExposureIndex",type:4,count:1})],[34867,new v({name:"ISOSpeed",type:4,count:1})],[36864,new v({name:"ExifVersion",type:7})],[36867,new v({name:"DateTimeOriginal",type:2})],[36868,new v({name:"DateTimeDigitized",type:2})],[36880,new v({name:"OffsetTime",type:2})],[36881,new v({name:"OffsetTimeOriginal",type:2})],[36882,new v({name:"OffsetTimeDigitized",type:2})],[37121,new v({name:"ComponentsConfiguration",type:7})],[37122,new v({name:"CompressedBitsPerPixel"})],[37377,new v({name:"ShutterSpeedValue"})],[37378,new v({name:"ApertureValue"})],[37379,new v({name:"BrightnessValue"})],[37380,new v({name:"ExposureBiasValue"})],[37381,new v({name:"MaxApertureValue"})],[37382,new v({name:"SubjectDistance"})],[37383,new v({name:"MeteringMode"})],[37384,new v({name:"LightSource"})],[37385,new v({name:"Flash"})],[37386,new v({name:"FocalLength"})],[37396,new v({name:"SubjectArea"})],[37500,new v({name:"MakerNote",type:7})],[37510,new v({name:"UserComment",type:7})],[37520,new v({name:"SubSecTime"})],[37521,new v({name:"SubSecTimeOriginal"})],[37522,new v({name:"SubSecTimeDigitized"})],[40091,new v({name:"XPTitle"})],[40092,new v({name:"XPComment"})],[40093,new v({name:"XPAuthor"})],[40094,new v({name:"XPKeywords"})],[40095,new v({name:"XPSubject"})],[40960,new v({name:"FlashPixVersion"})],[40961,new v({name:"ColorSpace",type:3,count:1})],[40962,new v({name:"ExifImageWidth",type:3,count:1})],[40963,new v({name:"ExifImageLength",type:3,count:1})],[40964,new v({name:"RelatedSoundFile"})],[40965,new v({name:"InteroperabilityOffset"})],[41483,new v({name:"FlashEnergy"})],[41484,new v({name:"SpatialFrequencyResponse"})],[41486,new v({name:"FocalPlaneXResolution"})],[41487,new v({name:"FocalPlaneYResolution"})],[41488,new v({name:"FocalPlaneResolutionUnit"})],[41492,new v({name:"SubjectLocation"})],[41493,new v({name:"ExposureIndex"})],[41495,new v({name:"SensingMethod"})],[41728,new v({name:"FileSource"})],[41729,new v({name:"SceneType"})],[41730,new v({name:"CVAPattern"})],[41985,new v({name:"CustomRendered"})],[41986,new v({name:"ExposureMode"})],[41987,new v({name:"WhiteBalance"})],[41988,new v({name:"DigitalZoomRatio"})],[41989,new v({name:"FocalLengthIn35mmFilm"})],[41990,new v({name:"SceneCaptureType"})],[41991,new v({name:"GainControl"})],[41992,new v({name:"Contrast"})],[41993,new v({name:"Saturation"})],[41994,new v({name:"Sharpness"})],[41995,new v({name:"DeviceSettingDescription"})],[41996,new v({name:"SubjectDistanceRange"})],[42016,new v({name:"ImageUniqueID"})],[42032,new v({name:"CameraOwnerName",type:2})],[42033,new v({name:"BodySerialNumber",type:2})],[42034,new v({name:"LensSpecification"})],[42035,new v({name:"LensMake",type:2})],[42036,new v({name:"LensModel",type:2})],[42037,new v({name:"LensSerialNumber",type:2})],[42240,new v({name:"Gamma",type:5,count:1})],[50341,new v({name:"PrintIM"})],[59932,new v({name:"Padding"})],[59933,new v({name:"OffsetSchema"})],[65e3,new v({name:"OwnerName",type:2})],[65001,new v({name:"SerialNumber",type:2})]]),qs=new Map([[1,new v({name:"InteropIndex",type:2})],[2,new v({name:"InteropVersion",type:7})],[4096,new v({name:"RelatedImageFileFormat",type:2})],[4097,new v({name:"RelatedImageWidth",type:3,count:1})],[4098,new v({name:"RelatedImageLength",type:3,count:1})]]),Gs=new Map([[0,new v({name:"GPSVersionID"})],[1,new v({name:"GPSLatitudeRef"})],[2,new v({name:"GPSLatitude"})],[3,new v({name:"GPSLongitudeRef"})],[4,new v({name:"GPSLongitude"})],[5,new v({name:"GPSAltitudeRef"})],[6,new v({name:"GPSAltitude"})],[7,new v({name:"GPSTimeStamp"})],[8,new v({name:"GPSSatellites"})],[9,new v({name:"GPSStatus"})],[10,new v({name:"GPSMeasureMode"})],[11,new v({name:"GPSDOP"})],[12,new v({name:"GPSSpeedRef"})],[13,new v({name:"GPSSpeed"})],[14,new v({name:"GPSTrackRef"})],[15,new v({name:"GPSTrack"})],[16,new v({name:"GPSImgDirectionRef"})],[17,new v({name:"GPSImgDirection"})],[18,new v({name:"GPSMapDatum"})],[19,new v({name:"GPSDestLatitudeRef"})],[20,new v({name:"GPSDestLatitude"})],[21,new v({name:"GPSDestLongitudeRef"})],[22,new v({name:"GPSDestLongitude"})],[23,new v({name:"GPSDestBearingRef"})],[24,new v({name:"GPSDestBearing"})],[25,new v({name:"GPSDestDistanceRef"})],[26,new v({name:"GPSDestDistance"})],[27,new v({name:"GPSProcessingMethod"})],[28,new v({name:"GPSAreaInformation"})],[29,new v({name:"GPSDate"})],[30,new v({name:"GPSDifferential"})]])});var ue,Ve=A(()=>{"use strict";sn();be();xe();ue=class{get type(){return 0}get length(){return 0}get dataSize(){return ss(this.type,this.length)}get typeString(){return as(this.type)}toBool(e){return!1}toInt(e){return 0}toDouble(e){return 0}toData(){return new Uint8Array}toRational(e){return new fe(0,1)}write(e){}setBool(e,t){}setInt(e,t){}setDouble(e,t){}setRational(e,t,n){}setString(e){}equals(e){return!1}clone(){throw new T("Cannot be copied.")}toString(){return`${this.constructor.name}`}}});var Ue,Nn=A(()=>{"use strict";nn();Ve();xe();Ue=class extends ue{constructor(t){super();typeof t=="string"?this._value=t:this._value=String.fromCharCode(...t)}get type(){return 2}get length(){return we.getCodePoints(this._value).length+1}static data(t,n){let i=n>0?t.readString(n-1):"";return new Ue(i)}toData(){return we.getCodePoints(this._value)}write(t){let n=we.getCodePoints(this._value);t.writeBytes(n),t.writeByte(0)}setString(t){this._value=t}equals(t){return t instanceof Ue&&this.length===t.length&&this._value===this._value}clone(){return new Ue(this._value)}toString(){return`${this.constructor.name} (${this._value})`}}});var qe,_i=A(()=>{"use strict";Ve();xe();G();qe=class extends ue{constructor(t){super();typeof t=="number"?(this._value=new Uint16Array(1),this._value[0]=t):this._value=Uint16Array.from(t)}get type(){return 3}get length(){return this._value.length}static data(t,n){let i=new Uint16Array(n);for(let r=0;r<n;++r)i[r]=t.readUint16();return new qe(i)}toInt(t=0){return this._value[t]}write(t){for(let n=0,i=this._value.length;n<i;++n)t.writeUint16(this._value[n])}setInt(t,n=0){this._value[n]=t}equals(t){return t instanceof qe&&this.length===t.length&&U.equals(this._value,t._value)}clone(){return new qe(this._value)}toString(){return`${this.constructor.name} (${this._value.length===1?`${this._value[0]}`:`${this._value}`})`}}});var Se,Rn=A(()=>{"use strict";Ve();xe();sn();G();Se=class extends ue{constructor(t){super();t instanceof fe?this._value=[t]:this._value=t}get type(){return 5}get length(){return this._value.length}static data(t,n){let i=new Array;for(let r=0;r<n;r++){let a=new fe(t.readUint32(),t.readUint32());i.push(a)}return new Se(i)}static from(t){let n=new fe(t.numerator,t.denominator);return new Se(n)}toInt(t=0){return this._value[t].toInt}toDouble(t=0){return this._value[t].toDouble}toRational(t=0){return this._value[t]}write(t){for(let n of this._value)t.writeUint32(n.numerator),t.writeUint32(n.denominator)}setRational(t,n,i=0){this._value[i]=new fe(t,n)}equals(t){return t instanceof Se&&this.length===t.length&&U.equalsRationalArray(this._value,t._value)}clone(){return new Se(this._value)}toString(){return`${this.constructor.name} (${this._value.length===1?`${this._value[0]}`:`${this._value}`})`}}});var Ze,Dn=A(()=>{"use strict";Ve();xe();G();Ze=class extends ue{constructor(t){super();typeof t=="number"?(this._value=new Uint8Array(1),this._value[0]=t):this._value=Uint8Array.from(t)}get type(){return 1}get length(){return this._value.length}static data(t,n,i){let r=t.toUint8Array(n,i);return new Ze(r)}toInt(t=0){return this._value[t]}toData(){return this._value}write(t){t.writeBytes(this._value)}setInt(t,n=0){this._value[n]=t}equals(t){return t instanceof Ze&&this.length===t.length&&U.equals(this._value,t._value)}clone(){return new Ze(this._value)}toString(){return`${this.constructor.name} (${this._value.length===1?`${this._value[0]}`:`${this._value}`})`}}});var Te,Vn=A(()=>{"use strict";Ve();xe();G();Te=class extends ue{constructor(t){super();typeof t=="number"?(this._value=new Uint32Array(1),this._value[0]=t):this._value=Uint32Array.from(t)}get type(){return 4}get length(){return this._value.length}static data(t,n){let i=new Uint32Array(n);for(let r=0;r<n;++r)i[r]=t.readUint32();return new Te(i)}toInt(t=0){return this._value[t]}toData(){return new Uint8Array(this._value.buffer)}write(t){for(let n=0,i=this._value.length;n<i;++n)t.writeUint32(this._value[n])}setInt(t,n=0){this._value[n]=t}equals(t){return t instanceof Te&&this.length===t.length&&U.equals(this._value,t._value)}clone(){return new Te(this._value)}toString(){return`${this.constructor.name} (${this._value.length===1?`${this._value[0]}`:`${this._value}`})`}}});var _t,Tn=A(()=>{"use strict";Ve();xe();G();_t=class extends ue{constructor(t){super();typeof t=="number"?(this._value=new Int8Array(1),this._value[0]=t):this._value=Int8Array.from(t)}get type(){return 6}get length(){return this._value.length}static data(t,n,i){let r=new Int8Array(new Int8Array(t.toUint8Array(n,i).buffer));return new _t(r)}toInt(t=0){return this._value[t]}toData(){return new Uint8Array(this._value.buffer)}write(t){t.writeBytes(new Uint8Array(this._value.buffer))}setInt(t,n=0){this._value[n]=t}equals(t){return t instanceof _t&&this.length===t.length&&U.equals(this._value,t._value)}clone(){return new _t(this._value)}toString(){return`${this.constructor.name} (${this._value.length===1?`${this._value[0]}`:`${this._value}`})`}}});var Ft,Ln=A(()=>{"use strict";Ve();xe();G();Ft=class extends ue{constructor(t){super();typeof t=="number"?(this._value=new Uint8Array(1),this._value[0]=t):this._value=t}get type(){return 7}get length(){return this._value.length}static data(t,n,i){let r=new Uint8Array(t.toUint8Array(n,i));return new Ft(r)}toData(){return this._value}write(t){t.writeBytes(this._value)}equals(t){return t instanceof Ft&&this.length===t.length&&U.equals(this._value,t._value)}clone(){return new Ft(this._value)}toString(){return`${this.constructor.name} (undefined)`}}});var Qe,En=A(()=>{"use strict";Ve();xe();G();Qe=class extends ue{constructor(t){super();typeof t=="number"?(this._value=new Int16Array(1),this._value[0]=t):this._value=Int16Array.from(t)}get type(){return 8}get length(){return this._value.length}static data(t,n){let i=new Int16Array(n);for(let r=0;r<n;++r)i[r]=t.readInt16();return new Qe(i)}toInt(t=0){return this._value[t]}toData(){return new Uint8Array(this._value.buffer)}write(t){let n=new Int16Array(1),i=new Uint16Array(n.buffer);for(let r=0,a=this._value.length;r<a;++r)n[0]=this._value[r],t.writeUint16(i[0])}setInt(t,n=0){this._value[n]=t}equals(t){return t instanceof Qe&&this.length===t.length&&U.equals(this._value,t._value)}clone(){return new Qe(this._value)}toString(){return`${this.constructor.name} (${this._value.length===1?`${this._value[0]}`:`${this._value}`})`}}});var yt,Hn=A(()=>{"use strict";Ve();xe();Jt();G();yt=class extends ue{constructor(t){super();typeof t=="number"?(this._value=new Int32Array(1),this._value[0]=t):this._value=Int32Array.from(t)}get type(){return 9}get length(){return this._value.length}static data(t,n){let i=new Int32Array(n);for(let r=0;r<n;++r)i[r]=t.readInt32();return new yt(i)}toInt(t=0){return this._value[t]}toData(){return new Uint8Array(this._value.buffer)}write(t){for(let n=0,i=this._value.length;n<i;++n)t.writeUint32(K.int32ToUint32(this._value[n]))}setInt(t,n=0){this._value[n]=t}equals(t){return t instanceof yt&&this.length===t.length&&U.equals(this._value,t._value)}clone(){return new yt(this._value)}toString(){return`${this.constructor.name} (${this._value.length===1?`${this._value[0]}`:`${this._value}`})`}}});var Ge,qn=A(()=>{"use strict";Ve();xe();Jt();sn();G();Ge=class extends ue{constructor(t){super();t instanceof fe?this._value=[t]:this._value=t}get type(){return 10}get length(){return this._value.length}static data(t,n){let i=new Array;for(let r=0;r<n;r++){let a=new fe(t.readInt32(),t.readInt32());i.push(a)}return new Ge(i)}static from(t){let n=new fe(t.numerator,t.denominator);return new Ge(n)}toInt(t=0){return this._value[t].toInt}toDouble(t=0){return this._value[t].toDouble}toRational(t=0){return this._value[t]}write(t){for(let n of this._value)t.writeUint32(K.int32ToUint32(n.numerator)),t.writeUint32(K.int32ToUint32(n.denominator))}setRational(t,n,i=0){this._value[i]=new fe(t,n)}equals(t){return t instanceof Ge&&this.length===t.length&&U.equalsRationalArray(this._value,t._value)}clone(){return new Ge(this._value)}toString(){return`${this.constructor.name} (${this._value.length===1?`${this._value[0]}`:`${this._value}`})`}}});var Ct,Gn=A(()=>{"use strict";Ve();xe();G();Ct=class extends ue{constructor(t){super();typeof t=="number"?(this._value=new Float32Array(1),this._value[0]=t):this._value=Float32Array.from(t)}get type(){return 11}get length(){return this._value.length}static data(t,n){let i=new Float32Array(n);for(let r=0;r<n;++r)i[r]=t.readFloat32();return new Ct(i)}toDouble(t=0){return this._value[t]}toData(){return new Uint8Array(this._value.buffer)}write(t){for(let n=0,i=this._value.length;n<i;++n)t.writeFloat32(this._value[n])}setDouble(t,n=0){this._value[n]=t}equals(t){return t instanceof Ct&&this.length===t.length&&U.equals(this._value,t._value)}clone(){return new Ct(this._value)}toString(){return`${this.constructor.name} (${this._value.length===1?`${this._value[0]}`:`${this._value}`})`}}});var wt,$n=A(()=>{"use strict";Ve();xe();G();wt=class extends ue{constructor(t){super();typeof t=="number"?(this._value=new Float64Array(1),this._value[0]=t):this._value=Float64Array.from(t)}get type(){return 12}get length(){return this._value.length}static data(t,n){let i=new Float64Array(n);for(let r=0;r<n;++r)i[r]=t.readFloat64();return new wt(i)}toDouble(t=0){return this._value[t]}toData(){return new Uint8Array(this._value.buffer)}write(t){for(let n=0,i=this._value.length;n<i;++n)t.writeFloat64(this._value[n])}setDouble(t,n=0){this._value[n]=t}equals(t){return t instanceof wt&&this.length===t.length&&U.equals(this._value,t._value)}clone(){return new wt(this._value)}toString(){return`${this.constructor.name} (${this._value.length===1?`${this._value[0]}`:`${this._value}`})`}}});var Nt,yi=A(()=>{"use strict";sn();_n();xe();Ci();Ve();Nn();_i();Rn();Dn();Vn();Tn();Ln();En();Hn();qn();Gn();$n();nn();G();Nt=class{constructor(e){this._sub=new ln;this._data=e!=null?e:new Map}get sub(){return this._sub}get keys(){return this._data.keys()}get values(){return this._data.values()}get size(){return this._data.size}get isEmpty(){return this._data.size===0&&this._sub.isEmpty}get hasUserComment(){return this._data.has(37510)}get userComment(){var t;let e=(t=this._data.get(37510))==null?void 0:t.toData();return e!==void 0?we.utf8Decoder.decode(e):void 0}set userComment(e){if(e===void 0)this._data.delete(37510);else{let t=we.getCodePoints(e);this._data.set(37510,new Ft(t))}}get hasImageDescription(){return this._data.has(270)}get imageDescription(){var e;return(e=this._data.get(270))==null?void 0:e.toString()}set imageDescription(e){e===void 0?this._data.delete(270):this._data.set(270,new Ue(e))}get hasMake(){return this._data.has(271)}get make(){var e;return(e=this._data.get(271))==null?void 0:e.toString()}set make(e){e===void 0?this._data.delete(271):this._data.set(271,new Ue(e))}get hasModel(){return this._data.has(272)}get model(){var e;return(e=this._data.get(272))==null?void 0:e.toString()}set model(e){e===void 0?this._data.delete(272):this._data.set(272,new Ue(e))}get hasOrientation(){return this._data.has(274)}get orientation(){var e;return(e=this._data.get(274))==null?void 0:e.toInt()}set orientation(e){e===void 0?this._data.delete(274):this._data.set(274,new qe(e))}get hasResolutionX(){return this._data.has(282)}get resolutionX(){var e;return(e=this._data.get(282))==null?void 0:e.toRational()}set resolutionX(e){this.setRational(282,e)||this._data.delete(282)}get hasResolutionY(){return this._data.has(283)}get resolutionY(){var e;return(e=this._data.get(283))==null?void 0:e.toRational()}set resolutionY(e){this.setRational(283,e)||this._data.delete(283)}get hasResolutionUnit(){return this._data.has(296)}get resolutionUnit(){var e;return(e=this._data.get(296))==null?void 0:e.toInt()}set resolutionUnit(e){e===void 0?this._data.delete(296):this._data.set(296,new qe(Math.trunc(e)))}get hasImageWidth(){return this._data.has(256)}get imageWidth(){var e;return(e=this._data.get(256))==null?void 0:e.toInt()}set imageWidth(e){e===void 0?this._data.delete(256):this._data.set(256,new qe(Math.trunc(e)))}get hasImageHeight(){return this._data.has(257)}get imageHeight(){var e;return(e=this._data.get(257))==null?void 0:e.toInt()}set imageHeight(e){e===void 0?this._data.delete(257):this._data.set(257,new qe(Math.trunc(e)))}get hasSoftware(){return this._data.has(305)}get software(){var e;return(e=this._data.get(305))==null?void 0:e.toString()}set software(e){e===void 0?this._data.delete(305):this._data.set(305,new Ue(e))}get hasCopyright(){return this._data.has(33432)}get copyright(){var e;return(e=this._data.get(33432))==null?void 0:e.toString()}set copyright(e){e===void 0?this._data.delete(33432):this._data.set(33432,new Ue(e))}get dataSize(){let t=2+12*this.size+4;for(let n of this.values){let i=n.dataSize;i>4&&(t+=i)}for(let n of this.sub.keys){let i=this.sub.get(n),r=2+12*i.size;for(let a of i.values){let s=a.dataSize;s>4&&(r+=s)}t+=r}return t}setRational(e,t){if(t instanceof fe)return this._data.set(e,Se.from(t)),!0;if(U.isNumArrayOrTypedArray(t)&&t.length>=2){let n=new fe(t[0],t[1]);return this._data.set(e,Se.from(n)),!0}return!1}static from(e){return new Nt(new Map(e._data))}static isArrayOfRationalNumbers(e){return Array.isArray(e)&&e.every(t=>U.isNumArrayOrTypedArray(t)&&t.length>=2)}has(e){return this._data.has(e)}getValue(e){let t=e;if(typeof t=="string"&&(t=ne.get(t)),typeof t=="number")return this._data.get(t)}setValue(e,t){let n=e;if(typeof n=="string"&&(n=ne.get(n)),typeof n=="number")if(t===void 0)this._data.delete(n);else if(t instanceof ue)this._data.set(n,t);else{let i=On.get(n);if(i!==void 0)switch(i.type){case 1:U.isNumArrayOrTypedArray(t)?this._data.set(n,new Ze(new Uint8Array(t))):typeof t=="number"&&this._data.set(n,new Ze(t));break;case 2:typeof t=="string"&&this._data.set(n,new Ue(t));break;case 3:U.isNumArrayOrTypedArray(t)?this._data.set(n,new qe(new Uint16Array(t))):typeof t=="number"&&this._data.set(n,new qe(t));break;case 4:U.isNumArrayOrTypedArray(t)?this._data.set(n,new Te(new Uint32Array(t))):typeof t=="number"&&this._data.set(n,new Te(t));break;case 5:if(U.isArrayOfRational(t))this._data.set(n,new Se(t));else if(U.isNumArrayOrTypedArray(t)&&t.length>=2){let a=new fe(t[0],t[1]);this._data.set(n,new Se(a))}else t instanceof fe&&this._data.set(n,new Se(t));break;case 6:U.isNumArrayOrTypedArray(t)?this._data.set(n,new _t(new Int8Array(t))):typeof t=="number"&&this._data.set(n,new _t(t));break;case 7:U.isNumArrayOrTypedArray(t)&&this._data.set(n,new Ft(new Uint8Array(t)));break;case 8:U.isNumArrayOrTypedArray(t)?this._data.set(n,new Qe(new Int16Array(t))):typeof t=="number"&&this._data.set(n,new Qe(t));break;case 9:U.isNumArrayOrTypedArray(t)?this._data.set(n,new yt(new Int32Array(t))):typeof t=="number"&&this._data.set(n,new yt(t));break;case 10:if(U.isArrayOfRational(t))this._data.set(n,new Ge(t));else if(U.isNumArrayOrTypedArray(t)&&t.length>=2){let a=new fe(t[0],t[1]);this._data.set(n,new Ge(a))}else t instanceof fe&&this._data.set(n,new Ge(t));break;case 11:U.isNumArrayOrTypedArray(t)?this._data.set(n,new Ct(new Float32Array(t))):typeof t=="number"&&this._data.set(n,new Ct(t));break;case 12:U.isNumArrayOrTypedArray(t)?this._data.set(n,new wt(new Float64Array(t))):typeof t=="number"&&this._data.set(n,new wt(t));break;case 0:break}}}copyFrom(e){e._data.forEach((t,n)=>this._data.set(n,t.clone()))}clone(){return Nt.from(this)}}});var ln,Ci=A(()=>{"use strict";yi();ln=class{get keys(){return this.directories.keys()}get values(){return this.directories.values()}get size(){return this.directories.size}get isEmpty(){if(this.directories.size===0)return!0;for(let e of this.directories.values())if(!e.isEmpty)return!1;return!0}constructor(e){this.directories=e!=null?e:new Map}static from(e){let t=new Map(e.directories);return new ln(t)}has(e){return this.directories.has(e)}get(e){let t=this.directories.get(e);return t===void 0&&(t=new Nt,this.directories.set(e,t)),t}set(e,t){this.directories.set(e,t)}clear(){this.directories.clear()}}});var Ie,Tt=A(()=>{"use strict";mr();_n();Ci();yi();xe();Nn();Dn();$n();Vn();Rn();Tn();_i();Gn();Hn();qn();En();Ln();Ie=class extends ln{get imageIfd(){return this.get("ifd0")}get thumbnailIfd(){return this.get("ifd1")}get exifIfd(){return this.get("ifd0").sub.get("exif")}get gpsIfd(){return this.get("ifd0").sub.get("gps")}get interopIfd(){return this.get("ifd0").sub.get("interop")}get dataSize(){var e,t;return 8+((t=(e=this.directories.get("ifd0"))==null?void 0:e.dataSize)!=null?t:0)}writeDirectory(e,t,n){let i=n,r=ne.get("StripOffsets");e.writeUint16(t.size);for(let a of t.keys){let s=t.getValue(a),u=a===r&&s.type===7?4:s.type,o=a===r&&s.type===7?1:s.length;e.writeUint16(a),e.writeUint16(u),e.writeUint32(o);let l=s.dataSize;if(l<=4)for(s.write(e);l<4;)e.writeByte(0),l++;else e.writeUint32(i),i+=l}return i}writeDirectoryLargeValues(e,t){for(let n of t.values)n.dataSize>4&&n.write(e)}readEntry(e,t){let n=e.readUint16(),i=e.readUint16(),r=e.readUint32(),a=new lr(n,void 0);if(i>Object.keys(Ce).length)return a;let s=i,u=xn[i],o=r*u,l=e.offset+4;if(o>4){let b=e.readUint32();e.offset=b+t}if(e.offset+o>e.end)return a;let m=e.readBytes(o);switch(s){case 0:break;case 6:a.value=_t.data(m,r);break;case 1:a.value=Ze.data(m,r);break;case 7:a.value=Ft.data(m,r);break;case 2:a.value=Ue.data(m,r);break;case 3:a.value=qe.data(m,r);break;case 4:a.value=Te.data(m,r);break;case 5:a.value=Se.data(m,r);break;case 10:a.value=Ge.data(m,r);break;case 8:a.value=Qe.data(m,r);break;case 9:a.value=yt.data(m,r);break;case 11:a.value=Ct.data(m,r);break;case 12:a.value=wt.data(m,r);break}return e.offset=l,a}static from(e){let t=new Map(e.directories);return new Ie(t)}static fromInputBuffer(e){let t=new Ie;return t.read(e),t}hasTag(e){for(let t of this.directories.values())if(t.has(e))return!0;return!1}getTag(e){for(let t of this.directories.values())if(t.has(e))return t.getValue(e)}getTagName(e){var t,n;return(n=(t=On.get(e))==null?void 0:t.name)!=null?n:"<unknown>"}write(e){let t=e.bigEndian;e.bigEndian=!0,e.writeUint16(19789),e.writeUint16(42),e.writeUint32(8),this.directories.get("ifd0")===void 0&&this.directories.set("ifd0",new Nt);let n=8,i=new Map;for(let[a,s]of this.directories){i.set(a,n),s.sub.has("exif")?s.setValue(34665,new Te(0)):s.setValue(34665,void 0),s.sub.has("interop")?s.setValue(40965,new Te(0)):s.setValue(40965,void 0),s.sub.has("gps")?s.setValue(34853,new Te(0)):s.setValue(34853,void 0),n+=2+12*s.size+4;for(let u of s.values){let o=u.dataSize;o>4&&(n+=o)}for(let u of s.sub.keys){let o=s.sub.get(u);i.set(u,n);let l=2+12*o.size;for(let m of o.values){let b=m.dataSize;b>4&&(l+=b)}n+=l}}let r=Array.from(this.directories);for(let a=0;a<r.length;a++){let[s,u]=r[a];u.sub.has("exif")&&u.getValue(34665).setInt(i.get("exif")),u.sub.has("interop")&&u.getValue(40965).setInt(i.get("interop")),u.sub.has("gps")&&u.getValue(34853).setInt(i.get("gps"));let l=i.get(s)+2+12*u.size+4;if(this.writeDirectory(e,u,l),a===r.length-1)e.writeUint32(0);else{let m=r[a+1][0];e.writeUint32(i.get(m))}this.writeDirectoryLargeValues(e,u);for(let m of u.sub.keys){let b=u.sub.get(m),c=i.get(m)+2+12*b.size;this.writeDirectory(e,b,c),this.writeDirectoryLargeValues(e,b)}}e.bigEndian=t}read(e){let t=e.bigEndian;e.bigEndian=!0;let n=e.offset,i=e.readUint16();if(i===18761){if(e.bigEndian=!1,e.readUint16()!==42)return e.bigEndian=t,!1}else if(i===19789){if(e.bigEndian=!0,e.readUint16()!==42)return e.bigEndian=t,!1}else return!1;let r=e.readUint32(),a=0;for(;r>0;){e.offset=n+r;let u=new Nt,o=e.readUint16(),l=new Array;for(let m=0;m<o;m++){let b=this.readEntry(e,n);l.push(b)}for(let m of l)m.value!==void 0&&u.setValue(m.tag,m.value);this.directories.set(`ifd${a}`,u),a++,r=e.readUint32()}let s=new Map([[34665,"exif"],[40965,"interop"],[34853,"gps"]]);for(let u of this.directories.values())for(let o of s.keys())if(u.has(o)){let l=u.getValue(o).toInt();e.offset=n+l;let m=new Nt,b=e.readUint16(),h=new Array;for(let c=0;c<b;c++){let d=this.readEntry(e,n);h.push(d)}for(let c of h)c.value!==void 0&&m.setValue(c.tag,c.value);u.sub.set(s.get(o),m)}return e.bigEndian=t,!1}clone(){return Ie.from(this)}toString(){let e="";for(let[t,n]of this.directories){e+=`${t}
`;for(let i of n.keys){let r=n.getValue(i);r===void 0?e+=`	${this.getTagName(i)}
`:e+=`	${this.getTagName(i)}: ${r.toString()}
`}for(let i of n.sub.keys){e+=`${i}
`;let r=n.sub.get(i);for(let a of r.keys){let s=r.getValue(a);s===void 0?e+=`	${this.getTagName(a)}
`:e+=`	${this.getTagName(a)}: ${s}
`}}}return`${this.constructor.name} (${e})`}}});var us,Wn=A(()=>{"use strict";us=[[[0,0,0],[0,0,0],[0,0,0]],[[.375,1,0],[.375,0,1],[.25,1,1]],[[.4375,1,0],[.1875,-1,1],[.3125,0,1],[.0625,1,1]],[[.19047619047619047,1,0],[.09523809523809523,2,0],[.047619047619047616,-2,1],[.09523809523809523,-1,1],[.19047619047619047,0,1],[.09523809523809523,1,1],[.047619047619047616,2,1],[.023809523809523808,-2,2],[.047619047619047616,-1,2],[.09523809523809523,0,2],[.047619047619047616,1,2],[.023809523809523808,2,2]],[[.125,1,0],[.125,2,0],[.125,-1,1],[.125,0,1],[.125,1,1],[.125,0,2]]]});var Yn=A(()=>{"use strict"});var Ke,hr=A(()=>{"use strict";oe();ae();H();G();un();wi();Ke=class{get image(){return this._image}get x(){return this._x}get y(){return this._y}get xNormalized(){return this.width>1?this._x/(this.width-1):0}get yNormalized(){return this.height>1?this._y/(this.height-1):0}get index(){return this.r}set index(e){this.r=e}get data(){return this._image.data}get isValid(){return this._x>=0&&this._x<this._image.width-1&&this._y>=0&&this._y<this._image.height-1}get width(){return this._image.width}get height(){return this._image.width}get length(){return this._image.numChannels}get numChannels(){return this._image.numChannels}get maxChannelValue(){return this._image.maxChannelValue}get maxIndexValue(){return this._image.maxIndexValue}get format(){return 9}get isLdrFormat(){return this._image.isLdrFormat}get isHdrFormat(){return this._image.isLdrFormat}get hasPalette(){return this._image.hasPalette}get palette(){}get r(){return this.numChannels>0?R.float16ToDouble(this.data[this._index]):0}set r(e){this.numChannels>0&&(this.data[this._index]=R.doubleToFloat16(e))}get g(){return this.numChannels>1?R.float16ToDouble(this.data[this._index+1]):0}set g(e){this.numChannels>1&&(this.data[this._index+1]=R.doubleToFloat16(e))}get b(){return this.numChannels>2?R.float16ToDouble(this.data[this._index+2]):0}set b(e){this.numChannels>2&&(this.data[this._index+2]=R.doubleToFloat16(e))}get a(){return this.numChannels>3?R.float16ToDouble(this.data[this._index+3]):0}set a(e){this.numChannels>3&&(this.data[this._index+3]=R.doubleToFloat16(e))}get rNormalized(){return this.r/this.maxChannelValue}set rNormalized(e){this.r=e*this.maxChannelValue}get gNormalized(){return this.g/this.maxChannelValue}set gNormalized(e){this.g=e*this.maxChannelValue}get bNormalized(){return this.b/this.maxChannelValue}set bNormalized(e){this.b=e*this.maxChannelValue}get aNormalized(){return this.a/this.maxChannelValue}set aNormalized(e){this.a=e*this.maxChannelValue}get luminance(){return z.getLuminance(this)}get luminanceNormalized(){return z.getLuminanceNormalized(this)}constructor(e,t,n,i){this._image=i,this._index=n,this._x=e,this._y=t}static imageData(e){return new Ke(-1,0,-e.numChannels,e)}static image(e){return new Ke(-1,0,-e.numChannels,e.data instanceof Lt?e.data:new Lt(0,0,0))}static from(e){return new Ke(e.x,e.y,e._index,e.image)}next(){return this._x++,this._x===this.width&&(this._x=0,this._y++,this._y===this.height)?{done:!0,value:this}:(this._index+=this.numChannels,{done:this._index>=this.image.data.length,value:this})}setPosition(e,t){this._x=e,this._y=t,this._index=this._y*this._image.width*this._image.numChannels+this._x*this._image.numChannels}setPositionNormalized(e,t){return this.setPosition(Math.floor(e*(this.width-1)),Math.floor(t*(this.height-1)))}getChannel(e){return e===4?this.luminance:e<this.numChannels?R.float16ToDouble(this.data[this._index+e]):0}getChannelNormalized(e){return this.getChannel(e)/this.maxChannelValue}setChannel(e,t){e<this.numChannels&&(this.data[this._index+e]=R.doubleToFloat16(t))}set(e){this.numChannels>0&&(this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a)}setRgb(e,t,n){this.numChannels>0&&(this.data[this._index]=R.doubleToFloat16(e),this.numChannels>1&&(this.data[this._index+1]=R.doubleToFloat16(t),this.numChannels>2&&(this.data[this._index+2]=R.doubleToFloat16(n))))}setRgba(e,t,n,i){this.numChannels>0&&(this.data[this._index]=R.doubleToFloat16(e),this.numChannels>1&&(this.data[this._index+1]=R.doubleToFloat16(t),this.numChannels>2&&(this.data[this._index+2]=R.doubleToFloat16(n),this.numChannels>3&&(this.data[this._index+3]=R.doubleToFloat16(i)))))}toArray(){return U.generate(this.length,e=>this.getChannel(e))}equals(e){return e instanceof Ke?U.equals(this.toArray(),e.toArray()):Array.isArray(e)?U.equals(this.toArray(),e):!1}clone(){return Ke.from(this)}convert(e){return z.convertColor({from:this,format:e.format,numChannels:e.numChannels,alpha:e.alpha})}[Symbol.iterator](){return this}}});var le,$e=A(()=>{"use strict";le=class{constructor(e,t,n,i,r){this._pixel=e,this._x1=t,this._y1=n,this._x2=t+i-1,this._y2=n+r-1,this._pixel.setPosition(t-1,n)}next(){return this._pixel.x+1>this._x2?(this._pixel.setPosition(this._x1,this._pixel.y+1),{done:this._pixel.y>this._y2,value:this._pixel}):this._pixel.next()}[Symbol.iterator](){return this}}});var Lt,wi=A(()=>{"use strict";De();H();hr();$e();fi();un();Lt=class{get width(){return this._width}get height(){return this._height}get data(){return this._data}get numChannels(){return this._numChannels}get format(){return 9}get formatType(){return 2}get buffer(){return this._data.buffer}get rowStride(){return this._width*this._numChannels*2}get iterator(){return Ke.imageData(this)}get byteLength(){return this._data.byteLength}get length(){return this._data.byteLength}get maxChannelValue(){return 1}get maxIndexValue(){return 1}get hasPalette(){return this.palette!==void 0}get palette(){}get isHdrFormat(){return!0}get isLdrFormat(){return!this.isHdrFormat}get bitsPerChannel(){return 16}constructor(e,t,n,i){this._width=e,this._height=t,this._numChannels=n,this._data=i!=null?i:new Uint16Array(this._width*this._height*this._numChannels)}static from(e,t=!1){let n=t?new Uint16Array(e.data.length):e.data.slice();return new Lt(e.width,e.height,e._numChannels,n)}getRange(e,t,n,i){return new le(Ke.imageData(this),e,t,n,i)}getColor(e,t,n,i){return i===void 0?xt.rgb(e,t,n):xt.rgba(e,t,n,i)}getPixel(e,t,n){let i=n;return(i===void 0||!(i instanceof Ke)||i.image!==this)&&(i=Ke.imageData(this)),i.setPosition(e,t),i}setPixel(e,t,n){this.setPixelRgba(e,t,n.r,n.g,n.b,n.a)}setPixelR(e,t,n){let i=t*this._width*this._numChannels+e*this.numChannels;this.data[i]=R.doubleToFloat16(n)}setPixelRgb(e,t,n,i,r){let a=t*this._width*this._numChannels+e*this._numChannels;this._data[a]=R.doubleToFloat16(n),this._numChannels>1&&(this._data[a+1]=R.doubleToFloat16(i),this._numChannels>2&&(this._data[a+2]=R.doubleToFloat16(r)))}setPixelRgba(e,t,n,i,r,a){let s=t*this._width*this._numChannels+e*this._numChannels;this._data[s]=R.doubleToFloat16(n),this._numChannels>1&&(this._data[s+1]=R.doubleToFloat16(i),this._numChannels>2&&(this._data[s+2]=R.doubleToFloat16(r),this._numChannels>3&&(this._data[s+3]=R.doubleToFloat16(a))))}setPixelRgbSafe(e,t,n,i,r){e<0||e>=this.width||t<0||t>=this.height||this.setPixelRgb(e,t,n,i,r)}setPixelRgbaSafe(e,t,n,i,r,a){e<0||e>=this.width||t<0||t>=this.height||this.setPixelRgba(e,t,n,i,r,a)}clear(e){}clone(e=!1){return Lt.from(this,e)}toUint8Array(){return new Uint8Array(this.buffer)}getBytes(e){if(e===void 0)return this.toUint8Array();if(this.numChannels===4){if(e===2||e===3||e===1){let t=this.clone();if(e===2)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=s,n.g=a,n.b=r,n.a=i}else if(e===3)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=s,n.g=i,n.b=r,n.a=a}else if(e===1)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=a,n.g=r,n.b=i,n.a=s}return t.toUint8Array()}}else if(this.numChannels===3&&e===5){let t=this.clone();for(let n of t){let i=n.r;n.r=n.b,n.b=i}return t.toUint8Array()}return this.toUint8Array()}toString(){return`${this.constructor.name} (w: ${this._width}, h: ${this._height}, ch: ${this._numChannels})`}[Symbol.iterator](){return Ke.imageData(this)}}});var Je,cr=A(()=>{"use strict";oe();ae();H();G();vi();Je=class{get image(){return this._image}get x(){return this._x}get y(){return this._y}get xNormalized(){return this.width>1?this._x/(this.width-1):0}get yNormalized(){return this.height>1?this._y/(this.height-1):0}get index(){return this.r}set index(e){this.r=e}get data(){return this._image.data}get isValid(){return this._x>=0&&this._x<this._image.width-1&&this._y>=0&&this._y<this._image.height-1}get width(){return this._image.width}get height(){return this._image.width}get length(){return this._image.numChannels}get numChannels(){return this._image.numChannels}get maxChannelValue(){return this._image.maxChannelValue}get maxIndexValue(){return this._image.maxIndexValue}get format(){return 10}get isLdrFormat(){return this._image.isLdrFormat}get isHdrFormat(){return this._image.isLdrFormat}get hasPalette(){return this._image.hasPalette}get palette(){}get r(){return this.numChannels>0?this.data[this._index]:0}set r(e){this.numChannels>0&&(this.data[this._index]=e)}get g(){return this.numChannels>1?this.data[this._index+1]:0}set g(e){this.numChannels>1&&(this.data[this._index+1]=e)}get b(){return this.numChannels>2?this.data[this._index+2]:0}set b(e){this.numChannels>2&&(this.data[this._index+2]=e)}get a(){return this.numChannels>3?this.data[this._index+3]:1}set a(e){this.numChannels>3&&(this.data[this._index+3]=e)}get rNormalized(){return this.r/this.maxChannelValue}set rNormalized(e){this.r=e*this.maxChannelValue}get gNormalized(){return this.g/this.maxChannelValue}set gNormalized(e){this.g=e*this.maxChannelValue}get bNormalized(){return this.b/this.maxChannelValue}set bNormalized(e){this.b=e*this.maxChannelValue}get aNormalized(){return this.a/this.maxChannelValue}set aNormalized(e){this.a=e*this.maxChannelValue}get luminance(){return z.getLuminance(this)}get luminanceNormalized(){return z.getLuminanceNormalized(this)}constructor(e,t,n,i){this._image=i,this._index=n,this._x=e,this._y=t}static imageData(e){return new Je(-1,0,-e.numChannels,e)}static image(e){return new Je(-1,0,-e.numChannels,e.data instanceof Et?e.data:new Et(0,0,0))}static from(e){return new Je(e.x,e.y,e._index,e.image)}next(){return this._x++,this._x===this.width&&(this._x=0,this._y++,this._y===this.height)?{done:!0,value:this}:(this._index+=this.numChannels,{done:this._index>=this.image.data.length,value:this})}setPosition(e,t){this._x=e,this._y=t,this._index=this._y*this._image.width*this._image.numChannels+this._x*this._image.numChannels}setPositionNormalized(e,t){return this.setPosition(Math.floor(e*(this.width-1)),Math.floor(t*(this.height-1)))}getChannel(e){return e===4?this.luminance:e<this.numChannels?this.data[this._index+e]:0}getChannelNormalized(e){return this.getChannel(e)/this.maxChannelValue}setChannel(e,t){e<this.numChannels&&(this.data[this._index+e]=t)}set(e){this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a}setRgb(e,t,n){this.numChannels>0&&(this.data[this._index]=e,this.numChannels>1&&(this.data[this._index+1]=t,this.numChannels>2&&(this.data[this._index+2]=n)))}setRgba(e,t,n,i){this.numChannels>0&&(this.data[this._index]=e,this.numChannels>1&&(this.data[this._index+1]=t,this.numChannels>2&&(this.data[this._index+2]=n,this.numChannels>3&&(this.data[this._index+3]=i))))}toArray(){return U.generate(this.length,e=>this.getChannel(e))}equals(e){return e instanceof Je?U.equals(this.toArray(),e.toArray()):Array.isArray(e)?U.equals(this.toArray(),e):!1}clone(){return Je.from(this)}convert(e){return z.convertColor({from:this,format:e.format,numChannels:e.numChannels,alpha:e.alpha})}toString(){return`${this.constructor.name} (${this.toArray()})`}[Symbol.iterator](){return this}}});var Et,vi=A(()=>{"use strict";De();H();cr();$e();ri();Et=class{get width(){return this._width}get height(){return this._height}get data(){return this._data}get numChannels(){return this._numChannels}get format(){return 10}get formatType(){return 2}get buffer(){return this._data.buffer}get rowStride(){return this._width*this._numChannels*4}get iterator(){return Je.imageData(this)}get byteLength(){return this._data.byteLength}get length(){return this._data.byteLength}get maxChannelValue(){return 1}get maxIndexValue(){return 1}get hasPalette(){return this.palette!==void 0}get palette(){}get isHdrFormat(){return!0}get isLdrFormat(){return!this.isHdrFormat}get bitsPerChannel(){return 32}constructor(e,t,n,i){this._width=e,this._height=t,this._numChannels=n,this._data=i!=null?i:new Float32Array(this._width*this._height*this._numChannels)}static from(e,t=!1){let n=t?new Float32Array(e.data.length):e.data.slice();return new Et(e.width,e.height,e._numChannels,n)}getRange(e,t,n,i){return new le(Je.imageData(this),e,t,n,i)}getColor(e,t,n,i){return i===void 0?ot.rgb(e,t,n):ot.rgba(e,t,n,i)}getPixel(e,t,n){let i=n;return(i===void 0||!(i instanceof Je)||i.image!==this)&&(i=Je.imageData(this)),i.setPosition(e,t),i}setPixel(e,t,n){this.setPixelRgba(e,t,n.r,n.g,n.b,n.a)}setPixelR(e,t,n){let i=t*this._width*this._numChannels+e*this.numChannels;this.data[i]=n}setPixelRgb(e,t,n,i,r){let a=t*this._width*this._numChannels+e*this._numChannels;this._data[a]=n,this._numChannels>1&&(this._data[a+1]=i,this._numChannels>2&&(this._data[a+2]=r))}setPixelRgba(e,t,n,i,r,a){let s=t*this._width*this._numChannels+e*this._numChannels;this._data[s]=n,this._numChannels>1&&(this._data[s+1]=i,this._numChannels>2&&(this._data[s+2]=r,this._numChannels>3&&(this._data[s+3]=a)))}setPixelRgbSafe(e,t,n,i,r){e<0||e>=this.width||t<0||t>=this.height||this.setPixelRgb(e,t,n,i,r)}setPixelRgbaSafe(e,t,n,i,r,a){e<0||e>=this.width||t<0||t>=this.height||this.setPixelRgba(e,t,n,i,r,a)}clear(e){}clone(e=!1){return Et.from(this,e)}toUint8Array(){return new Uint8Array(this.buffer)}getBytes(e){if(e===void 0)return this.toUint8Array();if(this.numChannels===4){if(e===2||e===3||e===1){let t=this.clone();if(e===2)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=s,n.g=a,n.b=r,n.a=i}else if(e===3)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=s,n.g=i,n.b=r,n.a=a}else if(e===1)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=a,n.g=r,n.b=i,n.a=s}return t.toUint8Array()}}else if(this.numChannels===3&&e===5){let t=this.clone();for(let n of t){let i=n.r;n.r=n.b,n.b=i}return t.toUint8Array()}return this.toUint8Array()}toString(){return`${this.constructor.name} (w: ${this._width}, h: ${this._height}, ch: ${this._numChannels})`}[Symbol.iterator](){return Je.imageData(this)}}});var et,br=A(()=>{"use strict";oe();ae();H();G();Ii();et=class{get image(){return this._image}get x(){return this._x}get y(){return this._y}get xNormalized(){return this.width>1?this._x/(this.width-1):0}get yNormalized(){return this.height>1?this._y/(this.height-1):0}get index(){return this.r}set index(e){this.r=e}get data(){return this._image.data}get isValid(){return this._x>=0&&this._x<this._image.width-1&&this._y>=0&&this._y<this._image.height-1}get width(){return this._image.width}get height(){return this._image.width}get length(){return this._image.numChannels}get numChannels(){return this._image.numChannels}get maxChannelValue(){return this._image.maxChannelValue}get maxIndexValue(){return this._image.maxIndexValue}get format(){return 11}get isLdrFormat(){return this._image.isLdrFormat}get isHdrFormat(){return this._image.isLdrFormat}get hasPalette(){return this._image.hasPalette}get palette(){}get r(){return this.numChannels>0?this.data[this._index]:0}set r(e){this.numChannels>0&&(this.data[this._index]=e)}get g(){return this.numChannels>1?this.data[this._index+1]:0}set g(e){this.numChannels>1&&(this.data[this._index+1]=e)}get b(){return this.numChannels>2?this.data[this._index+2]:0}set b(e){this.numChannels>2&&(this.data[this._index+2]=e)}get a(){return this.numChannels>3?this.data[this._index+3]:0}set a(e){this.numChannels>3&&(this.data[this._index+3]=e)}get rNormalized(){return this.r/this.maxChannelValue}set rNormalized(e){this.r=e*this.maxChannelValue}get gNormalized(){return this.g/this.maxChannelValue}set gNormalized(e){this.g=e*this.maxChannelValue}get bNormalized(){return this.b/this.maxChannelValue}set bNormalized(e){this.b=e*this.maxChannelValue}get aNormalized(){return this.a/this.maxChannelValue}set aNormalized(e){this.a=e*this.maxChannelValue}get luminance(){return z.getLuminance(this)}get luminanceNormalized(){return z.getLuminanceNormalized(this)}constructor(e,t,n,i){this._image=i,this._index=n,this._x=e,this._y=t}static imageData(e){return new et(-1,0,-e.numChannels,e)}static image(e){return new et(-1,0,-e.numChannels,e.data instanceof Ht?e.data:new Ht(0,0,0))}static from(e){return new et(e.x,e.y,e._index,e.image)}[Symbol.iterator](){return this}next(){return this._x++,this._x===this.width&&(this._x=0,this._y++,this._y===this.height)?{done:!0,value:this}:(this._index+=this.numChannels,{done:this._index>=this.image.data.length,value:this})}setPosition(e,t){this._x=e,this._y=t,this._index=this._y*this._image.width*this._image.numChannels+this._x*this._image.numChannels}setPositionNormalized(e,t){return this.setPosition(Math.floor(e*(this.width-1)),Math.floor(t*(this.height-1)))}getChannel(e){return e===4?this.luminance:e<this.numChannels?this.data[this._index+e]:0}getChannelNormalized(e){return this.getChannel(e)/this.maxChannelValue}setChannel(e,t){e<this.numChannels&&(this.data[this._index+e]=t)}set(e){this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a}setRgb(e,t,n){this.numChannels>0&&(this.data[this._index]=e,this.numChannels>1&&(this.data[this._index+1]=t,this.numChannels>2&&(this.data[this._index+2]=n)))}setRgba(e,t,n,i){this.numChannels>0&&(this.data[this._index]=e,this.numChannels>1&&(this.data[this._index+1]=t,this.numChannels>2&&(this.data[this._index+2]=n,this.numChannels>3&&(this.data[this._index+3]=i))))}toArray(){return U.generate(this.length,e=>this.getChannel(e))}equals(e){return e instanceof et?U.equals(this.toArray(),e.toArray()):Array.isArray(e)?U.equals(this.toArray(),e):!1}clone(){return et.from(this)}convert(e){return z.convertColor({from:this,format:e.format,numChannels:e.numChannels,alpha:e.alpha})}toString(){return`${this.constructor.name} (${this.toArray()})`}}});var Ht,Ii=A(()=>{"use strict";De();H();br();$e();ai();Ht=class{get width(){return this._width}get height(){return this._height}get data(){return this._data}get numChannels(){return this._numChannels}get format(){return 11}get formatType(){return 2}get buffer(){return this._data.buffer}get rowStride(){return this._width*this._numChannels*8}get iterator(){return et.imageData(this)}get byteLength(){return this._data.byteLength}get length(){return this._data.byteLength}get maxChannelValue(){return 1}get maxIndexValue(){return 1}get hasPalette(){return this.palette!==void 0}get palette(){}get isHdrFormat(){return!0}get isLdrFormat(){return!this.isHdrFormat}get bitsPerChannel(){return 64}constructor(e,t,n,i){this._width=e,this._height=t,this._numChannels=n,this._data=i!=null?i:new Float64Array(this._width*this._height*4*this._numChannels)}static from(e,t=!1){let n=t?new Float64Array(e.data.length):e.data.slice();return new Ht(e.width,e.height,e._numChannels,n)}getRange(e,t,n,i){return new le(et.imageData(this),e,t,n,i)}getColor(e,t,n,i){return i===void 0?lt.rgb(e,t,n):lt.rgba(e,t,n,i)}getPixel(e,t,n){let i=n;return(i===void 0||!(i instanceof et)||i.image!==this)&&(i=et.imageData(this)),i.setPosition(e,t),i}setPixel(e,t,n){this.setPixelRgba(e,t,n.r,n.g,n.b,n.a)}setPixelR(e,t,n){let i=t*this._width*this._numChannels+e*this.numChannels;this.data[i]=n}setPixelRgb(e,t,n,i,r){let a=t*this._width*this._numChannels+e*this._numChannels;this._data[a]=n,this._numChannels>1&&(this._data[a+1]=i,this._numChannels>2&&(this._data[a+2]=r))}setPixelRgba(e,t,n,i,r,a){let s=t*this._width*this._numChannels+e*this._numChannels;this._data[s]=n,this._numChannels>1&&(this._data[s+1]=i,this._numChannels>2&&(this._data[s+2]=r,this._numChannels>3&&(this._data[s+3]=a)))}setPixelRgbSafe(e,t,n,i,r){e<0||e>=this.width||t<0||t>=this.height||this.setPixelRgb(e,t,n,i,r)}setPixelRgbaSafe(e,t,n,i,r,a){e<0||e>=this.width||t<0||t>=this.height||this.setPixelRgba(e,t,n,i,r,a)}clear(e){}clone(e=!1){return Ht.from(this,e)}toUint8Array(){return new Uint8Array(this.buffer)}getBytes(e){if(e===void 0)return this.toUint8Array();if(this.numChannels===4){if(e===2||e===3||e===1){let t=this.clone();if(e===2)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=s,n.g=a,n.b=r,n.a=i}else if(e===3)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=s,n.g=i,n.b=r,n.a=a}else if(e===1)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=a,n.g=r,n.b=i,n.a=s}return t.toUint8Array()}}else if(this.numChannels===3&&e===5){let t=this.clone();for(let n of t){let i=n.r;n.r=n.b,n.b=i}return t.toUint8Array()}return this.toUint8Array()}toString(){return`${this.constructor.name} (w: ${this._width}, h: ${this._height}, ch: ${this._numChannels})`}[Symbol.iterator](){return et.imageData(this)}}});var tt,fr=A(()=>{"use strict";oe();ae();H();G();Pi();tt=class{get image(){return this._image}get x(){return this._x}get y(){return this._y}get xNormalized(){return this.width>1?this._x/(this.width-1):0}get yNormalized(){return this.height>1?this._y/(this.height-1):0}get index(){return this.r}set index(e){this.r=e}get data(){return this._image.data}get isValid(){return this._x>=0&&this._x<this._image.width-1&&this._y>=0&&this._y<this._image.height-1}get width(){return this._image.width}get height(){return this._image.width}get length(){return this._image.numChannels}get numChannels(){return this._image.numChannels}get maxChannelValue(){return this._image.maxChannelValue}get maxIndexValue(){return this._image.maxIndexValue}get format(){return 7}get isLdrFormat(){return this._image.isLdrFormat}get isHdrFormat(){return this._image.isLdrFormat}get hasPalette(){return this._image.hasPalette}get palette(){}get r(){return this.numChannels>0?this.data[this._index]:0}set r(e){this.numChannels>0&&(this.data[this._index]=Math.trunc(e))}get g(){return this.numChannels>1?this.data[this._index+1]:0}set g(e){this.numChannels>1&&(this.data[this._index+1]=Math.trunc(e))}get b(){return this.numChannels>2?this.data[this._index+2]:0}set b(e){this.numChannels>2&&(this.data[this._index+2]=Math.trunc(e))}get a(){return this.numChannels>3?this.data[this._index+3]:0}set a(e){this.numChannels>3&&(this.data[this._index+3]=Math.trunc(e))}get rNormalized(){return this.r/this.maxChannelValue}set rNormalized(e){this.r=e*this.maxChannelValue}get gNormalized(){return this.g/this.maxChannelValue}set gNormalized(e){this.g=e*this.maxChannelValue}get bNormalized(){return this.b/this.maxChannelValue}set bNormalized(e){this.b=e*this.maxChannelValue}get aNormalized(){return this.a/this.maxChannelValue}set aNormalized(e){this.a=e*this.maxChannelValue}get luminance(){return z.getLuminance(this)}get luminanceNormalized(){return z.getLuminanceNormalized(this)}constructor(e,t,n,i){this._image=i,this._index=n,this._x=e,this._y=t}static imageData(e){return new tt(-1,0,-e.numChannels,e)}static image(e){return new tt(-1,0,-e.numChannels,e.data instanceof qt?e.data:new qt(0,0,0))}static from(e){return new tt(e.x,e.y,e._index,e.image)}next(){return this._x++,this._x===this.width&&(this._x=0,this._y++,this._y===this.height)?{done:!0,value:this}:(this._index+=this.numChannels,{done:this._index>=this.image.data.length,value:this})}setPosition(e,t){this._x=e,this._y=t,this._index=this._y*this._image.width*this._image.numChannels+this._x*this._image.numChannels}setPositionNormalized(e,t){return this.setPosition(Math.floor(e*(this.width-1)),Math.floor(t*(this.height-1)))}getChannel(e){return e===4?this.luminance:e<this.numChannels?this.data[this._index+e]:0}getChannelNormalized(e){return this.getChannel(e)/this.maxChannelValue}setChannel(e,t){e<this.numChannels&&(this.data[this._index+e]=Math.trunc(t))}set(e){this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a}setRgb(e,t,n){this.numChannels>0&&(this.data[this._index]=Math.trunc(e),this.numChannels>1&&(this.data[this._index+1]=Math.trunc(t),this.numChannels>2&&(this.data[this._index+2]=Math.trunc(n))))}setRgba(e,t,n,i){this.numChannels>0&&(this.data[this._index]=Math.trunc(e),this.numChannels>1&&(this.data[this._index+1]=Math.trunc(t),this.numChannels>2&&(this.data[this._index+2]=Math.trunc(n),this.numChannels>3&&(this.data[this._index+3]=Math.trunc(i)))))}toArray(){return U.generate(this.length,e=>this.getChannel(e))}equals(e){return e instanceof tt?U.equals(this.toArray(),e.toArray()):Array.isArray(e)?U.equals(this.toArray(),e):!1}clone(){return tt.from(this)}convert(e){return z.convertColor({from:this,format:e.format,numChannels:e.numChannels,alpha:e.alpha})}toString(){return`${this.constructor.name} (${this.toArray()})`}[Symbol.iterator](){return this}}});var qt,Pi=A(()=>{"use strict";De();si();H();fr();$e();qt=class{get width(){return this._width}get height(){return this._height}get data(){return this._data}get numChannels(){return this._numChannels}get format(){return 7}get formatType(){return 1}get buffer(){return this._data.buffer}get rowStride(){return this._width*this._numChannels*2}get iterator(){return tt.imageData(this)}get byteLength(){return this._data.byteLength}get length(){return this._data.byteLength}get maxChannelValue(){return 32767}get maxIndexValue(){return 32767}get hasPalette(){return this.palette!==void 0}get palette(){}get isHdrFormat(){return!0}get isLdrFormat(){return!this.isHdrFormat}get bitsPerChannel(){return 16}constructor(e,t,n,i){this._width=e,this._height=t,this._numChannels=n,this._data=i!=null?i:new Int16Array(this._width*this._height*this._numChannels)}static from(e,t=!1){let n=t?new Int16Array(e.data.length):e.data.slice();return new qt(e.width,e.height,e._numChannels,n)}getRange(e,t,n,i){return new le(tt.imageData(this),e,t,n,i)}getColor(e,t,n,i){return i===void 0?mt.rgb(Math.trunc(e),Math.trunc(t),Math.trunc(n)):mt.rgba(Math.trunc(e),Math.trunc(t),Math.trunc(n),Math.trunc(i))}getPixel(e,t,n){let i=n;return(i===void 0||!(i instanceof tt)||i.image!==this)&&(i=tt.imageData(this)),i.setPosition(e,t),i}setPixel(e,t,n){this.setPixelRgba(e,t,n.r,n.g,n.b,n.a)}setPixelR(e,t,n){let i=t*this.width*this.numChannels+e*this.numChannels;this.data[i]=Math.trunc(n)}setPixelRgb(e,t,n,i,r){let a=t*this.width*this.numChannels+e*this._numChannels;this._data[a]=Math.trunc(n),this._numChannels>1&&(this._data[a+1]=Math.trunc(i),this._numChannels>2&&(this._data[a+2]=Math.trunc(r)))}setPixelRgba(e,t,n,i,r,a){let s=t*this.width*this.numChannels+e*this._numChannels;this._data[s]=Math.trunc(n),this._numChannels>1&&(this._data[s+1]=Math.trunc(i),this._numChannels>2&&(this._data[s+2]=Math.trunc(r),this._numChannels>3&&(this._data[s+3]=Math.trunc(a))))}setPixelRgbSafe(e,t,n,i,r){e<0||e>=this.width||t<0||t>=this.height||this.setPixelRgb(e,t,n,i,r)}setPixelRgbaSafe(e,t,n,i,r,a){e<0||e>=this.width||t<0||t>=this.height||this.setPixelRgba(e,t,n,i,r,a)}clear(e){}clone(e=!1){return qt.from(this,e)}toUint8Array(){return new Uint8Array(this.buffer)}getBytes(e){if(e===void 0)return this.toUint8Array();if(this.numChannels===4){if(e===2||e===3||e===1){let t=this.clone();if(e===2)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=s,n.g=a,n.b=r,n.a=i}else if(e===3)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=s,n.g=i,n.b=r,n.a=a}else if(e===1)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=a,n.g=r,n.b=i,n.a=s}return t.toUint8Array()}}else if(this.numChannels===3&&e===5){let t=this.clone();for(let n of t){let i=n.r;n.r=n.b,n.b=i}return t.toUint8Array()}return this.toUint8Array()}toString(){return`${this.constructor.name} (w: ${this._width}, h: ${this._height}, ch: ${this._numChannels})`}[Symbol.iterator](){return tt.imageData(this)}}});var nt,dr=A(()=>{"use strict";oe();ae();H();G();Mi();nt=class{get image(){return this._image}get x(){return this._x}get y(){return this._y}get xNormalized(){return this.width>1?this._x/(this.width-1):0}get yNormalized(){return this.height>1?this._y/(this.height-1):0}get index(){return this.r}set index(e){this.r=e}get data(){return this._image.data}get isValid(){return this._x>=0&&this._x<this._image.width-1&&this._y>=0&&this._y<this._image.height-1}get width(){return this._image.width}get height(){return this._image.width}get length(){return this._image.numChannels}get numChannels(){return this._image.numChannels}get maxChannelValue(){return this._image.maxChannelValue}get maxIndexValue(){return this._image.maxIndexValue}get format(){return 8}get isLdrFormat(){return this._image.isLdrFormat}get isHdrFormat(){return this._image.isLdrFormat}get hasPalette(){return this._image.hasPalette}get palette(){}get r(){return this.numChannels>0?this.data[this._index]:0}set r(e){this.numChannels>0&&(this.data[this._index]=Math.trunc(e))}get g(){return this.numChannels>1?this.data[this._index+1]:0}set g(e){this.numChannels>1&&(this.data[this._index+1]=Math.trunc(e))}get b(){return this.numChannels>2?this.data[this._index+2]:0}set b(e){this.numChannels>2&&(this.data[this._index+2]=Math.trunc(e))}get a(){return this.numChannels>3?this.data[this._index+3]:0}set a(e){this.numChannels>3&&(this.data[this._index+3]=Math.trunc(e))}get rNormalized(){return this.r/this.maxChannelValue}set rNormalized(e){this.r=e*this.maxChannelValue}get gNormalized(){return this.g/this.maxChannelValue}set gNormalized(e){this.g=e*this.maxChannelValue}get bNormalized(){return this.b/this.maxChannelValue}set bNormalized(e){this.b=e*this.maxChannelValue}get aNormalized(){return this.a/this.maxChannelValue}set aNormalized(e){this.a=e*this.maxChannelValue}get luminance(){return z.getLuminance(this)}get luminanceNormalized(){return z.getLuminanceNormalized(this)}constructor(e,t,n,i){this._image=i,this._index=n,this._x=e,this._y=t}static imageData(e){return new nt(-1,0,-e.numChannels,e)}static image(e){return new nt(-1,0,-e.numChannels,e.data instanceof Gt?e.data:new Gt(0,0,0))}static from(e){return new nt(e.x,e.y,e._index,e.image)}next(){return this._x++,this._x===this.width&&(this._x=0,this._y++,this._y===this.height)?{done:!0,value:this}:(this._index+=this.numChannels,{done:this._index>=this.image.data.length,value:this})}setPosition(e,t){this._x=e,this._y=t,this._index=this._y*this._image.width*this._image.numChannels+this._x*this._image.numChannels}setPositionNormalized(e,t){return this.setPosition(Math.floor(e*(this.width-1)),Math.floor(t*(this.height-1)))}getChannel(e){return e===4?this.luminance:e<this.numChannels?this.data[this._index+e]:0}getChannelNormalized(e){return this.getChannel(e)/this.maxChannelValue}setChannel(e,t){e<this.numChannels&&(this.data[this._index+e]=Math.trunc(t))}set(e){this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a}setRgb(e,t,n){this.numChannels>0&&(this.data[this._index]=Math.trunc(e),this.numChannels>1&&(this.data[this._index+1]=Math.trunc(t),this.numChannels>2&&(this.data[this._index+2]=Math.trunc(n))))}setRgba(e,t,n,i){this.numChannels>0&&(this.data[this._index]=Math.trunc(e),this.numChannels>1&&(this.data[this._index+1]=Math.trunc(t),this.numChannels>2&&(this.data[this._index+2]=Math.trunc(n),this.numChannels>3&&(this.data[this._index+3]=Math.trunc(i)))))}toArray(){return U.generate(this.length,e=>this.getChannel(e))}equals(e){return e instanceof nt?U.equals(this.toArray(),e.toArray()):Array.isArray(e)?U.equals(this.toArray(),e):!1}clone(){return nt.from(this)}convert(e){return z.convertColor({from:this,format:e.format,numChannels:e.numChannels,alpha:e.alpha})}toString(){return`${this.constructor.name} (${this.toArray()})`}[Symbol.iterator](){return this}}});var Gt,Mi=A(()=>{"use strict";De();ui();H();dr();$e();Gt=class{get width(){return this._width}get height(){return this._height}get data(){return this._data}get numChannels(){return this._numChannels}get format(){return 8}get formatType(){return 1}get buffer(){return this._data.buffer}get rowStride(){return this._width*this._numChannels*4}get iterator(){return nt.imageData(this)}get byteLength(){return this._data.byteLength}get length(){return this._data.byteLength}get maxChannelValue(){return 2147483647}get maxIndexValue(){return 2147483647}get hasPalette(){return this.palette!==void 0}get palette(){}get isHdrFormat(){return!0}get isLdrFormat(){return!this.isHdrFormat}get bitsPerChannel(){return 32}constructor(e,t,n,i){this._width=e,this._height=t,this._numChannels=n,this._data=i!=null?i:new Int32Array(this._width*this._height*this._numChannels)}static from(e,t=!1){let n=t?new Int32Array(e.data.length):e.data.slice();return new Gt(e.width,e.height,e._numChannels,n)}getRange(e,t,n,i){return new le(nt.imageData(this),e,t,n,i)}getColor(e,t,n,i){return i===void 0?ht.rgb(Math.trunc(e),Math.trunc(t),Math.trunc(n)):ht.rgba(Math.trunc(e),Math.trunc(t),Math.trunc(n),Math.trunc(i))}getPixel(e,t,n){let i=n;return(i===void 0||!(i instanceof nt)||i.image!==this)&&(i=nt.imageData(this)),i.setPosition(e,t),i}setPixel(e,t,n){this.setPixelRgba(e,t,n.r,n.g,n.b,n.a)}setPixelR(e,t,n){let i=t*this.width*this.numChannels+e*this.numChannels;this.data[i]=Math.trunc(n)}setPixelRgb(e,t,n,i,r){let a=t*this.width*this.numChannels+e*this._numChannels;this._data[a]=Math.trunc(n),this._numChannels>1&&(this._data[a+1]=Math.trunc(i),this._numChannels>2&&(this._data[a+2]=Math.trunc(r)))}setPixelRgba(e,t,n,i,r,a){let s=t*this.width*this.numChannels+e*this._numChannels;this._data[s]=Math.trunc(n),this._numChannels>1&&(this._data[s+1]=Math.trunc(i),this._numChannels>2&&(this._data[s+2]=Math.trunc(r),this._numChannels>3&&(this._data[s+3]=Math.trunc(a))))}setPixelRgbSafe(e,t,n,i,r){e<0||e>=this.width||t<0||t>=this.height||this.setPixelRgb(e,t,n,i,r)}setPixelRgbaSafe(e,t,n,i,r,a){e<0||e>=this.width||t<0||t>=this.height||this.setPixelRgba(e,t,n,i,r,a)}clear(e){}clone(e=!1){return Gt.from(this,e)}toUint8Array(){return new Uint8Array(this.buffer)}getBytes(e){if(e===void 0)return this.toUint8Array();if(this.numChannels===4){if(e===2||e===3||e===1){let t=this.clone();if(e===2)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=s,n.g=a,n.b=r,n.a=i}else if(e===3)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=s,n.g=i,n.b=r,n.a=a}else if(e===1)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=a,n.g=r,n.b=i,n.a=s}return t.toUint8Array()}}else if(this.numChannels===3&&e===5){let t=this.clone();for(let n of t){let i=n.r;n.r=n.b,n.b=i}return t.toUint8Array()}return this.toUint8Array()}toString(){return`${this.constructor.name} (w: ${this._width}, h: ${this._height}, ch: ${this._numChannels})`}[Symbol.iterator](){return nt.imageData(this)}}});var it,pr=A(()=>{"use strict";oe();ae();H();G();Ai();it=class{get image(){return this._image}get x(){return this._x}get y(){return this._y}get xNormalized(){return this.width>1?this._x/(this.width-1):0}get yNormalized(){return this.height>1?this._y/(this.height-1):0}get index(){return this.r}set index(e){this.r=e}get data(){return this._image.data}get isValid(){return this._x>=0&&this._x<this._image.width-1&&this._y>=0&&this._y<this._image.height-1}get width(){return this._image.width}get height(){return this._image.width}get length(){return this._image.numChannels}get numChannels(){return this._image.numChannels}get maxChannelValue(){return this._image.maxChannelValue}get maxIndexValue(){return this._image.maxIndexValue}get format(){return 6}get isLdrFormat(){return this._image.isLdrFormat}get isHdrFormat(){return this._image.isLdrFormat}get hasPalette(){return this._image.hasPalette}get palette(){}get r(){return this.numChannels>0?this.data[this._index]:0}set r(e){this.numChannels>0&&(this.data[this._index]=Math.trunc(e))}get g(){return this.numChannels>1?this.data[this._index+1]:0}set g(e){this.numChannels>1&&(this.data[this._index+1]=Math.trunc(e))}get b(){return this.numChannels>2?this.data[this._index+2]:0}set b(e){this.numChannels>2&&(this.data[this._index+2]=Math.trunc(e))}get a(){return this.numChannels>3?this.data[this._index+3]:0}set a(e){this.numChannels>3&&(this.data[this._index+3]=Math.trunc(e))}get rNormalized(){return this.r/this.maxChannelValue}set rNormalized(e){this.r=e*this.maxChannelValue}get gNormalized(){return this.g/this.maxChannelValue}set gNormalized(e){this.g=e*this.maxChannelValue}get bNormalized(){return this.b/this.maxChannelValue}set bNormalized(e){this.b=e*this.maxChannelValue}get aNormalized(){return this.a/this.maxChannelValue}set aNormalized(e){this.a=e*this.maxChannelValue}get luminance(){return z.getLuminance(this)}get luminanceNormalized(){return z.getLuminanceNormalized(this)}constructor(e,t,n,i){this._image=i,this._index=n,this._x=e,this._y=t}static imageData(e){return new it(-1,0,-e.numChannels,e)}static image(e){return new it(-1,0,-e.numChannels,e.data instanceof $t?e.data:new $t(0,0,0))}static from(e){return new it(e.x,e.y,e._index,e.image)}next(){return this._x++,this._x===this.width&&(this._x=0,this._y++,this._y===this.height)?{done:!0,value:this}:(this._index+=this.numChannels,{done:this._index>=this.image.data.length,value:this})}setPosition(e,t){this._x=e,this._y=t,this._index=this._y*this._image.width*this._image.numChannels+this._x*this._image.numChannels}setPositionNormalized(e,t){return this.setPosition(Math.floor(e*(this.width-1)),Math.floor(t*(this.height-1)))}getChannel(e){return e===4?this.luminance:e<this.numChannels?this.data[this._index+e]:0}getChannelNormalized(e){return this.getChannel(e)/this.maxChannelValue}setChannel(e,t){e<this.numChannels&&(this.data[this._index+e]=Math.trunc(t))}set(e){this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a}setRgb(e,t,n){this.numChannels>0&&(this.data[this._index]=Math.trunc(e),this.numChannels>1&&(this.data[this._index+1]=Math.trunc(t),this.numChannels>2&&(this.data[this._index+2]=Math.trunc(n))))}setRgba(e,t,n,i){this.numChannels>0&&(this.data[this._index]=Math.trunc(e),this.numChannels>1&&(this.data[this._index+1]=Math.trunc(t),this.numChannels>2&&(this.data[this._index+2]=Math.trunc(n),this.numChannels>3&&(this.data[this._index+3]=Math.trunc(i)))))}toArray(){return U.generate(this.length,e=>this.getChannel(e))}equals(e){return e instanceof it?U.equals(this.toArray(),e.toArray()):Array.isArray(e)?U.equals(this.toArray(),e):!1}clone(){return it.from(this)}convert(e){return z.convertColor({from:this,format:e.format,numChannels:e.numChannels,alpha:e.alpha})}toString(){return`${this.constructor.name} (${this.toArray()})`}[Symbol.iterator](){return this}}});var $t,Ai=A(()=>{"use strict";De();oi();H();pr();$e();$t=class{get width(){return this._width}get height(){return this._height}get data(){return this._data}get numChannels(){return this._numChannels}get format(){return 6}get formatType(){return 1}get buffer(){return this._data.buffer}get rowStride(){return this._width*this._numChannels}get iterator(){return it.imageData(this)}get byteLength(){return this._data.byteLength}get length(){return this._data.byteLength}get maxChannelValue(){return 127}get maxIndexValue(){return 127}get hasPalette(){return this.palette!==void 0}get palette(){}get isHdrFormat(){return!0}get isLdrFormat(){return!this.isHdrFormat}get bitsPerChannel(){return 8}constructor(e,t,n,i){this._width=e,this._height=t,this._numChannels=n,this._data=i!=null?i:new Int8Array(this._width*this._height*this._numChannels)}static from(e,t=!1){let n=t?new Int8Array(e.data.length):e.data.slice();return new $t(e.width,e.height,e._numChannels,n)}getRange(e,t,n,i){return new le(it.imageData(this),e,t,n,i)}getColor(e,t,n,i){return i===void 0?ct.rgb(Math.trunc(e),Math.trunc(t),Math.trunc(n)):ct.rgba(Math.trunc(e),Math.trunc(t),Math.trunc(n),Math.trunc(i))}getPixel(e,t,n){let i=n;return(i===void 0||!(i instanceof it)||i.image!==this)&&(i=it.imageData(this)),i.setPosition(e,t),i}setPixel(e,t,n){this.setPixelRgba(e,t,n.r,n.g,n.b,n.a)}setPixelR(e,t,n){let i=t*this.rowStride+e*this.numChannels;this.data[i]=Math.trunc(n)}setPixelRgb(e,t,n,i,r){let a=t*this.rowStride+e*this._numChannels;this._data[a]=Math.trunc(n),this._numChannels>1&&(this._data[a+1]=Math.trunc(i),this._numChannels>2&&(this._data[a+2]=Math.trunc(r)))}setPixelRgba(e,t,n,i,r,a){let s=t*this.rowStride+e*this._numChannels;this._data[s]=Math.trunc(n),this._numChannels>1&&(this._data[s+1]=Math.trunc(i),this._numChannels>2&&(this._data[s+2]=Math.trunc(r),this._numChannels>3&&(this._data[s+3]=Math.trunc(a))))}setPixelRgbSafe(e,t,n,i,r){e<0||e>=this.width||t<0||t>=this.height||this.setPixelRgb(e,t,n,i,r)}setPixelRgbaSafe(e,t,n,i,r,a){e<0||e>=this.width||t<0||t>=this.height||this.setPixelRgba(e,t,n,i,r,a)}clear(e){}clone(e=!1){return $t.from(this,e)}toUint8Array(){return new Uint8Array(this.buffer)}getBytes(e){if(e===void 0)return this.toUint8Array();if(this.numChannels===4){if(e===2||e===3||e===1){let t=this.clone();if(e===2)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=s,n.g=a,n.b=r,n.a=i}else if(e===3)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=s,n.g=i,n.b=r,n.a=a}else if(e===1)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=a,n.g=r,n.b=i,n.a=s}return t.toUint8Array()}}else if(this.numChannels===3&&e===5){let t=this.clone();for(let n of t){let i=n.r;n.r=n.b,n.b=i}return t.toUint8Array()}return this.toUint8Array()}toString(){return`${this.constructor.name} (w: ${this._width}, h: ${this._height}, ch: ${this._numChannels})`}[Symbol.iterator](){return it.imageData(this)}}});var ke,gr=A(()=>{"use strict";oe();ae();H();G();_e();Fi();ke=class{get image(){return this._image}get x(){return this._x}get y(){return this._y}get xNormalized(){return this.width>1?this._x/(this.width-1):0}get yNormalized(){return this.height>1?this._y/(this.height-1):0}get index(){return this.getChannelInternal(0)}set index(e){this.setChannel(0,e)}get data(){return this._image.data}get isValid(){return this._x>=0&&this._x<this._image.width-1&&this._y>=0&&this._y<this._image.height-1}get width(){return this._image.width}get height(){return this._image.width}get length(){var e,t;return(t=(e=this.palette)==null?void 0:e.numChannels)!=null?t:this._image.numChannels}get numChannels(){return this._image.numChannels}get maxChannelValue(){return this._image.maxChannelValue}get maxIndexValue(){return this._image.maxIndexValue}get format(){return 0}get isLdrFormat(){return this._image.isLdrFormat}get isHdrFormat(){return this._image.isLdrFormat}get hasPalette(){return this._image.hasPalette}get palette(){return this._image.palette}get r(){return this.getChannel(0)}set r(e){this.setChannel(0,e)}get g(){return this.getChannel(1)}set g(e){this.setChannel(1,e)}get b(){return this.getChannel(2)}set b(e){this.setChannel(2,e)}get a(){return this.getChannel(3)}set a(e){this.setChannel(3,e)}get rNormalized(){return this.r/this.maxChannelValue}set rNormalized(e){this.r=e*this.maxChannelValue}get gNormalized(){return this.g/this.maxChannelValue}set gNormalized(e){this.g=e*this.maxChannelValue}get bNormalized(){return this.b/this.maxChannelValue}set bNormalized(e){this.b=e*this.maxChannelValue}get aNormalized(){return this.a/this.maxChannelValue}set aNormalized(e){this.a=e*this.maxChannelValue}get luminance(){return z.getLuminance(this)}get luminanceNormalized(){return z.getLuminanceNormalized(this)}get imageLength(){return this._image.length}constructor(e,t,n,i,r,a){this._image=a,this._index=n,this._bitIndex=i,this._rowOffset=r,this._x=e,this._y=t}static imageData(e){return new ke(-1,0,0,-1,0,e)}static image(e){return new ke(-1,0,0,-1,0,e.data instanceof Ut?e.data:new Ut(0,0,0))}static from(e){return new ke(e.x,e.y,e._index,e._bitIndex,e._rowOffset,e.image)}getChannelInternal(e){let t=this._index,n=7-(this._bitIndex+e);return n<0&&(n+=8,t++),t>=this._image.data.length?0:this._image.data[t]>>n&1}next(){if(this._x++,this._x===this.width)return this._x=0,this._y++,this._bitIndex=0,this._index++,this._rowOffset+=this.image.rowStride,{done:this._y>=this.height,value:this};let e=this.numChannels;if(this.palette!==void 0||e===1)this._bitIndex++,this._bitIndex>7&&(this._bitIndex=0,this._index++);else{let t=this.image.numChannels;this._bitIndex=this._x*t&7,this._index=this._rowOffset+(this._x*t>>3)}return{done:this._index>=this.imageLength,value:this}}setPosition(e,t){this._x=e,this._y=t;let n=this._image.numChannels;this._rowOffset=this._y*this._image.rowStride,this._index=this._rowOffset+(this._x*n>>3),this._bitIndex=this._x*n&7}setPositionNormalized(e,t){return this.setPosition(Math.floor(e*(this.width-1)),Math.floor(t*(this.height-1)))}getChannel(e){return this.palette!==void 0?this.palette.get(this.getChannelInternal(0),e):e===4?this.luminance:e<this.numChannels?this.getChannelInternal(e):0}getChannelNormalized(e){return this.getChannel(e)/this.maxChannelValue}setChannel(e,t){if(e>=this.numChannels)return;let n=this._index,i=7-(this._bitIndex+e);i<0&&(i+=8,n++);let r=this.data[n],a=_.clampInt(t,0,1),u=[254,253,251,247,239,223,191,127][i];r=r&u|a<<i,this.data[n]=r}set(e){this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a}setRgb(e,t,n){let i=this.image.numChannels;i>0&&(this.setChannel(0,e),i>1&&(this.setChannel(1,t),i>2&&this.setChannel(2,n)))}setRgba(e,t,n,i){let r=this.numChannels;r>0&&(this.setChannel(0,e),r>1&&(this.setChannel(1,t),r>2&&(this.setChannel(2,n),r>3&&this.setChannel(3,i))))}toArray(){return U.generate(this.length,e=>this.getChannel(e))}equals(e){return e instanceof ke?U.equals(this.toArray(),e.toArray()):Array.isArray(e)?U.equals(this.toArray(),e):!1}clone(){return ke.from(this)}convert(e){return z.convertColor({from:this,format:e.format,numChannels:e.numChannels,alpha:e.alpha})}toString(){return`${this.constructor.name} (${this.toArray()})`}[Symbol.iterator](){return this}}});var Ut,Fi=A(()=>{"use strict";De();H();gr();$e();li();Ut=class{get width(){return this._width}get height(){return this._height}get data(){return this._data}get numChannels(){return this._numChannels}get format(){return 0}get formatType(){return 0}get buffer(){return this._data.buffer}get rowStride(){return this._rowStride}get iterator(){return ke.imageData(this)}get byteLength(){return this._data.byteLength}get length(){return this._data.byteLength}get maxChannelValue(){var e,t;return(t=(e=this._palette)==null?void 0:e.maxChannelValue)!=null?t:1}get maxIndexValue(){return 1}get hasPalette(){return this.palette!==void 0}get palette(){return this._palette}get isHdrFormat(){return!1}get isLdrFormat(){return!this.isHdrFormat}get bitsPerChannel(){return 1}constructor(e,t,n,i){this._width=e,this._height=t,this._numChannels=n,this._rowStride=Math.ceil(this._width*this._numChannels/8),this._palette=void 0,this._data=i!=null?i:new Uint8Array(Math.max(this._rowStride*this._height,1))}static palette(e,t,n){let i=Math.ceil(e/8),r=new Uint8Array(Math.max(i*t,1)),a=new Ut(e,t,1,r);return a._rowStride=i,a._palette=n,a}static from(e,t=!1){var r;let n=t?new Uint8Array(e.data.length):e.data.slice(),i=new Ut(e.width,e.height,e._numChannels,n);return i._rowStride=e.rowStride,i._palette=(r=e.palette)==null?void 0:r.clone(),i}getRange(e,t,n,i){return new le(ke.imageData(this),e,t,n,i)}getColor(e,t,n,i){return i===void 0?bt.rgb(Math.trunc(e),Math.trunc(t),Math.trunc(n)):bt.rgba(Math.trunc(e),Math.trunc(t),Math.trunc(n),Math.trunc(i))}getPixel(e,t,n){let i=n;return(i===void 0||!(i instanceof ke)||i.image!==this)&&(i=ke.imageData(this)),i.setPosition(e,t),i}setPixel(e,t,n){this.setPixelRgba(e,t,n.r,n.g,n.b,n.a)}setPixelR(e,t,n){var i;this._numChannels<1||((i=this.pixel)!=null||(this.pixel=ke.imageData(this)),this.pixel.setPosition(e,t),this.pixel.index=n)}setPixelRgb(e,t,n,i,r){var a;this._numChannels<1||((a=this.pixel)!=null||(this.pixel=ke.imageData(this)),this.pixel.setPosition(e,t),this.pixel.setRgb(n,i,r))}setPixelRgba(e,t,n,i,r,a){var s;this._numChannels<1||((s=this.pixel)!=null||(this.pixel=ke.imageData(this)),this.pixel.setPosition(e,t),this.pixel.setRgba(n,i,r,a))}setPixelRgbSafe(e,t,n,i,r){e<0||e>=this.width||t<0||t>=this.height||this.setPixelRgb(e,t,n,i,r)}setPixelRgbaSafe(e,t,n,i,r,a){e<0||e>=this.width||t<0||t>=this.height||this.setPixelRgba(e,t,n,i,r,a)}clear(e){}clone(e=!1){return Ut.from(this,e)}toUint8Array(){return new Uint8Array(this.buffer)}getBytes(e){if(e===void 0)return this.toUint8Array();if(this.numChannels===4){if(e===2||e===3||e===1){let t=this.clone();if(e===2)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=s,n.g=a,n.b=r,n.a=i}else if(e===3)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=s,n.g=i,n.b=r,n.a=a}else if(e===1)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=a,n.g=r,n.b=i,n.a=s}return t.toUint8Array()}}else if(this.numChannels===3&&e===5){let t=this.clone();for(let n of t){let i=n.r;n.r=n.b,n.b=i}return t.toUint8Array()}return this.toUint8Array()}toString(){return`${this.constructor.name} (w: ${this._width}, h: ${this._height}, ch: ${this._numChannels})`}[Symbol.iterator](){return ke.imageData(this)}}});var rt,xr=A(()=>{"use strict";oe();ae();H();G();Bi();rt=class{get image(){return this._image}get x(){return this._x}get y(){return this._y}get xNormalized(){return this.width>1?this._x/(this.width-1):0}get yNormalized(){return this.height>1?this._y/(this.height-1):0}get index(){return this.r}set index(e){this.r=e}get data(){return this._image.data}get isValid(){return this._x>=0&&this._x<this._image.width-1&&this._y>=0&&this._y<this._image.height-1}get width(){return this._image.width}get height(){return this._image.width}get length(){return this._image.numChannels}get numChannels(){return this._image.numChannels}get maxChannelValue(){return this._image.maxChannelValue}get maxIndexValue(){return this._image.maxIndexValue}get format(){return 4}get isLdrFormat(){return this._image.isLdrFormat}get isHdrFormat(){return this._image.isLdrFormat}get hasPalette(){return this._image.hasPalette}get palette(){}get r(){return this.numChannels>0?this.data[this._index]:0}set r(e){this.numChannels>0&&(this.data[this._index]=Math.trunc(e))}get g(){return this.numChannels>1?this.data[this._index+1]:0}set g(e){this.numChannels>1&&(this.data[this._index+1]=Math.trunc(e))}get b(){return this.numChannels>2?this.data[this._index+2]:0}set b(e){this.numChannels>2&&(this.data[this._index+2]=Math.trunc(e))}get a(){return this.numChannels>3?this.data[this._index+3]:0}set a(e){this.numChannels>3&&(this.data[this._index+3]=Math.trunc(e))}get rNormalized(){return this.r/this.maxChannelValue}set rNormalized(e){this.r=e*this.maxChannelValue}get gNormalized(){return this.g/this.maxChannelValue}set gNormalized(e){this.g=e*this.maxChannelValue}get bNormalized(){return this.b/this.maxChannelValue}set bNormalized(e){this.b=e*this.maxChannelValue}get aNormalized(){return this.a/this.maxChannelValue}set aNormalized(e){this.a=e*this.maxChannelValue}get luminance(){return z.getLuminance(this)}get luminanceNormalized(){return z.getLuminanceNormalized(this)}constructor(e,t,n,i){this._image=i,this._index=n,this._x=e,this._y=t}static imageData(e){return new rt(-1,0,-e.numChannels,e)}static image(e){return new rt(-1,0,-e.numChannels,e.data instanceof Wt?e.data:new Wt(0,0,0))}static from(e){return new rt(e.x,e.y,e._index,e.image)}next(){return this._x++,this._x===this.width&&(this._x=0,this._y++,this._y===this.height)?{done:!0,value:this}:(this._index+=this.numChannels,{done:this._index>=this.image.data.length,value:this})}setPosition(e,t){this._x=e,this._y=t,this._index=this._y*this._image.width*this._image.numChannels+this._x*this._image.numChannels}setPositionNormalized(e,t){return this.setPosition(Math.floor(e*(this.width-1)),Math.floor(t*(this.height-1)))}getChannel(e){return e===4?this.luminance:e<this.numChannels?this.data[this._index+e]:0}getChannelNormalized(e){return this.getChannel(e)/this.maxChannelValue}setChannel(e,t){e<this.numChannels&&(this.data[this._index+e]=Math.trunc(t))}set(e){this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a}setRgb(e,t,n){this.numChannels>0&&(this.data[this._index]=Math.trunc(e),this.numChannels>1&&(this.data[this._index+1]=Math.trunc(t),this.numChannels>2&&(this.data[this._index+2]=Math.trunc(n))))}setRgba(e,t,n,i){this.numChannels>0&&(this.data[this._index]=Math.trunc(e),this.numChannels>1&&(this.data[this._index+1]=Math.trunc(t),this.numChannels>2&&(this.data[this._index+2]=Math.trunc(n),this.numChannels>3&&(this.data[this._index+3]=Math.trunc(i)))))}equals(e){return e instanceof rt?U.equals(this.toArray(),e.toArray()):Array.isArray(e)?U.equals(this.toArray(),e):!1}toArray(){return U.generate(this.length,e=>this.getChannel(e))}clone(){return rt.from(this)}convert(e){return z.convertColor({from:this,format:e.format,numChannels:e.numChannels,alpha:e.alpha})}toString(){return`${this.constructor.name} (${this.toArray()})`}[Symbol.iterator](){return this}}});var Wt,Bi=A(()=>{"use strict";De();H();xr();$e();mi();Wt=class{get width(){return this._width}get height(){return this._height}get data(){return this._data}get numChannels(){return this._numChannels}get format(){return 4}get formatType(){return 0}get buffer(){return this._data.buffer}get rowStride(){return this._width*this._numChannels*2}get iterator(){return rt.imageData(this)}get byteLength(){return this._data.byteLength}get length(){return this._data.byteLength}get maxChannelValue(){return 65535}get maxIndexValue(){return 65535}get hasPalette(){return this.palette!==void 0}get palette(){}get isHdrFormat(){return!0}get isLdrFormat(){return!this.isHdrFormat}get bitsPerChannel(){return 16}constructor(e,t,n,i){this._width=e,this._height=t,this._numChannels=n,this._data=i!=null?i:new Uint16Array(this._width*this._height*this._numChannels)}static from(e,t=!1){let n=t?new Uint16Array(e.data.length):e.data.slice();return new Wt(e.width,e.height,e._numChannels,n)}getRange(e,t,n,i){return new le(rt.imageData(this),e,t,n,i)}getColor(e,t,n,i){return i===void 0?ft.rgb(Math.trunc(e),Math.trunc(t),Math.trunc(n)):ft.rgba(Math.trunc(e),Math.trunc(t),Math.trunc(n),Math.trunc(i))}getPixel(e,t,n){let i=n;return(i===void 0||!(i instanceof rt)||i.image!==this)&&(i=rt.imageData(this)),i.setPosition(e,t),i}setPixel(e,t,n){this.setPixelRgba(e,t,n.r,n.g,n.b,n.a)}setPixelR(e,t,n){let i=t*this._width*this._numChannels+e*this.numChannels;this.data[i]=Math.trunc(n)}setPixelRgb(e,t,n,i,r){let a=t*this._width*this._numChannels+e*this._numChannels;this._data[a]=Math.trunc(n),this._numChannels>1&&(this._data[a+1]=Math.trunc(i),this._numChannels>2&&(this._data[a+2]=Math.trunc(r)))}setPixelRgba(e,t,n,i,r,a){let s=t*this._width*this._numChannels+e*this._numChannels;this._data[s]=Math.trunc(n),this._numChannels>1&&(this._data[s+1]=Math.trunc(i),this._numChannels>2&&(this._data[s+2]=Math.trunc(r),this._numChannels>3&&(this._data[s+3]=Math.trunc(a))))}setPixelRgbSafe(e,t,n,i,r){e<0||e>=this.width||t<0||t>=this.height||this.setPixelRgb(e,t,n,i,r)}setPixelRgbaSafe(e,t,n,i,r,a){e<0||e>=this.width||t<0||t>=this.height||this.setPixelRgba(e,t,n,i,r,a)}clear(e){}clone(e=!1){return Wt.from(this,e)}toUint8Array(){return new Uint8Array(this.buffer)}getBytes(e){if(e===void 0)return this.toUint8Array();if(this.numChannels===4){if(e===2||e===3||e===1){let t=this.clone();if(e===2)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=s,n.g=a,n.b=r,n.a=i}else if(e===3)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=s,n.g=i,n.b=r,n.a=a}else if(e===1)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=a,n.g=r,n.b=i,n.a=s}return t.toUint8Array()}}else if(this.numChannels===3&&e===5){let t=this.clone();for(let n of t){let i=n.r;n.r=n.b,n.b=i}return t.toUint8Array()}return this.toUint8Array()}toString(){return`${this.constructor.name} (w: ${this._width}, h: ${this._height}, ch: ${this._numChannels})`}[Symbol.iterator](){return rt.imageData(this)}}});var ze,_r=A(()=>{"use strict";oe();ae();H();G();_e();Ui();ze=class{get image(){return this._image}get x(){return this._x}get y(){return this._y}get xNormalized(){return this.width>1?this._x/(this.width-1):0}get yNormalized(){return this.height>1?this._y/(this.height-1):0}get index(){return this.getChannelInternal(0)}set index(e){this.setChannel(0,e)}get data(){return this._image.data}get isValid(){return this._x>=0&&this._x<this._image.width-1&&this._y>=0&&this._y<this._image.height-1}get width(){return this._image.width}get height(){return this._image.width}get length(){var e,t;return(t=(e=this.palette)==null?void 0:e.numChannels)!=null?t:this._image.numChannels}get numChannels(){return this._image.numChannels}get maxChannelValue(){return this._image.maxChannelValue}get maxIndexValue(){return this._image.maxIndexValue}get format(){return 1}get isLdrFormat(){return this._image.isLdrFormat}get isHdrFormat(){return this._image.isLdrFormat}get hasPalette(){return this._image.hasPalette}get palette(){return this._image.palette}get r(){return this.getChannel(0)}set r(e){this.setChannel(0,e)}get g(){return this.getChannel(1)}set g(e){this.setChannel(1,e)}get b(){return this.getChannel(2)}set b(e){this.setChannel(2,e)}get a(){return this.getChannel(3)}set a(e){this.setChannel(3,e)}get rNormalized(){return this.r/this.maxChannelValue}set rNormalized(e){this.r=e*this.maxChannelValue}get gNormalized(){return this.g/this.maxChannelValue}set gNormalized(e){this.g=e*this.maxChannelValue}get bNormalized(){return this.b/this.maxChannelValue}set bNormalized(e){this.b=e*this.maxChannelValue}get aNormalized(){return this.a/this.maxChannelValue}set aNormalized(e){this.a=e*this.maxChannelValue}get luminance(){return z.getLuminance(this)}get luminanceNormalized(){return z.getLuminanceNormalized(this)}get bitsPerPixel(){return this._image.palette!==void 0?2:this._image.numChannels<<1}constructor(e,t,n,i,r,a){this._image=a,this._index=n,this._bitIndex=i,this._rowOffset=r,this._x=e,this._y=t}static imageData(e){return new ze(-1,0,0,-2,0,e)}static image(e){return new ze(-1,0,0,-2,0,e.data instanceof St?e.data:new St(0,0,0))}static from(e){return new ze(e.x,e.y,e._index,e._bitIndex,e._rowOffset,e.image)}getChannelInternal(e){let t=this._index,n=6-(this._bitIndex+(e<<1));return n<0&&(n+=8,t++),this._image.data[t]>>n&3}next(){if(this._x++,this._x===this.width)return this._x=0,this._y++,this._bitIndex=0,this._index++,this._rowOffset+=this.image.rowStride,{done:this._y>=this.height,value:this};let e=this.numChannels;if(this.palette!==void 0||e===1)this._bitIndex+=2,this._bitIndex>7&&(this._bitIndex=0,this._index++);else{let t=this.bitsPerPixel;this._bitIndex=this._x*t&7,this._index=this._rowOffset+(this._x*t>>3)}return{done:this._index>=this.image.data.length,value:this}}setPosition(e,t){this._x=e,this._y=t;let n=this.bitsPerPixel;this._rowOffset=this._y*this._image.rowStride,this._index=this._rowOffset+(this._x*n>>3),this._bitIndex=this._x*n&7}setPositionNormalized(e,t){return this.setPosition(Math.floor(e*(this.width-1)),Math.floor(t*(this.height-1)))}getChannel(e){return this.palette!==void 0?this.palette.get(this.getChannelInternal(0),e):e===4?this.luminance:e<this.numChannels?this.getChannelInternal(e):0}getChannelNormalized(e){return this.getChannel(e)/this.maxChannelValue}setChannel(e,t){if(e>=this.image.numChannels)return;let n=this._index,i=6-(this._bitIndex+(e<<1));i<0&&(i+=8,n++);let r=this.data[n],a=_.clampInt(t,0,3),u=[252,243,207,63][i>>1];r=r&u|a<<i,this.data[n]=r}set(e){this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a}setRgb(e,t,n){let i=this.image.numChannels;i>0&&(this.setChannel(0,e),i>1&&(this.setChannel(1,t),i>2&&this.setChannel(2,n)))}setRgba(e,t,n,i){let r=this.image.numChannels;r>0&&(this.setChannel(0,e),r>1&&(this.setChannel(1,t),r>2&&(this.setChannel(2,n),r>3&&this.setChannel(3,i))))}equals(e){return e instanceof ze?U.equals(this.toArray(),e.toArray()):Array.isArray(e)?U.equals(this.toArray(),e):!1}toArray(){return U.generate(this.length,e=>this.getChannel(e))}clone(){return ze.from(this)}convert(e){return z.convertColor({from:this,format:e.format,numChannels:e.numChannels,alpha:e.alpha})}toString(){return`${this.constructor.name} (${this.toArray()})`}[Symbol.iterator](){return this}}});var St,Ui=A(()=>{"use strict";De();H();_r();$e();hi();St=class{get width(){return this._width}get height(){return this._height}get data(){return this._data}get numChannels(){return this._numChannels}get format(){return 1}get formatType(){return 0}get buffer(){return this._data.buffer}get rowStride(){return this._rowStride}get iterator(){return ze.imageData(this)}get byteLength(){return this._data.byteLength}get length(){return this._data.byteLength}get maxChannelValue(){var e,t;return(t=(e=this._palette)==null?void 0:e.maxChannelValue)!=null?t:3}get maxIndexValue(){return 1}get hasPalette(){return this.palette!==void 0}get palette(){return this._palette}get isHdrFormat(){return!1}get isLdrFormat(){return!this.isHdrFormat}get bitsPerChannel(){return 2}constructor(e,t,n,i){this._width=e,this._height=t,this._numChannels=n,this._rowStride=Math.ceil(this._width*(this._numChannels<<1)/8),this._palette=void 0,this._data=i!=null?i:new Uint8Array(Math.max(this._rowStride*this._height,1))}static palette(e,t,n){let i=Math.ceil(e/4),r=new Uint8Array(Math.max(i*t,1)),a=new St(e,t,1,r);return a._rowStride=i,a._palette=n,a}static from(e,t=!1){var r;let n=t?new Uint8Array(e.data.length):e.data.slice(),i=new St(e.width,e.height,e._numChannels,n);return i._rowStride=e.rowStride,i._palette=(r=e.palette)==null?void 0:r.clone(),i}getRange(e,t,n,i){return new le(ze.imageData(this),e,t,n,i)}getColor(e,t,n,i){return i===void 0?dt.rgb(Math.trunc(e),Math.trunc(t),Math.trunc(n)):dt.rgba(Math.trunc(e),Math.trunc(t),Math.trunc(n),Math.trunc(i))}getPixel(e,t,n){let i=n;return(i===void 0||!(i instanceof ze)||i.image!==this)&&(i=ze.imageData(this)),i.setPosition(e,t),i}setPixel(e,t,n){this.setPixelRgba(e,t,n.r,n.g,n.b,n.a)}setPixelR(e,t,n){var i;this._numChannels<1||((i=this._pixel)!=null||(this._pixel=ze.imageData(this)),this._pixel.setPosition(e,t),this._pixel.index=n)}setPixelRgb(e,t,n,i,r){var a;this._numChannels<1||((a=this._pixel)!=null||(this._pixel=ze.imageData(this)),this._pixel.setPosition(e,t),this._pixel.setRgb(n,i,r))}setPixelRgba(e,t,n,i,r,a){var s;this._numChannels<1||((s=this._pixel)!=null||(this._pixel=ze.imageData(this)),this._pixel.setPosition(e,t),this._pixel.setRgba(n,i,r,a))}setPixelRgbSafe(e,t,n,i,r){e<0||e>=this.width||t<0||t>=this.height||this.setPixelRgb(e,t,n,i,r)}setPixelRgbaSafe(e,t,n,i,r,a){e<0||e>=this.width||t<0||t>=this.height||this.setPixelRgba(e,t,n,i,r,a)}clear(e){}clone(e=!1){return St.from(this,e)}toUint8Array(){return new Uint8Array(this.buffer)}getBytes(e){if(e===void 0)return this.toUint8Array();if(this.numChannels===4){if(e===2||e===3||e===1){let t=this.clone();if(e===2)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=s,n.g=a,n.b=r,n.a=i}else if(e===3)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=s,n.g=i,n.b=r,n.a=a}else if(e===1)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=a,n.g=r,n.b=i,n.a=s}return t.toUint8Array()}}else if(this.numChannels===3&&e===5){let t=this.clone();for(let n of t){let i=n.r;n.r=n.b,n.b=i}return t.toUint8Array()}return this.toUint8Array()}toString(){return`${this.constructor.name} (w: ${this._width}, h: ${this._height}, ch: ${this._numChannels})`}[Symbol.iterator](){return ze.imageData(this)}}});var at,yr=A(()=>{"use strict";oe();ae();H();G();Si();at=class{get image(){return this._image}get x(){return this._x}get y(){return this._y}get xNormalized(){return this.width>1?this._x/(this.width-1):0}get yNormalized(){return this.height>1?this._y/(this.height-1):0}get index(){return this.r}set index(e){this.r=e}get data(){return this._image.data}get isValid(){return this._x>=0&&this._x<this._image.width-1&&this._y>=0&&this._y<this._image.height-1}get width(){return this._image.width}get height(){return this._image.width}get length(){return this._image.numChannels}get numChannels(){return this._image.numChannels}get maxChannelValue(){return this._image.maxChannelValue}get maxIndexValue(){return this._image.maxIndexValue}get format(){return 5}get isLdrFormat(){return this._image.isLdrFormat}get isHdrFormat(){return this._image.isLdrFormat}get hasPalette(){return this._image.hasPalette}get palette(){}get r(){return this.numChannels>0?this.data[this._index]:0}set r(e){this.numChannels>0&&(this.data[this._index]=Math.trunc(e))}get g(){return this.numChannels>1?this.data[this._index+1]:0}set g(e){this.numChannels>1&&(this.data[this._index+1]=Math.trunc(e))}get b(){return this.numChannels>2?this.data[this._index+2]:0}set b(e){this.numChannels>2&&(this.data[this._index+2]=Math.trunc(e))}get a(){return this.numChannels>3?this.data[this._index+3]:0}set a(e){this.numChannels>3&&(this.data[this._index+3]=Math.trunc(e))}get rNormalized(){return this.r/this.maxChannelValue}set rNormalized(e){this.r=e*this.maxChannelValue}get gNormalized(){return this.g/this.maxChannelValue}set gNormalized(e){this.g=e*this.maxChannelValue}get bNormalized(){return this.b/this.maxChannelValue}set bNormalized(e){this.b=e*this.maxChannelValue}get aNormalized(){return this.a/this.maxChannelValue}set aNormalized(e){this.a=e*this.maxChannelValue}get luminance(){return z.getLuminance(this)}get luminanceNormalized(){return z.getLuminanceNormalized(this)}constructor(e,t,n,i){this._image=i,this._index=n,this._x=e,this._y=t}static imageData(e){return new at(-1,0,-e.numChannels,e)}static image(e){return new at(-1,0,-e.numChannels,e.data instanceof Yt?e.data:new Yt(0,0,0))}static from(e){return new at(e.x,e.y,e._index,e.image)}next(){return this._x++,this._x===this.width&&(this._x=0,this._y++,this._y===this.height)?{done:!0,value:this}:(this._index+=this.numChannels,{done:this._index>=this.image.data.length,value:this})}setPosition(e,t){this._x=e,this._y=t,this._index=this._y*this._image.width*this._image.numChannels+this._x*this._image.numChannels}setPositionNormalized(e,t){return this.setPosition(Math.floor(e*(this.width-1)),Math.floor(t*(this.height-1)))}getChannel(e){return e===4?this.luminance:e<this.numChannels?this.data[this._index+e]:0}getChannelNormalized(e){return this.getChannel(e)/this.maxChannelValue}setChannel(e,t){e<this.numChannels&&(this.data[this._index+e]=Math.trunc(t))}set(e){this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a}setRgb(e,t,n){this.numChannels>0&&(this.data[this._index]=Math.trunc(e),this.numChannels>1&&(this.data[this._index+1]=Math.trunc(t),this.numChannels>2&&(this.data[this._index+2]=Math.trunc(n))))}setRgba(e,t,n,i){this.numChannels>0&&(this.data[this._index]=Math.trunc(e),this.numChannels>1&&(this.data[this._index+1]=Math.trunc(t),this.numChannels>2&&(this.data[this._index+2]=Math.trunc(n),this.numChannels>3&&(this.data[this._index+3]=Math.trunc(i)))))}equals(e){return e instanceof at?U.equals(this.toArray(),e.toArray()):Array.isArray(e)?U.equals(this.toArray(),e):!1}toArray(){return U.generate(this.length,e=>this.getChannel(e))}clone(){return at.from(this)}convert(e){return z.convertColor({from:this,format:e.format,numChannels:e.numChannels,alpha:e.alpha})}toString(){return`${this.constructor.name} (${this.toArray()})`}[Symbol.iterator](){return this}}});var Yt,Si=A(()=>{"use strict";De();H();yr();$e();ci();Yt=class{get width(){return this._width}get height(){return this._height}get data(){return this._data}get numChannels(){return this._numChannels}get format(){return 5}get formatType(){return 0}get buffer(){return this._data.buffer}get rowStride(){return this._width*this._numChannels*4}get iterator(){return at.imageData(this)}get byteLength(){return this._data.byteLength}get length(){return this._data.byteLength}get maxChannelValue(){return 4294967295}get maxIndexValue(){return 4294967295}get hasPalette(){return this.palette!==void 0}get palette(){}get isHdrFormat(){return!0}get isLdrFormat(){return!this.isHdrFormat}get bitsPerChannel(){return 32}constructor(e,t,n,i){this._width=e,this._height=t,this._numChannels=n,this._data=i!=null?i:new Uint32Array(this._width*this._height*this._numChannels)}static from(e,t=!1){let n=t?new Uint32Array(e.data.length):e.data.slice();return new Yt(e.width,e.height,e._numChannels,n)}getRange(e,t,n,i){return new le(at.imageData(this),e,t,n,i)}getColor(e,t,n,i){return i===void 0?pt.rgb(Math.trunc(e),Math.trunc(t),Math.trunc(n)):pt.rgba(Math.trunc(e),Math.trunc(t),Math.trunc(n),Math.trunc(i))}getPixel(e,t,n){let i=n;return(i===void 0||!(i instanceof at)||i.image!==this)&&(i=at.imageData(this)),i.setPosition(e,t),i}setPixel(e,t,n){this.setPixelRgba(e,t,n.r,n.g,n.b,n.a)}setPixelR(e,t,n){let i=t*this._width*this._numChannels+e*this.numChannels;this.data[i]=Math.trunc(n)}setPixelRgb(e,t,n,i,r){let a=t*this._width*this._numChannels+e*this._numChannels;this._data[a]=Math.trunc(n),this._numChannels>1&&(this._data[a+1]=Math.trunc(i),this._numChannels>2&&(this._data[a+2]=Math.trunc(r)))}setPixelRgba(e,t,n,i,r,a){let s=t*this._width*this._numChannels+e*this._numChannels;this._data[s]=Math.trunc(n),this._numChannels>1&&(this._data[s+1]=Math.trunc(i),this._numChannels>2&&(this._data[s+2]=Math.trunc(r),this._numChannels>3&&(this._data[s+3]=Math.trunc(a))))}setPixelRgbSafe(e,t,n,i,r){e<0||e>=this.width||t<0||t>=this.height||this.setPixelRgb(e,t,n,i,r)}setPixelRgbaSafe(e,t,n,i,r,a){e<0||e>=this.width||t<0||t>=this.height||this.setPixelRgba(e,t,n,i,r,a)}clear(e){}clone(e=!1){return Yt.from(this,e)}toUint8Array(){return new Uint8Array(this.buffer)}getBytes(e){if(e===void 0)return this.toUint8Array();if(this.numChannels===4){if(e===2||e===3||e===1){let t=this.clone();if(e===2)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=s,n.g=a,n.b=r,n.a=i}else if(e===3)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=s,n.g=i,n.b=r,n.a=a}else if(e===1)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=a,n.g=r,n.b=i,n.a=s}return t.toUint8Array()}}else if(this.numChannels===3&&e===5){let t=this.clone();for(let n of t){let i=n.r;n.r=n.b,n.b=i}return t.toUint8Array()}return this.toUint8Array()}toString(){return`${this.constructor.name} (w: ${this._width}, h: ${this._height}, ch: ${this._numChannels})`}[Symbol.iterator](){return at.imageData(this)}}});var Oe,Cr=A(()=>{"use strict";oe();ae();H();G();_e();ki();Oe=class{get image(){return this._image}get x(){return this._x}get y(){return this._y}get xNormalized(){return this.width>1?this._x/(this.width-1):0}get yNormalized(){return this.height>1?this._y/(this.height-1):0}get index(){return this.getChannelInternal(0)}set index(e){this.setChannel(0,e)}get data(){return this._image.data}get isValid(){return this._x>=0&&this._x<this._image.width-1&&this._y>=0&&this._y<this._image.height-1}get width(){return this._image.width}get height(){return this._image.width}get length(){var e,t;return(t=(e=this.palette)==null?void 0:e.numChannels)!=null?t:this._image.numChannels}get numChannels(){return this._image.numChannels}get maxChannelValue(){return this._image.maxChannelValue}get maxIndexValue(){return this._image.maxIndexValue}get format(){return 2}get isLdrFormat(){return this._image.isLdrFormat}get isHdrFormat(){return this._image.isLdrFormat}get hasPalette(){return this._image.hasPalette}get palette(){return this._image.palette}get r(){return this.getChannel(0)}set r(e){this.setChannel(0,e)}get g(){return this.getChannel(1)}set g(e){this.setChannel(1,e)}get b(){return this.getChannel(2)}set b(e){this.setChannel(2,e)}get a(){return this.getChannel(3)}set a(e){this.setChannel(3,e)}get rNormalized(){return this.r/this.maxChannelValue}set rNormalized(e){this.r=e*this.maxChannelValue}get gNormalized(){return this.g/this.maxChannelValue}set gNormalized(e){this.g=e*this.maxChannelValue}get bNormalized(){return this.b/this.maxChannelValue}set bNormalized(e){this.b=e*this.maxChannelValue}get aNormalized(){return this.a/this.maxChannelValue}set aNormalized(e){this.a=e*this.maxChannelValue}get luminance(){return z.getLuminance(this)}get luminanceNormalized(){return z.getLuminanceNormalized(this)}constructor(e,t,n,i,r){this._image=r,this._index=n,this._bitIndex=i,this._x=e,this._y=t}static imageData(e){return new Oe(-1,0,0,-(e.numChannels<<2),e)}static image(e){return new Oe(-1,0,0,-(e.numChannels<<2),e.data instanceof kt?e.data:new kt(0,0,0))}static from(e){return new Oe(e.x,e.y,e._index,e._bitIndex,e.image)}getChannelInternal(e){let t=this._index,n=4-(this._bitIndex+(e<<2));return n<0&&(n+=8,t++),this._image.data[t]>>n&15}next(){if(this._x++,this._x===this.width)return this._x=0,this._y++,this._bitIndex=0,this._index=this._y*this.image.rowStride,{done:this._y>=this.height,value:this};let e=this.image.numChannels;if(this.palette!==void 0||e===1)this._bitIndex+=4,this._bitIndex>7&&(this._bitIndex=0,this._index++);else{let t=e<<2;for(this._bitIndex+=t;this._bitIndex>7;)this._bitIndex-=8,this._index++}return{done:this._index>=this.image.data.length,value:this}}setPosition(e,t){this._x=e,this._y=t;let n=this.image.numChannels*4,i=this.image.width,r=this.image.rowStride;this._index=n===4?this._y*r+(this._x>>1):n===8?this._y*i+this._x:n===16?this._y*r+(this._x<<1):this._y*r+(this._x*n>>3),this._bitIndex=n>7?this._x*n&4:this._x*n&7}setPositionNormalized(e,t){return this.setPosition(Math.floor(e*(this.width-1)),Math.floor(t*(this.height-1)))}getChannel(e){return this.palette!==void 0?this.palette.get(this.getChannelInternal(0),e):e===4?this.luminance:e<this.numChannels?this.getChannelInternal(e):0}getChannelNormalized(e){return this.getChannel(e)/this.maxChannelValue}setChannel(e,t){if(e>=this.image.numChannels)return;let n=this._index,i=4-(this._bitIndex+(e<<2));i<0&&(i+=8,n++);let r=this.data[n],a=_.clampInt(t,0,15);r=r&(i===4?15:240)|a<<i,this.data[n]=r}set(e){this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a}setRgb(e,t,n){let i=this.image.numChannels;i>0&&(this.setChannel(0,e),i>1&&(this.setChannel(1,t),i>2&&this.setChannel(2,n)))}setRgba(e,t,n,i){let r=this.image.numChannels;r>0&&(this.setChannel(0,e),r>1&&(this.setChannel(1,t),r>2&&(this.setChannel(2,n),r>3&&this.setChannel(3,i))))}equals(e){return e instanceof Oe?U.equals(this.toArray(),e.toArray()):Array.isArray(e)?U.equals(this.toArray(),e):!1}toArray(){return U.generate(this.length,e=>this.getChannel(e))}clone(){return Oe.from(this)}convert(e){return z.convertColor({from:this,format:e.format,numChannels:e.numChannels,alpha:e.alpha})}toString(){return`${this.constructor.name} (${this.toArray()})`}[Symbol.iterator](){return this}}});var kt,ki=A(()=>{"use strict";De();H();Cr();$e();bi();kt=class{get width(){return this._width}get height(){return this._height}get data(){return this._data}get numChannels(){return this._numChannels}get format(){return 2}get formatType(){return 0}get buffer(){return this._data.buffer}get rowStride(){return this._rowStride}get iterator(){return Oe.imageData(this)}get byteLength(){return this._data.byteLength}get length(){return this._data.byteLength}get maxChannelValue(){var e,t;return(t=(e=this._palette)==null?void 0:e.maxChannelValue)!=null?t:15}get maxIndexValue(){return 15}get hasPalette(){return this.palette!==void 0}get palette(){return this._palette}get isHdrFormat(){return!1}get isLdrFormat(){return!this.isHdrFormat}get bitsPerChannel(){return 4}constructor(e,t,n,i){this._width=e,this._height=t,this._numChannels=n,this._rowStride=this._numChannels===2?this._width:this._numChannels===4?this._width*2:this._numChannels===3?Math.ceil(this._width*1.5):Math.ceil(this._width/2),this._palette=void 0,this._data=i!=null?i:new Uint8Array(Math.max(this._rowStride*this._height,1))}static palette(e,t,n){let i=Math.ceil(e/2),r=new Uint8Array(Math.max(i*t,1)),a=new kt(e,t,1,r);return a._rowStride=i,a._palette=n,a}static from(e,t=!1){var r;let n=t?new Uint8Array(e.data.length):e.data.slice(),i=new kt(e.width,e.height,e._numChannels,n);return i._rowStride=e.rowStride,i._palette=(r=e.palette)==null?void 0:r.clone(),i}getRange(e,t,n,i){return new le(Oe.imageData(this),e,t,n,i)}getColor(e,t,n,i){return i===void 0?gt.rgb(Math.trunc(e),Math.trunc(t),Math.trunc(n)):gt.rgba(Math.trunc(e),Math.trunc(t),Math.trunc(n),Math.trunc(i))}getPixel(e,t,n){let i=n;return(i===void 0||!(i instanceof Oe)||i.image!==this)&&(i=Oe.imageData(this)),i.setPosition(e,t),i}setPixel(e,t,n){this.setPixelRgba(e,t,n.r,n.g,n.b,n.a)}setPixelR(e,t,n){var i;this._numChannels<1||((i=this._pixel)!=null||(this._pixel=Oe.imageData(this)),this._pixel.setPosition(e,t),this._pixel.index=n)}setPixelRgb(e,t,n,i,r){var a;this._numChannels<1||((a=this._pixel)!=null||(this._pixel=Oe.imageData(this)),this._pixel.setPosition(e,t),this._pixel.setRgb(n,i,r))}setPixelRgba(e,t,n,i,r,a){var s;this._numChannels<1||((s=this._pixel)!=null||(this._pixel=Oe.imageData(this)),this._pixel.setPosition(e,t),this._pixel.setRgba(n,i,r,a))}setPixelRgbSafe(e,t,n,i,r){e<0||e>=this.width||t<0||t>=this.height||this.setPixelRgb(e,t,n,i,r)}setPixelRgbaSafe(e,t,n,i,r,a){e<0||e>=this.width||t<0||t>=this.height||this.setPixelRgba(e,t,n,i,r,a)}clear(e){}clone(e=!1){return kt.from(this,e)}toUint8Array(){return new Uint8Array(this.buffer)}getBytes(e){if(e===void 0)return this.toUint8Array();if(this.numChannels===4){if(e===2||e===3||e===1){let t=this.clone();if(e===2)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=s,n.g=a,n.b=r,n.a=i}else if(e===3)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=s,n.g=i,n.b=r,n.a=a}else if(e===1)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=a,n.g=r,n.b=i,n.a=s}return t.toUint8Array()}}else if(this.numChannels===3&&e===5){let t=this.clone();for(let n of t){let i=n.r;n.r=n.b,n.b=i}return t.toUint8Array()}return this.toUint8Array()}toString(){return`${this.constructor.name} (w: ${this._width}, h: ${this._height}, ch: ${this._numChannels})`}[Symbol.iterator](){return Oe.imageData(this)}}});var st,wr=A(()=>{"use strict";oe();ae();H();G();_e();Xn();st=class{get image(){return this._image}get x(){return this._x}get y(){return this._y}get xNormalized(){return this.width>1?this._x/(this.width-1):0}get yNormalized(){return this.height>1?this._y/(this.height-1):0}get index(){return this.data[this._index]}set index(e){this.data[this._index]=_.clampInt255(e)}get data(){return this._image.data}get isValid(){return this._x>=0&&this._x<this._image.width-1&&this._y>=0&&this._y<this._image.height-1}get width(){return this._image.width}get height(){return this._image.width}get length(){var e,t;return(t=(e=this.palette)==null?void 0:e.numChannels)!=null?t:this._image.numChannels}get numChannels(){return this._image.numChannels}get maxChannelValue(){return this._image.maxChannelValue}get maxIndexValue(){return this._image.maxIndexValue}get format(){return 3}get isLdrFormat(){return this._image.isLdrFormat}get isHdrFormat(){return this._image.isLdrFormat}get hasPalette(){return this._image.hasPalette}get palette(){return this._image.palette}get r(){return this.palette===void 0?this.numChannels>0?this.data[this._index]:0:this.palette.getRed(this.data[this._index])}set r(e){this.numChannels>0&&(this.data[this._index]=_.clampInt255(e))}get g(){return this.palette===void 0?this.numChannels>1?this.data[this._index+1]:0:this.palette.getGreen(this.data[this._index])}set g(e){this.numChannels>1&&(this.data[this._index+1]=_.clampInt255(e))}get b(){return this.palette===void 0?this.numChannels>2?this.data[this._index+2]:0:this.palette.getBlue(this.data[this._index])}set b(e){this.numChannels>2&&(this.data[this._index+2]=_.clampInt255(e))}get a(){return this.palette===void 0?this.numChannels>3?this.data[this._index+3]:255:this.palette.getAlpha(this.data[this._index])}set a(e){this.numChannels>3&&(this.data[this._index+3]=_.clampInt255(e))}get rNormalized(){return this.r/this.maxChannelValue}set rNormalized(e){this.r=e*this.maxChannelValue}get gNormalized(){return this.g/this.maxChannelValue}set gNormalized(e){this.g=e*this.maxChannelValue}get bNormalized(){return this.b/this.maxChannelValue}set bNormalized(e){this.b=e*this.maxChannelValue}get aNormalized(){return this.a/this.maxChannelValue}set aNormalized(e){this.a=e*this.maxChannelValue}get luminance(){return z.getLuminance(this)}get luminanceNormalized(){return z.getLuminanceNormalized(this)}constructor(e,t,n,i){this._image=i,this._index=n,this._x=e,this._y=t}static imageData(e){return new st(-1,0,-e.numChannels,e)}static image(e){return new st(-1,0,-e.numChannels,e.data instanceof ut?e.data:new ut(0,0,0))}static from(e){return new st(e.x,e.y,e._index,e.image)}next(){return this._x++,this._x===this.width&&(this._x=0,this._y++,this._y===this.height)?{done:!0,value:this}:(this._index+=this.palette===void 0?this.numChannels:1,{done:this._index>=this.image.data.length,value:this})}setPosition(e,t){this._x=e,this._y=t,this._index=this._y*this._image.width*this._image.numChannels+this._x*this._image.numChannels}setPositionNormalized(e,t){return this.setPosition(Math.floor(e*(this.width-1)),Math.floor(t*(this.height-1)))}getChannel(e){return this.palette!==void 0?this.palette.get(this.data[this._index],e):e===4?this.luminance:e<this.data.length?this.data[this._index+e]:0}getChannelNormalized(e){return this.getChannel(e)/this.maxChannelValue}setChannel(e,t){e<this.numChannels&&(this.data[this._index+e]=_.clampInt255(t))}set(e){this._image.hasPalette?this._index=e.index:(this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a)}setRgb(e,t,n){this.numChannels>0&&(this.data[this._index]=Math.trunc(e),this.numChannels>1&&(this.data[this._index+1]=Math.trunc(t),this.numChannels>2&&(this.data[this._index+2]=Math.trunc(n))))}setRgba(e,t,n,i){this.numChannels>0&&(this.data[this._index]=Math.trunc(e),this.numChannels>1&&(this.data[this._index+1]=Math.trunc(t),this.numChannels>2&&(this.data[this._index+2]=Math.trunc(n),this.numChannels>3&&(this.data[this._index+3]=Math.trunc(i)))))}equals(e){return e instanceof st?U.equals(this.toArray(),e.toArray()):Array.isArray(e)?U.equals(this.toArray(),e):!1}toArray(){return U.generate(this.length,e=>this.getChannel(e))}clone(){return st.from(this)}convert(e){return z.convertColor({from:this,format:e.format,numChannels:e.numChannels,alpha:e.alpha})}toString(){return`${this.constructor.name} (${this.toArray()})`}[Symbol.iterator](){return this}}});var ut,Xn=A(()=>{"use strict";De();H();wr();$e();dn();pn();_e();ut=class{get width(){return this._width}get height(){return this._height}get data(){return this._data}get numChannels(){return this._numChannels}get format(){return 3}get formatType(){return 0}get buffer(){return this._data.buffer}get rowStride(){return this._width*this._numChannels}get iterator(){return st.imageData(this)}get byteLength(){return this._data.byteLength}get length(){return this._data.byteLength}get maxChannelValue(){var e,t;return(t=(e=this._palette)==null?void 0:e.maxChannelValue)!=null?t:255}get maxIndexValue(){return 255}get hasPalette(){return this.palette!==void 0}get palette(){return this._palette}get isHdrFormat(){return!1}get isLdrFormat(){return!this.isHdrFormat}get bitsPerChannel(){return 8}constructor(e,t,n,i){this._width=e,this._height=t,this._numChannels=n,this._palette=void 0,this._data=i!=null?i:new Uint8Array(this._width*this._height*this._numChannels)}static palette(e,t,n){let i=new Uint8Array(e*t),r=new ut(e,t,1,i);return r._palette=n,r}static from(e,t=!1){var r;let n=t?new Uint8Array(e.data.length):e.data.slice(),i=new ut(e.width,e.height,e._numChannels,n);return i._palette=(r=e.palette)==null?void 0:r.clone(),i}getRange(e,t,n,i){return new le(st.imageData(this),e,t,n,i)}getColor(e,t,n,i){return i===void 0?new tn(_.clampInt255(e),_.clampInt255(t),_.clampInt255(n)):new Dt(_.clampInt255(e),_.clampInt255(t),_.clampInt255(n),_.clampInt255(i))}getPixel(e,t,n){let i=n;return(i===void 0||!(i instanceof st)||i.image!==this)&&(i=st.imageData(this)),i.setPosition(e,t),i}setPixel(e,t,n){this.setPixelRgba(e,t,n.r,n.g,n.b,n.a)}setPixelR(e,t,n){let i=t*this.rowStride+e*this.numChannels;this.data[i]=Math.trunc(n)}setPixelRgb(e,t,n,i,r){let a=t*this.rowStride+e*this._numChannels;this._data[a]=Math.trunc(n),this._numChannels>1&&(this._data[a+1]=Math.trunc(i),this._numChannels>2&&(this._data[a+2]=Math.trunc(r)))}setPixelRgba(e,t,n,i,r,a){let s=t*this.rowStride+e*this._numChannels;this._data[s]=Math.trunc(n),this._numChannels>1&&(this._data[s+1]=Math.trunc(i),this._numChannels>2&&(this._data[s+2]=Math.trunc(r),this._numChannels>3&&(this._data[s+3]=Math.trunc(a))))}setPixelRgbSafe(e,t,n,i,r){e<0||e>=this.width||t<0||t>=this.height||this.setPixelRgb(e,t,n,i,r)}setPixelRgbaSafe(e,t,n,i,r,a){e<0||e>=this.width||t<0||t>=this.height||this.setPixelRgba(e,t,n,i,r,a)}clear(e){let t=e==null?void 0:e.convert({format:3});if(this._numChannels===1){let n=t===void 0?0:_.clampInt255(t.r);this._data.fill(n)}else if(this._numChannels===2){let n=t===void 0?0:_.clampInt255(t.r),r=(t===void 0?0:_.clampInt255(t.g))<<8|n;new Uint16Array(this._data.buffer).fill(r)}else if(this._numChannels===4){let n=t===void 0?0:_.clampInt255(t.r),i=t===void 0?0:_.clampInt255(t.g),r=t===void 0?0:_.clampInt255(t.b),s=(t===void 0?0:_.clampInt255(t.a))<<24|r<<16|i<<8|n;new Uint32Array(this._data.buffer).fill(s)}else{let n=t===void 0?0:_.clampInt255(t.r),i=t===void 0?0:_.clampInt255(t.g),r=t===void 0?0:_.clampInt255(t.b);for(let a of this)a.r=n,a.g=i,a.b=r}}clone(e=!1){return ut.from(this,e)}toUint8Array(){return new Uint8Array(this.buffer)}getBytes(e){if(e===void 0)return this.toUint8Array();if(this.numChannels===4){if(e===2||e===3||e===1){let t=this.clone();if(e===2)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=s,n.g=a,n.b=r,n.a=i}else if(e===3)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=s,n.g=i,n.b=r,n.a=a}else if(e===1)for(let n of t){let i=n.r,r=n.g,a=n.b,s=n.a;n.r=a,n.g=r,n.b=i,n.a=s}return t.toUint8Array()}}else if(this.numChannels===3&&e===5){let t=this.clone();for(let n of t){let i=n.r;n.r=n.b,n.b=i}return t.toUint8Array()}return this.toUint8Array()}toString(){return`${this.constructor.name} (w: ${this._width}, h: ${this._height}, ch: ${this._numChannels})`}[Symbol.iterator](){return st.imageData(this)}}});var yn,vr=A(()=>{"use strict";H();un();yn=class{get data(){return this._data}get numColors(){return this._numColors}get numChannels(){return this._numChannels}get byteLength(){return this.data.byteLength}get buffer(){return this.data.buffer}get format(){return 9}get maxChannelValue(){return 1}constructor(e,t,n){this._numColors=e,this._numChannels=t,this._data=n!=null?n:new Uint16Array(e*t)}static from(e){return new yn(e.numColors,e.numChannels,e.data)}setRgb(e,t,n,i){let r=e;r*=this._numChannels,this._data[r]=R.doubleToFloat16(t),this._numChannels>1&&(this._data[r+1]=R.doubleToFloat16(n),this._numChannels>2&&(this._data[r+2]=R.doubleToFloat16(i)))}setRgba(e,t,n,i,r){let a=e;a*=this._numChannels,this._data[a]=R.doubleToFloat16(t),this._numChannels>1&&(this._data[a+1]=R.doubleToFloat16(n),this._numChannels>2&&(this._data[a+2]=R.doubleToFloat16(i),this._numChannels>3&&(this._data[a+3]=R.doubleToFloat16(r))))}set(e,t,n){let i=e;t<this._numChannels&&(i*=this._numChannels,this._data[i+t]=R.doubleToFloat16(n))}get(e,t){return t<this._numChannels?R.float16ToDouble(this._data[e*this._numChannels+t]):0}getRed(e){let t=e;return t*=this._numChannels,R.float16ToDouble(this._data[t])}getGreen(e){let t=e;return this._numChannels<2?0:(t*=this._numChannels,R.float16ToDouble(this._data[t+1]))}getBlue(e){let t=e;return this._numChannels<3?0:(t*=this._numChannels,R.float16ToDouble(this._data[t+2]))}getAlpha(e){let t=e;return this._numChannels<4?255:(t*=this._numChannels,R.float16ToDouble(this._data[t+3]))}setRed(e,t){this.set(e,0,t)}setGreen(e,t){this.set(e,1,t)}setBlue(e,t){this.set(e,2,t)}setAlpha(e,t){this.set(e,3,t)}clone(){return yn.from(this)}toUint8Array(){return new Uint8Array(this.buffer)}}});var Cn,Ir=A(()=>{"use strict";H();Cn=class{get data(){return this._data}get numColors(){return this._numColors}get numChannels(){return this._numChannels}get byteLength(){return this.data.byteLength}get buffer(){return this.data.buffer}get format(){return 10}get maxChannelValue(){return 1}constructor(e,t,n){this._numColors=e,this._numChannels=t,this._data=n!=null?n:new Float32Array(e*t)}static from(e){return new Cn(e.numColors,e.numChannels,e.data)}setRgb(e,t,n,i){let r=e;r*=this._numChannels,this._data[r]=t,this._numChannels>1&&(this._data[r+1]=n,this._numChannels>2&&(this._data[r+2]=i))}setRgba(e,t,n,i,r){let a=e;a*=this._numChannels,this._data[a]=t,this._numChannels>1&&(this._data[a+1]=n,this._numChannels>2&&(this._data[a+2]=i,this._numChannels>3&&(this._data[a+3]=r)))}set(e,t,n){let i=e;t<this._numChannels&&(i*=this._numChannels,this._data[i+t]=n)}get(e,t){return t<this._numChannels?this._data[e*this._numChannels+t]:0}getRed(e){let t=e;return t*=this._numChannels,this._data[t]}getGreen(e){let t=e;return this._numChannels<2?0:(t*=this._numChannels,this._data[t+1])}getBlue(e){let t=e;return this._numChannels<3?0:(t*=this._numChannels,this._data[t+2])}getAlpha(e){let t=e;return this._numChannels<4?255:(t*=this._numChannels,this._data[t+3])}setRed(e,t){this.set(e,0,t)}setGreen(e,t){this.set(e,1,t)}setBlue(e,t){this.set(e,2,t)}setAlpha(e,t){this.set(e,3,t)}clone(){return Cn.from(this)}toUint8Array(){return new Uint8Array(this.buffer)}}});var wn,Pr=A(()=>{"use strict";H();wn=class{get data(){return this._data}get numColors(){return this._numColors}get numChannels(){return this._numChannels}get byteLength(){return this.data.byteLength}get buffer(){return this.data.buffer}get format(){return 11}get maxChannelValue(){return 1}constructor(e,t,n){this._numColors=e,this._numChannels=t,this._data=n!=null?n:new Float64Array(e*t)}static from(e){return new wn(e.numColors,e.numChannels,e.data)}setRgb(e,t,n,i){let r=e;r*=this._numChannels,this._data[r]=t,this._numChannels>1&&(this._data[r+1]=n,this._numChannels>2&&(this._data[r+2]=i))}setRgba(e,t,n,i,r){let a=e;a*=this._numChannels,this._data[a]=t,this._numChannels>1&&(this._data[a+1]=n,this._numChannels>2&&(this._data[a+2]=i,this._numChannels>3&&(this._data[a+3]=r)))}set(e,t,n){let i=e;t<this._numChannels&&(i*=this._numChannels,this._data[i+t]=n)}get(e,t){return t<this._numChannels?this._data[e*this._numChannels+t]:0}getRed(e){let t=e;return t*=this._numChannels,this._data[t]}getGreen(e){let t=e;return this._numChannels<2?0:(t*=this._numChannels,this._data[t+1])}getBlue(e){let t=e;return this._numChannels<3?0:(t*=this._numChannels,this._data[t+2])}getAlpha(e){let t=e;return this._numChannels<4?255:(t*=this._numChannels,this._data[t+3])}setRed(e,t){this.set(e,0,t)}setGreen(e,t){this.set(e,1,t)}setBlue(e,t){this.set(e,2,t)}setAlpha(e,t){this.set(e,3,t)}clone(){return wn.from(this)}toUint8Array(){return new Uint8Array(this.buffer)}}});var vn,Mr=A(()=>{"use strict";H();vn=class{get data(){return this._data}get numColors(){return this._numColors}get numChannels(){return this._numChannels}get byteLength(){return this._data.byteLength}get buffer(){return this._data.buffer}get format(){return 7}get maxChannelValue(){return 32767}constructor(e,t,n){this._numColors=e,this._numChannels=t,this._data=n!=null?n:new Int16Array(e*t)}static from(e){return new vn(e.numColors,e.numChannels,e.data)}setRgb(e,t,n,i){let r=e;r*=this._numChannels,this._data[r]=Math.trunc(t),this._numChannels>1&&(this._data[r+1]=Math.trunc(n),this._numChannels>2&&(this._data[r+2]=Math.trunc(i)))}setRgba(e,t,n,i,r){let a=e;a*=this._numChannels,this._data[a]=Math.trunc(t),this._numChannels>1&&(this._data[a+1]=Math.trunc(n),this._numChannels>2&&(this._data[a+2]=Math.trunc(i),this._numChannels>3&&(this._data[a+3]=Math.trunc(r))))}set(e,t,n){let i=e;t<this._numChannels&&(i*=this._numChannels,this._data[i+t]=Math.trunc(n))}get(e,t){return t<this._numChannels?this._data[e*this._numChannels+t]:0}getRed(e){let t=e;return t*=this._numChannels,this._data[t]}getGreen(e){let t=e;return this._numChannels<2?0:(t*=this._numChannels,this._data[t+1])}getBlue(e){let t=e;return this._numChannels<3?0:(t*=this._numChannels,this._data[t+2])}getAlpha(e){let t=e;return this._numChannels<4?0:(t*=this._numChannels,this._data[t+3])}setRed(e,t){this.set(e,0,t)}setGreen(e,t){this.set(e,1,t)}setBlue(e,t){this.set(e,2,t)}setAlpha(e,t){this.set(e,3,t)}clone(){return vn.from(this)}toUint8Array(){return new Uint8Array(this.buffer)}}});var In,Ar=A(()=>{"use strict";H();In=class{get data(){return this._data}get numColors(){return this._numColors}get numChannels(){return this._numChannels}get byteLength(){return this._data.byteLength}get buffer(){return this._data.buffer}get format(){return 8}get maxChannelValue(){return 2147483647}constructor(e,t,n){this._numColors=e,this._numChannels=t,this._data=n!=null?n:new Int32Array(e*t)}static from(e){return new In(e.numColors,e.numChannels,e.data)}setRgb(e,t,n,i){let r=e;r*=this._numChannels,this._data[r]=Math.trunc(t),this._numChannels>1&&(this._data[r+1]=Math.trunc(n),this._numChannels>2&&(this._data[r+2]=Math.trunc(i)))}setRgba(e,t,n,i,r){let a=e;a*=this._numChannels,this._data[a]=Math.trunc(t),this._numChannels>1&&(this._data[a+1]=Math.trunc(n),this._numChannels>2&&(this._data[a+2]=Math.trunc(i),this._numChannels>3&&(this._data[a+3]=Math.trunc(r))))}set(e,t,n){let i=e;t<this._numChannels&&(i*=this._numChannels,this._data[i+t]=Math.trunc(n))}get(e,t){return t<this._numChannels?this._data[e*this._numChannels+t]:0}getRed(e){let t=e;return t*=this._numChannels,this._data[t]}getGreen(e){let t=e;return this._numChannels<2?0:(t*=this._numChannels,this._data[t+1])}getBlue(e){let t=e;return this._numChannels<3?0:(t*=this._numChannels,this._data[t+2])}getAlpha(e){let t=e;return this._numChannels<4?0:(t*=this._numChannels,this._data[t+3])}setRed(e,t){this.set(e,0,t)}setGreen(e,t){this.set(e,1,t)}setBlue(e,t){this.set(e,2,t)}setAlpha(e,t){this.set(e,3,t)}clone(){return In.from(this)}toUint8Array(){return new Uint8Array(this.buffer)}}});var Pn,Fr=A(()=>{"use strict";H();Pn=class{get data(){return this._data}get numColors(){return this._numColors}get numChannels(){return this._numChannels}get byteLength(){return this.data.byteLength}get buffer(){return this.data.buffer}get format(){return 6}get maxChannelValue(){return 127}constructor(e,t,n){this._numColors=e,this._numChannels=t,this._data=n!=null?n:new Int8Array(e*t)}static from(e){return new Pn(e.numColors,e.numChannels,e.data)}setRgb(e,t,n,i){let r=e;r*=this._numChannels,this._data[r]=Math.trunc(t),this._numChannels>1&&(this._data[r+1]=Math.trunc(n),this._numChannels>2&&(this._data[r+2]=Math.trunc(i)))}setRgba(e,t,n,i,r){let a=e;a*=this._numChannels,this._data[a]=Math.trunc(t),this._numChannels>1&&(this._data[a+1]=Math.trunc(n),this._numChannels>2&&(this._data[a+2]=Math.trunc(i),this._numChannels>3&&(this._data[a+3]=Math.trunc(r))))}set(e,t,n){let i=e;t<this._numChannels&&(i*=this._numChannels,this._data[i+t]=Math.trunc(n))}get(e,t){return t<this._numChannels?this._data[e*this._numChannels+t]:0}getRed(e){let t=e;return t*=this._numChannels,this._data[t]}getGreen(e){let t=e;return this._numChannels<2?0:(t*=this._numChannels,this._data[t+1])}getBlue(e){let t=e;return this._numChannels<3?0:(t*=this._numChannels,this._data[t+2])}getAlpha(e){let t=e;return this._numChannels<4?0:(t*=this._numChannels,this._data[t+3])}setRed(e,t){this.set(e,0,t)}setGreen(e,t){this.set(e,1,t)}setBlue(e,t){this.set(e,2,t)}setAlpha(e,t){this.set(e,3,t)}clone(){return Pn.from(this)}toUint8Array(){return new Uint8Array(this.buffer)}}});var Mn,Br=A(()=>{"use strict";H();Mn=class{get data(){return this._data}get numColors(){return this._numColors}get numChannels(){return this._numChannels}get byteLength(){return this._data.byteLength}get buffer(){return this._data.buffer}get format(){return 4}get maxChannelValue(){return 65535}constructor(e,t,n){this._numColors=e,this._numChannels=t,this._data=n!=null?n:new Uint16Array(e*t)}static from(e){return new Mn(e.numColors,e.numChannels,e.data)}setRgb(e,t,n,i){let r=e;r*=this._numChannels,this._data[r]=Math.trunc(t),this._numChannels>1&&(this._data[r+1]=Math.trunc(n),this._numChannels>2&&(this._data[r+2]=Math.trunc(i)))}setRgba(e,t,n,i,r){let a=e;a*=this._numChannels,this._data[a]=Math.trunc(t),this._numChannels>1&&(this._data[a+1]=Math.trunc(n),this._numChannels>2&&(this._data[a+2]=Math.trunc(i),this._numChannels>3&&(this._data[a+3]=Math.trunc(r))))}set(e,t,n){let i=e;t<this._numChannels&&(i*=this._numChannels,this._data[i+t]=Math.trunc(n))}get(e,t){return t<this._numChannels?this._data[e*this._numChannels+t]:0}getRed(e){let t=e;return t*=this._numChannels,this._data[t]}getGreen(e){let t=e;return this._numChannels<2?0:(t*=this._numChannels,this._data[t+1])}getBlue(e){let t=e;return this._numChannels<3?0:(t*=this._numChannels,this._data[t+2])}getAlpha(e){let t=e;return this._numChannels<4?0:(t*=this._numChannels,this._data[t+3])}setRed(e,t){this.set(e,0,t)}setGreen(e,t){this.set(e,1,t)}setBlue(e,t){this.set(e,2,t)}setAlpha(e,t){this.set(e,3,t)}clone(){return Mn.from(this)}toUint8Array(){return new Uint8Array(this.buffer)}}});var rn,zi=A(()=>{"use strict";H();rn=class{get data(){return this._data}get numColors(){return this._numColors}get numChannels(){return this._numChannels}get byteLength(){return this._data.byteLength}get buffer(){return this._data.buffer}get format(){return 5}get maxChannelValue(){return 4294967295}constructor(e,t,n){this._numColors=e,this._numChannels=t,this._data=n!=null?n:new Uint32Array(e*t)}static from(e){return new rn(e.numColors,e.numChannels,e.data)}setRgb(e,t,n,i){let r=e;r*=this._numChannels,this._data[r]=Math.trunc(t),this._numChannels>1&&(this._data[r+1]=Math.trunc(n),this._numChannels>2&&(this._data[r+2]=Math.trunc(i)))}setRgba(e,t,n,i,r){let a=e;a*=this._numChannels,this._data[a]=Math.trunc(t),this._numChannels>1&&(this._data[a+1]=Math.trunc(n),this._numChannels>2&&(this._data[a+2]=Math.trunc(i),this._numChannels>3&&(this._data[a+3]=Math.trunc(r))))}set(e,t,n){let i=e;t<this._numChannels&&(i*=this._numChannels,this._data[i+t]=Math.trunc(n))}get(e,t){return t<this._numChannels?this._data[e*this._numChannels+t]:0}getRed(e){let t=e;return t*=this._numChannels,this._data[t]}getGreen(e){let t=e;return this._numChannels<2?0:(t*=this._numChannels,this._data[t+1])}getBlue(e){let t=e;return this._numChannels<3?0:(t*=this._numChannels,this._data[t+2])}getAlpha(e){let t=e;return this._numChannels<4?0:(t*=this._numChannels,this._data[t+3])}setRed(e,t){this.set(e,0,t)}setGreen(e,t){this.set(e,1,t)}setBlue(e,t){this.set(e,2,t)}setAlpha(e,t){this.set(e,3,t)}clone(){return rn.from(this)}toUint8Array(){return new Uint8Array(this.buffer)}}});var Ae,Xt=A(()=>{"use strict";H();Ae=class{get data(){return this._data}get numColors(){return this._numColors}get numChannels(){return this._numChannels}get byteLength(){return this._data.byteLength}get buffer(){return this._data.buffer}get format(){return 3}get maxChannelValue(){return 255}constructor(e,t,n){this._numColors=e,this._numChannels=t,this._data=n!=null?n:new Uint8Array(e*t)}static from(e){return new Ae(e.numColors,e.numChannels,e.data)}setRgb(e,t,n,i){let r=e;r*=this._numChannels,this._data[r]=Math.trunc(t),this._numChannels>1&&(this._data[r+1]=Math.trunc(n),this._numChannels>2&&(this._data[r+2]=Math.trunc(i)))}setRgba(e,t,n,i,r){let a=e;a*=this._numChannels,this._data[a]=Math.trunc(t),this._numChannels>1&&(this._data[a+1]=Math.trunc(n),this._numChannels>2&&(this._data[a+2]=Math.trunc(i),this._numChannels>3&&(this._data[a+3]=Math.trunc(r))))}set(e,t,n){let i=e;t<this._numChannels&&(i*=this._numChannels,this._data[i+t]=Math.trunc(n))}get(e,t){return t<this._numChannels?this._data[e*this._numChannels+t]:0}getRed(e){let t=e;return t*=this._numChannels,t>=this._data.length?0:this._data[t]}getGreen(e){let t=e;return this._numChannels<2||(t*=this._numChannels,t>=this._data.length)?0:this._data[t+1]}getBlue(e){let t=e;return this._numChannels<3||(t*=this._numChannels,t>=this._data.length)?0:this._data[t+2]}getAlpha(e){let t=e;return this._numChannels<4?255:(t*=this._numChannels,t>=this._data.length?0:this._data[t+3])}setRed(e,t){this.set(e,0,t)}setGreen(e,t){this.set(e,1,t)}setBlue(e,t){this.set(e,2,t)}setAlpha(e,t){this.set(e,3,t)}clone(){return Ae.from(this)}toUint8Array(){return new Uint8Array(this.buffer)}}});var os,Oi,Ur=A(()=>{"use strict";H();Xn();os=class{get image(){return os._nullImageData}get isValid(){return!1}get width(){return 0}get height(){return 0}get x(){return 0}get y(){return 0}get xNormalized(){return 0}get yNormalized(){return 0}get length(){return 0}get maxChannelValue(){return 0}get maxIndexValue(){return 0}get format(){return 3}get isLdrFormat(){return!1}get isHdrFormat(){return!1}get hasPalette(){return!1}get palette(){}get index(){return 0}set index(e){}get r(){return 0}set r(e){}get g(){return 0}set g(e){}get b(){return 0}set b(e){}get a(){return 0}set a(e){}get rNormalized(){return 0}set rNormalized(e){}get gNormalized(){return 0}set gNormalized(e){}get bNormalized(){return 0}set bNormalized(e){}get aNormalized(){return 0}set aNormalized(e){}get luminance(){return 0}get luminanceNormalized(){return 0}getChannel(e){return 0}getChannelNormalized(e){return 0}setChannel(e,t){}set(e){}setRgb(e,t,n){}setRgba(e,t,n,i){}clone(){return new os}convert(e){return this}setPosition(e,t){}setPositionNormalized(e,t){}equals(e){return e instanceof os}next(){return{done:!0,value:this}}toArray(){return[]}toString(){return`${this.constructor.name} (undefined)`}[Symbol.iterator](){return this}},Oi=os;Oi._nullImageData=new ut(0,0,0)});var Sr,kr=A(()=>{"use strict";Ur();Sr=new Oi});var Q,It=A(()=>{"use strict";De();en();ae();H();G();Sn();_e();be();Tt();Yn();wi();vi();Ii();Pi();Mi();Ai();Fi();Bi();Ui();Si();ki();Xn();vr();Ir();Pr();Mr();Ar();Fr();Br();zi();Xt();kr();Q=class{constructor(e){this._frames=[];var t,n,i,r,a,s,u,o;e!==void 0?(this._loopCount=(t=e.loopCount)!=null?t:0,this._frameType=(n=e.frameType)!=null?n:2,this._frameDuration=(i=e.frameDuration)!=null?i:0,this._frameIndex=(r=e.frameIndex)!=null?r:0,this._backgroundColor=e.backgroundColor,this._textData=e.textData,this._frames.push(this),this.initialize({width:e.width,height:e.height,format:(a=e.format)!=null?a:3,numChannels:(s=e.numChannels)!=null?s:3,withPalette:(u=e.withPalette)!=null?u:!1,paletteFormat:(o=e.paletteFormat)!=null?o:3,palette:e.palette,exifData:e.exifData,iccProfile:e.iccProfile})):(this._loopCount=0,this._frameType=2,this._frameDuration=0,this._frameIndex=0)}get data(){return this._data}get numPixelColors(){return this.format===0?2:this.format===1?4:this.format===2?16:this.format===3?256:0}get format(){var e,t;return(t=(e=this._data)==null?void 0:e.format)!=null?t:3}get hasPalette(){var e;return((e=this._data)==null?void 0:e.palette)!==void 0}get palette(){var e;return(e=this._data)==null?void 0:e.palette}get numChannels(){var e,t,n,i;return(i=(n=(e=this.palette)==null?void 0:e.numChannels)!=null?n:(t=this._data)==null?void 0:t.numChannels)!=null?i:0}get hasAnimation(){return this._frames.length>1}get numFrames(){return this._frames.length}get exifData(){var e;return(e=this._exifData)!=null||(this._exifData=new Ie),this._exifData}set exifData(e){this._exifData=e}get maxChannelValue(){var e,t;return(t=(e=this._data)==null?void 0:e.maxChannelValue)!=null?t:0}get maxIndexValue(){var e,t;return(t=(e=this.data)==null?void 0:e.maxIndexValue)!=null?t:0}get supportsPalette(){return this.format===0||this.format===1||this.format===2||this.format===3}get width(){var e,t;return(t=(e=this.data)==null?void 0:e.width)!=null?t:0}get height(){var e,t;return(t=(e=this.data)==null?void 0:e.height)!=null?t:0}get formatType(){var e,t;return(t=(e=this.data)==null?void 0:e.formatType)!=null?t:0}get isValid(){return this._data!==void 0&&this.width>0&&this.height>0}get buffer(){var e;return(e=this._data)==null?void 0:e.buffer}get byteLength(){var e,t;return(t=(e=this._data)==null?void 0:e.buffer.byteLength)!=null?t:0}get rowStride(){var e,t;return(t=(e=this._data)==null?void 0:e.rowStride)!=null?t:0}get isLdrFormat(){var e,t;return(t=(e=this._data)==null?void 0:e.isLdrFormat)!=null?t:!1}get isHdrFormat(){var e,t;return(t=(e=this._data)==null?void 0:e.isHdrFormat)!=null?t:!1}get bitsPerChannel(){var e,t;return(t=(e=this._data)==null?void 0:e.bitsPerChannel)!=null?t:0}get hasAlpha(){return this.numChannels===4}get iccProfile(){return this._iccProfile}set iccProfile(e){this._iccProfile=e}get textData(){return this._textData}get backgroundColor(){return this._backgroundColor}set backgroundColor(e){this._backgroundColor=e}get loopCount(){return this._loopCount}set loopCount(e){this._loopCount=e}get frameType(){return this._frameType}set frameType(e){this._frameType=e}get frames(){return this._frames}get frameDuration(){return this._frameDuration}set frameDuration(e){this._frameDuration=e}get frameIndex(){return this._frameIndex}static fromResized(e,t,n,i=!1){var a,s,u,o;let r=new Q({width:t,height:n,loopCount:e._loopCount,frameType:e._frameType,frameDuration:e._frameDuration,frameIndex:e._frameIndex,backgroundColor:(a=e._backgroundColor)==null?void 0:a.clone(),format:e.format,numChannels:e.numChannels,withPalette:e.hasPalette,paletteFormat:(s=e.palette)==null?void 0:s.format,palette:e.palette,exifData:(u=e._exifData)==null?void 0:u.clone(),iccProfile:(o=e._iccProfile)==null?void 0:o.clone(),textData:e._textData!==void 0?new Map(e._textData):void 0});if(e._extraChannels!==void 0&&(r._extraChannels=new Map(e._extraChannels)),!i){let l=e.numFrames;for(let m=1;m<l;++m){let b=e._frames[m];r.addFrame(Q.fromResized(b,t,n))}}return r}static from(e,t=!1,n=!1){var r,a,s,u;let i=new Q;if(i._data=(r=e.data)==null?void 0:r.clone(n),i._exifData=(a=e._exifData)==null?void 0:a.clone(),i._iccProfile=(s=e.iccProfile)==null?void 0:s.clone(),i._frameType=e.frameType,i._loopCount=e._loopCount,i._backgroundColor=(u=e._backgroundColor)==null?void 0:u.clone(),i._frameDuration=e._frameDuration,i._frameIndex=e._frameIndex,e._extraChannels!==void 0&&(i._extraChannels=new Map(e._extraChannels)),e._textData!==void 0&&(i._textData=new Map(e.textData)),i._frames.push(i),!t&&e.hasAnimation){let o=e.numFrames;for(let l=1;l<o;++l){let m=e._frames[l];i.addFrame(Q.from(m))}}return i}static fromBytes(e){var u,o,l,m,b,h,c,d,p,g;let t=new Q;t._loopCount=(u=e.loopCount)!=null?u:0,t._frameType=(o=e.frameType)!=null?o:2,t._frameDuration=(l=e.frameDuration)!=null?l:0,t._frameIndex=(m=e.frameIndex)!=null?m:0,t._backgroundColor=e.backgroundColor,t._textData=e.textData,t._frames.push(t);let n=(b=e.format)!=null?b:3,i=(h=e.withPalette)!=null?h:!1,r=(c=e.paletteFormat)!=null?c:3,a=(d=e.numChannels)!=null?d:e.channelOrder!==void 0?Ja.get(e.channelOrder):3;if(a<0||a>4)throw new T("A MemoryImage can only have 1-4 channels.");let s=(p=e.channelOrder)!=null?p:a===3?4:a===4?0:a===1?7:6;if(a===1?s=7:a===2?s=6:a===3?s!==4&&s!==5&&(s=4):a===4&&s!==1&&s!==0&&s!==2&&s!==3&&(s=0),t.initialize({width:e.width,height:e.height,format:n,numChannels:a,withPalette:i,paletteFormat:r,palette:e.palette,exifData:e.exifData,iccProfile:e.iccProfile}),t.data!==void 0){let x=t.data.toUint8Array(),y=new Uint8Array(e.bytes),C=(g=e.rowStride)!=null?g:e.width*a*es.get(n),I=t.data.rowStride,P=Math.min(C,I),F=0,M=0;for(let w=0;w<e.height;++w,M+=C,F+=I)U.copyRange(y,M,M+P,x,F);if(a===3&&s===5)for(let w of t){let k=w.r;w.r=w.b,w.b=k}else if(a===4&&s===2)for(let w of t){let k=w.r,B=w.g,N=w.b,O=w.a;w.r=O,w.g=N,w.b=B,w.a=k}else if(a===4&&s===3)for(let w of t){let k=w.r,B=w.g,N=w.b,O=w.a;w.r=O,w.g=k,w.b=B,w.a=N}else if(a===4&&s===1)for(let w of t){let k=w.r,B=w.g,N=w.b,O=w.a;w.r=N,w.g=B,w.b=k,w.a=O}}return t}initialize(e){var s,u,o,l,m;let t=(s=e.format)!=null?s:3,n=(u=e.numChannels)!=null?u:3,i=(o=e.withPalette)!=null?o:!1,r=(l=e.paletteFormat)!=null?l:3;if(n<1||n>4)throw new T(`Invalid number of channels for image (${n}). Must be between 1 and 4.`);this._iccProfile=e.iccProfile,e.exifData!==void 0&&(this._exifData=e.exifData.clone());let a=(m=e.palette)!=null?m:i&&this.supportsPalette?this.createPalette(r,n):void 0;this.createImageData(e.width,e.height,t,n,a)}createImageData(e,t,n,i,r){switch(n){case 0:r===void 0?this._data=new Ut(e,t,i):this._data=Ut.palette(e,t,r);break;case 1:r===void 0?this._data=new St(e,t,i):this._data=St.palette(e,t,r);break;case 2:r===void 0?this._data=new kt(e,t,i):this._data=kt.palette(e,t,r);break;case 3:r===void 0?this._data=new ut(e,t,i):this._data=ut.palette(e,t,r);break;case 4:this._data=new Wt(e,t,i);break;case 5:this._data=new Yt(e,t,i);break;case 6:this._data=new $t(e,t,i);break;case 7:this._data=new qt(e,t,i);break;case 8:this._data=new Gt(e,t,i);break;case 9:this._data=new Lt(e,t,i);break;case 10:this._data=new Et(e,t,i);break;case 11:this._data=new Ht(e,t,i);break}}createPalette(e,t){switch(e){case 0:return;case 1:return;case 2:return;case 3:return new Ae(this.numPixelColors,t);case 4:return new Mn(this.numPixelColors,t);case 5:return new rn(this.numPixelColors,t);case 6:return new Pn(this.numPixelColors,t);case 7:return new vn(this.numPixelColors,t);case 8:return new In(this.numPixelColors,t);case 9:return new yn(this.numPixelColors,t);case 10:return new Cn(this.numPixelColors,t);case 11:return new wn(this.numPixelColors,t)}throw new T("Unknown palette format.")}addFrame(e){let t=e!=null?e:Q.from(this,!0,!0);return t._frameIndex=this._frames.length,this._frames[this._frames.length-1]!==t&&this._frames.push(t),t}getFrame(e){return this._frames[e]}clone(e){var i,r;let t=(i=e==null?void 0:e.skipAnimation)!=null?i:!1,n=(r=e==null?void 0:e.skipPixels)!=null?r:!1;return Q.from(this,t,n)}hasExtraChannel(e){return this._extraChannels!==void 0&&this._extraChannels.has(e)}getExtraChannel(e){return this._extraChannels!==void 0?this._extraChannels.get(e):void 0}setExtraChannel(e,t){var n;this._extraChannels===void 0&&t===void 0||((n=this._extraChannels)!=null||(this._extraChannels=new Map),t===void 0?this._extraChannels.delete(e):this._extraChannels.set(e,t),this._extraChannels.size===0&&(this._extraChannels=void 0))}getRange(e,t,n,i){return this.data.getRange(e,t,n,i)}toUint8Array(){var e,t;return(t=(e=this._data)==null?void 0:e.toUint8Array())!=null?t:this.buffer!==void 0?new Uint8Array(this.buffer):new Uint8Array}getBytes(e){var t,n;return(n=(t=this._data)==null?void 0:t.getBytes(e))!=null?n:this.toUint8Array()}remapChannels(e){if(this.numChannels===4){if(e===2||e===3||e===1){if(e===2)for(let t of this){let n=t.r,i=t.g,r=t.b,a=t.a;t.r=a,t.g=r,t.b=i,t.a=n}else if(e===3)for(let t of this){let n=t.r,i=t.g,r=t.b,a=t.a;t.r=a,t.g=n,t.b=i,t.a=r}else if(e===1)for(let t of this){let n=t.r,i=t.g,r=t.b,a=t.a;t.r=r,t.g=i,t.b=n,t.a=a}}}else if(this.numChannels===3&&e===5)for(let t of this){let n=t.r;t.r=t.b,t.b=n}}isBoundsSafe(e,t){return e>=0&&t>=0&&e<this.width&&t<this.height}getColor(e,t,n,i){var r,a;return(a=(r=this._data)==null?void 0:r.getColor(e,t,n,i))!=null?a:new ge(0)}getPixel(e,t,n){var i,r;return(r=(i=this._data)==null?void 0:i.getPixel(e,t,n))!=null?r:Sr}getPixelSafe(e,t,n){return e<0||e>=this.width||t<0||t>=this.height?Sr:this.getPixel(e,t,n)}getPixelClamped(e,t,n){let i=_.clamp(e,0,this.width-1),r=_.clamp(t,0,this.height-1);return this.getPixel(i,r,n)}getPixelInterpolate(e,t,n=1){switch(n){case 0:return this.getPixelSafe(Math.trunc(e),Math.trunc(t));case 1:case 3:return this.getPixelLinear(e,t);case 2:return this.getPixelCubic(e,t)}throw new T("Unknown Interpolation mode.")}getPixelLinear(e,t){let n=Math.trunc(e)-(e>=0?0:1),i=n+1,r=Math.trunc(t)-(t>=0?0:1),a=r+1,s=e-n,u=t-r,o=(c,d,p,g)=>c+s*(d-c+u*(c+g-p-d))+u*(p-c),l=this.getPixelSafe(n,r),m=a>=this.height?l:this.getPixelSafe(n,a),b=i>=this.width?l:this.getPixelSafe(i,r),h=i>=this.width||a>=this.height?l:this.getPixelSafe(i,a);return this.getColor(o(l.r,b.r,m.r,h.r),o(l.g,b.g,m.g,h.g),o(l.b,b.b,m.b,h.b),o(l.a,b.a,m.a,h.a))}getPixelCubic(e,t){let n=Math.trunc(e)-(e>=0?0:1),i=n-1,r=n+1,a=n+2,s=Math.trunc(t)-(t>=0?0:1),u=s-1,o=s+1,l=s+2,m=e-n,b=t-s,h=(Qt,$a,Wa,Ya,rr)=>Wa+.5*(Qt*(-$a+Ya)+Qt*Qt*(2*$a-5*Wa+4*Ya-rr)+Qt*Qt*Qt*(-$a+3*Wa-3*Ya+rr)),c=this.getPixelSafe(n,s),d=i<0||u<0?c:this.getPixelSafe(i,u),p=i<0?c:this.getPixelSafe(n,u),g=u<0||r>=this.width?c:this.getPixelSafe(r,u),x=a>=this.width||u<0?c:this.getPixelSafe(a,u),y=h(m,d.r,p.r,g.r,x.r),C=h(m,d.g,p.g,g.g,x.g),I=h(m,d.b,p.b,g.b,x.b),P=h(m,d.a,p.a,g.a,x.a),F=i<0?c:this.getPixelSafe(i,s),M=r>=this.width?c:this.getPixelSafe(r,s),w=a>=this.width?c:this.getPixelSafe(a,s),k=h(m,F.r,c.r,M.r,w.r),B=h(m,F.g,c.g,M.g,w.g),N=h(m,F.b,c.b,M.b,w.b),O=h(m,F.a,c.a,M.a,w.a),V=i<0||o>=this.height?c:this.getPixelSafe(i,o),E=o>=this.height?c:this.getPixelSafe(n,o),$=r>=this.width||o>=this.height?c:this.getPixelSafe(r,o),X=a>=this.width||o>=this.height?c:this.getPixelSafe(a,o),ie=h(m,V.r,E.r,$.r,X.r),te=h(m,V.g,E.g,$.g,X.g),re=h(m,V.b,E.b,$.b,X.b),W=h(m,V.a,E.a,$.a,X.a),j=i<0||l>=this.height?c:this.getPixelSafe(i,l),Re=l>=this.height?c:this.getPixelSafe(n,l),pe=r>=this.width||l>=this.height?c:this.getPixelSafe(r,l),se=a>=this.width||l>=this.height?c:this.getPixelSafe(a,l),me=h(m,j.r,Re.r,pe.r,se.r),fn=h(m,j.g,Re.g,pe.g,se.g),Ot=h(m,j.b,Re.b,pe.b,se.b),Zt=h(m,j.a,Re.a,pe.a,se.a),Mt=h(b,y,k,ie,me),Ye=h(b,C,B,te,fn),Xe=h(b,I,N,re,Ot),an=h(b,P,O,W,Zt);return this.getColor(Math.trunc(Mt),Math.trunc(Ye),Math.trunc(Xe),Math.trunc(an))}setPixel(e,t,n){var i;if("image"in n&&"index"in n&&n.image.hasPalette&&this.hasPalette){this.setPixelIndex(e,t,n.index);return}(i=this._data)==null||i.setPixelRgba(e,t,n.r,n.g,n.b,n.a)}setPixelIndex(e,t,n){var i;(i=this._data)==null||i.setPixelR(e,t,n)}setPixelR(e,t,n){var i;(i=this._data)==null||i.setPixelR(e,t,n)}setPixelRgb(e,t,n,i,r){var a;(a=this._data)==null||a.setPixelRgb(e,t,n,i,r)}setPixelRgba(e,t,n,i,r,a){var s;(s=this._data)==null||s.setPixelRgba(e,t,n,i,r,a)}clear(e){var t;(t=this._data)==null||t.clear(e)}convert(e){var u,o,l,m,b,h,c,d,p,g;let t=(u=e.format)!=null?u:this.format,n=(o=e.numChannels)!=null?o:this.numChannels,i=(l=e.alpha)!=null?l:Xa.get(t),r=(m=e.withPalette)!=null?m:!1,a=(b=e.skipAnimation)!=null?b:!1;if((r&&(n>=4||!(t===0||t===1||t===2||t===3&&n===1))||t<3&&this.format>=3)&&(r=!1),t===this.format&&n===this.numChannels&&(!r&&this.palette===void 0||r&&this.palette!==void 0))return Q.from(this);let s;for(let x of this._frames){let y=new Q({width:x.width,height:x.height,format:t,numChannels:n,withPalette:r,exifData:(h=x._exifData)==null?void 0:h.clone(),iccProfile:(c=x._iccProfile)==null?void 0:c.clone(),backgroundColor:(d=x._backgroundColor)==null?void 0:d.clone(),frameType:x._frameType,loopCount:x._loopCount,frameDuration:x._frameDuration,textData:x._textData!==void 0?new Map(x.textData):void 0});s!==void 0?s.addFrame(y):s=y;let C=y.palette,I=(g=(p=y.palette)==null?void 0:p.format)!=null?g:t;if(C!==void 0){let P=new Map,F=0,M=x.getPixel(0,0),w;for(let k of y){let B=Math.floor(M.rNormalized*255),N=Math.floor(M.gNormalized*255),O=Math.floor(M.bNormalized*255),V=z.rgbaToUint32(B,N,O,0);P.has(V)?k.index=P.get(V):(P.set(V,F),k.index=F,w=z.convertColor({from:M,to:w,format:I,numChannels:n,alpha:i}),C.setRgb(F,w.r,w.g,w.b),F++),M.next()}}else{let P=x.getPixel(0,0);for(let F of y)z.convertColor({from:P,to:F,alpha:i}),P.next()}if(a)break}return s}addTextData(e){var t;(t=this._textData)!=null||(this._textData=new Map);for(let[n,i]of e)this._textData.set(n,i)}getColorExtremes(){let e=!0,t=0,n=0;for(let i of this){for(let r=0;r<i.length;r++){let a=i.getChannel(r);(e||a<t)&&(t=a),(e||a>n)&&(n=a)}e=!1}return{min:t,max:n}}toString(){return`${this.constructor.name} (w: ${this.width}, h: ${this.height}, f: ${q[this.format]}, ch: ${this.numChannels})`}[Symbol.iterator](){return this._data!==void 0?this._data[Symbol.iterator]():{next:()=>({done:!0,value:Sr})}}}});var ee,he,jn=A(()=>{"use strict";dn();pn();_e();It();zi();Xt();ee=class{constructor(e,t=256,n=10){this._netIndex=new Int32Array(256);this._netSize=16;this._specials=3;this._bgColor=0;this._cutNetSize=0;this._maxNetPos=0;this._initRadius=0;this._initBiasRadius=0;this._samplingFactor=n,this.initialize(t),this.addImage(e)}get palette(){return this._palette}get numColors(){return this._netSize}initialize(e){this._netSize=Math.max(e,4),this._cutNetSize=this._netSize-this._specials,this._maxNetPos=this._netSize-1,this._initRadius=Math.floor(this._netSize/8),this._initBiasRadius=this._initRadius*ee._radiusBias,this._paletteInternal=new rn(256,4),this._palette=new Ae(256,3),this._specials=3,this._bgColor=this._specials-1,this._radiusPower=new Int32Array(this._netSize>>3),this._network=new Array(this._netSize*3).fill(0),this._bias=new Array(this._netSize).fill(0),this._freq=new Array(this._netSize).fill(0),this._network[0]=0,this._network[1]=0,this._network[2]=0,this._network[3]=255,this._network[4]=255,this._network[5]=255;let t=1/this._netSize;for(let n=0;n<this._specials;++n)this._freq[n]=t,this._bias[n]=0;for(let n=this._specials,i=this._specials*3;n<this._netSize;++n)this._network[i++]=255*(n-this._specials)/this._cutNetSize,this._network[i++]=255*(n-this._specials)/this._cutNetSize,this._network[i++]=255*(n-this._specials)/this._cutNetSize,this._freq[n]=t,this._bias[n]=0}updateRadiusPower(e,t){for(let n=0;n<e;n++)this._radiusPower[n]=Math.trunc(t*((e*e-n*n)*ee._radiusBias/(e*e)))}specialFind(e,t,n){for(let i=0,r=0;i<this._specials;i++)if(this._network[r++]===e&&this._network[r++]===t&&this._network[r++]===n)return i;return-1}contest(e,t,n){let i=1e30,r=i,a=-1,s=a;for(let u=this._specials,o=this._specials*3;u<this._netSize;u++){let l=this._network[o++]-e;l<0&&(l=-l);let m=this._network[o++]-t;m<0&&(m=-m),l+=m,m=this._network[o++]-n,m<0&&(m=-m),l+=m,l<i&&(i=l,a=u);let b=l-this._bias[u];b<r&&(r=b,s=u),this._freq[u]-=ee._beta*this._freq[u],this._bias[u]+=ee._betaGamma*this._freq[u]}return this._freq[a]+=ee._beta,this._bias[a]-=ee._betaGamma,s}alterSingle(e,t,n,i,r){let a=t*3;this._network[a]-=e*(this._network[a]-n),this._network[a+1]-=e*(this._network[a+1]-i),this._network[a+2]-=e*(this._network[a+2]-r)}alterNeighbors(e,t,n,i,r,a){let s=n-t;s<this._specials-1&&(s=this._specials-1);let u=n+t;u>this._netSize&&(u=this._netSize);let o=n+1,l=n-1,m=1;for(;o<u||l>s;){let b=this._radiusPower[m++];if(o<u){let h=o*3;this._network[h]-=b*(this._network[h]-i)/ee.alphaRadiusBias,this._network[h+1]-=b*(this._network[h+1]-r)/ee.alphaRadiusBias,this._network[h+2]-=b*(this._network[h+2]-a)/ee.alphaRadiusBias,o++}if(l>s){let h=l*3;this._network[h]-=b*(this._network[h]-i)/ee.alphaRadiusBias,this._network[h+1]-=b*(this._network[h+1]-r)/ee.alphaRadiusBias,this._network[h+2]-=b*(this._network[h+2]-a)/ee.alphaRadiusBias,l--}}}learn(e){let t=this._initBiasRadius,n=30+Math.floor((this._samplingFactor-1)/3),i=e.width*e.height,r=Math.floor(i/this._samplingFactor),a=Math.max(Math.floor(r/ee._numCycles),1),s=ee._initAlpha;a===0&&(a=1);let u=t>>ee._radiusBiasShift;u<=1&&(u=0),this.updateRadiusPower(u,s);let o=0,l=0;i<ee._smallImageBytes?(this._samplingFactor=1,o=1):i%ee._prime1!==0?o=ee._prime1:i%ee._prime2!==0?o=ee._prime2:i%ee._prime3!==0?o=ee._prime3:o=ee._prime4;let m=e.width,b=e.height,h=0,c=0,d=0;for(;d<r;){let p=e.getPixel(h,c),g=p.r,x=p.g,y=p.b;d===0&&(this._network[this._bgColor*3]=y,this._network[this._bgColor*3+1]=x,this._network[this._bgColor*3+2]=g);let C=this.specialFind(y,x,g);if(C=C<0?this.contest(y,x,g):C,C>=this._specials){let I=Number(s)/ee._initAlpha;this.alterSingle(I,C,y,x,g),u>0&&this.alterNeighbors(I,u,C,y,x,g)}for(l+=o,h+=o;h>m;)h-=m,c++;for(;l>=i;)l-=i,c-=b;d++,d%a===0&&(s-=Math.floor(s/n),t-=Math.floor(t/ee._radiusDec),u=t>>ee._radiusBiasShift,u<=1&&(u=0),this.updateRadiusPower(u,s))}}fix(){for(let e=0,t=0;e<this._netSize;e++){for(let n=0;n<3;++n,++t){let i=_.clampInt255(Math.trunc(.5+this._network[t]));this._paletteInternal.set(e,n,i)}this._paletteInternal.set(e,3,e)}}inxBuild(){let e=0,t=0;for(let n=0;n<this._netSize;n++){let i=n,r=this._paletteInternal.get(n,1);for(let u=n+1;u<this._netSize;u++)this._paletteInternal.get(u,1)<r&&(i=u,r=this._paletteInternal.get(u,1));let a=n,s=i;if(n!==i){let u=this._paletteInternal.get(s,0);this._paletteInternal.set(s,0,this._paletteInternal.get(a,0)),this._paletteInternal.set(a,0,u),u=this._paletteInternal.get(s,1),this._paletteInternal.set(s,1,this._paletteInternal.get(a,1)),this._paletteInternal.set(a,1,u),u=this._paletteInternal.get(s,2),this._paletteInternal.set(s,2,this._paletteInternal.get(a,2)),this._paletteInternal.set(a,2,u),u=this._paletteInternal.get(s,3),this._paletteInternal.set(s,3,this._paletteInternal.get(a,3)),this._paletteInternal.set(a,3,u)}if(r!==e){this._netIndex[e]=t+n>>1;for(let u=e+1;u<r;u++)this._netIndex[u]=n;e=Math.trunc(r),t=n}}this._netIndex[e]=t+this._maxNetPos>>1;for(let n=e+1;n<256;n++)this._netIndex[n]=this._maxNetPos}copyPalette(){for(let e=0;e<this._netSize;++e)this._palette.setRgb(e,Math.abs(this._paletteInternal.get(e,2)),Math.abs(this._paletteInternal.get(e,1)),Math.abs(this._paletteInternal.get(e,0)))}inxSearch(e,t,n){let i=1e3,r=-1,a=this._netIndex[t],s=a-1;for(;a<this._netSize||s>=0;){if(a<this._netSize){let u=this._paletteInternal.get(a,1)-t;if(u>=i)a=this._netSize;else{u<0&&(u=-u);let o=this._paletteInternal.get(a,0)-e;o<0&&(o=-o),u+=o,u<i&&(o=this._paletteInternal.get(a,2)-n,o<0&&(o=-o),u+=o,u<i&&(i=Math.trunc(u),r=a)),a++}}if(s>=0){let u=s*4,o=t-this._paletteInternal.get(s,1);if(o>=i)s=-1;else{o<0&&(o=-o);let l=this._paletteInternal.get(s,0)-e;l<0&&(l=-l),o+=l,o<i&&(l=this._paletteInternal.get(s,2)-n,l<0&&(l=-l),o+=l,o<i&&(i=Math.trunc(o),r=s)),s--}}}return r}getColorIndex(e){let t=Math.trunc(e.r),n=Math.trunc(e.g),i=Math.trunc(e.b);return this.inxSearch(i,n,t)}getColorIndexRgb(e,t,n){return this.inxSearch(n,t,e)}getQuantizedColor(e){let t=this.getColorIndex(e),n=e.length===4?new Dt(0,0,0,255):new tn(0,0,0);return n.r=this.palette.get(t,0),n.g=this.palette.get(t,1),n.b=this.palette.get(t,2),e.length===4&&(n.a=e.a),n}getIndexImage(e){let t=new Q({width:e.width,height:e.height,numChannels:1,palette:this.palette}),n=e[Symbol.iterator](),i=t[Symbol.iterator](),r,a;for(;r=n.next(),a=i.next(),!r.done&&!a.done;)a.value.setChannel(0,this.getColorIndex(r.value));return t}addImage(e){this.learn(e),this.fix(),this.inxBuild(),this.copyPalette()}},he=ee;he._numCycles=100,he._alphaBiasShift=10,he._initAlpha=1<<ee._alphaBiasShift,he._radiusBiasShift=8,he._radiusBias=1<<ee._radiusBiasShift,he._alphaRadiusBiasShift=ee._alphaBiasShift+ee._radiusBiasShift,he.alphaRadiusBias=1<<ee._alphaRadiusBiasShift,he._radiusDec=30,he._gamma=1024,he._beta=1/1024,he._betaGamma=ee._beta*ee._gamma,he._prime1=499,he._prime2=491,he._prime3=487,he._prime4=503,he._smallImageBytes=3*ee._prime4});var zr,Or=A(()=>{"use strict";zr=class{constructor(){this._buf=[void 0]}get buf(){return this._buf}get n(){return this._buf.length}}});var Ni,Nr=A(()=>{"use strict";G();Ni=class{constructor(e,t,n){this._r=0;this._g=0;this._b=0;this._count=0;this._heapIndex=0;this._paletteIndex=0;this._children=U.fill(8,void 0);this._childCount=0;this._childIndex=0;this._flags=0;this._depth=0;this._childIndex=e,this._depth=t,this._parent=n,n!==void 0&&n._childCount++}get r(){return this._r}set r(e){this._r=e}get g(){return this._g}set g(e){this._g=e}get b(){return this._b}set b(e){this._b=e}get count(){return this._count}set count(e){this._count=e}get heapIndex(){return this._heapIndex}set heapIndex(e){this._heapIndex=e}get paletteIndex(){return this._paletteIndex}set paletteIndex(e){this._paletteIndex=e}get parent(){return this._parent}get children(){return this._children}get childCount(){return this._childCount}set childCount(e){this._childCount=e}get childIndex(){return this._childIndex}get flags(){return this._flags}set flags(e){this._flags=e}get depth(){return this._depth}}});var Is,mn,Ri=A(()=>{"use strict";dn();Or();It();Nr();Xt();Is=class{get palette(){return this._palette}constructor(e,t=256){this._root=new Ni(0,0);let n=new zr;for(let s of e){let u=Math.trunc(s.r),o=Math.trunc(s.g),l=Math.trunc(s.b);this.heapAdd(n,this.nodeInsert(this._root,u,o,l))}let i=t+1;for(;n.n>i;)this.heapAdd(n,this.nodeFold(this.popHeap(n)));for(let s=1;s<n.n;s++){let u=n.buf[s],o=u.count;u.r=Math.round(u.r/o),u.g=Math.round(u.g/o),u.b=Math.round(u.b/o)}let r=[];this.getNodes(r,this._root),this._palette=new Ae(r.length,3);let a=r.length;for(let s=0;s<a;++s){r[s].paletteIndex=s;let u=r[s];this._palette.setRgb(s,u.r,u.g,u.b)}}nodeInsert(e,t,n,i){let r=e,a=0;for(let s=1<<7;++a<8;s>>=1){let u=(n&s?1:0)*4+(t&s?1:0)*2+(i&s?1:0);r.children[u]===void 0&&(r.children[u]=new Ni(u,a,r)),r=r.children[u]}return r.r+=t,r.g+=n,r.b+=i,r.count++,r}popHeap(e){if(e.n<=1)return;let t=e.buf[1];return e.buf[1]=e.buf.pop(),e.buf[1].heapIndex=1,this.downHeap(e,e.buf[1]),t}heapAdd(e,t){if(t.flags&Is._inHeap){this.downHeap(e,t),this.upHeap(e,t);return}t.flags|=Is._inHeap,t.heapIndex=e.n,e.buf.push(t),this.upHeap(e,t)}downHeap(e,t){let n=t.heapIndex;for(;;){let i=n*2;if(i>=e.n||(i+1<e.n&&this.compareNode(e.buf[i],e.buf[i+1])>0&&i++,this.compareNode(t,e.buf[i])<=0))break;e.buf[n]=e.buf[i],e.buf[n].heapIndex=n,n=i}e.buf[n]=t,t.heapIndex=n}upHeap(e,t){let n=t.heapIndex,i;for(;n>1&&(i=e.buf[Math.trunc(n/2)],!(this.compareNode(t,i)>=0));)e.buf[n]=i,i.heapIndex=n,n=Math.trunc(n/2);e.buf[n]=t,t.heapIndex=n}nodeFold(e){if(e.childCount>0)return;let t=e.parent;return t.count+=e.count,t.r+=e.r,t.g+=e.g,t.b+=e.b,t.childCount--,t.children[e.childIndex]=void 0,t}compareNode(e,t){if(e.childCount<t.childCount)return-1;if(e.childCount>t.childCount)return 1;let n=e.count>>e.depth,i=t.count>>t.depth;return n<i?-1:n>i?1:0}getNodes(e,t){if(t.childCount===0){e.push(t);return}for(let n of t.children)n!==void 0&&this.getNodes(e,n)}getColorIndex(e){return this.getColorIndexRgb(Math.trunc(e.r),Math.trunc(e.g),Math.trunc(e.b))}getColorIndexRgb(e,t,n){var r;let i=this._root;for(let a=1<<7;a!==0;a>>=1){let s=(t&a?1:0)*4+(e&a?1:0)*2+(n&a?1:0);if(i.children[s]===void 0)break;i=i.children[s]}return(r=i==null?void 0:i.paletteIndex)!=null?r:0}getQuantizedColor(e){let t=Math.trunc(e.r),n=Math.trunc(e.g),i=Math.trunc(e.b),r=this._root;for(let a=1<<7;a!==0;a>>=1){let s=(n&a?1:0)*4+(t&a?1:0)*2+(i&a?1:0);if(r.children[s]===void 0)break;r=r.children[s]}return t=r.r,n=r.g,i=r.b,new tn(t,n,i)}getIndexImage(e){let t=new Q({width:e.width,height:e.height,numChannels:1,palette:this.palette}),n=e[Symbol.iterator](),i=t[Symbol.iterator](),r,a;for(;r=n.next(),a=i.next(),!r.done&&!a.done;)a.value.setChannel(0,this.getColorIndex(r.value));return t}},mn=Is;mn._inHeap=1});var Rr=A(()=>{"use strict"});var Dr=A(()=>{"use strict"});var Vr=A(()=>{"use strict"});var Tr,Lr=A(()=>{"use strict";oe();G();_e();Tr=class{get length(){return this._coefficients.length}constructor(e){this._size=e,this._coefficients=U.fill(2*e+1,0)}reflect(e,t){return t<0?-t:t>=e?e-(t-e)-1:t}applyCoefficientsLine(e,t,n,i,r,a,s){for(let u=0;u<i;u++){let o=0,l=0,m=0,b=0;for(let d=-this._size,p=0;d<=this._size;++d,++p){let g=this._coefficients[p],x=this.reflect(i,u+d),y=r?e.getPixel(x,n):e.getPixel(n,x);o+=g*y.r,l+=g*y.g,m+=g*y.b,b+=g*y.a}let h=r?t.getPixel(u,n):t.getPixel(n,u),c=s==null?void 0:s.getPixel(h.x,h.y).getChannelNormalized(a);c===void 0?h.setRgba(o,l,m,b):(h.r=_.mix(h.r,o,c),h.g=_.mix(h.g,l,c),h.b=_.mix(h.b,m,c),h.a=_.mix(h.a,b,c))}}getCoefficient(e){return this._coefficients[e]}setCoefficient(e,t){this._coefficients[e]=t}apply(e){var i,r;let t=(i=e.horizontal)!=null?i:!0,n=(r=e.maskChannel)!=null?r:4;if(t)for(let a=0;a<e.src.height;++a)this.applyCoefficientsLine(e.src,e.dst,a,e.src.width,t,n,e.mask);else for(let a=0;a<e.src.width;++a)this.applyCoefficientsLine(e.src,e.dst,a,e.src.height,t,n,e.mask)}scaleCoefficients(e){for(let t=0;t<this._coefficients.length;++t)this._coefficients[t]*=e}}});var Pe,Zn,Er=A(()=>{"use strict";oe();pn();Sn();_e();jn();Ri();ur();zn();It();Wn();Rr();Dr();Vr();Lr();ae();Pe=class{static adjustColor(e){var $,X,ie,te,re,W,j,Re,pe,se,me,fn,Ot,Zt,Mt,Ye,Xe,an,Qt,$a,Wa,Ya;let t=($=e.maskChannel)!=null?$:4,n=e.contrast!==void 0?_.clamp(e.contrast,0,1):void 0,i=e.saturation!==void 0?_.clamp(e.saturation,0,1):void 0,r=e.brightness!==void 0?_.clamp(e.brightness,0,1):void 0,a=e.gamma!==void 0?_.clamp(e.gamma,0,1e3):void 0,s=e.exposure!==void 0?_.clamp(e.exposure,0,1e3):void 0,u=_.clamp((X=e.amount)!=null?X:1,0,1e3),o=e.hue;if(u===0)return e.image;let l=.0174532925,m=.5,b=.5,h=.5,c=.2125,d=.7154,p=.0721,g=e.blacks!==void 0||e.whites!==void 0||e.mids!==void 0,x=0,y=0,C=0,I=0,P=0,F=0,M=0,w=0,k=0;g&&(x=(te=(ie=e.blacks)==null?void 0:ie.rNormalized)!=null?te:0,y=(W=(re=e.blacks)==null?void 0:re.gNormalized)!=null?W:0,C=(Re=(j=e.blacks)==null?void 0:j.bNormalized)!=null?Re:0,I=(se=(pe=e.whites)==null?void 0:pe.rNormalized)!=null?se:0,P=(fn=(me=e.whites)==null?void 0:me.gNormalized)!=null?fn:0,F=(Zt=(Ot=e.whites)==null?void 0:Ot.bNormalized)!=null?Zt:0,M=(Ye=(Mt=e.mids)==null?void 0:Mt.rNormalized)!=null?Ye:0,w=(an=(Xe=e.mids)==null?void 0:Xe.gNormalized)!=null?an:0,k=($a=(Qt=e.mids)==null?void 0:Qt.bNormalized)!=null?$a:0,M=1/(1+2*(M-.5)),w=1/(1+2*(w-.5)),k=1/(1+2*(k-.5)));let B=i!==void 0?1-_.clamp(i,0,1):0,N=n!==void 0?1-_.clamp(n,0,1):0;s!==void 0&&(s=Math.pow(2,s));let O=0,V=0,E=0;if(o!==void 0){o*=l;let rr=Math.sin(o),Kt=Math.cos(o);O=2*Kt/3,V=(-Math.sqrt(3)*rr-Kt)/3,E=(Math.sqrt(3)*rr-Kt+1)/3}for(let rr of e.image.frames)for(let Kt of rr){let xu=Kt.rNormalized,_u=Kt.gNormalized,yu=Kt.bNormalized,Le=xu,Ee=_u,He=yu;if(g&&(Le=Math.pow((Le+x)*I,M),Ee=Math.pow((Ee+y)*P,w),He=Math.pow((He+C)*F,k)),r!==void 0&&r!==1){let Un=_.clamp(r,0,1e3);Le*=Un,Ee*=Un,He*=Un}if(i!==void 0){let Un=Le*c+Ee*d+He*p;Le=Un*B+Le*i,Ee=Un*B+Ee*i,He=Un*B+He*i}if(n!==void 0&&(Le=m*N+Le*n,Ee=b*N+Ee*n,He=h*N+He*n),a!==void 0&&(Le=Math.pow(Le,a),Ee=Math.pow(Ee,a),He=Math.pow(He,a)),s!==void 0&&(Le*=s,Ee*=s,He*=s),o!==void 0&&o!==0){let Un=Le*O+Ee*V+He*E,Pu=Le*E+Ee*O+He*V,Mu=Le*V+Ee*E+He*O;Le=Un,Ee=Pu,He=Mu}let Es=((Ya=(Wa=e.mask)==null?void 0:Wa.getPixel(Kt.x,Kt.y).getChannelNormalized(t))!=null?Ya:1)*u;Le=_.mix(xu,Le,Es),Ee=_.mix(_u,Ee,Es),He=_.mix(yu,He,Es),Kt.rNormalized=Le,Kt.gNormalized=Ee,Kt.bNormalized=He}return e.image}static billboard(e){var a,s,u,o;let t=(a=e.grid)!=null?a:10,n=(s=e.amount)!=null?s:1,i=(u=e.maskChannel)!=null?u:4,r=.2025;for(let l of e.image.frames){let m=l.width,b=l.height,h=m/b,c=.0015625,d=.0015625*h,p=l.clone({skipAnimation:!0});for(let g of l){let x=g.x/(m-1),y=g.y/(b-1),C=Math.floor(x/(t*c)),I=Math.floor(y/(t*d)),P=Math.floor(C*t*c*(m-1)),F=Math.floor(I*t*d*(b-1));if(P>=m||F>=b)continue;let M=p.getPixel(P,F),w=_.fract(x/(t*c)),k=_.fract(y/(t*d)),B=Math.pow(Math.abs(w-.5),2),N=Math.pow(Math.abs(k-.5),2),O=M.r/g.maxChannelValue,V=M.g/g.maxChannelValue,E=M.b/g.maxChannelValue,$=_.smoothStep(r-.1,r+.1,B+N),X=(O+V+E)/3,ie=.3,te=Math.ceil(X/ie),re=ie*te+.3;O=_.mix(re*O,.1,$),V=_.mix(re*V,.1,$),E=_.mix(re*E,.1,$);let W=(o=e.mask)==null?void 0:o.getPixel(g.x,g.y).getChannelNormalized(i),j=(W!=null?W:1)*n;g.r=_.mix(g.r,O*g.maxChannelValue,j),g.g=_.mix(g.g,V*g.maxChannelValue,j),g.b=_.mix(g.b,E*g.maxChannelValue,j)}}return e.image}static bleachBypass(e){var s,u,o,l;let t=(s=e.amount)!=null?s:1,n=(u=e.maskChannel)!=null?u:4,i=.2125,r=.7154,a=.0721;for(let m of e.image.frames)for(let b of m){let h=b.rNormalized,c=b.gNormalized,d=b.bNormalized,p=h*i,g=c*r,x=d*a,y=p+g+x,C=_.clamp((y-.45)*10,0,1),I=2*h*y,P=2*c*y,F=2*d*y,M=1-2*(1-h)*(1-y),w=1-2*(1-c)*(1-y),k=1-2*(1-d)*(1-y);if(((l=(o=e.mask)==null?void 0:o.getPixel(b.x,b.y).getChannelNormalized(n))!=null?l:1)*t!==1){let O=_.mix(I,M,C)*b.maxChannelValue,V=_.mix(P,w,C)*b.maxChannelValue,E=_.mix(F,k,C)*b.maxChannelValue;b.r=_.mix(b.r,O,t),b.g=_.mix(b.g,V,t),b.b=_.mix(b.b,E,t)}else b.rNormalized=_.mix(I,M,C),b.gNormalized=_.mix(P,w,C),b.bNormalized=_.mix(F,k,C)}return e.image}static bulgeDistortion(e){var r,a,s,u,o,l,m;let t=(r=e.scale)!=null?r:.5,n=(a=e.interpolation)!=null?a:0,i=(s=e.maskChannel)!=null?s:4;for(let b of e.image.frames){let h=b.clone({skipAnimation:!0}),c=b.width,d=b.height,p=(u=e.centerX)!=null?u:Math.trunc(c/2),g=(o=e.centerY)!=null?o:Math.trunc(d/2),x=(l=e.radius)!=null?l:Math.trunc(Math.min(c,d)/2),y=x*x;for(let C of b){let I=C.x,P=C.y,F=p-I,M=g-P,w=F*F+M*M;if(I-=p,P-=g,w<y){let N=1-(y-w)/y*t,O=N*N;I*=O,P*=O}I+=p,P+=g;let k=h.getPixelInterpolate(I,P,n),B=(m=e.mask)==null?void 0:m.getPixel(C.x,C.y).getChannelNormalized(i);B===void 0?C.set(k):(C.r=_.mix(C.r,k.r,B),C.g=_.mix(C.g,k.g,B),C.b=_.mix(C.b,k.b,B),C.a=_.mix(C.a,k.a,B))}}return e.image}static bumpToNormal(e){var r;let t=(r=e.strength)!=null?r:2,n=Q.from(e.image),i=e.image.maxChannelValue;for(let a of e.image.frames)for(let s=0;s<a.height;++s)for(let u=0;u<a.width;++u){let o=a.getPixel(u,s).r/i,l=(o-a.getPixel(u<a.width-1?u+1:u,s).r/i)*t,m=(o-a.getPixel(u,s<a.height-1?s+1:s).r/i)*t,b=Math.abs(l)+Math.abs(m);b>1&&(l/=b,m/=b);let h=Math.sqrt(1-l*l-m*m),c=l*.5+.5,d=m*.5+.5,p=h;n.frames[a.frameIndex].setPixelRgb(u,s,c*i,d*i,p*i)}return n}static chromaticAberration(e){var i,r,a;let t=(i=e.shift)!=null?i:5,n=(r=e.maskChannel)!=null?r:4;for(let s of e.image.frames){let u=s.clone({skipAnimation:!0}),o=s.width-1;for(let l of s){let m=_.clamp(l.x-t,0,o),b=_.clamp(l.x+t,0,o),h=u.getPixel(m,l.y),c=u.getPixel(b,l.y),d=(a=e.mask)==null?void 0:a.getPixel(l.x,l.y).getChannelNormalized(n);d===void 0?(l.r=c.r,l.b=h.b):(l.r=_.mix(l.r,c.r,d),l.b=_.mix(l.b,h.b,d))}}return e.image}static colorHalftone(e){var s,u,o,l,m,b,h;let t=(s=e.amount)!=null?s:1,n=(u=e.angle)!=null?u:1,i=(o=e.size)!=null?o:5,r=(l=e.maskChannel)!=null?l:4;n*=.0174533;let a=(c,d,p,g,x)=>{let y=3.14159/i,C=Math.sin(x),I=Math.cos(x),P=c-p,F=d-g,M=(I*P-C*F)*y,w=(C*P+I*F)*y;return Math.sin(M)*Math.sin(w)*4};for(let c of e.image.frames){let d=c.width,p=c.height,g=(m=e.centerX)!=null?m:Math.trunc(d/2),x=(b=e.centerY)!=null?b:Math.trunc(p/2);for(let y of c){let C=y.x,I=y.y,P=1-y.rNormalized,F=1-y.gNormalized,M=1-y.bNormalized,w=Math.min(P,Math.min(F,M));P=(P-w)/(1-w),F=(F-w)/(1-w),M=(M-w)/(1-w),P=_.clamp(P*10-3+a(C,I,g,x,n+.26179),0,1),F=_.clamp(F*10-3+a(C,I,g,x,n+1.30899),0,1),M=_.clamp(M*10-3+a(C,I,g,x,n),0,1),w=_.clamp(w*10-5+a(C,I,g,x,n+.78539),0,1);let k=(1-P-w)*y.maxChannelValue,B=(1-F-w)*y.maxChannelValue,N=(1-M-w)*y.maxChannelValue,O=(h=e.mask)==null?void 0:h.getPixel(y.x,y.y).getChannelNormalized(r),V=(O!=null?O:1)*t;V!==1?(y.r=_.mix(y.r,k,V),y.g=_.mix(y.g,B,V),y.b=_.mix(y.b,N,V)):(y.r=k,y.g=B,y.b=N)}}return e.image}static colorOffset(e){var s,u,o,l,m,b;let t=(s=e.red)!=null?s:0,n=(u=e.green)!=null?u:0,i=(o=e.blue)!=null?o:0,r=(l=e.alpha)!=null?l:0,a=(m=e.maskChannel)!=null?m:4;for(let h of e.image.frames)for(let c of h){let d=(b=e.mask)==null?void 0:b.getPixel(c.x,c.y).getChannelNormalized(a);d===void 0?(c.r+=t,c.g+=n,c.b+=i,c.a+=r):(c.r=_.mix(c.r,c.r+t,d),c.g=_.mix(c.g,c.g+n,d),c.b=_.mix(c.b,c.b+i,d),c.a=_.mix(c.a,c.a+r,d))}return e.image}static contrast(e){var n,i;let t=(n=e.maskChannel)!=null?n:4;if(e.contrast===100)return e.image;if(Pe._contrastCache===void 0||e.contrast!==Pe._contrastCache.lastContrast){Pe._contrastCache={lastContrast:e.contrast,contrast:new Uint8Array(256)};let r=e.contrast*e.contrast/1e4;for(let a=0;a<256;++a)Pe._contrastCache.contrast[a]=_.clampInt255(((a/255-.5)*r+.5)*255)}for(let r of e.image.frames)for(let a of r){let s=(i=e.mask)==null?void 0:i.getPixel(a.x,a.y).getChannelNormalized(t),u=Math.trunc(a.r),o=Math.trunc(a.g),l=Math.trunc(a.b);s===void 0?(a.r=Pe._contrastCache.contrast[u],a.g=Pe._contrastCache.contrast[o],a.b=Pe._contrastCache.contrast[l]):(a.r=_.mix(a.r,Pe._contrastCache.contrast[u],s),a.g=_.mix(a.g,Pe._contrastCache.contrast[o],s),a.b=_.mix(a.b,Pe._contrastCache.contrast[l],s))}return e.image}static convolution(e){var s,u,o,l,m;let t=(s=e.div)!=null?s:1,n=(u=e.offset)!=null?u:0,i=(o=e.amount)!=null?o:1,r=(l=e.maskChannel)!=null?l:4,a=Q.from(e.image);for(let b of e.image.frames){let h=a.frames[b.frameIndex];for(let c of h){let d=0,p=0,g=0;for(let I=0,P=0;I<3;++I){let F=Math.min(Math.max(c.y-1+I,0),e.image.height-1);for(let M=0;M<3;++M,++P){let w=Math.min(Math.max(c.x-1+M,0),e.image.width-1),k=h.getPixel(w,F);d+=k.r*e.filter[P],p+=k.g*e.filter[P],g+=k.b*e.filter[P]}}d=_.clampInt255(d/t+n),p=_.clampInt255(p/t+n),g=_.clampInt255(g/t+n);let x=b.getPixel(c.x,c.y),y=(m=e.mask)==null?void 0:m.getPixel(x.x,x.y).getChannelNormalized(r),C=(y!=null?y:1)*i;x.r=_.mix(x.r,d,C),x.g=_.mix(x.g,p,C),x.b=_.mix(x.b,g,C)}}return e.image}static copyImageChannels(e){var s,u,o;let t=(s=e.scaled)!=null?s:!1,n=(u=e.maskChannel)!=null?u:4,i=e.from.width/e.image.width,r=e.from.height/e.image.height,a=e.from.getPixel(0,0);for(let l of e.image.frames)for(let m of l){t?a.setPosition(Math.floor(m.x*i),Math.floor(m.y*r)):a.setPosition(m.x,m.y);let b=e.red!==void 0?a.getChannelNormalized(e.red):m.rNormalized,h=e.green!==void 0?a.getChannelNormalized(e.green):m.gNormalized,c=e.blue!==void 0?a.getChannelNormalized(e.blue):m.bNormalized,d=e.alpha!==void 0?a.getChannelNormalized(e.alpha):m.aNormalized,p=(o=e.mask)==null?void 0:o.getPixel(m.x,m.y).getChannelNormalized(n);p===void 0?(m.rNormalized=b,m.gNormalized=h,m.bNormalized=c,m.aNormalized=d):(m.rNormalized=_.mix(m.r,b,p),m.gNormalized=_.mix(m.g,h,p),m.bNormalized=_.mix(m.b,c,p),m.aNormalized=_.mix(m.a,d,p))}return e.image}static ditherImage(e){var c,d,p;let t=(c=e.quantizer)!=null?c:new he(e.image),n=(d=e.kernel)!=null?d:2,i=(p=e.serpentine)!=null?p:!1;if(n===0)return t.getIndexImage(e.image);let r=us[n],a=e.image.height,s=e.image.width,u=i?-1:1,o=t.palette,l=new Q({width:s,height:a,numChannels:1,palette:o}),m=e.image[Symbol.iterator](),b=m.next(),h=0;for(let g=0;g<a;g++){i&&(u*=-1);let x=u===1?0:s-1,y=u===1?s:0;for(let C=x;C!==y;C+=u,++h,b=m.next()){let I=b.value,P=Math.trunc(I.getChannel(0)),F=Math.trunc(I.getChannel(1)),M=Math.trunc(I.getChannel(2)),w=t.getColorIndexRgb(P,F,M);l.setPixelRgb(C,g,w,0,0);let k=o.get(w,0),B=o.get(w,1),N=o.get(w,2),O=P-k,V=F-B,E=M-N;if(O===0&&V===0&&E===0)continue;let $=u===1?0:r.length-1,X=u===1?r.length:0;for(let ie=$;ie!==X;ie+=u){let te=Math.trunc(r[ie][1]),re=Math.trunc(r[ie][2]);if(te+C>=0&&te+C<s&&re+g>=0&&re+g<a){let W=r[ie][0];w=h+te+re*s,w*=4;let j=e.image.getPixel(te,re);j.r=Math.max(0,Math.min(255,Math.trunc(j.r+O*W))),j.g=Math.max(0,Math.min(255,Math.trunc(j.g+O*W))),j.b=Math.max(0,Math.min(255,Math.trunc(j.b+O*W)))}}}}return l}static dotScreen(e){var u,o,l,m,b,h,c;let t=(u=e.angle)!=null?u:180,n=(o=e.size)!=null?o:5.75,i=(l=e.amount)!=null?l:1,r=(m=e.maskChannel)!=null?m:4;t*=.0174533;let a=Math.sin(t),s=Math.cos(t);for(let d of e.image.frames){let p=d.width-1,g=d.height-1,x=((b=e.centerX)!=null?b:Math.trunc(p/2))/p,y=((h=e.centerY)!=null?h:Math.trunc(g/2))/g,C=(I,P,F,M)=>{let w=(F-I)*p,k=(M-P)*g,B=(s*w-a*k)*n,N=(a*w+s*k)*n;return Math.sin(B)*Math.sin(N)*4};for(let I of d){let P=I.luminanceNormalized,F=C(x,y,I.x/p,I.y/g),M=(P*10-5+F)*I.maxChannelValue,w=(c=e.mask)==null?void 0:c.getPixel(I.x,I.y).getChannelNormalized(r),k=(w!=null?w:1)*i;I.r=_.mix(I.r,M,k),I.g=_.mix(I.g,M,k),I.b=_.mix(I.b,M,k)}}return e.image}static dropShadow(e){var h;let t=e.blur>=0?e.blur:0,n=(h=e.shadowColor)!=null?h:new Dt(0,0,0,128),i=e.image.width+t*2,r=e.image.height+t*2,a=-t,s=-t,u=i,o=r,l=0,m=0;a+e.hShadow<0&&(l=-(a+e.hShadow),a=-a,u=l),s+e.vShadow<0&&(m=-(s+e.vShadow),s=-s,o+=m),i+a+e.hShadow>u&&(u=i+a+e.hShadow),r+s+e.vShadow>o&&(o=r+s+e.vShadow);let b=new Q({width:u,height:o,numChannels:4});return b.clear(new Dt(255,255,255,0)),D.compositeImage({dst:b,src:e.image,dstX:a,dstY:s}),Pe.remapColors({image:b,red:3,green:3,blue:3}),Pe.scaleRgba({image:b,scale:n}),Pe.gaussianBlur({image:b,radius:t}),D.compositeImage({dst:b,src:e.image,dstX:l,dstY:m}),b}static edgeGlow(e){var i,r,a;let t=(i=e.amount)!=null?i:1,n=(r=e.maskChannel)!=null?r:4;if(t===0)return e.image;for(let s of e.image.frames){let u=Q.from(s,!0),o=s.width,l=s.height;for(let m of s){let b=_.clamp(m.y-1,0,l-1),h=_.clamp(m.y+1,0,l-1),c=_.clamp(m.x-1,0,o-1),d=_.clamp(m.x+1,0,o-1),p=u.getPixel(c,b),g=u.getPixel(m.x,b),x=u.getPixel(d,b),y=u.getPixel(c,m.y),C=m,I=u.getPixel(d,m.y),P=u.getPixel(c,h),F=u.getPixel(m.x,h),M=u.getPixel(d,h),w=p.rNormalized+2*g.rNormalized+x.rNormalized-P.rNormalized-2*F.rNormalized-M.rNormalized,k=p.gNormalized+2*g.gNormalized+x.gNormalized-P.gNormalized-2*F.gNormalized-M.gNormalized,B=p.bNormalized+2*g.bNormalized+x.bNormalized-P.bNormalized-2*F.bNormalized-M.bNormalized,N=p.rNormalized-x.rNormalized+2*y.rNormalized-2*I.rNormalized+P.rNormalized-M.rNormalized,O=p.gNormalized-x.gNormalized+2*y.gNormalized-2*I.gNormalized+P.gNormalized-M.gNormalized,V=p.bNormalized-x.bNormalized+2*y.bNormalized-2*I.bNormalized+P.bNormalized-M.bNormalized,E=Math.sqrt(w*w+N*N),$=Math.sqrt(k*k+O*O),X=Math.sqrt(B*B+V*V),ie=E*2*C.rNormalized*m.maxChannelValue,te=$*2*C.gNormalized*m.maxChannelValue,re=X*2*C.bNormalized*m.maxChannelValue,W=(a=e.mask)==null?void 0:a.getPixel(m.x,m.y).getChannelNormalized(n),j=(W!=null?W:1)*t;m.r=_.mix(m.r,ie,j),m.g=_.mix(m.g,te,j),m.b=_.mix(m.b,re,j)}}return e.image}static emboss(e){var r,a;let t=(r=e.amount)!=null?r:1,n=(a=e.maskChannel)!=null?a:4,i=[1.5,0,0,0,0,0,0,0,-1.5];return Pe.convolution({image:e.image,filter:i,div:1,offset:127,amount:t,mask:e.mask,maskChannel:n})}static gamma(e){var n,i;let t=(n=e.maskChannel)!=null?n:4;for(let r of e.image.frames)for(let a of r){let s=(i=e.mask)==null?void 0:i.getPixel(a.x,a.y).getChannelNormalized(t);s===void 0?(a.rNormalized=Math.pow(a.rNormalized,e.gamma),a.gNormalized=Math.pow(a.gNormalized,e.gamma),a.bNormalized=Math.pow(a.bNormalized,e.gamma)):(a.rNormalized=_.mix(a.rNormalized,Math.pow(a.rNormalized,e.gamma),s),a.gNormalized=_.mix(a.gNormalized,Math.pow(a.gNormalized,e.gamma),s),a.bNormalized=_.mix(a.bNormalized,Math.pow(a.bNormalized,e.gamma),s))}return e.image}static gaussianBlur(e){var i;let t=(i=e.maskChannel)!=null?i:4;if(e.radius<=0)return e.image;let n;if(Pe._gaussianKernelCache.has(e.radius))n=Pe._gaussianKernelCache.get(e.radius);else{let r=e.radius*2/3,a=2*r*r;n=new Tr(e.radius);let s=0;for(let u=-e.radius;u<=e.radius;++u){let o=Math.exp(-(u*u)/a);s+=o,n.setCoefficient(u+e.radius,o)}n.scaleCoefficients(1/s),Pe._gaussianKernelCache.set(e.radius,n)}return Pe.separableConvolution({image:e.image,kernel:n,mask:e.mask,maskChannel:t})}static grayscale(e){var i,r,a;let t=(i=e.amount)!=null?i:1,n=(r=e.maskChannel)!=null?r:4;for(let s of e.image.frames)if(s.hasPalette){let u=s.palette,o=u.numColors;for(let l=0;l<o;++l){let m=z.getLuminanceRgb(u.getRed(l),u.getGreen(l),u.getBlue(l));if(t!==1){let b=_.mix(u.getRed(l),m,t),h=_.mix(u.getGreen(l),m,t),c=_.mix(u.getBlue(l),m,t);u.setRed(l,b),u.setGreen(l,h),u.setBlue(l,c)}else u.setRed(l,m),u.setGreen(l,m),u.setBlue(l,m)}}else for(let u of s){let o=z.getLuminanceRgb(u.r,u.g,u.b),l=(a=e.mask)==null?void 0:a.getPixel(u.x,u.y).getChannelNormalized(n),m=(l!=null?l:1)*t;m!==1?(u.r=_.mix(u.r,o,m),u.g=_.mix(u.g,o,m),u.b=_.mix(u.b,o,m)):(u.r=o,u.g=o,u.b=o)}return e.image}static hdrToLdr(e){let t=(s,u)=>Math.log(s*u+1)/u,n=(s,u)=>{let o=Math.max(0,s*u);return o>1&&(o=1+t(o-1,.184874)),Math.pow(o,.4545)*84.66},i=new Q({width:e.image.width,height:e.image.height,numChannels:e.image.numChannels}),r=e.exposure!==void 0?Math.pow(2,_.clamp(e.exposure+2.47393,-20,20)):1,a=e.image.numChannels;for(let s=0;s<e.image.height;++s)for(let u=0;u<e.image.width;++u){let o=e.image.getPixel(u,s),l=o.rNormalized,m=a===1?l:o.gNormalized,b=a===1?l:o.bNormalized;(!isFinite(l)||isNaN(l))&&(l=0),(!isFinite(m)||isNaN(m))&&(m=0),(!isFinite(b)||isNaN(b))&&(b=0);let h=0,c=0,d=0;e.exposure!==void 0?(h=n(l,r),c=n(m,r),d=n(b,r)):(h=_.clamp(l,0,1)*255,c=_.clamp(m,0,1)*255,d=_.clamp(b,0,1)*255);let p=Math.max(h,Math.max(c,d));if(p>255&&(h=255*(h/p),c=255*(c/p),d=255*(d/p)),e.image.numChannels>3){let g=o.a;(!isFinite(g)||isNaN(g))&&(g=1),i.setPixelRgba(u,s,_.clampInt255(h),_.clampInt255(c),_.clampInt255(d),_.clampInt255(g*255))}else i.setPixelRgb(u,s,_.clampInt255(h),_.clampInt255(c),_.clampInt255(d))}return i}static hexagonPixelate(e){var r,a,s,u,o,l;let t=(r=e.size)!=null?r:5,n=(a=e.amount)!=null?a:1,i=(s=e.maskChannel)!=null?s:4;for(let m of e.image.frames){let b=m.width-1,h=m.height-1,c=((u=e.centerX)!=null?u:Math.trunc(m.width/2))/b,d=((o=e.centerY)!=null?o:Math.trunc(m.height/2))/h,p=m.clone({skipAnimation:!0});for(let g of m){let x=(g.x-c)/t,y=(g.y-d)/t;y/=.866025404,x-=y*.5;let C=0,I=0;x+y-Math.floor(x)-Math.floor(y)<1?(C=Math.floor(x),I=Math.floor(y)):(C=Math.ceil(x),I=Math.ceil(y));let P=Math.ceil(x),F=Math.floor(y),M=Math.floor(x),w=Math.ceil(y),k=x,B=y,N=1-x-y,O=C,V=I,E=1-C-I,$=P,X=F,ie=1-P-F,te=M,re=w,W=1-M-w,j=_.length3(k-O,B-V,N-E),Re=_.length3(k-$,B-X,N-ie),pe=_.length3(k-te,B-re,N-W),se=0,me=0;j<Re?j<pe?(se=C,me=I):(se=M,me=w):Re<pe?(se=P,me=F):(se=M,me=w),se+=me*.5,me*=.866025404,se*=t/b,me*=t/h;let fn=se+c/b,Ot=me+d/h,Zt=_.clamp(fn*b,0,b),Mt=_.clamp(Ot*h,0,h),Ye=p.getPixel(Math.floor(Zt),Math.floor(Mt)),Xe=(l=e.mask)==null?void 0:l.getPixel(g.x,g.y).getChannelNormalized(i),an=(Xe!=null?Xe:1)*n;g.r=_.mix(g.r,Ye.r,an),g.g=_.mix(g.g,Ye.g,an),g.b=_.mix(g.b,Ye.b,an)}}return e.image}static invert(e){var i,r;let t=(i=e.maskChannel)!=null?i:4,n=e.image.maxChannelValue;for(let a of e.image.frames)if(e.image.hasPalette){let s=a.palette,u=s.numColors;for(let o=0;o<u;++o){let l=n-s.getRed(o),m=n-s.getGreen(o),b=n-s.getBlue(o);s.setRgb(o,l,m,b)}}else if(n!==0)for(let s of a){let u=(r=e.mask)==null?void 0:r.getPixel(s.x,s.y).getChannelNormalized(t);u===void 0?(s.r=n-s.r,s.g=n-s.g,s.b=n-s.b):(s.r=_.mix(s.r,n-s.r,u),s.g=_.mix(s.g,n-s.g,u),s.b=_.mix(s.b,n-s.b,u))}return e.image}static luminanceThreshold(e){var a,s,u,o,l,m;let t=(a=e.threshold)!=null?a:.5,n=(s=e.outputColor)!=null?s:!1,i=(u=e.amount)!=null?u:1,r=(o=e.maskChannel)!=null?o:4;for(let b of e.image.frames)for(let h of b){let c=.3*h.rNormalized+.59*h.gNormalized+.11*h.bNormalized;if(n){let d=Math.max(0,c-t),p=Math.sign(d),g=(l=e.mask)==null?void 0:l.getPixel(h.x,h.y).getChannelNormalized(r),x=(g!=null?g:1)*i;h.r=_.mix(h.r,h.r*p,x),h.g=_.mix(h.g,h.g*p,x),h.b*=_.mix(h.b,h.b*p,x)}else{let d=c<t?0:h.maxChannelValue,p=(m=e.mask)==null?void 0:m.getPixel(h.x,h.y).getChannelNormalized(r),g=(p!=null?p:1)*i;h.r=_.mix(h.r,d,g),h.g=_.mix(h.g,d,g),h.b=_.mix(h.b,d,g)}}return e.image}static monochrome(e){var s,u,o,l,m,b,h,c,d;let t=(s=e.amount)!=null?s:1,n=(u=e.maskChannel)!=null?u:4;if(t===0)return e.image;let i=(l=(o=e.color)==null?void 0:o.rNormalized)!=null?l:.45,r=(b=(m=e.color)==null?void 0:m.gNormalized)!=null?b:.6,a=(c=(h=e.color)==null?void 0:h.bNormalized)!=null?c:.3;for(let p of e.image.frames)for(let g of p){let x=g.luminanceNormalized,y=x<.5?2*x*i:1-2*(1-x)*(1-i),C=x<.5?2*x*r:1-2*(1-x)*(1-r),I=x<.5?2*x*a:1-2*(1-x)*(1-a),P=(d=e.mask)==null?void 0:d.getPixel(g.x,g.y).getChannelNormalized(n),F=(P!=null?P:1)*t;g.r=_.mix(g.r,y*g.maxChannelValue,F),g.g=_.mix(g.g,C*g.maxChannelValue,F),g.b=_.mix(g.b,I*g.maxChannelValue,F)}return e.image}static noise(e){var s,u,o,l,m,b,h;let t=(s=e.type)!=null?s:0,n=(u=e.maskChannel)!=null?u:4,i=e.sigma,r=0,a=0;if(i===0&&t!==3)return e.image;if(i<0||t===2){let c=e.image.getColorExtremes();r=c.min,a=c.max}i<0&&(i=-i*(a-r)/100);for(let c of e.image.frames)switch(t){case 0:for(let d of c){let p=d.r+i*ye.grand(),g=d.g+i*ye.grand(),x=d.b+i*ye.grand(),y=d.a,C=(o=e.mask)==null?void 0:o.getPixel(d.x,d.y).getChannelNormalized(n);C===void 0?d.setRgba(p,g,x,y):(d.r=_.mix(d.r,p,C),d.g=_.mix(d.g,g,C),d.b=_.mix(d.b,x,C),d.a=_.mix(d.a,y,C))}break;case 1:for(let d of c){let p=d.r+i*ye.crand(),g=d.g+i*ye.crand(),x=d.b+i*ye.crand(),y=d.a,C=(l=e.mask)==null?void 0:l.getPixel(d.x,d.y).getChannelNormalized(n);C===void 0?d.setRgba(p,g,x,y):(d.r=_.mix(d.r,p,C),d.g=_.mix(d.g,g,C),d.b=_.mix(d.b,x,C),d.a=_.mix(d.a,y,C))}break;case 2:i<0&&(i=-i),a===r&&(r=0,a=255);for(let d of c)if(Math.random()*100<i){let p=Math.random()<.5?a:r,g=Math.random()<.5?a:r,x=Math.random()<.5?a:r,y=d.a,C=(m=e.mask)==null?void 0:m.getPixel(d.x,d.y).getChannelNormalized(n);C===void 0?d.setRgba(p,g,x,y):(d.r=_.mix(d.r,p,C),d.g=_.mix(d.g,g,C),d.b=_.mix(d.b,x,C),d.a=_.mix(d.a,y,C))}break;case 3:for(let d of c){let p=ye.prand(d.r),g=ye.prand(d.g),x=ye.prand(d.b),y=d.a,C=(b=e.mask)==null?void 0:b.getPixel(d.x,d.y).getChannelNormalized(n);C===void 0?d.setRgba(p,g,x,y):(d.r=_.mix(d.r,p,C),d.g=_.mix(d.g,g,C),d.b=_.mix(d.b,x,C),d.a=_.mix(d.a,y,C))}break;case 4:{let d=Math.sqrt(2);for(let p of c){let g=p.r/d,x=g+i*ye.grand(),y=g+i*ye.grand(),C=Math.sqrt(x*x+y*y),I=Math.trunc(C);g=p.g/d,x=g+i*ye.grand(),y=g+i*ye.grand(),C=Math.sqrt(x*x+y*y);let P=Math.trunc(C);g=p.b/d,x=g+i*ye.grand(),y=g+i*ye.grand(),C=Math.sqrt(x*x+y*y);let F=Math.trunc(C),M=p.a,w=(h=e.mask)==null?void 0:h.getPixel(p.x,p.y).getChannelNormalized(n);w===void 0?p.setRgba(I,P,F,M):(p.r=_.mix(p.r,I,w),p.g=_.mix(p.g,P,w),p.b=_.mix(p.b,F,w),p.a=_.mix(p.a,M,w))}break}}return e.image}static normalize(e){var l,m;let t=(l=e.maskChannel)!=null?l:4,n=e.min<e.max?e.min:e.max,i=e.min<e.max?e.max:e.min,r=e.image.getColorExtremes(),a=r.min,s=r.max;if(a===s)return e.image;let u=a,o=s;if(a!==n||s!==i)for(let b of e.image.frames)for(let h of b){let c=(m=e.mask)==null?void 0:m.getPixel(h.x,h.y).getChannelNormalized(t);if(c===void 0)h.r=(h.r-u)/(o-u)*(i-n)+n,h.g=(h.g-u)/(o-u)*(i-n)+n,h.b=(h.b-u)/(o-u)*(i-n)+n,h.a=(h.a-u)/(o-u)*(i-n)+n;else{let d=(h.r-u)/(o-u)*(i-n)+n,p=(h.g-u)/(o-u)*(i-n)+n,g=(h.b-u)/(o-u)*(i-n)+n,x=(h.a-u)/(o-u)*(i-n)+n;h.r=_.mix(h.r,d,c),h.g=_.mix(h.g,p,c),h.b=_.mix(h.b,g,c),h.a=_.mix(h.a,x,c)}}return e.image}static pixelate(e){var r,a,s,u,o;let t=(r=e.mode)!=null?r:0,n=(a=e.amount)!=null?a:1,i=(s=e.maskChannel)!=null?s:4;if(e.size<=1)return e.image;for(let l of e.image.frames){let m=l.width,b=l.height;switch(t){case 0:for(let h of l){let c=Math.trunc(h.x/e.size)*e.size,d=Math.trunc(h.y/e.size)*e.size,p=l.getPixel(c,d),g=(u=e.mask)==null?void 0:u.getPixel(h.x,h.y).getChannelNormalized(i),x=(g!=null?g:1)*n;x===1?h.set(p):(h.r=_.mix(h.r,p.r,x),h.g=_.mix(h.g,p.g,x),h.b=_.mix(h.b,p.b,x),h.a=_.mix(h.a,p.a,x))}break;case 1:{let h=0,c=0,d=0,p=0,g=-1,x=-1;for(let y of l){let C=Math.trunc(y.x/e.size)*e.size,I=Math.trunc(y.y/e.size)*e.size,P=(o=e.mask)==null?void 0:o.getPixel(y.x,y.y).getChannelNormalized(i),F=(P!=null?P:1)*n;if(C!==g||I<=x){g=C,x=I,h=0,c=0,d=0,p=0;for(let w=0,k=I;w<e.size&&k<b;++w,++k)for(let B=0,N=C;B<e.size&&N<m;++B,++N){let O=l.getPixel(N,k);h+=O.r,c+=O.g,d+=O.b,p+=O.a}let M=e.size*e.size;h/=M,c/=M,d/=M,p/=M}y.r=_.mix(y.r,h,F),y.g=_.mix(y.g,c,F),y.b=_.mix(y.b,d,F),y.a=_.mix(y.a,p,F)}}break}}return e.image}static quantize(e){var s,u,o,l;let t=(s=e.numberOfColors)!=null?s:256,n=(u=e.method)!=null?u:0,i=(o=e.dither)!=null?o:0,r=(l=e.ditherSerpentine)!=null?l:!1,a;return n===1||t<4?a=new mn(e.image,t):a=new he(e.image,t),Pe.ditherImage({image:e.image,quantizer:a,kernel:i,serpentine:r})}static reinhardToneMap(e){var a,s;let t=(a=e.maskChannel)!=null?a:4,n=[.212671,.71516,.072169],i=0;for(let u of e.image){let o=u.r,l=u.g,m=u.b,b=n[0]*o+n[1]*l+n[2]*m;b>1e-4&&(i+=Math.log(b))}i=Math.exp(i/(e.image.width*e.image.height));let r=1/(i*i);for(let u of e.image){let o=u.r,l=u.g,m=u.b,b=n[0]*o+n[1]*l+n[2]*m,h=(1+b*r)/(1+b),c=(s=e.mask)==null?void 0:s.getPixel(u.x,u.y).getChannelNormalized(t);c===void 0?(u.r=o*h,u.g=l*h,u.b=m*h):(u.r=_.mix(u.r,o*h,c),u.g=_.mix(u.g,l*h,c),u.b=_.mix(u.b,m*h,c))}return e.image}static remapColors(e){var s,u,o,l;let t=(s=e.red)!=null?s:0,n=(u=e.green)!=null?u:1,i=(o=e.blue)!=null?o:2,r=(l=e.alpha)!=null?l:3,a=[0,0,0,0,0];for(let m of e.image.frames)for(let b of m)a[0]=b.r,a[1]=b.g,a[2]=b.b,a[3]=b.a,(t===4||n===4||i===4||r===4)&&(a[4]=z.getLuminanceRgb(a[0],a[1],a[2])),b.r=a[t],b.g=a[n],b.b=a[i],b.a=a[r];return e.image}static scaleRgba(e){var s,u;let t=(s=e.maskChannel)!=null?s:4,n=e.scale.rNormalized,i=e.scale.gNormalized,r=e.scale.bNormalized,a=e.scale.aNormalized;for(let o of e.image.frames)for(let l of o){let m=(u=e.mask)==null?void 0:u.getPixel(l.x,l.y).getChannelNormalized(t);m===void 0?l.setRgba(l.r*n,l.g*i,l.b*r,l.a*a):(l.r=_.mix(l.r,l.r*n,m),l.g=_.mix(l.g,l.g*i,m),l.b=_.mix(l.b,l.b*r,m),l.a=_.mix(l.a,l.a*a,m))}return e.image}static separableConvolution(e){var i;let t=(i=e.maskChannel)!=null?i:4,n=Q.from(e.image);return e.kernel.apply({src:e.image,dst:n,maskChannel:t,mask:e.mask}),e.kernel.apply({src:n,dst:e.image,horizontal:!1,maskChannel:t,mask:e.mask}),e.image}static sepia(e){var i,r,a;let t=(i=e.amount)!=null?i:1,n=(r=e.maskChannel)!=null?r:4;if(t===0)return e.image;for(let s of e.image.frames)for(let u of s){let o=u.rNormalized,l=u.gNormalized,m=u.bNormalized,b=z.getLuminanceRgb(o,l,m),h=(a=e.mask)==null?void 0:a.getPixel(u.x,u.y).getChannelNormalized(n),c=(h!=null?h:1)*t;u.rNormalized=c*(b+.15)+(1-c)*o,u.gNormalized=c*(b+.07)+(1-c)*l,u.bNormalized=c*(b-.12)+(1-c)*m}return e.image}static sketch(e){var i,r,a;let t=(i=e.amount)!=null?i:1,n=(r=e.maskChannel)!=null?r:4;if(t===0)return e.image;for(let s of e.image.frames){let u=s.width,o=s.height,l=Q.from(s,!0);for(let m of s){let b=_.clamp(m.y-1,0,o-1),h=_.clamp(m.y+1,0,o-1),c=_.clamp(m.x-1,0,u-1),d=_.clamp(m.x+1,0,u-1),p=l.getPixel(c,h).luminanceNormalized,g=l.getPixel(c,b).luminanceNormalized,x=l.getPixel(d,h).luminanceNormalized,y=l.getPixel(d,b).luminanceNormalized,C=l.getPixel(c,m.y).luminanceNormalized,I=l.getPixel(d,m.y).luminanceNormalized,P=l.getPixel(m.x,h).luminanceNormalized,F=l.getPixel(m.x,b).luminanceNormalized,M=-g-2*F-y+p+2*P+x,w=-p-2*C-g+x+2*I+y,k=1-Math.sqrt(M*M+w*w),B=_.clamp(k*m.r,0,m.maxChannelValue),N=_.clamp(k*m.g,0,m.maxChannelValue),O=_.clamp(k*m.b,0,m.maxChannelValue),V=(a=e.mask)==null?void 0:a.getPixel(m.x,m.y).getChannelNormalized(n),E=(V!=null?V:1)*t;m.r=_.mix(m.r,B,E),m.g=_.mix(m.g,N,E),m.b=_.mix(m.b,O,E)}}return e.image}static smooth(e){var i;let t=(i=e.maskChannel)!=null?i:4,n=[1,1,1,1,e.weight,1,1,1,1];return Pe.convolution({image:e.image,filter:n,div:e.weight+8,offset:0,mask:e.mask,maskChannel:t})}static sobel(e){var i,r,a;let t=(i=e.amount)!=null?i:1,n=(r=e.maskChannel)!=null?r:4;if(t===0)return e.image;for(let s of e.image.frames){let u=Q.from(s,!0),o=s.width,l=s.height;for(let m of s){let b=_.clamp(m.y-1,0,l-1),h=_.clamp(m.y+1,0,l-1),c=_.clamp(m.x-1,0,o-1),d=_.clamp(m.x+1,0,o-1),p=u.getPixel(c,h).luminanceNormalized,g=u.getPixel(c,b).luminanceNormalized,x=u.getPixel(d,h).luminanceNormalized,y=u.getPixel(d,b).luminanceNormalized,C=u.getPixel(c,m.y).luminanceNormalized,I=u.getPixel(d,m.y).luminanceNormalized,P=u.getPixel(m.x,h).luminanceNormalized,F=u.getPixel(m.x,b).luminanceNormalized,M=-g-2*F-y+p+2*P+x,w=-p-2*C-g+x+2*I+y,k=Math.sqrt(M*M+w*w)*m.maxChannelValue,B=(a=e.mask)==null?void 0:a.getPixel(m.x,m.y).getChannelNormalized(n),N=(B!=null?B:1)*t,O=1-N;m.r=k*N+m.r*O,m.g=k*N+m.g*O,m.b=k*N+m.b*O}}return e.image}static stretchDistortion(e){var i,r,a,s,u;let t=(i=e.interpolation)!=null?i:0,n=(r=e.maskChannel)!=null?r:4;for(let o of e.image.frames){let l=o.clone({skipAnimation:!0}),m=o.width-1,b=o.height-1,h=(a=e.centerX)!=null?a:Math.trunc(o.width/2),c=(s=e.centerY)!=null?s:Math.trunc(o.height/2),d=2*(h/m)-1,p=2*(c/b)-1;for(let g of o){let x=g.x/m*2-1,y=g.y/b*2-1;x-=d,y-=p;let C=Math.sign(x),I=Math.sign(y);x=Math.abs(x),y=Math.abs(y),x=(.5*x+.5*_.smoothStep(.25,.5,x)*x)*C,y=(.5*y+.5*_.smoothStep(.25,.5,y)*y)*I,x+=d,y+=p;let P=_.clamp((x/2+.5)*m,0,m-1),F=_.clamp((y/2+.5)*b,0,b-1),M=l.getPixelInterpolate(P,F,t),w=(u=e.mask)==null?void 0:u.getPixel(g.x,g.y).getChannelNormalized(n);w===void 0?(g.r=M.r,g.g=M.g,g.b=M.b):(g.r=_.mix(g.r,M.r,w),g.g=_.mix(g.g,M.g,w),g.b=_.mix(g.b,M.b,w))}}return e.image}static vignette(e){var h,c,d,p,g,x,y,C,I,P,F,M,w;let t=(h=e.start)!=null?h:.3,n=(c=e.end)!=null?c:.85,i=(d=e.amount)!=null?d:.9,r=(p=e.maskChannel)!=null?p:4,a=e.image.height-1,s=e.image.width-1,u=(x=(g=e.color)==null?void 0:g.rNormalized)!=null?x:0,o=(C=(y=e.color)==null?void 0:y.gNormalized)!=null?C:0,l=(P=(I=e.color)==null?void 0:I.bNormalized)!=null?P:0,m=(M=(F=e.color)==null?void 0:F.aNormalized)!=null?M:1,b=s/a;for(let k of e.image.frames)for(let B of k){let N=(.5-B.x/s)*b,O=.5-B.y/a,V=Math.sqrt(N*N+O*O);V=1-_.smoothStep(n,t,V);let E=_.mix(B.rNormalized,u,V)*B.maxChannelValue,$=_.mix(B.gNormalized,o,V)*B.maxChannelValue,X=_.mix(B.bNormalized,l,V)*B.maxChannelValue,ie=_.mix(B.aNormalized,m,V)*B.maxChannelValue,te=(w=e.mask)==null?void 0:w.getPixel(B.x,B.y).getChannelNormalized(r),re=(te!=null?te:1)*i;B.r=_.mix(B.r,E,re),B.g=_.mix(B.g,$,re),B.b=_.mix(B.b,X,re),B.a=_.mix(B.a,ie,re)}return e.image}},Zn=Pe;Zn._gaussianKernelCache=new Map});var Ps,An,Fn=A(()=>{"use strict";je();be();Ps=class{get fileLength(){return this._fileLength}set imageOffset(e){this._imageOffset=e}get imageOffset(){return this._imageOffset}constructor(e){if(!Ps.isValidFile(e))throw new T("Not a bitmap file.");e.skip(2),this._fileLength=e.readInt32(),e.skip(4),this._imageOffset=e.readInt32()}static isValidFile(e){return e.length<2?!1:Y.from(e).readUint16()===Ps.signature}},An=Ps;An.signature=19778});var Di=A(()=>{"use strict"});var Vi=A(()=>{"use strict";Jt();be();Xt();Di();Fn()});var Ti=A(()=>{"use strict";H();je();It();Fn();Vi()});var Hr=A(()=>{"use strict";H();At();Xt();Di();Fn()});var cs=A(()=>{"use strict"});var bs=A(()=>{"use strict"});var qr=A(()=>{"use strict";Ti()});var fs=A(()=>{"use strict"});var jt,Li=A(()=>{"use strict";en();Xt();jt=class{get numColors(){return this._numColors}get palette(){return this._palette}get bitsPerPixel(){return this._bitsPerPixel}set transparent(e){this._transparent=e}get transparent(){return this._transparent}constructor(e,t){this._numColors=e,this._palette=t!=null?t:new Ae(e,3),this._bitsPerPixel=jt.bitSize(e)}static bitSize(e){for(let t=1;t<=8;t++)if(1<<t>=e)return t;return 0}static from(e){let t=Ae.from(e._palette),n=new jt(e.numColors,t);return n._bitsPerPixel=e._bitsPerPixel,n._transparent=e._transparent,n}getColor(e){let t=this.getRed(e),n=this.getGreen(e),i=this.getBlue(e),r=this.getAlpha(e);return ge.rgba(t,n,i,r)}setColor(e,t,n,i){this._palette.setRgb(e,t,n,i)}getRed(e){return Math.trunc(this._palette.getRed(e))}getGreen(e){return Math.trunc(this._palette.getGreen(e))}getBlue(e){return Math.trunc(this._palette.getBlue(e))}getAlpha(e){return e===this._transparent?0:255}getPalette(){if(this._transparent===void 0)return this._palette;let e=new Ae(this._palette.numColors,4),t=this._palette.numColors;for(let n=0;n<t;++n)e.setRgba(n,this.getRed(n),this.getGreen(n),this.getBlue(n),this.getAlpha(n));return e}}});var Gr,$r=A(()=>{"use strict";Li();Gr=class{constructor(e){this._duration=80;this._clearFrame=!0;this._x=e.readUint16(),this._y=e.readUint16(),this._width=e.readUint16(),this._height=e.readUint16();let t=e.readByte(),n=(t&7)+1;if(this._interlaced=(t&64)!==0,t&128){this._colorMap=new jt(1<<n);for(let i=0;i<this._colorMap.numColors;++i)this._colorMap.setColor(i,e.readByte(),e.readByte(),e.readByte())}this._inputPosition=e.position}get x(){return this._x}get y(){return this._y}get width(){return this._width}get height(){return this._height}get interlaced(){return this._interlaced}get colorMap(){return this._colorMap}set colorMap(e){this._colorMap=e}set duration(e){this._duration=e}get duration(){return this._duration}set clearFrame(e){this._clearFrame=e}get clearFrame(){return this._clearFrame}get inputPosition(){return this._inputPosition}}});var Wr,Yr=A(()=>{"use strict";Wr=class{constructor(e){this._width=0;this._height=0;this._backgroundColor=void 0;this._isGif89=!1;var t,n,i,r,a;this._width=(t=e==null?void 0:e.width)!=null?t:0,this._height=(n=e==null?void 0:e.height)!=null?n:0,this._backgroundColor=e==null?void 0:e.backgroundColor,this._frames=(i=e==null?void 0:e.frames)!=null?i:new Array,this._colorResolution=(r=e==null?void 0:e.colorResolution)!=null?r:0,this._globalColorMap=e==null?void 0:e.globalColorMap,this._isGif89=(a=e==null?void 0:e.isGif89)!=null?a:!1}get width(){return this._width}get height(){return this._height}get backgroundColor(){return this._backgroundColor}get frames(){return this._frames}get colorResolution(){return this._colorResolution}get globalColorMap(){return this._globalColorMap}get isGif89(){return this._isGif89}get numFrames(){return this.frames.length}}});var Z,Ne,Xr=A(()=>{"use strict";je();G();Li();$r();Yr();It();en();Z=class{constructor(e){this._repeat=0;this._bitsPerPixel=0;this._currentShiftDWord=0;this._currentShiftState=0;this._stackPtr=0;this._lastCode=0;this._maxCode1=0;this._runningBits=0;this._runningCode=0;this._eofCode=0;this._clearCode=0;e!==void 0&&this.startDecode(e)}get numFrames(){return this._info!==void 0?this._info.numFrames:0}static getPrefixChar(e,t,n){let i=t,r=0;for(;i>n&&r++<=Z._lzMaxCode;){if(i>Z._lzMaxCode)return Z._noSuchCode;i=e[i]}return i}static updateImage(e,t,n,i){if(n!==void 0){let r=i.length;for(let a=0;a<r;++a)e.setPixelRgb(a,t,i[a],0,0)}}getInfo(){if(this._input===void 0)return!1;let e=this._input.readString(Z._stampSize);if(e!==Z._gif87Stamp&&e!==Z._gif89Stamp)return!1;let t=this._input.readUint16(),n=this._input.readUint16(),i=this._input.readByte(),r=((i&112)+1>>4)+1,a=(i&7)+1,s=new ge(new Uint8Array([this._input.readByte()]));this._input.skip(1);let u;if(i&128){u=new jt(1<<a);for(let l=0;l<u.numColors;++l){let m=this._input.readByte(),b=this._input.readByte(),h=this._input.readByte();u.setColor(l,m,b,h)}}let o=e===Z._gif89Stamp;return this._info=new Wr({width:t,height:n,colorResolution:r,backgroundColor:s,globalColorMap:u,isGif89:o}),!0}skipImage(){if(this._input===void 0||this._input.isEOS)return;let e=new Gr(this._input);return this._input.skip(1),this.skipRemainder(),e}skipRemainder(){if(this._input===void 0||this._input.isEOS)return!0;let e=this._input.readByte();for(;e!==0&&!this._input.isEOS;){if(this._input.skip(e),this._input.isEOS)return!0;e=this._input.readByte()}return!0}readApplicationExt(e){let t=e.readByte();if(e.readString(t)==="NETSCAPE2.0"){let i=e.readByte(),r=e.readByte();i===3&&r===1&&(this._repeat=e.readUint16())}else this.skipRemainder()}readGraphicsControlExt(e){e.readByte();let t=e.readByte(),n=e.readUint16(),i=e.readByte();e.readByte();let r=t>>2&7,a=t&1;if(e.peekBytes(1).getByte(0)===Z._imageDescRecordType){e.skip(1);let u=this.skipImage();if(u===void 0)return;u.duration=n,u.clearFrame=r===2,a!==0&&(u.colorMap===void 0&&this._info.globalColorMap!==void 0&&(u.colorMap=jt.from(this._info.globalColorMap)),u.colorMap!==void 0&&(u.colorMap.transparent=i)),this._info.frames.push(u)}}getLine(e){return this._pixelCount=this._pixelCount-e.length,this.decompressLine(e)?(this._pixelCount===0&&this.skipRemainder(),!0):!1}decompressLine(e){if(this._stackPtr>Z._lzMaxCode)return!1;let t=e.length,n=0;if(this._stackPtr!==0)for(;this._stackPtr!==0&&n<t;)e[n++]=this._stack[--this._stackPtr];let i;for(;n<t;){if(this._currentCode=this.decompressInput(),this._currentCode===void 0||this._currentCode===this._eofCode)return!1;if(this._currentCode===this._clearCode){for(let r=0;r<=Z._lzMaxCode;r++)this._prefix[r]=Z._noSuchCode;this._runningCode=this._eofCode+1,this._runningBits=this._bitsPerPixel+1,this._maxCode1=1<<this._runningBits,this._lastCode=Z._noSuchCode}else{if(this._currentCode<this._clearCode)e[n++]=this._currentCode;else{if(this._prefix[this._currentCode]===Z._noSuchCode)if(this._currentCode===this._runningCode-2){i=this._lastCode;let a=Z.getPrefixChar(this._prefix,this._lastCode,this._clearCode);this._stack[this._stackPtr++]=a,this._suffix[this._runningCode-2]=a}else return!1;else i=this._currentCode;let r=0;for(;r++<=Z._lzMaxCode&&i>this._clearCode&&i<=Z._lzMaxCode;)this._stack[this._stackPtr++]=this._suffix[i],i=this._prefix[i];if(r>=Z._lzMaxCode||i>Z._lzMaxCode)return!1;for(this._stack[this._stackPtr++]=i;this._stackPtr!==0&&n<t;)e[n++]=this._stack[--this._stackPtr]}this._lastCode!==Z._noSuchCode&&this._prefix[this._runningCode-2]===Z._noSuchCode&&(this._prefix[this._runningCode-2]=this._lastCode,this._currentCode===this._runningCode-2?this._suffix[this._runningCode-2]=Z.getPrefixChar(this._prefix,this._lastCode,this._clearCode):this._suffix[this._runningCode-2]=Z.getPrefixChar(this._prefix,this._currentCode,this._clearCode)),this._lastCode=this._currentCode}}return!0}decompressInput(){if(this._runningBits>Z._lzBits)return;for(;this._currentShiftState<this._runningBits;){let t=this.bufferedInput();this._currentShiftDWord|=t<<this._currentShiftState,this._currentShiftState+=8}let e=this._currentShiftDWord&Z._codeMasks[this._runningBits];return this._currentShiftDWord>>=this._runningBits,this._currentShiftState-=this._runningBits,this._runningCode<Z._lzMaxCode+2&&++this._runningCode>this._maxCode1&&this._runningBits<Z._lzBits&&(this._maxCode1<<=1,this._runningBits++),e}bufferedInput(){let e=0;if(this._buffer[0]===0){if(this._buffer[0]=this._input.readByte(),this._buffer[0]===0)return;let t=this._input.readBytes(this._buffer[0]).toUint8Array();U.copyRange(t,0,this._buffer[0],this._buffer,1),e=this._buffer[1],this._buffer[1]=2,this._buffer[0]--}else e=this._buffer[this._buffer[1]++],this._buffer[0]--;return e}initDecode(){this._buffer=new Uint8Array(256),this._stack=new Uint8Array(Z._lzMaxCode),this._suffix=new Uint8Array(Z._lzMaxCode+1),this._prefix=new Uint32Array(Z._lzMaxCode+1)}decodeImage(e){if(this._input===void 0||this._info===void 0)return;this._buffer===void 0&&this.initDecode(),this._bitsPerPixel=this._input.readByte(),this._clearCode=1<<this._bitsPerPixel,this._eofCode=this._clearCode+1,this._runningCode=this._eofCode+1,this._runningBits=this._bitsPerPixel+1,this._maxCode1=1<<this._runningBits,this._stackPtr=0,this._lastCode=Z._noSuchCode,this._currentShiftState=0,this._currentShiftDWord=0,this._buffer[0]=0,this._prefix.fill(Z._noSuchCode,0,this._prefix.length);let t=e.width,n=e.height;if(e.x+t>this._info.width||e.y+n>this._info.height)return;let i=e.colorMap!==void 0?e.colorMap:this._info.globalColorMap;this._pixelCount=t*n;let r=new Q({width:t,height:n,numChannels:1,palette:i.getPalette()}),a=new Uint8Array(t);if(e.interlaced){let s=e.y;for(let u=0,o=0;u<4;++u)for(let l=s+Z._interlacedOffset[u];l<s+n;l+=Z._interlacedJump[u],++o){if(!this.getLine(a))return r;Z.updateImage(r,l,i,a)}}else for(let s=0;s<n;++s){if(!this.getLine(a))return r;Z.updateImage(r,s,i,a)}return r}isValidFile(e){return this._input=new Y({buffer:e}),this.getInfo()}startDecode(e){if(this._input=new Y({buffer:e}),!!this.getInfo()){try{for(;!this._input.isEOS;)switch(this._input.readByte()){case Z._imageDescRecordType:{let n=this.skipImage();if(n===void 0)return this._info;this._info.frames.push(n);break}case Z._extensionRecordType:{let n=this._input.readByte();n===Z._applicationExt?this.readApplicationExt(this._input):n===Z._graphicControlExt?this.readGraphicsControlExt(this._input):this.skipRemainder();break}case Z._terminateRecordType:return this._info;default:break}}catch(t){}return this._info}}decode(e,t){if(this.startDecode(e)===void 0||this._info===void 0)return;if(this._info.numFrames===1)return this.decodeFrame(t!=null?t:0);let n,i;for(let r=0;r<this._info.numFrames;++r){let a=this._info.frames[r],s=this.decodeFrame(r);if(s===void 0)return;if(s.frameDuration=a.duration*10,n===void 0||i===void 0){n=s,i=s,s.loopCount=this._repeat;continue}if(s.width===i.width&&s.height===i.height&&a.x===0&&a.y===0&&a.clearFrame){i=s,n.addFrame(i);continue}if(a.clearFrame){let u=a.colorMap!==void 0?a.colorMap:this._info.globalColorMap;i=new Q({width:i.width,height:i.height,numChannels:1,palette:u.getPalette()}),i.clear(u.getColor(this._info.backgroundColor.r))}else i=Q.from(i);i.frameDuration=s.frameDuration;for(let u of s)u.a!==0&&i.setPixel(u.x+a.x,u.y+a.y,u);n.addFrame(i)}return n}decodeFrame(e){if(this._input===void 0||this._info===void 0||e>=this._info.frames.length||e<0)return;let t=this._info.frames[e];return this._input.offset=t.inputPosition,this.decodeImage(this._info.frames[e])}},Ne=Z;Ne._stampSize=6,Ne._gif87Stamp="GIF87a",Ne._gif89Stamp="GIF89a",Ne._imageDescRecordType=44,Ne._extensionRecordType=33,Ne._terminateRecordType=59,Ne._graphicControlExt=249,Ne._applicationExt=255,Ne._lzMaxCode=4095,Ne._lzBits=12,Ne._noSuchCode=4098,Ne._codeMasks=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095],Ne._interlacedOffset=[0,4,2,1],Ne._interlacedJump=[8,8,4,2]});var jr=A(()=>{"use strict"});var Fe,Pt,Zr=A(()=>{"use strict";jn();At();nn();jr();Ri();Er();be();Wn();Fe=class{constructor(e){this._curAccum=0;this._curBits=0;this._nBits=0;this._initBits=0;this._eofCode=0;this._maxCode=0;this._clearCode=0;this._freeEnt=0;this._clearFlag=!1;this._blockSize=0;this._supportsAnimation=!0;var t,n,i,r,a;this._delay=(t=e==null?void 0:e.delay)!=null?t:80,this._repeat=(n=e==null?void 0:e.repeat)!=null?n:0,this._numColors=256,this._quantizerType=1,this._samplingFactor=(i=e==null?void 0:e.samplingFactor)!=null?i:10,this._dither=(r=e==null?void 0:e.dither)!=null?r:2,this._ditherSerpentine=(a=e==null?void 0:e.ditherSerpentine)!=null?a:!1,this._encodedFrames=0}get supportsAnimation(){return this._supportsAnimation}addImage(e,t,n){if(!e.hasPalette)throw new T("GIF can only encode palette images.");let i=e.palette,r=i.numColors,a=this._outputBuffer;a.writeByte(Fe._imageDescRecordType),a.writeUint16(0),a.writeUint16(0),a.writeUint16(t),a.writeUint16(n);let s=i.toUint8Array();a.writeByte(135);let u=i.numChannels;if(u===3)a.writeBytes(s);else if(u===4)for(let o=0,l=0;o<r;++o,l+=4)a.writeByte(s[l]),a.writeByte(s[l+1]),a.writeByte(s[l+2]);else if(u===1||u===2)for(let o=0,l=0;o<r;++o,l+=u){let m=s[l];a.writeByte(m),a.writeByte(m),a.writeByte(m)}for(let o=r;o<256;++o)a.writeByte(0),a.writeByte(0),a.writeByte(0);this.encodeLZW(e)}encodeLZW(e){this._curAccum=0,this._curBits=0,this._blockSize=0,this._block=new Uint8Array(256);let t=8;this._outputBuffer.writeByte(t);let n=new Int32Array(Fe._hSize),i=new Int32Array(Fe._hSize),r=e[Symbol.iterator](),a=r.next();this._initBits=t+1,this._nBits=this._initBits,this._maxCode=(1<<this._nBits)-1,this._clearCode=1<<this._initBits-1,this._eofCode=this._clearCode+1,this._clearFlag=!1,this._freeEnt=this._clearCode+2;let s=!1,u=()=>{if(s)return Fe._eof;let h=Math.trunc(a.value.index);return a=r.next(),a.done&&(s=!0),h},o=u(),l=0;for(let h=Fe._hSize;h<65536;h*=2)l++;l=8-l;let m=Fe._hSize;for(let h=0;h<m;++h)n[h]=-1;this.output(this._clearCode);let b=!0;for(;b;){b=!1;let h=u();for(;h!==Fe._eof;){let c=(h<<Fe._bits)+o,d=h<<l^o;if(n[d]===c){o=i[d],h=u();continue}else if(n[d]>=0){let p=m-d;d===0&&(p=1);do if((d-=p)<0&&(d+=m),n[d]===c){o=i[d],b=!0;break}while(n[d]>=0);if(b)break}if(this.output(o),o=h,this._freeEnt<1<<Fe._bits)i[d]=this._freeEnt++,n[d]=c;else{for(let p=0;p<Fe._hSize;++p)n[p]=-1;this._freeEnt=this._clearCode+2,this._clearFlag=!0,this.output(this._clearCode)}h=u()}}this.output(o),this.output(this._eofCode),this._outputBuffer.writeByte(0)}output(e){for(this._curAccum&=Fe._masks[this._curBits],this._curBits>0?this._curAccum|=e<<this._curBits:this._curAccum=e,this._curBits+=this._nBits;this._curBits>=8;)this.addToBlock(this._curAccum&255),this._curAccum>>=8,this._curBits-=8;if((this._freeEnt>this._maxCode||this._clearFlag)&&(this._clearFlag?(this._nBits=this._initBits,this._maxCode=(1<<this._nBits)-1,this._clearFlag=!1):(++this._nBits,this._nBits===Fe._bits?this._maxCode=1<<Fe._bits:this._maxCode=(1<<this._nBits)-1)),e===this._eofCode){for(;this._curBits>0;)this.addToBlock(this._curAccum&255),this._curAccum>>=8,this._curBits-=8;this.writeBlock()}}writeBlock(){this._blockSize>0&&(this._outputBuffer.writeByte(this._blockSize),this._outputBuffer.writeBytes(this._block,this._blockSize),this._blockSize=0)}addToBlock(e){this._block[this._blockSize++]=e,this._blockSize>=254&&this.writeBlock()}writeApplicationExt(){this._outputBuffer.writeByte(Fe._extensionRecordType),this._outputBuffer.writeByte(Fe._applicationExt),this._outputBuffer.writeByte(11);let e=we.getCodePoints("NETSCAPE2.0");this._outputBuffer.writeBytes(e),this._outputBuffer.writeBytes(new Uint8Array([3,1])),this._outputBuffer.writeUint16(this._repeat),this._outputBuffer.writeByte(0)}writeGraphicsCtrlExt(e){var o;this._outputBuffer.writeByte(Fe._extensionRecordType),this._outputBuffer.writeByte(Fe._graphicControlExt),this._outputBuffer.writeByte(4);let t=0,n=0,i=e.palette,r=i.numChannels,a=r-1;if(r===4||r===2){let l=i.toUint8Array(),m=i.numColors;for(let b=0,h=a;b<m;++b,h+=r)if(l[h]===0){n=1,t=b;break}}let u=0|2<<2|0|n;this._outputBuffer.writeByte(u),this._outputBuffer.writeUint16((o=this._lastImageDuration)!=null?o:this._delay),this._outputBuffer.writeByte(t),this._outputBuffer.writeByte(0)}writeHeader(e,t){let n=we.getCodePoints(Fe._gif89Id);this._outputBuffer.writeBytes(n),this._outputBuffer.writeUint16(e),this._outputBuffer.writeUint16(t),this._outputBuffer.writeByte(0),this._outputBuffer.writeByte(0),this._outputBuffer.writeByte(0)}finish(){let e;return this._outputBuffer===void 0||(this._encodedFrames===0?(this.writeHeader(this._width,this._height),this.writeApplicationExt()):this.writeGraphicsCtrlExt(this._lastImage),this.addImage(this._lastImage,this._width,this._height),this._outputBuffer.writeByte(Fe._terminateRecordType),this._lastImage=void 0,this._lastColorMap=void 0,this._encodedFrames=0,e=this._outputBuffer.getBytes(),this._outputBuffer=void 0),e}addFrame(e,t){if(this._outputBuffer===void 0){this._outputBuffer=new Be,e.hasPalette?this._lastImage=e:(this._quantizerType===1?this._lastColorMap=new he(e,this._numColors,this._samplingFactor):this._lastColorMap=new mn(e,this._numColors),this._lastImage=Zn.ditherImage({image:e,quantizer:this._lastColorMap,kernel:this._dither,serpentine:this._ditherSerpentine})),this._lastImageDuration=t,this._width=e.width,this._height=e.height;return}this._encodedFrames===0&&(this.writeHeader(this._width,this._height),this.writeApplicationExt()),this.writeGraphicsCtrlExt(this._lastImage),this.addImage(this._lastImage,this._width,this._height),this._encodedFrames++,e.hasPalette?this._lastImage=e:(this._quantizerType===1?this._lastColorMap=new he(e,this._numColors,this._samplingFactor):this._lastColorMap=new mn(e,this._numColors),this._lastImage=Zn.ditherImage({image:e,quantizer:this._lastColorMap,kernel:this._dither,serpentine:this._ditherSerpentine})),this._lastImageDuration=t}encode(e,t=!1){if(!e.hasAnimation||t)return this.addFrame(e),this.finish();this._repeat=e.loopCount;for(let n of e.frames)this.addFrame(n,Math.trunc(n.frameDuration/10));return this.finish()}},Pt=Fe;Pt._gif89Id="GIF89a",Pt._imageDescRecordType=44,Pt._extensionRecordType=33,Pt._terminateRecordType=59,Pt._applicationExt=255,Pt._graphicControlExt=249,Pt._eof=-1,Pt._bits=12,Pt._hSize=5003,Pt._masks=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535]});var Qr=A(()=>{"use strict";Vi()});var Kr=A(()=>{"use strict"});var Jr=A(()=>{"use strict"});var ea=A(()=>{"use strict";G();Kr();Jr()});var Qn=A(()=>{"use strict"});var Ei=A(()=>{"use strict"});var Ou,Hi=A(()=>{"use strict";Ou=ws(ps());pi();At();nn();Qn();H();jn();Ei()});var ta=A(()=>{"use strict";At();be();Hi()});var na=A(()=>{"use strict";ta()});var ia,ra=A(()=>{"use strict";ia=class{get hSamples(){return this._hSamples}get maxHSamples(){return this._maxHSamples}get vSamples(){return this._vSamples}get maxVSamples(){return this._maxVSamples}get lines(){return this._lines}get hScaleShift(){return this._hScaleShift}get vScaleShift(){return this._vScaleShift}constructor(e,t,n,i,r){this._hSamples=e,this._maxHSamples=t,this._vSamples=n,this._maxVSamples=i,this._lines=r,this._hScaleShift=this._hSamples===1&&this._maxHSamples===2?1:0,this._vScaleShift=this._vSamples===1&&this._maxVSamples===2?1:0}}});var aa,sa=A(()=>{"use strict";aa=class{get version(){return this._version}get flags0(){return this._flags0}get flags1(){return this._flags1}get transformCode(){return this._transformCode}constructor(e,t,n,i){this._version=e,this._flags0=t,this._flags1=n,this._transformCode=i}}});var ua,oa=A(()=>{"use strict";ua=class{constructor(e,t,n,i){this._blocks=new Array;this._blocksPerLine=0;this._blocksPerColumn=0;this._huffmanTableDC=[];this._huffmanTableAC=[];this._pred=0;this._hSamples=e,this._vSamples=t,this._quantizationTableList=n,this._quantizationIndex=i}get hSamples(){return this._hSamples}get vSamples(){return this._vSamples}get blocks(){return this._blocks}get blocksPerLine(){return this._blocksPerLine}get blocksPerColumn(){return this._blocksPerColumn}set huffmanTableDC(e){this._huffmanTableDC=e}get huffmanTableDC(){return this._huffmanTableDC}set huffmanTableAC(e){this._huffmanTableAC=e}get huffmanTableAC(){return this._huffmanTableAC}set pred(e){this._pred=e}get pred(){return this._pred}get quantizationTable(){return this._quantizationTableList[this._quantizationIndex]}setBlocks(e,t,n){this._blocks=e,this._blocksPerLine=t,this._blocksPerColumn=n}}});var la,ma=A(()=>{"use strict";G();la=class{constructor(e,t,n,i,r,a,s){this._maxHSamples=0;this._maxVSamples=0;this._mcusPerLine=0;this._mcusPerColumn=0;this._components=e,this._componentsOrder=t,this._extended=n,this._progressive=i,this._precision=r,this._scanLines=a,this._samplesPerLine=s}get components(){return this._components}get componentsOrder(){return this._componentsOrder}get extended(){return this._extended}get progressive(){return this._progressive}get precision(){return this._precision}get scanLines(){return this._scanLines}get samplesPerLine(){return this._samplesPerLine}get maxHSamples(){return this._maxHSamples}get maxVSamples(){return this._maxVSamples}get mcusPerLine(){return this._mcusPerLine}get mcusPerColumn(){return this._mcusPerColumn}prepare(){for(let[e,t]of this._components)this._maxHSamples=Math.max(this._maxHSamples,t.hSamples),this._maxVSamples=Math.max(this._maxVSamples,t.vSamples);this._mcusPerLine=Math.ceil(this._samplesPerLine/8/this._maxHSamples),this._mcusPerColumn=Math.ceil(this._scanLines/8/this._maxVSamples);for(let[e,t]of this._components){let n=Math.ceil(Math.ceil(this._samplesPerLine/8)*t.hSamples/this._maxHSamples),i=Math.ceil(Math.ceil(this._scanLines/8)*t.vSamples/this.maxVSamples),r=this._mcusPerLine*t.hSamples,a=this._mcusPerColumn*t.vSamples,s=U.generate(a,u=>U.generate(r,o=>new Int32Array(64)));t.setBlocks(s,n,i)}}}});var Kn,ha=A(()=>{"use strict";Kn=class{constructor(){this._children=[];this._index=0}get children(){return this._children}get index(){return this._index}incrementIndex(){this._index++}}});var ca,ba=A(()=>{"use strict";ca=class{constructor(){this._width=0;this._height=0;this._numFrames=1;this._backgroundColor=void 0}get width(){return this._width}get height(){return this._height}get numFrames(){return this._numFrames}get backgroundColor(){return this._backgroundColor}setSize(e,t){this._width=e,this._height=t}}});var fa,da=A(()=>{"use strict";fa=class{get thumbWidth(){return this._thumbWidth}get thumbHeight(){return this._thumbHeight}get majorVersion(){return this._majorVersion}get minorVersion(){return this._minorVersion}get densityUnits(){return this._densityUnits}get xDensity(){return this._xDensity}get yDensity(){return this._yDensity}get thumbData(){return this._thumbData}constructor(e,t,n,i,r,a,s,u){this._thumbWidth=e,this._thumbHeight=t,this._majorVersion=n,this._minorVersion=i,this._densityUnits=r,this._xDensity=a,this._yDensity=s,this._thumbData=u}}});var Jn,hn,pa=A(()=>{"use strict";_e();be();Tt();It();Jn=class{static createDctClip(){let e=new Uint8Array(Jn._dctClipLength),t=0;for(t=-256;t<0;++t)e[Jn._dctClipOffset+t]=0;for(t=0;t<256;++t)e[Jn._dctClipOffset+t]=t;for(t=256;t<512;++t)e[Jn._dctClipOffset+t]=255;return e}static quantizeAndInverse(e,t,n,i){let r=i,a=4017,s=799,u=3406,o=2276,l=1567,m=3784,b=5793,h=2896;for(let d=0;d<64;d++)r[d]=t[d]*e[d];let c=0;for(let d=0;d<8;++d,c+=8){if(r[1+c]===0&&r[2+c]===0&&r[3+c]===0&&r[4+c]===0&&r[5+c]===0&&r[6+c]===0&&r[7+c]===0){let w=b*r[0+c]+512>>10;r[c+0]=w,r[c+1]=w,r[c+2]=w,r[c+3]=w,r[c+4]=w,r[c+5]=w,r[c+6]=w,r[c+7]=w;continue}let p=b*r[0+c]+128>>8,g=b*r[4+c]+128>>8,x=r[2+c],y=r[6+c],C=h*(r[1+c]-r[7+c])+128>>8,I=h*(r[1+c]+r[7+c])+128>>8,P=r[3+c]<<4,F=r[5+c]<<4,M=p-g+1>>1;p=p+g+1>>1,g=M,M=x*m+y*l+128>>8,x=x*l-y*m+128>>8,y=M,M=C-F+1>>1,C=C+F+1>>1,F=M,M=I+P+1>>1,P=I-P+1>>1,I=M,M=p-y+1>>1,p=p+y+1>>1,y=M,M=g-x+1>>1,g=g+x+1>>1,x=M,M=C*o+I*u+2048>>12,C=C*u-I*o+2048>>12,I=M,M=P*s+F*a+2048>>12,P=P*a-F*s+2048>>12,F=M,r[0+c]=p+I,r[7+c]=p-I,r[1+c]=g+F,r[6+c]=g-F,r[2+c]=x+P,r[5+c]=x-P,r[3+c]=y+C,r[4+c]=y-C}for(let d=0;d<8;++d){let p=d;if(r[1*8+p]===0&&r[2*8+p]===0&&r[3*8+p]===0&&r[4*8+p]===0&&r[5*8+p]===0&&r[6*8+p]===0&&r[7*8+p]===0){let k=b*i[d]+8192>>14;r[0*8+p]=k,r[1*8+p]=k,r[2*8+p]=k,r[3*8+p]=k,r[4*8+p]=k,r[5*8+p]=k,r[6*8+p]=k,r[7*8+p]=k;continue}let g=b*r[0*8+p]+2048>>12,x=b*r[4*8+p]+2048>>12,y=r[2*8+p],C=r[6*8+p],I=h*(r[1*8+p]-r[7*8+p])+2048>>12,P=h*(r[1*8+p]+r[7*8+p])+2048>>12,F=r[3*8+p],M=r[5*8+p],w=g-x+1>>1;g=g+x+1>>1,x=w,w=y*m+C*l+2048>>12,y=y*l-C*m+2048>>12,C=w,w=I-M+1>>1,I=I+M+1>>1,M=w,w=P+F+1>>1,F=P-F+1>>1,P=w,w=g-C+1>>1,g=g+C+1>>1,C=w,w=x-y+1>>1,x=x+y+1>>1,y=w,w=I*o+P*u+2048>>12,I=I*u-P*o+2048>>12,P=w,w=F*s+M*a+2048>>12,F=F*a-M*s+2048>>12,M=w,r[0*8+p]=g+P,r[7*8+p]=g-P,r[1*8+p]=x+M,r[6*8+p]=x-M,r[2*8+p]=y+F,r[5*8+p]=y-F,r[3*8+p]=C+I,r[4*8+p]=C-I}for(let d=0;d<64;++d)n[d]=Jn._dctClip[Jn._dctClipOffset+128+(r[d]+8>>4)]}static getImageFromJpeg(e){let t=e.exifData.imageIfd.hasOrientation?e.exifData.imageIfd.orientation:0,n=e.width,i=e.height,r=t>=5&&t<=8,a=r?i:n,s=r?n:i,u=new Q({width:a,height:s});u.exifData=Ie.from(e.exifData),u.exifData.imageIfd.orientation=void 0;let o,l,m,b,h,c,d,p,g=!1,x=i-1,y=n-1;switch(e.components.length){case 1:{o=e.components[0];let C=o.lines,I=o.hScaleShift,P=o.vScaleShift;for(let F=0;F<i;F++){let M=F>>P;h=C[M];for(let w=0;w<n;w++){let k=w>>I,B=h[k];t===2?u.setPixelRgb(y-w,F,B,B,B):t===3?u.setPixelRgb(y-w,x-F,B,B,B):t===4?u.setPixelRgb(w,x-F,B,B,B):t===5?u.setPixelRgb(F,w,B,B,B):t===6?u.setPixelRgb(x-F,w,B,B,B):t===7?u.setPixelRgb(x-F,y-w,B,B,B):t===8?u.setPixelRgb(F,y-w,B,B,B):u.setPixelRgb(w,F,B,B,B)}}}break;case 2:break;case 3:{g=!0,o=e.components[0],l=e.components[1],m=e.components[2];let C=o.lines,I=l.lines,P=m.lines,F=o.hScaleShift,M=o.vScaleShift,w=l.hScaleShift,k=l.vScaleShift,B=m.hScaleShift,N=m.vScaleShift;for(let O=0;O<i;O++){let V=O>>M,E=O>>k,$=O>>N;h=C[V],c=I[E],d=P[$];for(let X=0;X<n;X++){let ie=X>>F,te=X>>w,re=X>>B,W=h[ie]<<8,j=c[te]-128,Re=d[re]-128,pe=W+359*Re+128,se=W-88*j-183*Re+128,me=W+454*j+128;pe=_.clampInt255(pe>>8),se=_.clampInt255(se>>8),me=_.clampInt255(me>>8),t===2?u.setPixelRgb(y-X,O,pe,se,me):t===3?u.setPixelRgb(y-X,x-O,pe,se,me):t===4?u.setPixelRgb(X,x-O,pe,se,me):t===5?u.setPixelRgb(O,X,pe,se,me):t===6?u.setPixelRgb(x-O,X,pe,se,me):t===7?u.setPixelRgb(x-O,y-X,pe,se,me):t===8?u.setPixelRgb(O,y-X,pe,se,me):u.setPixelRgb(X,O,pe,se,me)}}}break;case 4:{if(e.adobe===void 0)throw new T("Unsupported color mode (4 components)");g=!1,e.adobe.transformCode!==0&&(g=!0),o=e.components[0],l=e.components[1],m=e.components[2],b=e.components[3];let C=o.lines,I=l.lines,P=m.lines,F=b.lines,M=o.hScaleShift,w=o.vScaleShift,k=l.hScaleShift,B=l.vScaleShift,N=m.hScaleShift,O=m.vScaleShift,V=b.hScaleShift,E=b.vScaleShift;for(let $=0;$<e.height;$++){let X=$>>w,ie=$>>B,te=$>>O,re=$>>E;h=C[X],c=I[ie],d=P[te],p=F[re];for(let W=0;W<e.width;W++){let j=W>>M,Re=W>>k,pe=W>>N,se=W>>V,me=0,fn=0,Ot=0,Zt=0;if(!g)me=h[j],fn=c[Re],Ot=d[pe],Zt=p[se];else{Ot=h[j];let an=c[Re],Qt=d[pe];Zt=p[se],me=255-_.clampInt255(Ot+1.402*(Qt-128)),fn=255-_.clampInt255(Ot-.3441363*(an-128)-.71413636*(Qt-128)),Ot=255-_.clampInt255(Ot+1.772*(an-128))}let Mt=me*Zt>>8,Ye=fn*Zt>>8,Xe=Ot*Zt>>8;t===2?u.setPixelRgb(y-W,$,Mt,Ye,Xe):t===3?u.setPixelRgb(y-W,x-$,Mt,Ye,Xe):t===4?u.setPixelRgb(W,x-$,Mt,Ye,Xe):t===5?u.setPixelRgb($,W,Mt,Ye,Xe):t===6?u.setPixelRgb(x-$,W,Mt,Ye,Xe):t===7?u.setPixelRgb(x-$,y-W,Mt,Ye,Xe):t===8?u.setPixelRgb($,y-W,Mt,Ye,Xe):u.setPixelRgb(W,$,Mt,Ye,Xe)}}}break;default:throw new T("Unsupported color mode")}return u}},hn=Jn;hn._dctClipOffset=256,hn._dctClipLength=768,hn._dctClip=Jn.createDctClip()});var ei,qi=A(()=>{"use strict";ei=class{}});var cn,Gi=A(()=>{"use strict";qi();cn=class extends ei{constructor(t){super();this._children=t}get children(){return this._children}}});var ti,$i=A(()=>{"use strict";qi();ti=class extends ei{constructor(t){super();this._value=t}get value(){return this._value}}});var Bn=A(()=>{"use strict"});var ga,xa=A(()=>{"use strict";be();Gi();$i();Wi();Bn();ga=class{constructor(e,t,n,i,r,a,s,u){this._bitsData=0;this._bitsCount=0;this._eobrun=0;this._successiveACState=0;this._successiveACNextValue=0;this._input=e,this._frame=t,this._precision=t.precision,this._samplesPerLine=t.samplesPerLine,this._scanLines=t.scanLines,this._mcusPerLine=t.mcusPerLine,this._progressive=t.progressive,this._maxH=t.maxHSamples,this._maxV=t.maxVSamples,this._components=n,this._resetInterval=u,this._spectralStart=i,this._spectralEnd=r,this._successivePrev=a,this._successive=s}get input(){return this._input}get frame(){return this._frame}get precision(){return this._precision}get samplesPerLine(){return this._samplesPerLine}get scanLines(){return this._scanLines}get mcusPerLine(){return this._mcusPerLine}get progressive(){return this._progressive}get maxH(){return this._maxH}get maxV(){return this._maxV}get components(){return this._components}get resetInterval(){return this._resetInterval}get spectralStart(){return this._spectralStart}get spectralEnd(){return this._spectralEnd}get successivePrev(){return this._successivePrev}get successive(){return this._successive}get bitsData(){return this._bitsData}get bitsCount(){return this._bitsCount}get eobrun(){return this._eobrun}get successiveACState(){return this._successiveACState}get successiveACNextValue(){return this._successiveACNextValue}readBit(){if(this.bitsCount>0)return this._bitsCount--,this._bitsData>>this._bitsCount&1;if(!this._input.isEOS){if(this._bitsData=this._input.readByte(),this._bitsData===255){let e=this.input.readByte();if(e!==0){let t=(this._bitsData<<8|e).toString(16);throw new T(`unexpected marker: ${t}`)}}return this._bitsCount=7,this._bitsData>>7&1}}decodeHuffman(e){let t=new cn(e),n;for(;(n=this.readBit())!==void 0;)if(t instanceof cn&&(t=t.children[n]),t instanceof ti)return t.value}receive(e){let t=0,n=e;for(;n>0;){let i=this.readBit();if(i===void 0)return;t=t<<1|i,n--}return t}receiveAndExtend(e){if(e===1)return this.readBit()===1?1:-1;let t=this.receive(e);return t>=1<<(e!=null?e:0)-1?t:t+(-1<<(e!=null?e:0))+1}decodeBaseline(e,t){let n=this.decodeHuffman(e.huffmanTableDC),i=n===0?0:this.receiveAndExtend(n);e.pred+=i,t[0]=e.pred;let r=1;for(;r<64;){let a=this.decodeHuffman(e.huffmanTableAC),s=a&15,u=a>>4;if(s===0){if(u<15)break;r+=16;continue}r+=u,s=this.receiveAndExtend(s);let o=Me.dctZigZag[r];t[o]=s,r++}}decodeDCFirst(e,t){let n=this.decodeHuffman(e.huffmanTableDC),i=n===0?0:this.receiveAndExtend(n)<<this._successive;e.pred+=i,t[0]=e.pred}decodeDCSuccessive(e,t){t[0]|=this.readBit()<<this._successive}decodeACFirst(e,t){if(this._eobrun>0){this._eobrun--;return}let n=this._spectralStart,i=this._spectralEnd;for(;n<=i;){let r=this.decodeHuffman(e.huffmanTableAC),a=r&15,s=r>>4;if(a===0){if(s<15){this._eobrun=this.receive(s)+(1<<s)-1;break}n+=16;continue}n+=s;let u=Me.dctZigZag[n];t[u]=this.receiveAndExtend(a)*(1<<this._successive),n++}}decodeACSuccessive(e,t){let n=this._spectralStart,i=this._spectralEnd,r=0,a=0;for(;n<=i;){let s=Me.dctZigZag[n];switch(this._successiveACState){case 0:{let u=this.decodeHuffman(e.huffmanTableAC);if(u===void 0)throw new T("Invalid progressive encoding");if(r=u&15,a=u>>4,r===0)a<15?(this._eobrun=this.receive(a)+(1<<a),this._successiveACState=4):(a=16,this._successiveACState=1);else{if(r!==1)throw new T("invalid ACn encoding");this._successiveACNextValue=this.receiveAndExtend(r),this._successiveACState=a!==0?2:3}continue}case 1:case 2:{t[s]!==0?t[s]+=this.readBit()<<this._successive:(a--,a===0&&(this._successiveACState=this._successiveACState===2?3:0));break}case 3:{t[s]!==0?t[s]+=this.readBit()<<this._successive:(t[s]=this._successiveACNextValue<<this._successive,this._successiveACState=0);break}case 4:{t[s]!==0&&(t[s]+=this.readBit()<<this._successive);break}}n++}this._successiveACState===4&&(this._eobrun--,this._eobrun===0&&(this._successiveACState=0))}decodeMcu(e,t,n,i,r){let a=Math.floor(n/this._mcusPerLine),s=n%this._mcusPerLine,u=a*e.vSamples+i,o=s*e.hSamples+r;if(u>=e.blocks.length)return;let l=e.blocks[u].length;o>=l||t.call(this,e,e.blocks[u][o])}decodeBlock(e,t,n){let i=Math.floor(n/e.blocksPerLine),r=n%e.blocksPerLine;t.call(this,e,e.blocks[i][r])}decode(){let e=this._components.length,t,n;this._progressive?this._spectralStart===0?n=this._successivePrev===0?this.decodeDCFirst:this.decodeDCSuccessive:n=this._successivePrev===0?this.decodeACFirst:this.decodeACSuccessive:n=this.decodeBaseline;let i=0,r;e===1?r=this._components[0].blocksPerLine*this._components[0].blocksPerColumn:r=this._mcusPerLine*this._frame.mcusPerColumn,(this._resetInterval===void 0||this._resetInterval===0)&&(this._resetInterval=r);let a,s;for(;i<r;){for(let l=0;l<e;l++)this._components[l].pred=0;if(this._eobrun=0,e===1){t=this._components[0];for(let l=0;l<this._resetInterval;l++)this.decodeBlock(t,n,i),i++}else for(let l=0;l<this._resetInterval;l++){for(let m=0;m<e;m++){t=this.components[m],a=t.hSamples,s=t.vSamples;for(let b=0;b<s;b++)for(let h=0;h<a;h++)this.decodeMcu(t,n,i,b,h)}i++}this._bitsCount=0;let u=this._input.getByte(0),o=this._input.getByte(1);if(u===255)if(o>=208&&o<=215)this._input.skip(2);else break}}}});var ni,Me,Wi=A(()=>{"use strict";je();be();ra();sa();oa();ma();ha();ba();da();pa();xa();Tt();G();Bn();$i();Gi();ni=class{constructor(){this._exifData=new Ie;this._quantizationTables=U.fill(ni.numQuantizationTables,void 0);this._frames=new Array;this._huffmanTablesAC=[];this._huffmanTablesDC=[];this._components=new Array}get input(){return this._input}get jfif(){return this._jfif}get adobe(){return this._adobe}get frame(){return this._frame}get resetInterval(){return this._resetInterval}get comment(){return this._comment}get exifData(){return this._exifData}get quantizationTables(){return this._quantizationTables}get frames(){return this._frames}get huffmanTablesAC(){return this._huffmanTablesAC}get huffmanTablesDC(){return this._huffmanTablesDC}get components(){return this._components}get width(){return this._frame.samplesPerLine}get height(){return this._frame.scanLines}readMarkers(){let e=this.nextMarker();if(e!==216)throw new T("Start Of Image marker not found.");for(e=this.nextMarker();e!==217&&!this._input.isEOS;){let t=this.readBlock();switch(e){case 224:case 225:case 226:case 227:case 228:case 229:case 230:case 231:case 232:case 233:case 234:case 235:case 236:case 237:case 238:case 239:case 254:this.readAppData(e,t);break;case 219:this.readDQT(t);break;case 192:case 193:case 194:this.readFrame(e,t);break;case 195:case 197:case 198:case 199:case 200:case 201:case 202:case 203:case 205:case 206:case 207:throw new T(`Unhandled frame type ${e.toString(16)}`);case 196:this.readDHT(t);break;case 221:this.readDRI(t);break;case 218:this.readSOS(t);break;case 255:this._input.getByte(0)!==255&&this._input.skip(-1);break;default:if(this._input.getByte(-3)===255&&this._input.getByte(-2)>=192&&this._input.getByte(-2)<=254){this._input.skip(-3);break}if(e!==0)throw new T(`Unknown JPEG marker ${e.toString(16)}`);break}e=this.nextMarker()}}skipBlock(){let e=this._input.readUint16();if(e<2)throw new T("Invalid Block");this._input.skip(e-2)}validate(e){this._input=new Y({buffer:e,bigEndian:!0});let t=this._input.peekBytes(2);if(t.getByte(0)!==255||t.getByte(1)!==216)return!1;let n=this.nextMarker();if(n!==216)return!1;let i=!1,r=!1;for(n=this.nextMarker();n!==217&&!this._input.isEOS;){let a=this._input.readUint16();if(a<2)break;switch(this._input.skip(a-2),n){case 192:case 193:case 194:i=!0;break;case 218:r=!0;break;default:}n=this.nextMarker()}return i&&r}readInfo(e){this._input=new Y({buffer:e,bigEndian:!0});let t=this.nextMarker();if(t!==216)return;let n=new ca,i=!1,r=!1;for(t=this.nextMarker();t!==217&&!this._input.isEOS;){switch(t){case 192:case 193:case 194:i=!0,this.readFrame(t,this.readBlock());break;case 218:r=!0,this.skipBlock();break;default:this.skipBlock();break}t=this.nextMarker()}return this._frame!==void 0&&(n.setSize(this._frame.samplesPerLine,this._frame.scanLines),this._frame=void 0),this.frames.length=0,i&&r?n:void 0}read(e){if(this._input=new Y({buffer:e,bigEndian:!0}),this.readMarkers(),this._frames.length!==1)throw new T("Only single frame JPEGs supported");if(this._frame!==void 0)for(let t=0;t<this._frame.componentsOrder.length;++t){let n=this._frame.components.get(this._frame.componentsOrder[t]);n!==void 0&&this.components.push(new ia(n.hSamples,this._frame.maxHSamples,n.vSamples,this._frame.maxVSamples,ni.buildComponentData(n)))}}getImage(){return hn.getImageFromJpeg(this)}static buildHuffmanTable(e,t){let n=0,i=new Array,r=16;for(;r>0&&e[r-1]===0;)r--;i.push(new Kn);let a=i[0];for(let s=0;s<r;s++){for(let u=0;u<e[s];u++){for(a=i.pop(),a.children.length<=a.index&&(a.children.length=a.index+1),a.children[a.index]=new ti(t[n]);a.index>0;)a=i.pop();for(a.incrementIndex(),i.push(a);i.length<=s;){let o=new Kn;i.push(o),a.children.length<=a.index&&(a.children.length=a.index+1),a.children[a.index]=new cn(o.children),a=o}n++}if(s+1<r){let u=new Kn;i.push(u),a.children.length<=a.index&&(a.children.length=a.index+1),a.children[a.index]=new cn(u.children),a=u}}return i[0].children}static buildComponentData(e){let t=e.blocksPerLine,n=e.blocksPerColumn,i=t<<3,r=new Int32Array(64),a=new Uint8Array(64),s=U.fill(n*8,void 0),u=0;for(let o=0;o<n;o++){let l=o<<3;for(let m=0;m<8;m++)s[u++]=new Uint8Array(i);for(let m=0;m<t;m++){hn.quantizeAndInverse(e.quantizationTable,e.blocks[o][m],a,r);let b=0,h=m<<3;for(let c=0;c<8;c++){let d=s[l+c];for(let p=0;p<8;p++)d[h+p]=a[b++]}}}return s}static toFix(e){return Math.trunc(e*1048576)&4294967295}readBlock(){let e=this._input.readUint16();if(e<2)throw new T("Invalid Block");return this._input.readBytes(e-2)}nextMarker(){let e=0;if(this._input.isEOS)return e;do{do e=this._input.readByte();while(e!==255&&!this._input.isEOS);if(this._input.isEOS)return e;do e=this._input.readByte();while(e===255&&!this._input.isEOS)}while(e===0&&!this._input.isEOS);return e}readExifData(e){e.readUint32()===1165519206&&e.readUint16()===0&&this.exifData.read(e)}readAppData(e,t){let n=t;if(e===224){if(n.getByte(0)===74&&n.getByte(1)===70&&n.getByte(2)===73&&n.getByte(3)===70&&n.getByte(4)===0){let i=n.getByte(5),r=n.getByte(6),a=n.getByte(7),s=n.getByte(8)<<8|n.getByte(9),u=n.getByte(10)<<8|n.getByte(11),o=n.getByte(12),l=n.getByte(13),m=3*o*l,b=n.subarray(14+m,void 0,14);this._jfif=new fa(o,l,i,r,a,s,u,b)}}else if(e===225)this.readExifData(n);else if(e===238){if(n.getByte(0)===65&&n.getByte(1)===100&&n.getByte(2)===111&&n.getByte(3)===98&&n.getByte(4)===101&&n.getByte(5)===0){let i=n.getByte(6),r=n.getByte(7)<<8|n.getByte(8),a=n.getByte(9)<<8|n.getByte(10),s=n.getByte(11);this._adobe=new aa(i,r,a,s)}}else if(e===254)try{this._comment=n.readStringUtf8()}catch(i){}}readDQT(e){for(;!e.isEOS;){let t=e.readByte(),n=t>>4;if(t&=15,t>=ni.numQuantizationTables)throw new T("Invalid number of quantization tables");this._quantizationTables[t]===void 0&&(this._quantizationTables[t]=new Int16Array(64));let i=this._quantizationTables[t];if(i!==void 0)for(let r=0;r<ni.dctSize2;r++){let a=n!==0?e.readUint16():e.readByte();i[ni.dctZigZag[r]]=a}}if(!e.isEOS)throw new T("Bad length for DQT block")}readFrame(e,t){if(this._frame!==void 0)throw new T("Duplicate JPG frame data found.");let n=e===193,i=e===194,r=t.readByte(),a=t.readUint16(),s=t.readUint16(),u=t.readByte(),o=new Map,l=new Array;for(let m=0;m<u;m++){let b=t.readByte(),h=t.readByte(),c=h>>4&15,d=h&15,p=t.readByte();l.push(b);let g=new ua(c,d,this._quantizationTables,p);o.set(b,g)}this._frame=new la(o,l,n,i,r,a,s),this._frame.prepare(),this.frames.push(this._frame)}readDHT(e){for(;!e.isEOS;){let t=e.readByte(),n=new Uint8Array(16),i=0;for(let s=0;s<16;s++)n[s]=e.readByte(),i+=n[s];let r=e.readBytes(i).toUint8Array(),a=[];t&16?(t-=16,a=this._huffmanTablesAC):a=this._huffmanTablesDC,a.length<=t&&(a.length=t+1),a[t]=ni.buildHuffmanTable(n,r)}}readDRI(e){this._resetInterval=e.readUint16()}readSOS(e){let t=e.readByte();if(t<1||t>ni.maxCompsInScan)throw new T("Invalid SOS block");let n=new Array;for(let l=0;l<t;l++){let m=e.readByte(),b=e.readByte();if(!this._frame.components.has(m))throw new T("Invalid Component in SOS block");let h=this._frame.components.get(m);if(h!==void 0){let c=b>>4&15,d=b&15;c<this._huffmanTablesDC.length&&(h.huffmanTableDC=this._huffmanTablesDC[c]),d<this._huffmanTablesAC.length&&(h.huffmanTableAC=this._huffmanTablesAC[d]),n.push(h)}}let i=e.readByte(),r=e.readByte(),a=e.readByte(),s=a>>4&15,u=a&15;new ga(this._input,this._frame,n,i,r,s,u,this._resetInterval).decode()}},Me=ni;Me.dctZigZag=[0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63],Me.dctSize=8,Me.dctSize2=64,Me.numQuantizationTables=4,Me.numHuffmanTables=4,Me.numArithTables=16,Me.maxCompsInScan=4,Me.maxSamplingFactor=4});var Yi,Xi=A(()=>{"use strict";je();be();Wi();Yi=class{get numFrames(){return this._info!==void 0?this._info.numFrames:0}isValidFile(e){return new Me().validate(e)}startDecode(e){return this._input=new Y({buffer:e,bigEndian:!0}),this._info=new Me().readInfo(e),this._info}decodeFrame(e){if(this._input===void 0)return;let t=new Me;if(t.read(this._input.buffer),t.frames.length!==1)throw new T("Only single frame JPEGs supported.");return t.getImage()}decode(e,t){let n=new Me;if(n.read(e),n.frames.length!==1)throw new T("Only single frame JPEGs supported.");return n.getImage()}}});var J,zt,_a=A(()=>{"use strict";G();_e();At();Bn();J=class{constructor(e=100){this._tableY=new Uint8Array(64);this._tableUv=new Uint8Array(64);this._fdTableY=new Float32Array(64);this._fdTableUv=new Float32Array(64);this._bitCode=U.fill(65535,void 0);this._category=U.fill(65535,void 0);this._outputfDCTQuant=U.fill(64,void 0);this._du=U.fill(64,void 0);this._ydu=new Float32Array(64);this._udu=new Float32Array(64);this._vdu=new Float32Array(64);this._tableRgbYuv=new Int32Array(2048);this._byteNew=0;this._bytePos=7;this._supportsAnimation=!1;this.initHuffmanTable(),this.initCategoryNumber(),this.initRgbYuvTable(),this.setQuality(e)}get supportsAnimation(){return this._supportsAnimation}static computeHuffmanTable(e,t){let n=0,i=0,r=new Array;for(let a=1;a<=16;a++){for(let s=1;s<=e[a];s++){let u=t[i];r.length<=u&&(r.length=u+1),r[u]=[n,a],i++,n++}n*=2}return r}static writeMarker(e,t){e.writeByte(255),e.writeByte(t&255)}static writeAPP0(e){J.writeMarker(e,224),e.writeUint16(16),e.writeByte(74),e.writeByte(70),e.writeByte(73),e.writeByte(70),e.writeByte(0),e.writeByte(1),e.writeByte(1),e.writeByte(0),e.writeUint16(1),e.writeUint16(1),e.writeByte(0),e.writeByte(0)}static writeAPP1(e,t){if(t.isEmpty)return;let n=new Be;t.write(n);let i=n.getBytes();this.writeMarker(e,225);let r=1165519206;e.writeUint16(i.length+8),e.writeUint32(r),e.writeUint16(0),e.writeBytes(i)}static writeSOF0(e,t,n){J.writeMarker(e,192),e.writeUint16(17),e.writeByte(8),e.writeUint16(n),e.writeUint16(t),e.writeByte(3),e.writeByte(1),e.writeByte(17),e.writeByte(0),e.writeByte(2),e.writeByte(17),e.writeByte(1),e.writeByte(3),e.writeByte(17),e.writeByte(1)}static writeSOS(e){J.writeMarker(e,218),e.writeUint16(12),e.writeByte(3),e.writeByte(1),e.writeByte(0),e.writeByte(2),e.writeByte(17),e.writeByte(3),e.writeByte(17),e.writeByte(0),e.writeByte(63),e.writeByte(0)}static writeDHT(e){J.writeMarker(e,196),e.writeUint16(418),e.writeByte(0);for(let t=0;t<16;t++)e.writeByte(J._stdDcLuminanceNrCodes[t+1]);for(let t=0;t<=11;t++)e.writeByte(J._stdDcLuminanceValues[t]);e.writeByte(16);for(let t=0;t<16;t++)e.writeByte(J._stdAcLuminanceNrCodes[t+1]);for(let t=0;t<=161;t++)e.writeByte(J._stdAcLuminanceValues[t]);e.writeByte(1);for(let t=0;t<16;t++)e.writeByte(J._stdDcChrominanceNrCodes[t+1]);for(let t=0;t<=11;t++)e.writeByte(J._stdDcChrominanceValues[t]);e.writeByte(17);for(let t=0;t<16;t++)e.writeByte(J._stdAcChrominanceNrCodes[t+1]);for(let t=0;t<=161;t++)e.writeByte(J._stdAcChrominanceValues[t])}initHuffmanTable(){this._ydcHuffman=J.computeHuffmanTable(J._stdDcLuminanceNrCodes,J._stdDcLuminanceValues),this._uvdcHuffman=J.computeHuffmanTable(J._stdDcChrominanceNrCodes,J._stdDcChrominanceValues),this._yacHuffman=J.computeHuffmanTable(J._stdAcLuminanceNrCodes,J._stdAcLuminanceValues),this._uvacHuffman=J.computeHuffmanTable(J._stdAcChrominanceNrCodes,J._stdAcChrominanceValues)}initCategoryNumber(){let e=1,t=2;for(let n=1;n<=15;n++){for(let i=e;i<t;i++)this._category[32767+i]=n,this._bitCode[32767+i]=[i,n];for(let i=-(t-1);i<=-e;i++)this._category[32767+i]=n,this._bitCode[32767+i]=[t-1+i,n];e<<=1,t<<=1}}initRgbYuvTable(){for(let e=0;e<256;e++)this._tableRgbYuv[e]=19595*e,this._tableRgbYuv[e+256]=38470*e,this._tableRgbYuv[e+512]=7471*e+32768,this._tableRgbYuv[e+768]=-11059*e,this._tableRgbYuv[e+1024]=-21709*e,this._tableRgbYuv[e+1280]=32768*e+8421375,this._tableRgbYuv[e+1536]=-27439*e,this._tableRgbYuv[e+1792]=-5329*e}setQuality(e){let t=_.clampInt(e,1,100);if(this._currentQuality===t)return;let n=0;t<50?n=Math.floor(5e3/t):n=Math.floor(200-t*2),this.initQuantTables(n),this._currentQuality=t}initQuantTables(e){let t=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99];for(let a=0;a<64;a++){let s=Math.floor((t[a]*e+50)/100);s<1?s=1:s>255&&(s=255),this._tableY[J._zigzag[a]]=s}let n=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99];for(let a=0;a<64;a++){let s=Math.floor((n[a]*e+50)/100);s<1?s=1:s>255&&(s=255),this._tableUv[J._zigzag[a]]=s}let i=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],r=0;for(let a=0;a<8;a++)for(let s=0;s<8;s++)this._fdTableY[r]=1/(this._tableY[J._zigzag[r]]*i[a]*i[s]*8),this._fdTableUv[r]=1/(this._tableUv[J._zigzag[r]]*i[a]*i[s]*8),r++}fDCTQuant(e,t){let n=0;for(let i=0;i<8;++i){let r=e[n],a=e[n+1],s=e[n+2],u=e[n+3],o=e[n+4],l=e[n+5],m=e[n+6],b=e[n+7],h=r+b,c=r-b,d=a+m,p=a-m,g=s+l,x=s-l,y=u+o,C=u-o,I=h+y,P=h-y,F=d+g,M=d-g;e[n]=I+F,e[n+4]=I-F;let w=(M+P)*.707106781;e[n+2]=P+w,e[n+6]=P-w,I=C+x,F=x+p,M=p+c;let k=(I-M)*.382683433,B=.5411961*I+k,N=1.306562965*M+k,O=F*.707106781,V=c+O,E=c-O;e[n+5]=E+B,e[n+3]=E-B,e[n+1]=V+N,e[n+7]=V-N,n+=8}n=0;for(let i=0;i<8;++i){let r=e[n],a=e[n+8],s=e[n+16],u=e[n+24],o=e[n+32],l=e[n+40],m=e[n+48],b=e[n+56],h=r+b,c=r-b,d=a+m,p=a-m,g=s+l,x=s-l,y=u+o,C=u-o,I=h+y,P=h-y,F=d+g,M=d-g;e[n]=I+F,e[n+32]=I-F;let w=(M+P)*.707106781;e[n+16]=P+w,e[n+48]=P-w,I=C+x,F=x+p,M=p+c;let k=(I-M)*.382683433,B=.5411961*I+k,N=1.306562965*M+k,O=F*.707106781,V=c+O,E=c-O;e[n+40]=E+B,e[n+24]=E-B,e[n+8]=V+N,e[n+56]=V-N,n++}for(let i=0;i<64;++i){let r=e[i]*t[i];this._outputfDCTQuant[i]=r>0?Math.trunc(r+.5):Math.trunc(r-.5)}return this._outputfDCTQuant}writeDQT(e){J.writeMarker(e,219),e.writeUint16(132),e.writeByte(0);for(let t=0;t<64;t++)e.writeByte(this._tableY[t]);e.writeByte(1);for(let t=0;t<64;t++)e.writeByte(this._tableUv[t])}writeBits(e,t){let n=t[0],i=t[1]-1;for(;i>=0;)n&1<<i&&(this._byteNew|=1<<this._bytePos),i--,this._bytePos--,this._bytePos<0&&(this._byteNew===255?(e.writeByte(255),e.writeByte(0)):e.writeByte(this._byteNew),this._bytePos=7,this._byteNew=0)}resetBits(){this._byteNew=0,this._bytePos=7}processDU(e,t,n,i,r,a){let s=r[0],u=r[240],o=16,l=63,m=64,b=this.fDCTQuant(t,n),h=i,c=0;for(let x=0;x<m;++x)this._du[J._zigzag[x]]=b[x];let d=this._du[0]-h;h=this._du[0],d===0?this.writeBits(e,a[0]):(c=32767+d,this.writeBits(e,a[this._category[c]]),this.writeBits(e,this._bitCode[c]));let p=63;for(;p>0&&this._du[p]===0;p--);if(p===0)return this.writeBits(e,s),h;let g=1;for(;g<=p;){let x=g;for(;this._du[g]===0&&g<=p;++g);let y=g-x;if(y>=o){let C=y>>4;for(let I=1;I<=C;++I)this.writeBits(e,u);y&=15}c=32767+this._du[g],this.writeBits(e,r[(y<<4)+this._category[c]]),this.writeBits(e,this._bitCode[c]),g++}return p!==l&&this.writeBits(e,s),h}encode(e,t=!1){let n=new Be({bigEndian:!0});J.writeMarker(n,216),J.writeAPP0(n),J.writeAPP1(n,e.exifData),this.writeDQT(n),J.writeSOF0(n,e.width,e.height),J.writeDHT(n),J.writeSOS(n);let i=0,r=0,a=0;this.resetBits();let s=e.width,u=e.height,o=0;for(;o<u;){let l=0;for(;l<s;){for(let m=0;m<64;m++){let b=m>>3,h=m&7,c=o+b,d=l+h;c>=u&&(c-=o+1+b-u),d>=s&&(d-=l+h-s+1);let p=e.getPixel(d,c),g=Math.trunc(p.r),x=Math.trunc(p.g),y=Math.trunc(p.b);this._ydu[m]=(this._tableRgbYuv[g]+this._tableRgbYuv[x+256]+this._tableRgbYuv[y+512]>>16)-128,this._udu[m]=(this._tableRgbYuv[g+768]+this._tableRgbYuv[x+1024]+this._tableRgbYuv[y+1280]>>16)-128,this._vdu[m]=(this._tableRgbYuv[g+1280]+this._tableRgbYuv[x+1536]+this._tableRgbYuv[y+1792]>>16)-128}i=this.processDU(n,this._ydu,this._fdTableY,i,this._yacHuffman,this._ydcHuffman),r=this.processDU(n,this._udu,this._fdTableUv,r,this._uvacHuffman,this._uvdcHuffman),a=this.processDU(n,this._vdu,this._fdTableUv,a,this._uvacHuffman,this._uvdcHuffman),l+=8}o+=8}if(this._bytePos>=0){let l=[(1<<this._bytePos+1)-1,this._bytePos+1];this.writeBits(n,l)}return J.writeMarker(n,217),n.getBytes()}},zt=J;zt._zigzag=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],zt._stdDcLuminanceNrCodes=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],zt._stdDcLuminanceValues=[0,1,2,3,4,5,6,7,8,9,10,11],zt._stdAcLuminanceNrCodes=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],zt._stdAcLuminanceValues=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],zt._stdDcChrominanceNrCodes=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],zt._stdDcChrominanceValues=[0,1,2,3,4,5,6,7,8,9,10,11],zt._stdAcChrominanceNrCodes=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],zt._stdAcChrominanceValues=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250]});var Za,ya,Ca=A(()=>{"use strict";je();At();Tt();Bn();Za=class{readExifData(e){if(!(e===void 0||e.readUint32()!==Za._exifSignature)&&e.readUint16()===0)return Ie.fromInputBuffer(e)}writeAPP1(e,t){if(t.isEmpty)return;let n=new Be;t.write(n);let i=n.getBytes();e.writeUint16(i.length+8),e.writeUint32(Za._exifSignature),e.writeUint16(0),e.writeBytes(i)}readBlock(e){let t=e.readUint16();if(!(t<2))return e.readBytes(t-2)}skipBlock(e,t){let n=e.readUint16();return t==null||t.writeUint16(n),n<2?!1:(t!==void 0?t.writeBuffer(e.readBytes(n-2)):e.skip(n-2),!0)}nextMarker(e,t){let n=0;if(e.isEOS)return n;do{do n=e.readByte(),t==null||t.writeByte(n);while(n!==255&&!e.isEOS);if(e.isEOS)return n;do n=e.readByte(),t==null||t.writeByte(n);while(n===255&&!e.isEOS)}while(n===0&&!e.isEOS);return n}decodeExif(e){let t=new Y({buffer:e,bigEndian:!0}),n=t.peekBytes(2);if(n.getByte(0)!==255||n.getByte(1)!==216)return;let i=this.nextMarker(t);if(i!==216)return;let r;for(i=this.nextMarker(t);i!==217&&!t.isEOS;){switch(i){case 225:if(r=this.readExifData(this.readBlock(t)),r!==void 0)return r;break;default:this.skipBlock(t);break}i=this.nextMarker(t)}}injectExif(e,t){let n=new Y({buffer:t,bigEndian:!0}),i=n.peekBytes(2);if(i.getByte(0)!==255||i.getByte(1)!==216)return;let r=new Be({size:t.length,bigEndian:!0}),a=this.nextMarker(n,r);if(a!==216)return;let s=!1,u=n.offset;for(a=this.nextMarker(n);!s&&a!==217&&!n.isEOS;){if(a===225){let o=this.readBlock(n);if((o==null?void 0:o.readUint32())===Za._exifSignature){s=!0;break}}else this.skipBlock(n);a=this.nextMarker(n)}if(n.offset=u,!s)return this.writeAPP1(r,e),r.writeBuffer(n.readBytes(n.length)),r.getBytes();for(a=this.nextMarker(n,r);a!==217&&!n.isEOS;){if(a===225){let o=n.offset;n.skip(2);let l=n.readUint32();if(n.offset=o,l===Za._exifSignature)return this.skipBlock(n),this.writeAPP1(r,e),r.writeBuffer(n.readBytes(n.length)),r.getBytes()}this.skipBlock(n,r),a=this.nextMarker(n,r)}return r.getBytes()}},ya=Za;ya._exifSignature=1165519206});var ji=A(()=>{"use strict"});var Zi=A(()=>{"use strict"});var wa=A(()=>{"use strict";ji();Zi()});var va=A(()=>{"use strict"});var Qi=A(()=>{"use strict"});var Ia=A(()=>{"use strict";Qi()});var Pa=A(()=>{"use strict";je();It();Qi();Ia()});var Ma=A(()=>{"use strict";At()});var Os,Ki,Aa=A(()=>{"use strict";Os=class{constructor(e){this._bitBuffer=0;this._bitPosition=0;this._input=e}readBits(e){let t=e;if(t===0)return 0;this._bitPosition===0&&(this._bitPosition=8,this._bitBuffer=this._input.readByte());let n=0;for(;t>this._bitPosition;)n=(n<<this._bitPosition)+(this._bitBuffer&Os._bitMask[this._bitPosition]),t-=this._bitPosition,this._bitPosition=8,this._bitBuffer=this._input.readByte();return t>0&&(this._bitPosition===0&&(this._bitPosition=8,this._bitBuffer=this._input.readByte()),n=(n<<t)+(this._bitBuffer>>this._bitPosition-t&Os._bitMask[t]),this._bitPosition-=t),n}readByte(){return this.readBits(8)}flushByte(){return this._bitPosition=0}},Ki=Os;Ki._bitMask=[0,1,3,7,15,31,63,127,255]});var Ji=A(()=>{"use strict"});var Fa,Ba=A(()=>{"use strict";_n();xe();Nn();Dn();$n();Vn();Rn();Tn();Gn();Hn();qn();En();Fa=class{get tag(){return this._tag}get type(){return this._type}get count(){return this._count}get valueOffset(){return this._valueOffset}get value(){return this._value}get p(){return this._p}get isValid(){return this._type!==0}get typeSize(){return this.isValid?xn[this._type]:0}get isString(){return this._type===2}constructor(e){this._tag=e.tag,this._type=e.type,this._count=e.count,this._p=e.p,this._valueOffset=e.valueOffset}read(){if(this._value!==void 0)return this._value;this._p.offset=this._valueOffset;let e=this.p.readBytes(this._count*this.typeSize);switch(this._type){case 1:return this._value=Ze.data(e,this._count);case 2:return this._value=Ue.data(e,this._count);case 7:return this._value=Ze.data(e,this._count);case 3:return this._value=Qe.data(e,this._count);case 4:return this._value=Te.data(e,this._count);case 5:return this._value=Se.data(e,this._count);case 11:return this._value=Ct.data(e,this._count);case 12:return this._value=wt.data(e,this._count);case 6:return this._value=_t.data(e,this._count);case 8:return this._value=Qe.data(e,this._count);case 9:return this._value=yt.data(e,this._count);case 10:return this._value=Ge.data(e,this._count);default:case 0:return}}toString(){let e=On.get(this._tag);return e!==void 0?`${e.name}: ${this._type} ${this._count}`:`${this.constructor.name} (<${this._tag}>: ${this._type} ${this._count})`}}});var ce,We,Ua=A(()=>{"use strict";be();ce=class{constructor(e){this._changingElemSize=0;this._bitPointer=0;this._bytePointer=0;this._lastChangingElement=0;this._compression=2;this._uncompressedMode=0;this._fillBits=0;this._oneD=0;this._fillOrder=e.fillOrder,this._width=e.width,this._height=e.height,this._prevChangingElements=new Array(this._width),this._prevChangingElements.fill(0),this._currChangingElements=new Array(this._width),this._currChangingElements.fill(0)}get width(){return this._width}get height(){return this._height}get fillOrder(){return this._fillOrder}nextNBits(e){let t=0,n=0,i=0,r=this._data.length-1,a=this._bytePointer;if(this._fillOrder===1)t=this._data.getByte(a),a===r?(n=0,i=0):a+1===r?(n=this._data.getByte(a+1),i=0):(n=this._data.getByte(a+1),i=this._data.getByte(a+2));else if(this._fillOrder===2)t=ce._flipTable[this._data.getByte(a)&255],a===r?(n=0,i=0):a+1===r?(n=ce._flipTable[this._data.getByte(a+1)&255],i=0):(n=ce._flipTable[this._data.getByte(a+1)&255],i=ce._flipTable[this._data.getByte(a+2)&255]);else throw new T("TIFFFaxDecoder7");let s=8-this._bitPointer,u=e-s,o=0;u>8&&(o=u-8,u=8),this._bytePointer=this._bytePointer+1;let l=(t&ce._table1[s])<<e-s,m=(n&ce._table2[u])>>8-u,b=0;return o!==0?(m<<=o,b=(i&ce._table2[o])>>8-o,m|=b,this._bytePointer+=1,this._bitPointer=o):u===8?(this._bitPointer=0,this._bytePointer+=1):this._bitPointer=u,l|m}nextLesserThan8Bits(e){let t=0,n=0,i=this._data.length-1,r=this._bytePointer;if(this._fillOrder===1)t=this._data.getByte(r),r===i?n=0:n=this._data.getByte(r+1);else if(this._fillOrder===2)t=ce._flipTable[this._data.getByte(r)&255],r===i?n=0:n=ce._flipTable[this._data.getByte(r+1)&255];else throw new T("TIFFFaxDecoder7");let a=8-this._bitPointer,s=e-a,u=a-e,o=0,l=0;return u>=0?(o=(t&ce._table1[a])>>u,this._bitPointer+=e,this._bitPointer===8&&(this._bitPointer=0,this._bytePointer+=1)):(o=(t&ce._table1[a])<<-u,l=(n&ce._table2[s])>>8-s,o|=l,this._bytePointer+=1,this._bitPointer=s),o}updatePointer(e){let t=this._bitPointer-e;t<0?(this._bytePointer-=1,this._bitPointer=8+t):this._bitPointer=t}advancePointer(){return this._bitPointer!==0&&(this._bytePointer+=1,this._bitPointer=0),!0}setToBlack(e,t,n,i){let r=8*t+n,a=r+i,s=r>>3,u=r&7;if(u>0){let o=1<<7-u,l=e.getByte(s);for(;o>0&&r<a;)l|=o,o>>=1,++r;e.setByte(s,l)}for(s=r>>3;r<a-7;)e.setByte(s++,255),r+=8;for(;r<a;)s=r>>3,e.setByte(s,e.getByte(s)|1<<7-(r&7)),++r}decodeNextScanline(e,t,n){let i=n,r=0,a=0,s=0,u=0,o=0,l=0,m=!0;for(this._changingElemSize=0;i<this._width;){for(;m;)if(u=this.nextNBits(10),o=ce._white[u],s=o&1,r=o>>1&15,r===12)l=this.nextLesserThan8Bits(2),u=u<<2&12|l,o=ce._additionalMakeup[u],r=o>>1&7,a=o>>4&4095,i+=a,this.updatePointer(4-r);else{if(r===0)throw new T("TIFFFaxDecoder0");if(r===15)throw new T("TIFFFaxDecoder1");a=o>>5&2047,i+=a,this.updatePointer(10-r),s===0&&(m=!1,this._currChangingElements[this._changingElemSize++]=i)}if(i===this._width){this._compression===2&&this.advancePointer();break}for(;m===!1;)if(u=this.nextLesserThan8Bits(4),o=ce._initBlack[u],s=o&1,r=o>>1&15,a=o>>5&2047,a===100)if(u=this.nextNBits(9),o=ce._black[u],s=o&1,r=o>>1&15,a=o>>5&2047,r===12)this.updatePointer(5),u=this.nextLesserThan8Bits(4),o=ce._additionalMakeup[u],r=o>>1&7,a=o>>4&4095,this.setToBlack(e,t,i,a),i+=a,this.updatePointer(4-r);else{if(r===15)throw new T("TIFFFaxDecoder2");this.setToBlack(e,t,i,a),i+=a,this.updatePointer(9-r),s===0&&(m=!0,this._currChangingElements[this._changingElemSize++]=i)}else a===200?(u=this.nextLesserThan8Bits(2),o=ce._twoBitBlack[u],a=o>>5&2047,r=o>>1&15,this.setToBlack(e,t,i,a),i+=a,this.updatePointer(2-r),m=!0,this._currChangingElements[this._changingElemSize++]=i):(this.setToBlack(e,t,i,a),i+=a,this.updatePointer(4-r),m=!0,this._currChangingElements[this._changingElemSize++]=i);if(i===this._width){this._compression===2&&this.advancePointer();break}}this._currChangingElements[this._changingElemSize++]=i}readEOL(){if(this._fillBits===0){if(this.nextNBits(12)!==1)throw new T("TIFFFaxDecoder6")}else if(this._fillBits===1){let e=8-this._bitPointer;if(this.nextNBits(e)!==0)throw new T("TIFFFaxDecoder8");if(e<4&&this.nextNBits(8)!==0)throw new T("TIFFFaxDecoder8");let t=0;for(;(t=this.nextNBits(8))!==1;)if(t!==0)throw new T("TIFFFaxDecoder8")}return this._oneD===0?1:this.nextLesserThan8Bits(1)}getNextChangingElement(e,t,n){let i=this._prevChangingElements,r=this._changingElemSize,a=this._lastChangingElement>0?this._lastChangingElement-1:0;t?a&=-2:a|=1;let s=a;for(;s<r;s+=2){let u=i[s];if(u>e){this._lastChangingElement=s,n[0]=u;break}}s+1<r&&(n[1]=i[s+1])}decodeWhiteCodeWord(){let e=0,t=0,n=0,i=0,r=0,a=-1,s=0,u=!0;for(;u;)if(e=this.nextNBits(10),t=ce._white[e],i=t&1,n=t>>1&15,n===12)r=this.nextLesserThan8Bits(2),e=e<<2&12|r,t=ce._additionalMakeup[e],n=t>>1&7,a=t>>4&4095,s+=a,this.updatePointer(4-n);else{if(n===0)throw new T("TIFFFaxDecoder0");if(n===15)throw new T("TIFFFaxDecoder1");a=t>>5&2047,s+=a,this.updatePointer(10-n),i===0&&(u=!1)}return s}decodeBlackCodeWord(){let e=0,t=0,n=0,i=0,r=-1,a=0,s=!1;for(;!s;)if(e=this.nextLesserThan8Bits(4),t=ce._initBlack[e],i=t&1,n=t>>1&15,r=t>>5&2047,r===100)if(e=this.nextNBits(9),t=ce._black[e],i=t&1,n=t>>1&15,r=t>>5&2047,n===12)this.updatePointer(5),e=this.nextLesserThan8Bits(4),t=ce._additionalMakeup[e],n=t>>1&7,r=t>>4&4095,a+=r,this.updatePointer(4-n);else{if(n===15)throw new T("TIFFFaxDecoder2");a+=r,this.updatePointer(9-n),i===0&&(s=!0)}else r===200?(e=this.nextLesserThan8Bits(2),t=ce._twoBitBlack[e],r=t>>5&2047,a+=r,n=t>>1&15,this.updatePointer(2-n),s=!0):(a+=r,this.updatePointer(4-n),s=!0);return a}decode1D(e,t,n,i){this._data=t,this._bitPointer=0,this._bytePointer=0;let r=0,a=Math.trunc((this._width+7)/8);for(let s=0;s<i;s++)this.decodeNextScanline(e,r,n),r+=a}decode2D(e,t,n,i,r){this._data=t,this._compression=3,this._bitPointer=0,this._bytePointer=0;let a=Math.trunc((this._width+7)/8),s=0,u=0,o=0,l=0,m=0,b=!1,h=0,c,d=new Array(2);if(d.fill(0),this._oneD=r&1,this._uncompressedMode=(r&2)>>1,this._fillBits=(r&4)>>2,this.readEOL()!==1)throw new T("TIFFFaxDecoder3");let p=0,g=0;this.decodeNextScanline(e,p,n),p+=a;for(let x=1;x<i;x++){if(this.readEOL()===0){for(c=this._prevChangingElements,this._prevChangingElements=this._currChangingElements,this._currChangingElements=c,h=0,s=-1,b=!0,g=n,this._lastChangingElement=0;g<this._width;){this.getNextChangingElement(s,b,d);let y=d[0],C=d[1];if(o=this.nextLesserThan8Bits(7),o=ce._twoDCodes[o]&255,l=(o&120)>>3,m=o&7,l===0)b||this.setToBlack(e,p,g,C-g),s=C,g=s,this.updatePointer(7-m);else if(l===1){this.updatePointer(7-m);let I=0;b?(I=this.decodeWhiteCodeWord(),g+=I,this._currChangingElements[h++]=g,I=this.decodeBlackCodeWord(),this.setToBlack(e,p,g,I),g+=I,this._currChangingElements[h++]=g):(I=this.decodeBlackCodeWord(),this.setToBlack(e,p,g,I),g+=I,this._currChangingElements[h++]=g,I=this.decodeWhiteCodeWord(),g+=I,this._currChangingElements[h++]=g),s=g}else if(l<=8)u=y+(l-5),this._currChangingElements[h++]=u,b||this.setToBlack(e,p,g,u-g),s=u,g=s,b=!b,this.updatePointer(7-m);else throw new T("TIFFFaxDecoder4")}this._currChangingElements[h++]=g,this._changingElemSize=h}else this.decodeNextScanline(e,p,n);p+=a}}decodeT6(e,t,n,i,r){this._data=t,this._compression=4,this._bitPointer=0,this._bytePointer=0;let a=Math.trunc((this._width+7)/8),s=0,u=0,o=0,l=0,m=0,b=0,h=0,c=!1,d=0,p,g=new Array(2);g.fill(0),this._uncompressedMode=(r&2)>>1;let x=this._currChangingElements;this._changingElemSize=0,x[this._changingElemSize++]=this._width,x[this._changingElemSize++]=this._width;let y=0,C=0;for(let I=0;I<i;I++){for(s=-1,c=!0,p=this._prevChangingElements,this._prevChangingElements=this._currChangingElements,x=this._currChangingElements=p,d=0,C=n,this._lastChangingElement=0;C<this._width;)if(this.getNextChangingElement(s,c,g),o=g[0],l=g[1],m=this.nextLesserThan8Bits(7),m=ce._twoDCodes[m]&255,b=(m&120)>>3,h=m&7,b===0)c||this.setToBlack(e,y,C,l-C),s=l,C=s,this.updatePointer(7-h);else if(b===1){this.updatePointer(7-h);let P=0;c?(P=this.decodeWhiteCodeWord(),C+=P,x[d++]=C,P=this.decodeBlackCodeWord(),this.setToBlack(e,y,C,P),C+=P,x[d++]=C):(P=this.decodeBlackCodeWord(),this.setToBlack(e,y,C,P),C+=P,x[d++]=C,P=this.decodeWhiteCodeWord(),C+=P,x[d++]=C),s=C}else if(b<=8)u=o+(b-5),x[d++]=u,c||this.setToBlack(e,y,C,u-C),s=u,C=s,c=!c,this.updatePointer(7-h);else if(b===11){if(this.nextLesserThan8Bits(3)!==7)throw new T("TIFFFaxDecoder5");let P=0,F=!1;for(;!F;){for(;this.nextLesserThan8Bits(1)!==1;)P++;P>5&&(P-=6,!c&&P>0&&(x[d++]=C),C+=P,P>0&&(c=!0),this.nextLesserThan8Bits(1)===0?(c||(x[d++]=C),c=!0):(c&&(x[d++]=C),c=!1),F=!0),P===5?(c||(x[d++]=C),C+=P,c=!0):(C+=P,x[d++]=C,this.setToBlack(e,y,C,1),++C,c=!1)}}else throw new T(`TIFFFaxDecoder5 ${b}`);x[d++]=C,this._changingElemSize=d,y+=a}}},We=ce;We._table1=[0,1,3,7,15,31,63,127,255],We._table2=[0,128,192,224,240,248,252,254,255],We._flipTable=[0,-128,64,-64,32,-96,96,-32,16,-112,80,-48,48,-80,112,-16,8,-120,72,-56,40,-88,104,-24,24,-104,88,-40,56,-72,120,-8,4,-124,68,-60,36,-92,100,-28,20,-108,84,-44,52,-76,116,-12,12,-116,76,-52,44,-84,108,-20,28,-100,92,-36,60,-68,124,-4,2,-126,66,-62,34,-94,98,-30,18,-110,82,-46,50,-78,114,-14,10,-118,74,-54,42,-86,106,-22,26,-102,90,-38,58,-70,122,-6,6,-122,70,-58,38,-90,102,-26,22,-106,86,-42,54,-74,118,-10,14,-114,78,-50,46,-82,110,-18,30,-98,94,-34,62,-66,126,-2,1,-127,65,-63,33,-95,97,-31,17,-111,81,-47,49,-79,113,-15,9,-119,73,-55,41,-87,105,-23,25,-103,89,-39,57,-71,121,-7,5,-123,69,-59,37,-91,101,-27,21,-107,85,-43,53,-75,117,-11,13,-115,77,-51,45,-83,109,-19,29,-99,93,-35,61,-67,125,-3,3,-125,67,-61,35,-93,99,-29,19,-109,83,-45,51,-77,115,-13,11,-117,75,-53,43,-85,107,-21,27,-101,91,-37,59,-69,123,-5,7,-121,71,-57,39,-89,103,-25,23,-105,87,-41,55,-73,119,-9,15,-113,79,-49,47,-81,111,-17,31,-97,95,-33,63,-65,127,-1],We._white=[6430,6400,6400,6400,3225,3225,3225,3225,944,944,944,944,976,976,976,976,1456,1456,1456,1456,1488,1488,1488,1488,718,718,718,718,718,718,718,718,750,750,750,750,750,750,750,750,1520,1520,1520,1520,1552,1552,1552,1552,428,428,428,428,428,428,428,428,428,428,428,428,428,428,428,428,654,654,654,654,654,654,654,654,1072,1072,1072,1072,1104,1104,1104,1104,1136,1136,1136,1136,1168,1168,1168,1168,1200,1200,1200,1200,1232,1232,1232,1232,622,622,622,622,622,622,622,622,1008,1008,1008,1008,1040,1040,1040,1040,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,396,396,396,396,396,396,396,396,396,396,396,396,396,396,396,396,1712,1712,1712,1712,1744,1744,1744,1744,846,846,846,846,846,846,846,846,1264,1264,1264,1264,1296,1296,1296,1296,1328,1328,1328,1328,1360,1360,1360,1360,1392,1392,1392,1392,1424,1424,1424,1424,686,686,686,686,686,686,686,686,910,910,910,910,910,910,910,910,1968,1968,1968,1968,2e3,2e3,2e3,2e3,2032,2032,2032,2032,16,16,16,16,10257,10257,10257,10257,12305,12305,12305,12305,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,330,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,362,878,878,878,878,878,878,878,878,1904,1904,1904,1904,1936,1936,1936,1936,-18413,-18413,-16365,-16365,-14317,-14317,-10221,-10221,590,590,590,590,590,590,590,590,782,782,782,782,782,782,782,782,1584,1584,1584,1584,1616,1616,1616,1616,1648,1648,1648,1648,1680,1680,1680,1680,814,814,814,814,814,814,814,814,1776,1776,1776,1776,1808,1808,1808,1808,1840,1840,1840,1840,1872,1872,1872,1872,6157,6157,6157,6157,6157,6157,6157,6157,6157,6157,6157,6157,6157,6157,6157,6157,-12275,-12275,-12275,-12275,-12275,-12275,-12275,-12275,-12275,-12275,-12275,-12275,-12275,-12275,-12275,-12275,14353,14353,14353,14353,16401,16401,16401,16401,22547,22547,24595,24595,20497,20497,20497,20497,18449,18449,18449,18449,26643,26643,28691,28691,30739,30739,-32749,-32749,-30701,-30701,-28653,-28653,-26605,-26605,-24557,-24557,-22509,-22509,-20461,-20461,8207,8207,8207,8207,8207,8207,8207,8207,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,4107,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,266,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,298,524,524,524,524,524,524,524,524,524,524,524,524,524,524,524,524,556,556,556,556,556,556,556,556,556,556,556,556,556,556,556,556,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,136,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,168,460,460,460,460,460,460,460,460,460,460,460,460,460,460,460,460,492,492,492,492,492,492,492,492,492,492,492,492,492,492,492,492,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,2059,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232,232],We._additionalMakeup=[28679,28679,31752,-32759,-31735,-30711,-29687,-28663,29703,29703,30727,30727,-27639,-26615,-25591,-24567],We._initBlack=[3226,6412,200,168,38,38,134,134,100,100,100,100,68,68,68,68],We._twoBitBlack=[292,260,226,226],We._black=[62,62,30,30,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,3225,588,588,588,588,588,588,588,588,1680,1680,20499,22547,24595,26643,1776,1776,1808,1808,-24557,-22509,-20461,-18413,1904,1904,1936,1936,-16365,-14317,782,782,782,782,814,814,814,814,-12269,-10221,10257,10257,12305,12305,14353,14353,16403,18451,1712,1712,1744,1744,28691,30739,-32749,-30701,-28653,-26605,2061,2061,2061,2061,2061,2061,2061,2061,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,424,750,750,750,750,1616,1616,1648,1648,1424,1424,1456,1456,1488,1488,1520,1520,1840,1840,1872,1872,1968,1968,8209,8209,524,524,524,524,524,524,524,524,556,556,556,556,556,556,556,556,1552,1552,1584,1584,2e3,2e3,2032,2032,976,976,1008,1008,1040,1040,1072,1072,1296,1296,1328,1328,718,718,718,718,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,456,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,326,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,358,490,490,490,490,490,490,490,490,490,490,490,490,490,490,490,490,4113,4113,6161,6161,848,848,880,880,912,912,944,944,622,622,622,622,654,654,654,654,1104,1104,1136,1136,1168,1168,1200,1200,1232,1232,1264,1264,686,686,686,686,1360,1360,1392,1392,12,12,12,12,12,12,12,12,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390,390],We._twoDCodes=[80,88,23,71,30,30,62,62,4,4,4,4,4,4,4,4,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41]});var er=A(()=>{"use strict"});var Sa=A(()=>{"use strict"});var ka,bn,za=A(()=>{"use strict";be();ka=class{constructor(){this._buffer=new Uint8Array(4096);this._bitsToGet=9;this._bytePointer=0;this._nextData=0;this._nextBits=0}addString(e,t){this._table[this._tableIndex]=t,this._prefix[this._tableIndex]=e,this._tableIndex=this._tableIndex+1,this._tableIndex===511?this._bitsToGet=10:this._tableIndex===1023?this._bitsToGet=11:this._tableIndex===2047&&(this._bitsToGet=12)}getString(e){this._bufferLength=0;let t=e;for(this._buffer[this._bufferLength++]=this._table[t],t=this._prefix[t];t!==ka._noSuchCode;)this._buffer[this._bufferLength++]=this._table[t],t=this._prefix[t]}getNextCode(){if(this._bytePointer>=this._dataLength)return 257;for(;this._nextBits<this._bitsToGet;){if(this._bytePointer>=this._dataLength)return 257;this._nextData=(this._nextData<<8)+this._data[this._bytePointer++]&4294967295,this._nextBits+=8}return this._nextBits-=this._bitsToGet,this._nextData>>this._nextBits&ka._andTable[this._bitsToGet-9]}initializeStringTable(){this._table=new Uint8Array(ka._lzMaxCode+1),this._prefix=new Uint32Array(ka._lzMaxCode+1),this._prefix.fill(ka._noSuchCode,0,this._prefix.length);for(let e=0;e<256;e++)this._table[e]=e;this._bitsToGet=9,this._tableIndex=258}decode(e,t){this._out=t;let n=t.length;if(this._outPointer=0,this._data=e.buffer,this._dataLength=this._data.length,this._bytePointer=e.offset,this._data[0]===0&&this._data[1]===1)throw new T("Invalid LZW Data");this.initializeStringTable(),this._nextData=0,this._nextBits=0;let i=0,r=this.getNextCode();for(;r!==257&&this._outPointer<n;){if(r===256){if(this.initializeStringTable(),r=this.getNextCode(),this._bufferLength=0,r===257)break;this._out[this._outPointer++]=r,i=r}else if(r<this._tableIndex){this.getString(r);for(let a=this._bufferLength-1;a>=0;--a)this._out[this._outPointer++]=this._buffer[a];this.addString(i,this._buffer[this._bufferLength-1]),i=r}else{this.getString(i);for(let a=this._bufferLength-1;a>=0;--a)this._out[this._outPointer++]=this._buffer[a];this._out[this._outPointer++]=this._buffer[this._bufferLength-1],this.addString(i,this._buffer[this._bufferLength-1]),i=r}r=this.getNextCode()}}},bn=ka;bn._lzMaxCode=4095,bn._noSuchCode=4098,bn._andTable=[511,1023,2047,4095]});var tr=A(()=>{"use strict"});var gs,Oa,Na=A(()=>{"use strict";gs=ws(ps());ae();H();G();Jt();un();je();be();_n();xe();It();Xi();Aa();Ji();Ba();Ua();er();Sa();za();tr();Oa=class{constructor(e){this._tags=new Map;this._width=0;this._height=0;this._photometricType=16;this._compression=1;this._bitsPerSample=1;this._samplesPerPixel=1;this._sampleFormat=1;this._imageType=9;this._isWhiteZero=!1;this._predictor=1;this._chromaSubH=0;this._chromaSubV=0;this._tiled=!1;this._tileWidth=0;this._tileHeight=0;this._tilesX=0;this._tilesY=0;this._fillOrder=1;this._t4Options=0;this._t6Options=0;this._colorMapSamples=0;this._colorMapRed=0;this._colorMapGreen=0;this._colorMapBlue=0;var i,r,a,s,u,o,l,m,b,h,c,d,p,g;let t=Y.from(e),n=e.readUint16();for(let x=0;x<n;++x){let y=e.readUint16(),C=e.readUint16(),I=C,P=xn[C],F=e.readUint32(),M=0;F*P>4?M=e.readUint32():(M=e.offset,e.skip(4));let w=new Fa({tag:y,type:I,count:F,p:t,valueOffset:M});if(this._tags.set(w.tag,w),y===ne.get("ImageWidth"))this._width=(r=(i=w.read())==null?void 0:i.toInt())!=null?r:0;else if(y===ne.get("ImageLength"))this._height=(s=(a=w.read())==null?void 0:a.toInt())!=null?s:0;else if(y===ne.get("PhotometricInterpretation")){let k=w.read();if(k===void 0)this._photometricType=16;else{let B=k.toInt();B<17?this._photometricType=B:this._photometricType=16}}else if(y===ne.get("Compression"))this._compression=(o=(u=w.read())==null?void 0:u.toInt())!=null?o:0;else if(y===ne.get("BitsPerSample"))this._bitsPerSample=(m=(l=w.read())==null?void 0:l.toInt())!=null?m:0;else if(y===ne.get("SamplesPerPixel"))this._samplesPerPixel=(h=(b=w.read())==null?void 0:b.toInt())!=null?h:0;else if(y===ne.get("Predictor"))this._predictor=(d=(c=w.read())==null?void 0:c.toInt())!=null?d:0;else if(y===ne.get("SampleFormat")){let k=(g=(p=w.read())==null?void 0:p.toInt())!=null?g:0;this._sampleFormat=k}else if(y===ne.get("ColorMap")){let k=w.read();k!==void 0&&(this._colorMap=new Uint16Array(k.toData().buffer),this._colorMapRed=0,this._colorMapGreen=Math.trunc(this._colorMap.length/3),this._colorMapBlue=this._colorMapGreen*2)}}if(this._colorMap!==void 0&&this._photometricType===3&&(this._colorMapSamples=3,this._samplesPerPixel=1),!(this._width===0||this._height===0)){if(this._colorMap!==void 0&&this._bitsPerSample===8){let x=this._colorMap,y=x.length;for(let C=0;C<y;++C)x[C]>>=8}if(this._photometricType===0&&(this._isWhiteZero=!0),this.hasTag(ne.get("TileOffsets")))this._tiled=!0,this._tileWidth=this.readTag(ne.get("TileWidth")),this._tileHeight=this.readTag(ne.get("TileLength")),this._tileOffsets=this.readTagList(ne.get("TileOffsets")),this._tileByteCounts=this.readTagList(ne.get("TileByteCounts"));else{if(this._tiled=!1,this._tileWidth=this.readTag(ne.get("TileWidth"),this._width),!this.hasTag(ne.get("RowsPerStrip")))this._tileHeight=this.readTag(ne.get("TileLength"),this._height);else{let x=this.readTag(ne.get("RowsPerStrip")),y=1;y=(y<<32)-1,x===y?this._tileHeight=this._height:this._tileHeight=x}this._tileOffsets=this.readTagList(ne.get("StripOffsets")),this._tileByteCounts=this.readTagList(ne.get("StripByteCounts"))}switch(this._tilesX=Math.trunc((this._width+this._tileWidth-1)/this._tileWidth),this._tilesY=Math.trunc((this._height+this._tileHeight-1)/this._tileHeight),this._tileSize=this._tileWidth*this._tileHeight*this._samplesPerPixel,this._fillOrder=this.readTag(ne.get("FillOrder"),1),this._t4Options=this.readTag(ne.get("T4Options")),this._t6Options=this.readTag(ne.get("T6Options")),this._extraSamples=this.readTag(ne.get("ExtraSamples")),this._photometricType){case 0:case 1:this._bitsPerSample===1&&this._samplesPerPixel===1?this._imageType=0:this._bitsPerSample===4&&this._samplesPerPixel===1?this._imageType=1:this._bitsPerSample%8===0&&(this._samplesPerPixel===1?this._imageType=2:this._samplesPerPixel===2?this._imageType=3:this._imageType=8);break;case 2:this._bitsPerSample%8===0&&(this._samplesPerPixel===3?this._imageType=5:this._samplesPerPixel===4?this._imageType=6:this._imageType=8);break;case 3:this._samplesPerPixel===1&&this._colorMap!==void 0&&(this._bitsPerSample===4||this._bitsPerSample===8||this._bitsPerSample===16)&&(this._imageType=4);break;case 4:this._bitsPerSample===1&&this._samplesPerPixel===1&&(this._imageType=0);break;case 6:if(this._compression===7&&this._bitsPerSample===8&&this._samplesPerPixel===3)this._imageType=5;else{if(this.hasTag(ne.get("YCbCrSubSampling"))){let x=ne.get("YCbCrSubSampling"),y=this._tags.get(x).read();this._chromaSubH=y.toInt(),this._chromaSubV=y.toInt(1)}else this._chromaSubH=2,this._chromaSubV=2;this._chromaSubH*this._chromaSubV===1?this._imageType=8:this._bitsPerSample===8&&this._samplesPerPixel===3&&(this._imageType=7)}break;default:this._bitsPerSample%8===0&&(this._imageType=8);break}}}get tags(){return this._tags}get width(){return this._width}get height(){return this._height}get photometricType(){return this._photometricType}get compression(){return this._compression}get bitsPerSample(){return this._bitsPerSample}get samplesPerPixel(){return this._samplesPerPixel}get sampleFormat(){return this._sampleFormat}get imageType(){return this._imageType}get isWhiteZero(){return this._isWhiteZero}get predictor(){return this._predictor}get chromaSubH(){return this._chromaSubH}get chromaSubV(){return this._chromaSubV}get tiled(){return this._tiled}get tileWidth(){return this._tileWidth}get tileHeight(){return this._tileHeight}get tileOffsets(){return this._tileOffsets}get tileByteCounts(){return this._tileByteCounts}get tilesX(){return this._tilesX}get tilesY(){return this._tilesY}get tileSize(){return this._tileSize}get fillOrder(){return this._fillOrder}get t4Options(){return this._t4Options}get t6Options(){return this._t6Options}get extraSamples(){return this._extraSamples}get colorMapSamples(){return this._colorMapSamples}get colorMap(){return this._colorMap}get isValid(){return this._width!==0&&this._height!==0}readTag(e,t=0){var n,i;return this.hasTag(e)?(i=(n=this._tags.get(e).read())==null?void 0:n.toInt())!=null?i:0:t}readTagList(e){if(!this.hasTag(e))return;let t=this._tags.get(e),n=t.read();return U.generate(t.count,i=>n.toInt(i))}decodeBilevelTile(e,t,n,i){let r=i*this._tilesX+n;e.offset=this._tileOffsets[r];let a=n*this._tileWidth,s=i*this._tileHeight,u=this._tileByteCounts[r],o;if(this._compression===32773){let c=0;this._tileWidth%8===0?c=Math.trunc(this._tileWidth/8)*this._tileHeight:c=(Math.trunc(this._tileWidth/8)+1)*this._tileHeight,o=new Y({buffer:new Uint8Array(this._tileWidth*this._tileHeight)}),this.decodePackBits(e,c,o.buffer)}else if(this._compression===5){if(o=new Y({buffer:new Uint8Array(this._tileWidth*this._tileHeight)}),new bn().decode(Y.from(e,0,u),o.buffer),this._predictor===2){let d=0;for(let p=0;p<this._height;p++){d=this._samplesPerPixel*(p*this._width+1);for(let g=this._samplesPerPixel;g<this._width*this._samplesPerPixel;g++){let x=o.getByte(d)+o.getByte(d-this._samplesPerPixel);o.setByte(d,x),d++}}}}else if(this._compression===2){o=new Y({buffer:new Uint8Array(this._tileWidth*this._tileHeight)});try{new We({fillOrder:this._fillOrder,width:this._tileWidth,height:this._tileHeight}).decode1D(o,e,0,this._tileHeight)}catch(c){}}else if(this._compression===3){o=new Y({buffer:new Uint8Array(this._tileWidth*this._tileHeight)});try{new We({fillOrder:this._fillOrder,width:this._tileWidth,height:this._tileHeight}).decode2D(o,e,0,this._tileHeight,this._t4Options)}catch(c){}}else if(this._compression===4){o=new Y({buffer:new Uint8Array(this._tileWidth*this._tileHeight)});try{new We({fillOrder:this._fillOrder,width:this._tileWidth,height:this._tileHeight}).decodeT6(o,e,0,this._tileHeight,this._t6Options)}catch(c){}}else if(this._compression===8){let c=e.toUint8Array(0,u),d=(0,gs.inflate)(c);o=new Y({buffer:d})}else if(this._compression===32946){let c=e.toUint8Array(0,u),d=(0,gs.inflate)(c);o=new Y({buffer:d})}else if(this._compression===1)o=e;else throw new T(`Unsupported Compression Type: ${this._compression}`);let l=new Ki(o),m=t.maxChannelValue,b=this._isWhiteZero?m:0,h=this._isWhiteZero?0:m;for(let c=0,d=s;c<this._tileHeight;++c,++d){for(let p=0,g=a;p<this._tileWidth&&!(d>=t.height||g>=t.width);++p,++g)l.readBits(1)===0?t.setPixelRgb(g,d,b,0,0):t.setPixelRgb(g,d,h,0,0);l.flushByte()}}decodeTile(e,t,n,i){if(this._imageType===0){this.decodeBilevelTile(e,t,n,i);return}let r=i*this._tilesX+n;e.offset=this._tileOffsets[r];let a=n*this._tileWidth,s=i*this._tileHeight,u=this._tileByteCounts[r],o=this._tileWidth*this._tileHeight*this._samplesPerPixel;this._bitsPerSample===16?o*=2:this._bitsPerSample===32&&(o*=4);let l;if(this._bitsPerSample===8||this._bitsPerSample===16||this._bitsPerSample===32||this._bitsPerSample===64){if(this._compression===1)l=e;else if(this._compression===5){l=new Y({buffer:new Uint8Array(o)});let m=new bn;try{m.decode(Y.from(e,0,u),l.buffer)}catch(b){}if(this._predictor===2){let b=0;for(let h=0;h<this._tileHeight;h++){b=this._samplesPerPixel*(h*this._tileWidth+1);let c=this._tileWidth*this._samplesPerPixel;for(let d=this._samplesPerPixel;d<c;d++)l.setByte(b,l.getByte(b)+l.getByte(b-this._samplesPerPixel)),b++}}}else if(this._compression===32773)l=new Y({buffer:new Uint8Array(o)}),this.decodePackBits(e,o,l.buffer);else if(this._compression===32946){let m=e.toUint8Array(0,u),b=(0,gs.inflate)(m);l=new Y({buffer:b})}else if(this._compression===8){let m=e.toUint8Array(0,u),b=(0,gs.inflate)(m);l=new Y({buffer:b})}else if(this._compression===6){let m=e.toUint8Array(0,u),b=new Yi().decode(m);b!==void 0&&this.jpegToImage(b,t,a,s,this._tileWidth,this._tileHeight);return}else throw new T(`Unsupported Compression Type: ${this._compression}`);for(let m=0,b=s;m<this._tileHeight&&b<this._height;++m,++b)for(let h=0,c=a;h<this._tileWidth&&c<this._width;++h,++c)if(this._samplesPerPixel===1)if(this._sampleFormat===3){let d=0;this._bitsPerSample===32?d=l.readFloat32():this._bitsPerSample===64?d=l.readFloat64():this._bitsPerSample===16&&(d=R.float16ToDouble(l.readUint16())),t.setPixelR(c,b,d)}else{let d=0;this._bitsPerSample===8?d=this._sampleFormat===2?l.readInt8():l.readByte():this._bitsPerSample===16?d=this._sampleFormat===2?l.readInt16():l.readUint16():this._bitsPerSample===32&&(d=this._sampleFormat===2?l.readInt32():l.readUint32()),this._photometricType===0&&(d=Math.trunc(t.maxChannelValue)-d),t.setPixelR(c,b,d)}else if(this._samplesPerPixel===2){let d=0,p=0;this._bitsPerSample===8?(d=this._sampleFormat===2?l.readInt8():l.readByte(),p=this._sampleFormat===2?l.readInt8():l.readByte()):this._bitsPerSample===16?(d=this._sampleFormat===2?l.readInt16():l.readUint16(),p=this._sampleFormat===2?l.readInt16():l.readUint16()):this._bitsPerSample===32&&(d=this._sampleFormat===2?l.readInt32():l.readUint32(),p=this._sampleFormat===2?l.readInt32():l.readUint32()),t.setPixelRgb(c,b,d,p,0)}else if(this._samplesPerPixel===3)if(this._sampleFormat===3){let d=0,p=0,g=0;this._bitsPerSample===32?(d=l.readFloat32(),p=l.readFloat32(),g=l.readFloat32()):this._bitsPerSample===64?(d=l.readFloat64(),p=l.readFloat64(),g=l.readFloat64()):this._bitsPerSample===16&&(d=R.float16ToDouble(l.readUint16()),p=R.float16ToDouble(l.readUint16()),g=R.float16ToDouble(l.readUint16())),t.setPixelRgb(c,b,d,p,g)}else{let d=0,p=0,g=0;this._bitsPerSample===8?(d=this._sampleFormat===2?l.readInt8():l.readByte(),p=this._sampleFormat===2?l.readInt8():l.readByte(),g=this._sampleFormat===2?l.readInt8():l.readByte()):this._bitsPerSample===16?(d=this._sampleFormat===2?l.readInt16():l.readUint16(),p=this._sampleFormat===2?l.readInt16():l.readUint16(),g=this._sampleFormat===2?l.readInt16():l.readUint16()):this._bitsPerSample===32&&(d=this._sampleFormat===2?l.readInt32():l.readUint32(),p=this._sampleFormat===2?l.readInt32():l.readUint32(),g=this._sampleFormat===2?l.readInt32():l.readUint32()),t.setPixelRgb(c,b,d,p,g)}else if(this._samplesPerPixel>=4)if(this._sampleFormat===3){let d=0,p=0,g=0,x=0;this._bitsPerSample===32?(d=l.readFloat32(),p=l.readFloat32(),g=l.readFloat32(),x=l.readFloat32()):this._bitsPerSample===64?(d=l.readFloat64(),p=l.readFloat64(),g=l.readFloat64(),x=l.readFloat64()):this._bitsPerSample===16&&(d=R.float16ToDouble(l.readUint16()),p=R.float16ToDouble(l.readUint16()),g=R.float16ToDouble(l.readUint16()),x=R.float16ToDouble(l.readUint16())),t.setPixelRgba(c,b,d,p,g,x)}else{let d=0,p=0,g=0,x=0;if(this._bitsPerSample===8?(d=this._sampleFormat===2?l.readInt8():l.readByte(),p=this._sampleFormat===2?l.readInt8():l.readByte(),g=this._sampleFormat===2?l.readInt8():l.readByte(),x=this._sampleFormat===2?l.readInt8():l.readByte()):this._bitsPerSample===16?(d=this._sampleFormat===2?l.readInt16():l.readUint16(),p=this._sampleFormat===2?l.readInt16():l.readUint16(),g=this._sampleFormat===2?l.readInt16():l.readUint16(),x=this._sampleFormat===2?l.readInt16():l.readUint16()):this._bitsPerSample===32&&(d=this._sampleFormat===2?l.readInt32():l.readUint32(),p=this._sampleFormat===2?l.readInt32():l.readUint32(),g=this._sampleFormat===2?l.readInt32():l.readUint32(),x=this._sampleFormat===2?l.readInt32():l.readUint32()),this._photometricType===5){let y=z.cmykToRgb(d,p,g,x);d=y[0],p=y[1],g=y[2],x=Math.trunc(t.maxChannelValue)}t.setPixelRgba(c,b,d,p,g,x)}}else throw new T(`Unsupported bitsPerSample: ${this._bitsPerSample}`)}jpegToImage(e,t,n,i,r,a){let s=r,u=a;for(let o=0;o<u;o++)for(let l=0;l<s;l++)t.setPixel(l+n,o+i,e.getPixel(l,o))}decodePackBits(e,t,n){let i=0,r=0;for(;r<t;){let a=K.uint8ToInt8(e.getByte(i++));if(a>=0&&a<=127)for(let s=0;s<a+1;++s)n[r++]=e.getByte(i++);else if(a<=-1&&a>=-127){let s=e.getByte(i++);for(let u=0;u<-a+1;++u)n[r++]=s}else i++}}decode(e){let t=this._sampleFormat===3,n=this._sampleFormat===2,i=this._bitsPerSample===1?0:this._bitsPerSample===2?1:this._bitsPerSample===4?2:t&&this._bitsPerSample===16?9:t&&this._bitsPerSample===32?10:t&&this._bitsPerSample===64?11:n&&this._bitsPerSample===8?6:n&&this._bitsPerSample===16?7:n&&this._bitsPerSample===32?8:this._bitsPerSample===16?4:this._bitsPerSample===32?5:3,r=this._colorMap!==void 0&&this._photometricType===3,a=r?3:this._samplesPerPixel,s=new Q({width:this._width,height:this._height,format:i,numChannels:a,withPalette:r});if(r){let u=s.palette,o=this._colorMap,l=3,m=Math.trunc(o.length/l);for(let b=0;b<m;++b)u.setRgb(b,o[this._colorMapRed+b],o[this._colorMapGreen+b],o[this._colorMapBlue+b])}for(let u=0,o=0;u<this._tilesY;++u)for(let l=0;l<this._tilesX;++l,++o)this.decodeTile(e,s,l,u);return s}hasTag(e){return this._tags.has(e)}}});var Ra,Da=A(()=>{"use strict";Ra=class{constructor(e){this._images=[];this._width=0;this._height=0;this._backgroundColor=void 0;this._bigEndian=e.bigEndian,this._signature=e.signature,this._ifdOffset=e.ifdOffset,this._images=e.images,this._images.length>0&&(this._width=this._images[0].width,this._height=this._images[0].height)}get bigEndian(){return this._bigEndian}get signature(){return this._signature}get ifdOffset(){return this._ifdOffset}get images(){return this._images}get width(){return this._width}get height(){return this._height}get backgroundColor(){throw this._backgroundColor}get numFrames(){return this._images.length}}});var Qa,ii,Va=A(()=>{"use strict";je();Tt();Yn();Na();Da();Qa=class{constructor(){this._info=void 0;this._exifData=void 0}get info(){return this._info}get exifData(){return this._exifData}get numFrames(){return this._info!==void 0?this._info.images.length:0}readHeader(e){let t=e.readUint16();if(t!==Qa._tiffLittleEndian&&t!==Qa._tiffBigEndian)return;let n=!1;t===Qa._tiffBigEndian?(e.bigEndian=!0,n=!0):(e.bigEndian=!1,n=!1);let i=0;if(i=e.readUint16(),i!==Qa._tiffSignature)return;let r=e.readUint32(),a=r,s=Y.from(e);s.offset=r;let u=[];for(;r!==0;){let o;try{if(o=new Oa(s),!o.isValid)break}catch(l){break}u.push(o),r=s.readUint32(),r!==0&&(s.offset=r)}return u.length>0?new Ra({bigEndian:n,signature:i,ifdOffset:a,images:u}):void 0}isValidFile(e){let t=new Y({buffer:e});return this.readHeader(t)!==void 0}startDecode(e){if(this._input=new Y({buffer:e}),this._info=this.readHeader(this._input),this.info!==void 0){let t=new Y({buffer:e});this._exifData=Ie.fromInputBuffer(t)}return this._info}decodeFrame(e){if(this._info===void 0)return;let t=this._info.images[e].decode(this._input);return this._exifData!==void 0&&(t.exifData=this._exifData),t}decode(e,t){if(this._input=new Y({buffer:e}),this._info=this.readHeader(this._input),this._info===void 0)return;let n=this.numFrames;if(n===1||t!==void 0)return this.decodeFrame(t!=null?t:0);let i=this.decodeFrame(0);if(i!==void 0){i.exifData=Ie.fromInputBuffer(new Y({buffer:e})),i.frameType=1;for(let r=1;r<n;++r){let a=this.decodeFrame(r);i.addFrame(a)}return i}}},ii=Qa;ii._tiffSignature=42,ii._tiffLittleEndian=18761,ii._tiffBigEndian=19789});var Ta=A(()=>{"use strict";H();At();be();Tt();Ln();Ji();er();tr()});var nr=A(()=>{"use strict"});var wu,La=A(()=>{"use strict";wu=ws(ps());G();nr()});var xs=A(()=>{"use strict"});var _s=A(()=>{"use strict"});var ys=A(()=>{"use strict"});var Ea=A(()=>{"use strict"});var Ha=A(()=>{"use strict"});var qa=A(()=>{"use strict"});var Ka=A(()=>{"use strict";be();gn();Sn();_e();Tt();It();xi();Ea();Ha();gi();zn();kn();qa()});var Cs=A(()=>{"use strict";Ti();Hr();Xr();Zr();Ga();na();Xi();_a();ir();Hi();Pa();Ma();Va();Ta();Qn();Wn();Ca();De();oe();fi();ri();ai();oi();si();ui();dn();pn();li();hi();bi();en();mi();ci();H();G();Jt();pi();un();je();Sn();sr();_e();At();gn();ur();sn();gi();nn();kn();or();zn();be();Nn();Dn();$n();Vn();Rn();Tn();_i();Gn();Hn();qn();En();Ln();Ve();Tt();mr();_n();Ci();yi();xe();Wn();Er();Rr();Dr();Vr();Lr();Di();Fn();Vi();Li();$r();Yr();Qr();Kr();ea();Jr();qi();Gi();$i();sa();ra();oa();Wi();ma();ha();ba();da();Bn();pa();xa();Ca();ji();Ei();Zi();Qn();wa();va();Qi();Ia();Aa();Ji();Ba();Ua();er();Sa();Na();Da();za();tr();Ti();Hr();qr();Xr();Zr();Ga();na();Xi();_a();ir();Hi();Pa();Ma();Va();Ta();ta();Yn();Or();La();nr();wi();vi();Ii();Ai();Pi();Mi();Fi();Ui();ki();Xn();Bi();Si();xi();It();jn();Nr();Ri();vr();Ir();Pr();Fr();Mr();Ar();Xt();Br();zi();hr();cr();br();pr();fr();dr();gr();_r();Cr();wr();xr();yr();Ur();$e();kr();jr();Ea();Ka();qa();Ha()});var ps=ku((a3,gu)=>{De();oe();fi();ri();ai();si();ui();oi();dn();pn();li();mi();hi();ci();bi();en();ae();ts();H();G();Jt();pi();un();je();Sn();sr();_e();At();gn();ur();sn();gi();nn();is();kn();or();zn();be();Tt();mr();_n();Ci();yi();xe();Nn();Dn();$n();Vn();Rn();Tn();_i();Gn();Hn();qn();En();Ln();Ve();Wn();Er();Rr();Dr();Vr();Lr();Ti();Hr();Di();Fn();Vi();cs();bs();qr();fs();Xr();Zr();Li();$r();Yr();Ga();na();Qr();Kr();ea();Jr();Xi();_a();qi();Gi();$i();sa();ra();oa();Wi();ma();ha();ba();da();Bn();pa();xa();Ca();ir();Hi();ji();Ei();Zi();Qn();wa();va();Pa();Ma();Qi();Ia();Va();Ta();Aa();Ji();Ba();Ua();er();Sa();Na();Da();za();tr();ta();Yn();Or();nr();La();wi();vi();Ii();Pi();Mi();Ai();Fi();Bi();Ui();Si();ki();Xn();xs();xi();It();jn();Nr();Ri();vr();Ir();Pr();Mr();Ar();Fr();Br();zi();Xt();_s();hr();cr();br();fr();dr();pr();$e();gr();xr();_r();yr();Cr();wr();Ur();kr();jr();ys();Cs();Ea();Ka();qa();Ha();var S={};typeof gu=="object"&&(gu.exports=S);S.parse=function(f,e){for(var t=S.bin.readUshort,n=S.bin.readUint,s=0,i={},r=new Uint8Array(f),a=r.length-4;n(r,a)!=101010256;)a--;var s=a;s+=4,s+=4;var u=t(r,s);s+=2;var o=t(r,s);s+=2;var l=n(r,s);s+=4;var m=n(r,s);s+=4,s=m;for(var b=0;b<u;b++){var h=n(r,s);s+=4,s+=4,s+=4,s+=4;var c=n(r,s);s+=4;var l=n(r,s);s+=4;var d=n(r,s);s+=4;var p=t(r,s),g=t(r,s+2),x=t(r,s+4);s+=6,s+=8;var y=n(r,s);s+=4,s+=p+g+x,S._readLocal(r,y,i,l,d,e)}return i};S._readLocal=function(f,e,t,n,i,r){var a=S.bin.readUshort,s=S.bin.readUint,u=s(f,e);e+=4;var o=a(f,e);e+=2;var l=a(f,e);e+=2;var m=a(f,e);e+=2;var b=s(f,e);e+=4;var h=s(f,e);e+=4,e+=8;var c=a(f,e);e+=2;var d=a(f,e);e+=2;var p=S.bin.readUTF8(f,e,c);if(e+=c,e+=d,r){t[p]={size:i,csize:n};return}var g=new Uint8Array(f.buffer,e);if(m==0)t[p]=new Uint8Array(g.buffer.slice(e,e+n));else if(m==8){var x=new Uint8Array(i);S.inflateRaw(g,x),t[p]=x}else throw"unknown compression method: "+m};S.inflateRaw=function(f,e){return S.F.inflate(f,e)};S.inflate=function(f,e){var t=f[0],n=f[1],i=t&15,r=t>>>4;return S.inflateRaw(new Uint8Array(f.buffer,f.byteOffset+2,f.length-6),e)};S.deflate=function(f,e){e==null&&(e={level:6});var t=0,n=new Uint8Array(50+Math.floor(f.length*1.1));n[t]=120,n[t+1]=156,t+=2,t=S.F.deflateRaw(f,n,t,e.level);var i=S.adler(f,0,f.length);return n[t+0]=i>>>24&255,n[t+1]=i>>>16&255,n[t+2]=i>>>8&255,n[t+3]=i>>>0&255,new Uint8Array(n.buffer,0,t+4)};S.deflateRaw=function(f,e){e==null&&(e={level:6});var t=new Uint8Array(50+Math.floor(f.length*1.1)),n=S.F.deflateRaw(f,t,n,e.level);return new Uint8Array(t.buffer,0,n)};S.encode=function(f,e){e==null&&(e=!1);var t=0,n=S.bin.writeUint,i=S.bin.writeUshort,r={};for(var a in f){var s=!S._noNeed(a)&&!e,u=f[a],o=S.crc.crc(u,0,u.length);r[a]={cpr:s,usize:u.length,crc:o,file:s?S.deflateRaw(u):u}}for(var a in r)t+=r[a].file.length+30+46+2*S.bin.sizeUTF8(a);t+=22;var l=new Uint8Array(t),m=0,b=[];for(var a in r){var h=r[a];b.push(m),m=S._writeHeader(l,m,a,h,0)}var c=0,d=m;for(var a in r){var h=r[a];b.push(m),m=S._writeHeader(l,m,a,h,1,b[c++])}var p=m-d;return n(l,m,101010256),m+=4,m+=4,i(l,m,c),m+=2,i(l,m,c),m+=2,n(l,m,p),m+=4,n(l,m,d),m+=4,m+=2,l.buffer};S._noNeed=function(f){var e=f.split(".").pop().toLowerCase();return"png,jpg,jpeg,zip".indexOf(e)!=-1};S._writeHeader=function(f,e,t,n,i,r){var a=S.bin.writeUint,s=S.bin.writeUshort,u=n.file;a(f,e,i==0?67324752:33639248),e+=4,i==1&&(e+=2),s(f,e,20),e+=2,s(f,e,0),e+=2,s(f,e,n.cpr?8:0),e+=2,a(f,e,0),e+=4,a(f,e,n.crc),e+=4,a(f,e,u.length),e+=4,a(f,e,n.usize),e+=4,s(f,e,S.bin.sizeUTF8(t)),e+=2,s(f,e,0),e+=2,i==1&&(e+=2,e+=2,e+=6,a(f,e,r),e+=4);var o=S.bin.writeUTF8(f,e,t);return e+=o,i==0&&(f.set(u,e),e+=u.length),e};S.crc={table:function(){for(var f=new Uint32Array(256),e=0;e<256;e++){for(var t=e,n=0;n<8;n++)t&1?t=3988292384^t>>>1:t=t>>>1;f[e]=t}return f}(),update:function(f,e,t,n){for(var i=0;i<n;i++)f=S.crc.table[(f^e[t+i])&255]^f>>>8;return f},crc:function(f,e,t){return S.crc.update(4294967295,f,e,t)^4294967295}};S.adler=function(f,e,t){for(var n=1,i=0,r=e,a=e+t;r<a;){for(var s=Math.min(r+5552,a);r<s;)n+=f[r++],i+=n;n=n%65521,i=i%65521}return i<<16|n};S.bin={readUshort:function(f,e){return f[e]|f[e+1]<<8},writeUshort:function(f,e,t){f[e]=t&255,f[e+1]=t>>8&255},readUint:function(f,e){return f[e+3]*(256*256*256)+(f[e+2]<<16|f[e+1]<<8|f[e])},writeUint:function(f,e,t){f[e]=t&255,f[e+1]=t>>8&255,f[e+2]=t>>16&255,f[e+3]=t>>24&255},readASCII:function(f,e,t){for(var n="",i=0;i<t;i++)n+=String.fromCharCode(f[e+i]);return n},writeASCII:function(f,e,t){for(var n=0;n<t.length;n++)f[e+n]=t.charCodeAt(n)},pad:function(f){return f.length<2?"0"+f:f},readUTF8:function(f,e,t){for(var n="",i,r=0;r<t;r++)n+="%"+S.bin.pad(f[e+r].toString(16));try{i=decodeURIComponent(n)}catch{return S.bin.readASCII(f,e,t)}return i},writeUTF8:function(f,e,t){for(var n=t.length,i=0,r=0;r<n;r++){var a=t.charCodeAt(r);if(!(a&4294967295-(1<<7)+1))f[e+i]=a,i++;else if(!(a&4294967295-(1<<11)+1))f[e+i]=192|a>>6,f[e+i+1]=128|a>>0&63,i+=2;else if(!(a&4294967295-(1<<16)+1))f[e+i]=224|a>>12,f[e+i+1]=128|a>>6&63,f[e+i+2]=128|a>>0&63,i+=3;else if(!(a&4294967295-(1<<21)+1))f[e+i]=240|a>>18,f[e+i+1]=128|a>>12&63,f[e+i+2]=128|a>>6&63,f[e+i+3]=128|a>>0&63,i+=4;else throw"e"}return i},sizeUTF8:function(f){for(var e=f.length,t=0,n=0;n<e;n++){var i=f.charCodeAt(n);if(!(i&4294967295-(1<<7)+1))t++;else if(!(i&4294967295-(1<<11)+1))t+=2;else if(!(i&4294967295-(1<<16)+1))t+=3;else if(!(i&4294967295-(1<<21)+1))t+=4;else throw"e"}return t}};S.F={};S.F.deflateRaw=function(f,e,t,n){var i=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]],r=i[n],a=S.F.U,s=S.F._goodIndex,u=S.F._hash,o=S.F._putsE,l=0,m=t<<3,b=0,h=f.length;if(n==0){for(;l<h;){var c=Math.min(65535,h-l);o(e,m,l+c==h?1:0),m=S.F._copyExact(f,l,c,e,m+8),l+=c}return m>>>3}var d=a.lits,p=a.strt,g=a.prev,x=0,y=0,C=0,I=0,P=0,F=0;h>2&&(F=S.F._hash(f,0),p[F]=0);var M=0,w=0;for(l=0;l<h;l++){if(P=F,l+1<h-2){F=S.F._hash(f,l+1);var k=l+1&32767;g[k]=p[F],p[F]=k}if(b<=l){(x>14e3||y>26697)&&h-l>100&&(b<l&&(d[x]=l-b,x+=2,b=l),m=S.F._writeBlock(l==h-1||b==h?1:0,d,x,I,f,C,l-C,e,m),x=y=I=0,C=l);var B=0;l<h-2&&(B=S.F._bestMatch(f,l,g,P,Math.min(r[2],h-l),r[3]));var c=B>>>16,N=B&65535;if(B!=0){var c=B>>>16,N=B&65535,O=s(c,a.of0);a.lhst[257+O]++;var V=s(N,a.df0);a.dhst[V]++,I+=a.exb[O]+a.dxb[V],d[x]=c<<23|l-b,d[x+1]=N<<16|O<<8|V,x+=2,b=l+c}else a.lhst[f[l]]++;y++}}for((C!=l||f.length==0)&&(b<l&&(d[x]=l-b,x+=2,b=l),m=S.F._writeBlock(1,d,x,I,f,C,l-C,e,m),x=0,y=0,x=y=I=0,C=l);m&7;)m++;return m>>>3};S.F._bestMatch=function(f,e,t,n,i,r){var a=e&32767,s=t[a],u=a-s+(1<<15)&32767;if(s==a||n!=S.F._hash(f,e-u))return 0;for(var o=0,l=0,m=Math.min(32767,e);u<=m&&--r!=0&&s!=a;){if(o==0||f[e+o]==f[e+o-u]){var b=S.F._howLong(f,e,u);if(b>o){if(o=b,l=u,o>=i)break;u+2<b&&(b=u+2);for(var h=0,c=0;c<b-2;c++){var d=e-u+c+32768&32767,p=t[d],g=d-p+(1<<15)&32767;g>h&&(h=g,s=d)}}}a=s,s=t[a],u+=a-s+(1<<15)&32767}return o<<16|l};S.F._howLong=function(f,e,t){if(f[e]!=f[e-t]||f[e+1]!=f[e+1-t]||f[e+2]!=f[e+2-t])return 0;var n=e,i=Math.min(f.length,e+258);for(e+=3;e<i&&f[e]==f[e-t];)e++;return e-n};S.F._hash=function(f,e){return(f[e]<<8|f[e+1])+(f[e+2]<<4)&65535};S.saved=0;S.F._writeBlock=function(f,e,t,n,i,r,a,s,u){var o=S.F.U,l=S.F._putsF,m=S.F._putsE,b,h,c,d,p,g,x,y,C;o.lhst[256]++,b=S.F.getTrees(),h=b[0],c=b[1],d=b[2],p=b[3],g=b[4],x=b[5],y=b[6],C=b[7];var I=(u+3&7?8-(u+3&7):0)+32+(a<<3),P=n+S.F.contSize(o.fltree,o.lhst)+S.F.contSize(o.fdtree,o.dhst),F=n+S.F.contSize(o.ltree,o.lhst)+S.F.contSize(o.dtree,o.dhst);F+=14+3*x+S.F.contSize(o.itree,o.ihst)+(o.ihst[16]*2+o.ihst[17]*3+o.ihst[18]*7);for(var M=0;M<286;M++)o.lhst[M]=0;for(var M=0;M<30;M++)o.dhst[M]=0;for(var M=0;M<19;M++)o.ihst[M]=0;var w=I<P&&I<F?0:P<F?1:2;l(s,u,f),l(s,u+1,w),u+=3;var k=u;if(w==0){for(;u&7;)u++;u=S.F._copyExact(i,r,a,s,u)}else{var B,N;if(w==1&&(B=o.fltree,N=o.fdtree),w==2){S.F.makeCodes(o.ltree,h),S.F.revCodes(o.ltree,h),S.F.makeCodes(o.dtree,c),S.F.revCodes(o.dtree,c),S.F.makeCodes(o.itree,d),S.F.revCodes(o.itree,d),B=o.ltree,N=o.dtree,m(s,u,p-257),u+=5,m(s,u,g-1),u+=5,m(s,u,x-4),u+=4;for(var O=0;O<x;O++)m(s,u+O*3,o.itree[(o.ordr[O]<<1)+1]);u+=3*x,u=S.F._codeTiny(y,o.itree,s,u),u=S.F._codeTiny(C,o.itree,s,u)}for(var V=r,E=0;E<t;E+=2){for(var $=e[E],X=$>>>23,ie=V+($&(1<<23)-1);V<ie;)u=S.F._writeLit(i[V++],B,s,u);if(X!=0){var te=e[E+1],re=te>>16,W=te>>8&255,j=te&255;u=S.F._writeLit(257+W,B,s,u),m(s,u,X-o.of0[W]),u+=o.exb[W],u=S.F._writeLit(j,N,s,u),l(s,u,re-o.df0[j]),u+=o.dxb[j],V+=X}}u=S.F._writeLit(256,B,s,u)}return u};S.F._copyExact=function(f,e,t,n,i){var r=i>>>3;return n[r]=t,n[r+1]=t>>>8,n[r+2]=255-n[r],n[r+3]=255-n[r+1],r+=4,n.set(new Uint8Array(f.buffer,e,t),r),i+(t+4<<3)};S.F.getTrees=function(){for(var f=S.F.U,e=S.F._hufTree(f.lhst,f.ltree,15),t=S.F._hufTree(f.dhst,f.dtree,15),n=[],i=S.F._lenCodes(f.ltree,n),r=[],a=S.F._lenCodes(f.dtree,r),s=0;s<n.length;s+=2)f.ihst[n[s]]++;for(var s=0;s<r.length;s+=2)f.ihst[r[s]]++;for(var u=S.F._hufTree(f.ihst,f.itree,7),o=19;o>4&&f.itree[(f.ordr[o-1]<<1)+1]==0;)o--;return[e,t,u,i,a,o,n,r]};S.F.getSecond=function(f){for(var e=[],t=0;t<f.length;t+=2)e.push(f[t+1]);return e};S.F.nonZero=function(f){for(var e="",t=0;t<f.length;t+=2)f[t+1]!=0&&(e+=(t>>1)+",");return e};S.F.contSize=function(f,e){for(var t=0,n=0;n<e.length;n++)t+=e[n]*f[(n<<1)+1];return t};S.F._codeTiny=function(f,e,t,n){for(var i=0;i<f.length;i+=2){var r=f[i],a=f[i+1];n=S.F._writeLit(r,e,t,n);var s=r==16?2:r==17?3:7;r>15&&(S.F._putsE(t,n,a,s),n+=s)}return n};S.F._lenCodes=function(f,e){for(var t=f.length;t!=2&&f[t-1]==0;)t-=2;for(var n=0;n<t;n+=2){var i=f[n+1],r=n+3<t?f[n+3]:-1,a=n+5<t?f[n+5]:-1,s=n==0?-1:f[n-1];if(i==0&&r==i&&a==i){for(var u=n+5;u+2<t&&f[u+2]==i;)u+=2;var o=Math.min(u+1-n>>>1,138);o<11?e.push(17,o-3):e.push(18,o-11),n+=o*2-2}else if(i==s&&r==i&&a==i){for(var u=n+5;u+2<t&&f[u+2]==i;)u+=2;var o=Math.min(u+1-n>>>1,6);e.push(16,o-3),n+=o*2-2}else e.push(i,0)}return t>>>1};S.F._hufTree=function(f,e,t){var n=[],i=f.length,r=e.length,a=0;for(a=0;a<r;a+=2)e[a]=0,e[a+1]=0;for(a=0;a<i;a++)f[a]!=0&&n.push({lit:a,f:f[a]});var s=n.length,u=n.slice(0);if(s==0)return 0;if(s==1){var o=n[0].lit,u=o==0?1:0;return e[(o<<1)+1]=1,e[(u<<1)+1]=1,1}n.sort(function(p,g){return p.f-g.f});var l=n[0],m=n[1],b=0,h=1,c=2;for(n[0]={lit:-1,f:l.f+m.f,l,r:m,d:0};h!=s-1;)b!=h&&(c==s||n[b].f<n[c].f)?l=n[b++]:l=n[c++],b!=h&&(c==s||n[b].f<n[c].f)?m=n[b++]:m=n[c++],n[h++]={lit:-1,f:l.f+m.f,l,r:m};var d=S.F.setDepth(n[h-1],0);for(d>t&&(S.F.restrictDepth(u,t,d),d=t),a=0;a<s;a++)e[(u[a].lit<<1)+1]=u[a].d;return d};S.F.setDepth=function(f,e){return f.lit!=-1?(f.d=e,e):Math.max(S.F.setDepth(f.l,e+1),S.F.setDepth(f.r,e+1))};S.F.restrictDepth=function(f,e,t){var n=0,i=1<<t-e,r=0;for(f.sort(function(s,u){return u.d==s.d?s.f-u.f:u.d-s.d}),n=0;n<f.length&&f[n].d>e;n++){var a=f[n].d;f[n].d=e,r+=i-(1<<t-a)}for(r=r>>>t-e;r>0;){var a=f[n].d;a<e?(f[n].d++,r-=1<<e-a-1):n++}for(;n>=0;n--)f[n].d==e&&r<0&&(f[n].d--,r++);r!=0&&console.log("debt left")};S.F._goodIndex=function(f,e){var t=0;return e[t|16]<=f&&(t|=16),e[t|8]<=f&&(t|=8),e[t|4]<=f&&(t|=4),e[t|2]<=f&&(t|=2),e[t|1]<=f&&(t|=1),t};S.F._writeLit=function(f,e,t,n){return S.F._putsF(t,n,e[f<<1]),n+e[(f<<1)+1]};S.F.inflate=function(f,e){var t=Uint8Array;if(f[0]==3&&f[1]==0)return e||new t(0);var n=S.F,i=n._bitsF,r=n._bitsE,a=n._decodeTiny,s=n.makeCodes,u=n.codes2map,o=n._get17,l=n.U,m=e==null;m&&(e=new t(f.length>>>2<<3));for(var b=0,h=0,c=0,d=0,p=0,g=0,x=0,y=0,C=0,I,P;b==0;){if(b=i(f,C,1),h=i(f,C+1,2),C+=3,h==0){C&7&&(C+=8-(C&7));var F=(C>>>3)+4,M=f[F-4]|f[F-3]<<8;m&&(e=S.F._check(e,y+M)),e.set(new t(f.buffer,f.byteOffset+F,M),y),C=F+M<<3,y+=M;continue}if(m&&(e=S.F._check(e,y+(1<<17))),h==1&&(I=l.flmap,P=l.fdmap,g=(1<<9)-1,x=(1<<5)-1),h==2){c=r(f,C,5)+257,d=r(f,C+5,5)+1,p=r(f,C+10,4)+4,C+=14;for(var w=C,k=0;k<38;k+=2)l.itree[k]=0,l.itree[k+1]=0;for(var B=1,k=0;k<p;k++){var N=r(f,C+k*3,3);l.itree[(l.ordr[k]<<1)+1]=N,N>B&&(B=N)}C+=3*p,s(l.itree,B),u(l.itree,B,l.imap),I=l.lmap,P=l.dmap,C=a(l.imap,(1<<B)-1,c+d,f,C,l.ttree);var O=n._copyOut(l.ttree,0,c,l.ltree);g=(1<<O)-1;var V=n._copyOut(l.ttree,c,d,l.dtree);x=(1<<V)-1,s(l.ltree,O),u(l.ltree,O,I),s(l.dtree,V),u(l.dtree,V,P)}for(;;){var E=I[o(f,C)&g];C+=E&15;var $=E>>>4;if(!($>>>8))e[y++]=$;else{if($==256)break;var X=y+$-254;if($>264){var ie=l.ldef[$-257];X=y+(ie>>>3)+r(f,C,ie&7),C+=ie&7}var te=P[o(f,C)&x];C+=te&15;var re=te>>>4,W=l.ddef[re],j=(W>>>4)+i(f,C,W&15);for(C+=W&15,m&&(e=S.F._check(e,y+(1<<17)));y<X;)e[y]=e[y++-j],e[y]=e[y++-j],e[y]=e[y++-j],e[y]=e[y++-j];y=X}}}return e.length==y?e:e.slice(0,y)};S.F._check=function(f,e){var t=f.length;if(e<=t)return f;var n=new Uint8Array(Math.max(t<<1,e));return n.set(f,0),n};S.F._decodeTiny=function(f,e,t,n,i,r){for(var a=S.F._bitsE,s=S.F._get17,u=0;u<t;){var o=f[s(n,i)&e];i+=o&15;var l=o>>>4;if(l<=15)r[u]=l,u++;else{var m=0,b=0;l==16?(b=3+a(n,i,2),i+=2,m=r[u-1]):l==17?(b=3+a(n,i,3),i+=3):l==18&&(b=11+a(n,i,7),i+=7);for(var h=u+b;u<h;)r[u]=m,u++}}return i};S.F._copyOut=function(f,e,t,n){for(var i=0,r=0,a=n.length>>>1;r<t;){var s=f[r+e];n[r<<1]=0,n[(r<<1)+1]=s,s>i&&(i=s),r++}for(;r<a;)n[r<<1]=0,n[(r<<1)+1]=0,r++;return i};S.F.makeCodes=function(f,e){for(var t=S.F.U,n=f.length,i,r,a,s,u,o=t.bl_count,s=0;s<=e;s++)o[s]=0;for(s=1;s<n;s+=2)o[f[s]]++;var l=t.next_code;for(i=0,o[0]=0,r=1;r<=e;r++)i=i+o[r-1]<<1,l[r]=i;for(a=0;a<n;a+=2)u=f[a+1],u!=0&&(f[a]=l[u],l[u]++)};S.F.codes2map=function(f,e,t){for(var n=f.length,i=S.F.U,r=i.rev15,a=0;a<n;a+=2)if(f[a+1]!=0)for(var s=a>>1,u=f[a+1],o=s<<4|u,l=e-u,m=f[a]<<l,b=m+(1<<l);m!=b;){var h=r[m]>>>15-e;t[h]=o,m++}};S.F.revCodes=function(f,e){for(var t=S.F.U.rev15,n=15-e,i=0;i<f.length;i+=2){var r=f[i]<<e-f[i+1];f[i]=t[r]>>>n}};S.F._putsE=function(f,e,t){t=t<<(e&7);var n=e>>>3;f[n]|=t,f[n+1]|=t>>>8};S.F._putsF=function(f,e,t){t=t<<(e&7);var n=e>>>3;f[n]|=t,f[n+1]|=t>>>8,f[n+2]|=t>>>16};S.F._bitsE=function(f,e,t){return(f[e>>>3]|f[(e>>>3)+1]<<8)>>>(e&7)&(1<<t)-1};S.F._bitsF=function(f,e,t){return(f[e>>>3]|f[(e>>>3)+1]<<8|f[(e>>>3)+2]<<16)>>>(e&7)&(1<<t)-1};S.F._get17=function(f,e){return(f[e>>>3]|f[(e>>>3)+1]<<8|f[(e>>>3)+2]<<16)>>>(e&7)};S.F._get25=function(f,e){return(f[e>>>3]|f[(e>>>3)+1]<<8|f[(e>>>3)+2]<<16|f[(e>>>3)+3]<<24)>>>(e&7)};S.F.U=function(){var f=Uint16Array,e=Uint32Array;return{next_code:new f(16),bl_count:new f(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new f(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new e(32),flmap:new f(512),fltree:[],fdmap:new f(32),fdtree:[],lmap:new f(32768),ltree:[],ttree:[],dmap:new f(32768),dtree:[],imap:new f(512),itree:[],rev15:new f(1<<15),lhst:new e(286),dhst:new e(30),ihst:new e(19),lits:new e(15e3),strt:new f(1<<16),prev:new f(1<<15)}}();(function(){for(var f=S.F.U,e=1<<15,t=0;t<e;t++){var n=t;n=(n&2863311530)>>>1|(n&1431655765)<<1,n=(n&3435973836)>>>2|(n&858993459)<<2,n=(n&4042322160)>>>4|(n&252645135)<<4,n=(n&4278255360)>>>8|(n&16711935)<<8,f.rev15[t]=(n>>>16|n<<16)>>>17}function i(r,a,s){for(;a--!=0;)r.push(0,s)}for(var t=0;t<32;t++)f.ldef[t]=f.of0[t]<<3|f.exb[t],f.ddef[t]=f.df0[t]<<4|f.dxb[t];i(f.fltree,144,8),i(f.fltree,255-143,9),i(f.fltree,279-255,7),i(f.fltree,287-279,8),S.F.makeCodes(f.fltree,9),S.F.codes2map(f.fltree,9,f.flmap),S.F.revCodes(f.fltree,9),i(f.fdtree,32,5),S.F.makeCodes(f.fdtree,5),S.F.codes2map(f.fdtree,5,f.fdmap),S.F.revCodes(f.fdtree,5),i(f.itree,19,0),i(f.ltree,286,0),i(f.dtree,30,0),i(f.ttree,320,0)})()});var ro,ir=A(()=>{"use strict";ro=ws(ps());pi();je();G();nn();be();wa();va();Ei();Zi();ji();pn();dn();It();Xt();H();La();nr();zn();kn();Qn()});var Ga=A(()=>{"use strict";je();At();Fn();qr();Qr();ea();ir();Yn()});De();oe();fi();ri();ai();si();ui();oi();dn();pn();li();mi();hi();ci();bi();en();ae();ts();H();G();Jt();pi();un();je();Sn();sr();_e();At();gn();ur();sn();gi();nn();is();kn();or();zn();be();Tt();mr();_n();Ci();yi();xe();Nn();Dn();$n();Vn();Rn();Tn();_i();Gn();Hn();qn();En();Ln();Ve();Wn();Er();Rr();Dr();Vr();Lr();Ti();Hr();Di();Fn();Vi();cs();bs();qr();fs();Xr();Zr();Li();$r();Yr();Ga();na();Qr();Kr();ea();Jr();Xi();_a();qi();Gi();$i();sa();ra();oa();Wi();ma();ha();ba();da();Bn();pa();xa();Ca();ir();Hi();ji();Ei();Zi();Qn();wa();va();Pa();Ma();Qi();Ia();Va();Ta();Aa();Ji();Ba();Ua();er();Sa();Na();Da();za();tr();ta();Yn();Or();nr();La();wi();vi();Ii();Pi();Mi();Ai();Fi();Bi();Ui();Si();ki();Xn();xs();xi();It();jn();Nr();Ri();vr();Ir();Pr();Mr();Ar();Fr();Br();zi();Xt();_s();hr();cr();br();fr();dr();pr();$e();gr();xr();_r();yr();Cr();wr();Ur();kr();jr();ys();Cs();Ea();Ka();qa();Ha();})();
//# sourceMappingURL=index.js.map
